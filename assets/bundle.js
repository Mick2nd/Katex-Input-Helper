/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={"./src/assets/js/bootLoader.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BootLoader: () => (/* binding */ BootLoader)\n/* harmony export */ });\n/* harmony import */ var _jquery_plugin_jquery_min__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jquery-plugin/jquery.min */ \"./src/assets/js/jquery-plugin/jquery.min.js\");\n/* harmony import */ var _jquery_plugin_jquery_min__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_jquery_plugin_jquery_min__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _jquery_easyui_jquery_easyui_min__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./jquery-easyui/jquery.easyui.min */ \"./src/assets/js/jquery-easyui/jquery.easyui.min.js\");\n/* harmony import */ var _jquery_easyui_jquery_easyui_min__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_jquery_easyui_jquery_easyui_min__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _jquery_easyui_datagrid_dnd__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./jquery-easyui/datagrid-dnd */ \"./src/assets/js/jquery-easyui/datagrid-dnd.js\");\n/* harmony import */ var _jquery_easyui_datagrid_dnd__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_jquery_easyui_datagrid_dnd__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _jquery_easyui_datagrid_filter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./jquery-easyui/datagrid-filter */ \"./src/assets/js/jquery-easyui/datagrid-filter.js\");\n/* harmony import */ var _jquery_easyui_datagrid_filter__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_jquery_easyui_datagrid_filter__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _jquery_easyui_datagrid_cellediting__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./jquery-easyui/datagrid-cellediting */ \"./src/assets/js/jquery-easyui/datagrid-cellediting.js\");\n/* harmony import */ var _jquery_easyui_datagrid_cellediting__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_jquery_easyui_datagrid_cellediting__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _katex_katex_min__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./katex/katex.min */ \"./src/assets/js/katex/katex.min.js\");\n/* harmony import */ var _katex_katex_min__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_katex_katex_min__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _katex_mhchem__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./katex/mhchem */ \"./src/assets/js/katex/mhchem.js\");\n/* harmony import */ var _codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./codemirror/lib/codemirror */ \"./src/assets/js/codemirror/lib/codemirror.js\");\n/* harmony import */ var _codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _patterns_observable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./patterns/observable */ \"./src/assets/js/patterns/observable.js\");\n/* harmony import */ var _localization__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./localization */ \"./src/assets/js/localization.js\");\n/* harmony import */ var _themes__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./themes */ \"./src/assets/js/themes.js\");\n/* harmony import */ var _parserExtension__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./parserExtension */ \"./src/assets/js/parserExtension.js\");\n/* harmony import */ var _parameters__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./parameters */ \"./src/assets/js/parameters.js\");\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./math */ \"./src/assets/js/math.js\");\n/* harmony import */ var _dialog__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./dialog */ \"./src/assets/js/dialog.js\");\n/* harmony import */ var _fileHandling__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./fileHandling */ \"./src/assets/js/fileHandling.js\");\n/* harmony import */ var _categoriesTree__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./categoriesTree */ \"./src/assets/js/categoriesTree.js\");\n/* harmony import */ var _panels__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./panels */ \"./src/assets/js/panels.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @abstract The boot loader of the Katex Input Helper.\r\n * \r\n * This is capable of supporting 2 different scenarios, one using *easyloader*, one not. \r\n */\r\nclass BootLoader {\r\n\t\r\n\tbaseLocation = null;\r\n\tvme = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor() {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Converts a method with given signature and callback to a Promise returning method.\r\n\t * \r\n\t * A special case is the use of setTimeout, where the order of arguments is swapped.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t * @param fnc - a function object to be invoked\r\n\t * @param args - args of the function. The function has one additional callback parameter\r\n\t * @returns the Promise, will be fulfilled if the callback is invoked\r\n\t */\r\n\tasync promisify(fnc, ...args) {\r\n\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\ttry {\r\n\t\t\t\tfunction resolveFunc() {\r\n\t\t\t\t\tvar msg = `Promise check: ${args} `;\r\n\t\t\t\t\tconsole.debug(msg);\r\n\t\t\t\t\tresolve('Success');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (fnc === setTimeout) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tresolveFunc();\r\n\t\t\t\t\t}, ...args);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfnc(...args, function() {\r\n\t\t\t\t\t\tresolveFunc();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch(err) {\r\n\t\t\t\tconsole.error(`Error occurred: ${err} `);\t\t\r\n\t\t\t\treject(err);\r\n\t\t\t}\t\t\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract A using function encapsulated by a Promise.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t * @param script - the url of the script to be loaded\r\n\t * @returns - the Promise indicating the state of the transaction\r\n\t */\r\n\tasync usingAsync(script) {\r\n\t\treturn this.promisify(/*using*/easyloader.load.bind(easyloader), script);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The promise is fulfilled if the document becomes ready.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync readyAsync() {\r\n\t\tvar doc = $(document);\r\n\t\treturn this.promisify(doc.ready.bind(doc));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The promise is fulfilled after a timeout is elapsed.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync setTimeoutAsync(delay) {\r\n\t\treturn this.promisify(setTimeout, delay);\r\n\t}\t\r\n\t\r\n\t/**\r\n\t * @abstract Initializes the scripts (css and js) using the easyloader.\r\n\t * \r\n\t * All but this boot loader and the easy loader is loaded here.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync initScripts() {\r\n\t\tthis.baseLocation = this.getBaseLocation();\r\n\t\teasyloader.base = this.baseLocation;    \t\t\t\t\t// set the easyui base directory\r\n\t\teasyloader.css = false;\r\n\t\tconsole.dir(easyloader.modules);\r\n\t\r\n\t\tvar modules = [ \r\n\t\t\t'parser', 'layout','window', 'dialog', 'panel', 'datagrid', 'tree', \r\n\t\t\t'menubutton', 'menu', 'accordion', 'linkbutton', 'tooltip', 'tabs', \r\n\t\t\t'messager', 'combobox' ];\r\n\t\t\r\n\t\tvar scripts = [\r\n\t\t\t//\"./jquery.easyui.min.js\",\r\n\t\t\t\"./datagrid-cellediting.js\",\r\n\t\t\t\"./datagrid-filter.js\",\r\n\t\t\t\"../jquery-colorpicker/js/colorpicker.js\",\r\n\t\t\t\"../codemirror/lib/codemirror.js\",\r\n\t\t\t\"../katex/katex.min.js\",\r\n\t\t\t\"../katex/mhchem.min.js\",\r\n\t\t\t\r\n\t\t\t\"../patterns/observable.js\",\r\n\t\t\t\"../localization.js\",\r\n\t\t\t\"../themes.js\",\r\n\t\t\t\"../parserExtension.js\",\r\n\t\t\t\"../parameters.js\",\r\n\t\t\t\"../fileHandling.js\",\r\n\t\t\t\"../helpers.js\",\r\n\t\t\t\"../math.js\",\r\n\t\t\t\"../categoriesTree.js\",\r\n\t\t\t\"../panels.js\",\r\n\t\t\t\"../dialog.js\"\r\n\t\t];\r\n\t\t\r\n\t\tvar csss = [\r\n\t\t\t\"./themes/default/easyui.css\",\r\n\t\t\t\"./themes/icon.css\",\r\n\t\t\t\"../jquery-easyui-MathEditorExtend/themes/aguas/easyui.css\",\r\n\t\t\t\"../jquery-easyui-MathEditorExtend/themes/icon.css\",\r\n\t\t\t\"../jquery-colorpicker/css/colorpicker.css\",\r\n\t\t\t\"../codemirror/lib/codemirror.css\",\r\n\t\t\t\"../keyboard/Keyboard.css\",\r\n\t\t\t\"../katex/katex.min.css\",\r\n\t\t\t\"../dialog.css\"\r\n\t\t];\r\n\r\n\t\tawait this.usingAsync('./jquery.min.js');\r\n\r\n\t\tfor (var module of modules) {\r\n\t\t\tawait this.usingAsync(module);\r\n\t\t}\r\n\t\r\n\t\tfor (var css of csss) {\r\n\t\t\tawait this.usingAsync(css);\r\n\t\t\t// works but has no effect\r\n\t\t\t$('link')\r\n\t\t\t.last()\r\n\t\t\t.removeAttr('media');\r\n\t\t}\r\n\t\t\r\n\t\tfor (var script of scripts) {\r\n\t\t\tawait this.usingAsync(script);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initializes the app.\r\n\t * \r\n\t * This is the true application logic.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync initApp(useEasyLoader) {\r\n\t\ttry {\r\n\t\t\tthis.vme = new _dialog__WEBPACK_IMPORTED_MODULE_14__.KatexInputHelper(useEasyLoader);\r\n\t\t\twindow.vme = this.vme;\t\t\t\t\t\t\t\t\t\t\t// prevents garbage collection?\r\n\t\t\tawait this.vme.initialise();\r\n\t\t\t$('#myContainer').layout({fit: true});\r\n\t\t\t$('#divEquationInputOutput').layout({});\r\n\t\t} finally {\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialization scenario 1 : without easy loader.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync init1() {\r\n\t\tvar counter = 20;\r\n\t\twhile (!this.presenceCheck(counter) && --counter >= 0) {\r\n\t\t\tawait this.setTimeoutAsync(100);\r\n\t\t}\r\n\t\tconsole.info(`jquery loaded : ${typeof $} `);\r\n\t\t\r\n\t\tawait this.readyAsync();\r\n\t\tconsole.debug('Promise check : document ready.');\r\n\t\t\r\n\t\tawait this.initApp(false);\r\n\t\tconsole.debug('Promise check : app started.');\r\n\t\tthis.check();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initialization scenario 2 : with easy loader.\r\n\t * \r\n\t * @async implements the Promise contract\r\n\t */\r\n\tasync init2() {\r\n\t\tvar counter = 0;\r\n\t\twhile ((typeof easyloader !== 'object' || !document.currentScript) && ++counter <= 50) {\r\n\t\t\tawait this.setTimeoutAsync(100);\r\n\t\t}\r\n\t\tif (counter > 50) {\r\n\t\t\tthrow Error(\"easyloader not loaded\");\r\n\t\t}\r\n\t\tconsole.info(`easyloader loaded : ${typeof easyloader} `);\r\n\r\n\t\tawait this.initScripts();\r\n\t\tconsole.debug('Promise check : scripts loaded.');\r\n\t\t\r\n\t\tawait this.readyAsync();\r\n\t\tconsole.debug('Promise check : document ready.');\r\n\t\t\r\n\t\t// trial to shift misplaced menus\r\n\t\t// $('#mFile, #mInsert, #mTools, #mView, #mOptions, #mInformations').append($('#menu'));\r\n\t\t\r\n\t\tawait this.initApp(true);\r\n\t\tconsole.debug('Promise check : app started.');\r\n\t\tthis.check();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Sets the base location.\r\n\t * \r\n\t * This will be needed for relative paths of some content like css or js files.\r\n\t * Is here used only for *easyloader*.\r\n\t * \r\n\t * @returns the location of this script, ending with a slash\r\n\t */\r\n\tgetBaseLocation() {\r\n\t\tvar location = document.currentScript.src\r\n\t\t\t.split('/')\r\n\t\t\t.slice(0, -1)\t\t\t\t\t\t\t\t\t\t// up to js folder\r\n\t\t\t.join('/')\r\n\t\t\t.replace(/ /g, '%20')\r\n\t\t\t.replace('file:///', 'file://')\r\n\t\t\t.replace('file://', 'file:///') + '/jquery-easyui/';\r\n\t\t\t\r\n\t\treturn location;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Checks the presence of the required scripts.\r\n\t */\r\n\tpresenceCheck(cycle) {\r\n\t\tvar lastChecked = 'Test';\r\n\t\tfunction checkTypeByName(type, name, readableName = name) {\r\n\t\t\tlastChecked = readableName;\r\n\t\t\tif (type === undefined || type === null || typeof type === 'undefined' || !type.prototype) {\r\n\t\t\t\tconsole.warn(`Undefined type : ${readableName}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar detectedName = type.prototype[\"constructor\"][\"name\"];\r\n\t\t\tvar equal = (detectedName === name);\r\n\t\t\tif (!equal) {\r\n\t\t\t\tconsole.warn(`Type check failed : ${detectedName} : ${readableName}`);\r\n\t\t\t}\r\n\t\t\treturn equal;\r\n\t\t}\r\n\t\tfunction checkOther(type, name, readableName) {\r\n\t\t\tlastChecked = readableName;\r\n\t\t\tvar equal = type === name;\r\n\t\t\tif (!equal) {\r\n\t\t\t\tconsole.warn(`Type check failed : ${type} : ${readableName}`);\r\n\t\t\t}\r\n\t\t\treturn equal;\r\n\t\t}\r\n\t\tfunction mhchemCheck() {\r\n\t\t\ttry {\r\n\t\t\t\tlastChecked = \"Mhchem\";\r\n\t\t\t\t_katex_katex_min__WEBPACK_IMPORTED_MODULE_5___default().renderToString(\"\\\\ce{SO4^2- + Ba^2+ -> BaSO4 v} \", { throwOnError: true });\r\n\t\t\t\treturn true;\r\n\t\t\t} catch(e) {\r\n\t\t\t\tconsole.warn(`Presence check failed : Mhchem`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar allLoaded = (\r\n\t\t\t// false &&\r\n\t\t\tcheckOther(typeof $, 'function', 'jquery') &&\r\n\t\t\tcheckOther(typeof $.messager, 'object', 'easyui') &&\r\n\t\t\tcheckOther(typeof $.fn.datagrid, 'function', 'datagrid') &&\r\n\t\t\tcheckOther(typeof $.fn.datagrid.defaults, 'object', 'datagrid') &&\r\n\t\t\tcheckOther(typeof $.fn.datagrid.defaults.defaultFilterOptions, 'object', 'datagrid-filter') &&\r\n\t\t\t// can we independantly check dnd and cellediting?\r\n\t\t\tcheckOther(typeof (_katex_katex_min__WEBPACK_IMPORTED_MODULE_5___default()), 'object', 'Katex') &&\r\n\t\t\tcheckOther(typeof (_katex_katex_min__WEBPACK_IMPORTED_MODULE_5___default().renderToString), 'function', 'Katex') &&\r\n\t\t\tmhchemCheck() &&\r\n\t\t\t//checkOther(typeof ($.fn.ColorPicker), 'function', 'ColorPicker') &&\r\n\t\t\tcheckTypeByName((_codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_7___default()), 'CodeMirror', 'CodeMirror') &&\r\n\t\t\t\r\n\t\t\tcheckTypeByName(_patterns_observable__WEBPACK_IMPORTED_MODULE_8__.Observable, 'Observable') &&\r\n\t\t\tcheckTypeByName(_localization__WEBPACK_IMPORTED_MODULE_9__.Localizer, 'Localizer') &&\r\n\t\t\tcheckTypeByName(_themes__WEBPACK_IMPORTED_MODULE_10__.Themes, 'Themes') &&\r\n\t\t\tcheckTypeByName(_parserExtension__WEBPACK_IMPORTED_MODULE_11__.ParserExtension, 'ParserExtension') &&\r\n\t\t\tcheckTypeByName(_parameters__WEBPACK_IMPORTED_MODULE_12__.KIHParameters, 'KIHParameters') &&\r\n\t\t\tcheckTypeByName(_fileHandling__WEBPACK_IMPORTED_MODULE_15__.FileHandler, 'FileHandler') &&\r\n\t\t\tcheckTypeByName(_math__WEBPACK_IMPORTED_MODULE_13__.MathFormulae, 'MathFormulae') &&\r\n\t\t\tcheckTypeByName(_categoriesTree__WEBPACK_IMPORTED_MODULE_16__.CategoriesTree, 'CategoriesTree') &&\r\n\t\t\tcheckTypeByName(_panels__WEBPACK_IMPORTED_MODULE_17__.DynamicPanel, 'DynamicPanel') &&\r\n\t\t\tcheckTypeByName(_dialog__WEBPACK_IMPORTED_MODULE_14__.KatexInputHelper, 'KatexInputHelper'));\r\n\t\tif (! allLoaded && cycle <= 0) {\r\n\t\t\tthrow Error(`${lastChecked} not loaded`);\r\n\t\t}\r\n\t\t\t\r\n\t\treturn allLoaded;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Performs a check about the presence of certain Html objects and provides\r\n\t * \t\t\t console report.\r\n\t */\r\n\tcheck() {\r\n\t\tvar ids = [\r\n\t\t\t'html',\r\n\t\t\t'head',\r\n\t\t\t'body',\r\n\t\t\t'#bodyPage',\r\n\t\t\t'#myContainer',\r\n\t\t\t'.easyui-layout', \r\n\t\t\t'.easyui-menubutton',\r\n\t\t\t'.easyui-dialog',\r\n\t\t];\r\n\t\tfor (var id of ids) {\r\n\t\t\t$(id)\r\n\t\t\t.each(function() {\r\n\t\t\t\tconsole.debug(`Element check : ${$(this).prop('tagName')} : ${$(this).attr('id')} `);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Displays an alert message in case of a crash.\r\n\t */\r\n\tfatal(err) {\r\n\t\talert('The Katex Input Helper could not be opened properly, \\n' + \r\n\t\t\t`(${err}). \\nPlease close it and open it again!`);\r\n\t}\r\n}\t\r\n\r\nif (!window.bootLoaderLoaded) {\r\n\twindow.bootLoaderLoaded = true;\r\n\tvar kihBootLoader = new BootLoader();\r\n\tkihBootLoader.init1()\r\n\t.then(() => {\r\n\t\tkihBootLoader.check();\r\n\t})\r\n\t.catch(err => {\r\n\t\tconsole.error(`Error ${err} `, err);\r\n\t\tkihBootLoader.fatal(err);\r\n\t});\r\n}\r\n\r\n/*\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = BootLoader;\r\n} catch(e) { }\r\n*/\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/bootLoader.js?")},"./src/assets/js/categoriesTree.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CategoriesTree: () => (/* binding */ CategoriesTree)\n/* harmony export */ });\n/* harmony import */ var _patterns_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./patterns/observable */ \"./src/assets/js/patterns/observable.js\");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n/**\r\n * @abstract Manages the Categories Tree.\r\n * \r\n * The Leafs of the tree refer to a set of equations and constitute the categories.\r\n * The Folders constitute super categories.\r\n */\r\nclass CategoriesTree {\r\n\t\r\n\tdata = null;\r\n\ttreeSelector = \"\";\r\n\t_tree = null;\r\n\tcontextNode = null;\r\n\tdropSourceParent = null;\r\n\tid = 0;\r\n\t\r\n\tpreviousLeaf = null;\r\n\tcurrentLeaf = null;\r\n\tnodeSelected = null;\r\n\ttreeChanged = null;\r\n\tequationMoved = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor() {\r\n\t\tthis.treeSelector = `#categories`;\r\n\t\tthis._tree = $(this.treeSelector);\r\n\t\tthis.nodeSelected = new _patterns_observable__WEBPACK_IMPORTED_MODULE_0__.Observable();\t\t\r\n\t\tthis.treeChanged = new _patterns_observable__WEBPACK_IMPORTED_MODULE_0__.Observable();\r\n\t\tthis.equationMoved = new _patterns_observable__WEBPACK_IMPORTED_MODULE_0__.Observable();\r\n\t\tthis.treeInitialise();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the tree jquery object.\r\n\t */\r\n\tget tree() {\r\n\t\treturn this._tree;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The Custom Equations setter.\r\n\t * \r\n\t * The whole data set, JSON compatible, with categories and equations.\r\n\t * This variant adds also some Sample data.\r\n\t * \r\n\t * @async the async variant with Promise contract\r\n\t */\r\n\tasync setCustomEquations(value) {\r\n\t\tvar converted = this.convert(value);\r\n\t\tconverted = await this.addSamples(converted);\r\n\t\tthis.data = this.getCustomEquationsProxy(converted);\r\n\t\tthis.initialise();\t\t\t\t\t\t\t\t\t\t// it is essential to invoke it here before currentEquations \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The Custom Equations setter.\r\n\t * \r\n\t * The whole data set, JSON compatible, with categories and equations.\r\n\t */\r\n\tset customEquations(value) {\r\n\t\tvar converted = this.convert(value);\r\n\t\tthis.data = this.getCustomEquationsProxy(converted);\r\n\t\tthis.initialise();\t\t\t\t\t\t\t\t\t\t// it is essential to invoke it here before currentEquations \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The Custom Equations getter.\r\n\t * \r\n\t * The whole data set, JSON compatible, with categories and equations.\r\n\t */\r\n\tget customEquations() {\r\n\t\treturn this.data;\r\n\t}\r\n\r\n\t/** @abstract Use this construct to make copies\r\n\t */\t\r\n\tgetCustomEquationsProxy(data) {\r\n\t\tvar rows = null;\r\n\t\trows = [ data ];\r\n\t\treturn _proxy(rows);\r\n\r\n\t\t/**\r\n\t\t * @abstract Copy a single node with relevant data.\r\n\t\t */\r\n\t\tfunction _copy(from) {\r\n\t\t\tvar keys = ['text', 'state', 'attributes', 'selected', 'haveSamples'];\r\n\t\t\tvar to = { };\r\n\t\t\tfor (var key of Object.keys(from)) {\r\n\t\t\t\tif (keys.includes(key)) {\r\n\t\t\t\t\tto[key] = from[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tto.children = [ ];\r\n\t\t\t\r\n\t\t\treturn to;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @abstract Proxy an array of nodes.\r\n\t\t */\r\n\t\tfunction _proxy(rows, parent = null) {\r\n\t\t\tvar targetRows = [ ];\r\n\t\t\tfor (var row of rows) {\r\n\t\t\t\tvar targetRow = _copy(row);\r\n\t\t\t\ttargetRows.push(targetRow);\r\n\t\t\t\tif (parent != null) {\r\n\t\t\t\t\tparent.children.push(targetRow);\r\n\t\t\t\t}\r\n\t\t\t\tvar children = row.children;\r\n\t\t\t\tif (children && children.length) {\r\n\t\t\t\t\t_proxy(children, targetRow);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn targetRows[0];\r\n\t\t}\t\t\r\n\t}\r\n\r\n\t\t\r\n\t/**\r\n\t * @abstract A Proxy of the Custom Equations data.\r\n\t * \r\n\t * This is capable of being serialized over JSON.\r\n\t */\r\n\tget customEquationsProxy() {\r\n\t\treturn this.getCustomEquationsProxy(this.data);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The Current Equations setter as for the current selected category.\r\n\t */\r\n\tset currentEquations(value) {\r\n\t\tif (this.currentLeaf != null) {\r\n\t\t\ttry {\r\n\t\t\t\tif (this.currentLeaf.attributes === undefined) {\r\n\t\t\t\t\tthis.currentLeaf.attributes = { };\r\n\t\t\t\t}\r\n\t\t\t\tif (this.currentLeaf.text == 'Default' && value.length === 0) {\r\n\t\t\t\t\tconsole.trace(`CategoriesTree : currentEquations setter`);\r\n\t\t\t\t}\r\n\t\t\t\tthis.currentLeaf.attributes.equations = value;\r\n\t\t\t} catch(e) {\r\n\t\t\t\tconsole.warn(`Exception in currentEquations setter : ${e} `);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The Current Equations getter as for the current selected category.\r\n\t */\r\n\tget currentEquations() {\r\n\t\tif (!this.currentLeaf) {\r\n\t\t\tthis.currentLeaf = \r\n\t\t\t\tthis.tree\r\n\t\t\t\t.tree('find', { text: 'Default'});\r\n\t\t}\r\n\t\ttry {\r\n\t\t\treturn this.currentLeaf.attributes.equations;\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`Exception in currentEquations getter : ${e} `);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract One time initialization of the *tree* extension. \r\n\t */\r\n\ttreeInitialise() {\r\n\t\tvar inst = this;\r\n\t\t$.extend($.fn.tree.methods, {\r\n\t\t\t/**\r\n\t\t\t * @abstract Extension of tree methods with sort functionality.\r\n\t\t\t */\r\n\t\t\tsort: function(jq, order) {\r\n\t\t\t\treturn jq.each(function() {\r\n\t\t\t\t\tinst.sort.bind(inst)(order);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tisLeafDefault: $.fn.tree.methods.isLeaf,\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * @abstract Extension (replacement) of tree methods with custom *isLeaf* method.\r\n\t\t\t */\r\n\t\t\tisLeaf: function(jq, target) {\r\n\t\t\t\treturn (function() {\r\n\t\t\t\t\tvar node = $(jq[0]).tree('getNode', target);\r\n\t\t\t\t\tif (node != null) {\r\n\t\t\t\t\t\tconsole.debug(`isLeaf: ${'attributes' in node} `);\r\n\t\t\t\t\t\treturn 'attributes' in node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn $(jq[0]).tree('isLeafDefault', target);\r\n\t\t\t\t})();\t\t\t\t \r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$.extend(true, $.fn.droppable.defaults, { accept: '.tree-node, .datagrid-div' });\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initialise routine. Part of the Custom Equations setter.\r\n\t */\r\n\tinitialise() {\r\n\t\tvar inst = this;\r\n\r\n\t\tfunction updateDndIcon(yes) {\r\n\t\t\t$('body')\r\n\t\t\t.find('.tree-dnd-icon')\r\n\t\t\t.removeClass('tree-dnd-yes tree-dnd-no')\r\n\t\t\t.addClass(yes ? 'tree-dnd-yes' : 'tree-dnd-no');\r\n\t\t}\r\n\t\t\r\n\t\tthis.tree\r\n\t\t.tree({\r\n\t\t\tdnd: true,\r\n\t\t\taccept: '.datagrid-div, .tree-node',\r\n\t\t\t\r\n\t\t\tonDragEnter: function(target, source) {\r\n\t\t\t\tconsole.debug(`onDragEnter `);\r\n\t\t\t\tconsole.dir(this);\r\n\t\t\t\tvar isLeaf = $(this).tree('isLeaf', target);\r\n\t\t\t\tupdateDndIcon(!isLeaf);\r\n\t\t\t},\r\n\t\t\tonDragOver: function(target, source) {\r\n\t\t\t\tconsole.debug(`onDragOver `);\r\n\t\t\t\tvar isLeaf = $(this).tree('isLeaf', target);\r\n\t\t\t\tupdateDndIcon(!isLeaf);\r\n\t\t\t},\r\n\t\t\tonDragLeave: function(target, source) {\r\n\t\t\t\tconsole.debug(`onDragLeave `);\r\n\t\t\t\tupdateDndIcon(false);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tonBeforeDrop: function(target, source, point) {\r\n\t\t\t\tconsole.debug(`onBeforeDrop ${point} `);\r\n\t\t\t\tconsole.dir(source);\r\n\t\t\t\t\r\n\t\t\t\tif (point != 'append') {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar isLeaf = $(this).tree('isLeaf', target);\r\n\r\n\t\t\t\tvar targetNode = $(this).tree('getNode', target);\r\n\t\t\t\tinst.openFolder(targetNode, false);\r\n\t\t\t\tinst.openFolder(targetNode, true);\r\n\r\n\t\t\t\tinst.dropSourceParent = inst.getParent(source);\r\n\r\n\t\t\t\tconsole.debug(`onBeforeDrop target is Leaf ${isLeaf} `);\r\n\t\t\t\treturn !isLeaf;\r\n\t\t\t},\r\n\t\t\tonDrop: function(target, source, point) {\r\n\t\t\t\tvar targetNode = $(this).tree('getNode', target);\r\n\t\t\t\tinst.openFolder(targetNode, false);\r\n\t\t\t\tinst.openFolder(targetNode, true);\r\n\t\t\t\t\r\n\t\t\t\tif (!inst.dropSourceParent.children || inst.dropSourceParent.children.length == 0) {\r\n\t\t\t\t\tinst.openFolder(inst.dropSourceParent, false);\r\n\t\t\t\t\tinst.correctIcon(inst.dropSourceParent);\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\tconsole.debug(`onDrop dropping ${source.text} `);\r\n\t\t\t},\r\n\t\t\tonBeforeSelect: function(node) {\r\n\t\t\t\tvar isLeaf = $(this).tree('isLeaf', node.target);\r\n\t\t\t\treturn isLeaf;\r\n\t\t\t},\r\n\t\t\tonSelect: function(node) {\r\n\t\t\t\tvar isLeaf = $(this).tree('isLeaf', node.target);\r\n\t\t\t\tif (isLeaf) {\r\n\t\t\t\t\tinst.previousLeaf = inst.currentLeaf;\r\n\t\t\t\t\tinst.currentLeaf = node;\r\n\t\t\t\t\tinst.customEquations.selected = inst.pathFromNode(node);\r\n\t\t\t\t\tinst.nodeSelected.notify(node.attributes.equations);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonDblClick: function(node) {\r\n\t\t\t\t$(this).tree('beginEdit', node.target);\t\t\t\t\r\n\t\t\t},\r\n\t\t\tonAfterEdit: function(node) {\r\n\t\t\t\tinst.treeChanged.notify(node);\t\t\t\t\r\n\t\t\t},\r\n\t\t\tonContextMenu: inst.onContextMenu.bind(inst),\r\n\t\t\tonLoadSuccess: inst.onLoadSuccess.bind(inst)\r\n\t\t})\r\n\t\t.tree('loadData', [ this.customEquations ])\r\n\t\t.tree('sort', 'asc');\r\n\t\tthis.expandAlt();\r\n\t\tthis.renumberIds();\r\n\r\n\t\tvar nodePath = '/Categories/Default';\r\n\t\tif (this.customEquations.selected !== undefined) {\r\n\t\t\tnodePath = this.customEquations.selected;\r\n\t\t}\r\n\t\tvar node = this.nodeFromPath(nodePath); \t\t\t\t// this.tree.tree('find', { text: nodeText });\r\n\t\tif (node != null) {\r\n\t\t\tthis.findNode(node);\r\n\t\t\tthis.tree.tree('select', node.target);\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tconsole.debug(`CategoriesTree : %O`, this.data);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The context menu of the tree nodes.\r\n\t * \r\n\t * We distinguish 2 context menues: one for the Leafs and one for the Folders.\r\n\t */\r\n\tonContextMenu(e, node) {\r\n\t\tvar inst = this;\r\n\r\n\t\tfunction remove() {\r\n\t\t\tvar nodeParent = inst.getParent(node);\r\n\t\t\tinst.tree.tree('remove', node.target);\r\n\t\t\t\r\n\t\t\tif (!nodeParent.children || nodeParent.children.length == 0) {\r\n\t\t\t\tinst.openFolder(nodeParent, false);\r\n\t\t\t\tinst.correctIcon(nodeParent);\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\te.preventDefault();\r\n\t\tinst.contextNode = node;\r\n\t\tif (!inst.isLeaf(node)) {\r\n\t\t\t$('#treeMenu')\t\t\t\t\t\t\t// prepare menu for Folders\r\n\t\t\t.menu({\r\n\t\t\t\tonClick: function(item) {\r\n\t\t\t\t\tconsole.debug(`Click on menu item ${item.target.id} `);\r\n\t\t\t\t\tswitch(item.target.id) {\r\n\t\t\t\t\t\tcase \"mAppendFolder\": \r\n\t\t\t\t\t\t\tinst.tree\r\n\t\t\t\t\t\t\t.tree('collapseAll', node.target)\r\n\t\t\t\t\t\t\t.tree('append', { parent: node.target, data: [{ text: 'Folder-1', id: inst.freeId, state: 'closed', children: [] }] });\r\n\t\t\t\t\t\t\tinst.expandAlt();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"mAppendCategory\":\r\n\t\t\t\t\t\t\tinst.tree\r\n\t\t\t\t\t\t\t.tree('collapseAll', node.target)\r\n\t\t\t\t\t\t\t.tree('append', { parent: node.target, data: [{ text: 'Category-1', id: inst.freeId, attributes: { equations: []} }] });\r\n\t\t\t\t\t\t\tinst.expandAlt();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"mRemove\":\r\n\t\t\t\t\t\t\tremove();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinst.treeChanged.notify(node);\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.menu('show', {\t\t\t\t\t\t// display context menu\r\n\t\t\t\tleft: e.pageX,\r\n\t\t\t\ttop: e.pageY\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t$('#treeMenuLeaf')\t\t\t\t\t// prepare menu for Leafs\r\n\t\t\t.menu({\r\n\t\t\t\tonClick: function(item) {\r\n\t\t\t\t\tconsole.debug(`Click on menu item ${item.target.id} `);\r\n\t\t\t\t\tswitch(item.target.id) {\r\n\t\t\t\t\t\tcase \"mRemoveLeaf\":\r\n\t\t\t\t\t\t\tremove();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"mCutPaste\":\r\n\t\t\t\t\t\t\tinst.moveEquations(inst.currentLeaf, node);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinst.treeChanged.notify(node);\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.menu('show', {\t\t\t\t\t\t// display context menu\r\n\t\t\t\tleft: e.pageX,\r\n\t\t\t\ttop: e.pageY\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The *onLoadSuccess* event handler.\r\n\t * \r\n\t * Its main purpose is to support the drag an drop operations from the datagrid\r\n\t * to the tree.\r\n\t */\r\n\tonLoadSuccess() {\r\n\t\tconsole.debug(`onLoadSuccess`);\r\n\t\tvar inst = this;\r\n\t\tinst.tree\r\n\t\t.find('.tree-node')\r\n\t\t.each(function() {\r\n\t\t\tvar opts = $(this)\r\n\t\t\t/* TEST WITHOUT THIS\r\n\t\t\t.droppable({ \r\n\t\t\t\taccept: 'div.tree-node, div.datagrid-div' \r\n\t\t\t})\r\n\t\t\t*/\r\n\t\t\t.droppable('options');\t\t\t\r\n\t\t\tconsole.debug(`Found tree node with accept: ${opts.accept} `);\r\n\r\n\t\t\topts.accept = 'div.tree-node, div.datagrid-div';\r\n\t\t\tvar onDragEnter = opts.onDragEnter;\r\n\t\t\tvar onDragOver = opts.onDragOver;\r\n\t\t\tvar onDragLeave = opts.onDragLeave;\r\n\t\t\tvar onDrop = opts.onDrop;\r\n\t\t\tvar onBeforeDrop = opts.onBeforeDrop;\r\n\t\t\t\r\n\t\t\topts.onDragEnter = function(e, source) {\r\n\t\t\t\tconsole.debug(`opts.onDragEnter`);\r\n\t\t\t\tconsole.dir(source);\r\n\t\t\t\tif ($(source).hasClass('tree-node')) {\r\n\t\t\t\t\treturn onDragEnter.call(this, e, source);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t};\r\n\t\t\topts.onDragOver = function(e, source) {\r\n\t\t\t\tconsole.debug(`opts.onDragOver`);\r\n\t\t\t\tif ($(source).hasClass('tree-node')) {\r\n\t\t\t\t\tonDragOver.call(this, e, source);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// allowDrop(source, true);\r\n\t\t\t\t\t$(this).removeClass('tree-node-append tree-node-top tree-node-bottom');\r\n\t\t\t\t\t$(this).addClass('tree-node-append');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\topts.onDragLeave = function(e, source) {\r\n\t\t\t\tif ($(source).hasClass('tree-node')) {\r\n\t\t\t\t\tonDragLeave.call(this, e, source);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// allowDrop(source, false);\r\n\t\t\t\t\t$(this).removeClass('tree-node-append tree-node-top tree-node-bottom');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\topts.onBeforeDrop = function(e, source, point) {\r\n\t\t\t\tif ($(source).hasClass('tree-node')) {\r\n\t\t\t\t\treturn onBeforeDrop.call(this, e, source, point);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\topts.onDrop = function(e, source, point) {\r\n\t\t\t\tif ($(source).hasClass('tree-node')) {\r\n\t\t\t\t\tonDrop.call(this, e, source, point);\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract *moveEquations* moves the checked equations from a source to a target category (Leaf node).\r\n\t * \r\n\t * This method notifies Observers about the change, f.i. the datagrid panel.\r\n\t * \r\n\t * @param from - source leaf node \r\n\t * @param to - target leaf node\r\n\t */\r\n\tmoveEquations(from, to) {\r\n\t\ttry {\r\n\t\t\tif (to !== from) {\r\n\t\t\t\tvar checkedEquations = this.getCheckedEquations();\t\t\t\t// indices\r\n\t\t\t\tfor (var idx of checkedEquations) {\t\t\t\t\t\t\t\t// first append the checked equations to the target\r\n\t\t\t\t\tvar equation = from.attributes.equations[idx];\r\n\t\t\t\t\tto.attributes.equations.push(equation);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.deleteEquations(from.attributes, checkedEquations);\t\t// then delete them from the source (from)\r\n\t\t\t\tthis.equationMoved.notify();\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`moveEquations failed : ${e} `);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Deletes a set of equations from the given set.\r\n\t * \r\n\t * @param from - the set of equations to be modified\r\n\t * @param checked - the indices of equations to be deleted\r\n\t */\r\n\tdeleteEquations(from, checked) {\r\n\t\tfrom.equations = from.equations.filter(\t\t\t\t\t\t\t\t\t// then delete them from the source (from)\r\n\t\t\t(elem, index) => !checked.includes(index));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the indices of the checked equations in the datagrid.\r\n\t * \r\n\t * @returns array of indices\r\n\t */\r\n\tgetCheckedEquations() {\r\n\t\tvar checkedRows = $('#customDatagrid')\r\n\t\t\t.datagrid('getChecked');\r\n\t\tvar indexes = checkedRows.map(row => $('#customDatagrid')\r\n\t\t\t.datagrid('getRowIndex', row));\r\n\t\t\t\r\n\t\treturn indexes;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Converts the Custom Equations from old to new format.\r\n\t * \r\n\t * The old format has only a single equations set and no category information.\r\n\t * \r\n\t * @param from - custom equations in old or new format\r\n\t * @returns - custom equations in new format, enriched with a category tree\r\n\t */\r\n\tconvert(from) {\r\n\t\tif (!Array.isArray(from)) {\r\n\t\t\treturn from;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t\"text\": \"Categories\",\r\n\t\t\t\"children\": \r\n\t\t\t[{\r\n\t\t\t\t\"text\": \"Default\",\r\n\t\t\t\t\"attributes\": { \"equations\": from }\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"text\": \"Physical\",\r\n\t\t\t\t\"state\": \"closed\",\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"text\": \"Mathematical\",\r\n\t\t\t\t\"state\": \"closed\",\r\n\t\t\t}]\r\n\t\t};\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Adds a Samples branch to the Categories tree.\r\n\t * \r\n\t * This routine secures against repeated insertions.\r\n\t * \r\n\t * @param from - the Categories (Custom Equations) tree as from JSON\r\n\t * @result the changed tree with added Samples\r\n\t */\r\n\tasync addSamples(from) {\r\n\t\t\r\n\t\t/**\r\n\t\t * Searches from a given start node down the hierarchy until node with text is found.\r\n\t\t */\r\n\t\tfunction getSamplesNode(node, text) {\r\n\t\t\t\r\n\t\t\treturn _traverse(node.children);\r\n\t\t\t\r\n\t\t\tfunction _traverse(nodes) {\r\n\t\t\t\tfor (var node of nodes) {\r\n\t\t\t\t\tif (node.text === text) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar children = node.children;\r\n\t\t\t\t\tif (children && children.length) {\r\n\t\t\t\t\t\tvar found = _traverse(children);\r\n\t\t\t\t\t\tif (found) {\r\n\t\t\t\t\t\t\treturn found;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * @abstract Loads a JSON file and returns the object.\r\n\t\t */\r\n\t\tasync function loadSamples() {\r\n\t\t\t\r\n\t\t\tvar response = await fetch('formulas/sampleEquations.json');\r\n\t\t\treturn await response.json();\r\n\t\t}\r\n\t\t\r\n\t\tif (!from.haveSamples && !getSamplesNode(from, \"Samples\")) {\r\n\t\t\t\r\n\t\t\tvar samples = await loadSamples();\r\n\t\t\tsamples = getSamplesNode(samples, \"Samples\");\r\n\t\t\tfrom.children.push(samples)\r\n\t\t\tfrom.haveSamples = true;\r\n\t\t}\r\n\t\treturn from;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Sort routine. Sorts the whole category tree.\r\n\t * \r\n\t * Folders first, then leafs. Alphabetically in ascending order.\r\n\t * This alternative uses *traverse*.\r\n\t * \r\n\t * @param target - the jquery tree object\r\n\t * @param order - the order. 'asc' for ascending \r\n\t */\r\n\tsort(order) {\r\n\t\tvar inst = this;\r\n\t\tvar tree = inst.tree;\t\t\r\n\t\torder = order || 'asc';\r\n\t\t\r\n\t\tthis.traverse(function(node) {\r\n\t\t\tvar nodes = node.children;\r\n\t\t\tif (nodes) {\r\n\t\t\t\t_sort(nodes);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\ttree.tree('loadData', [ this.customEquations ]);\r\n\t\t\r\n\t\tfunction _sort(nodes){\r\n\t\t\tnodes.sort(function(r1, r2) {\r\n\t\t\t\t\r\n\t\t\t\tvar sortFunc = function(a, b) {\r\n\t\t\t\t\treturn a == b ? 0 : (a > b ? 1 : -1);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar isLeaf1 = inst.isLeaf(r1);\r\n\t\t\t\tvar isLeaf2 = inst.isLeaf(r2);\r\n\t\t\t\tconsole.debug(`Leaf Test: ${r1.text}:${isLeaf1}, ${r2.text}:${isLeaf2}`)\r\n\t\t\t\tif (isLeaf1 != isLeaf2) {\r\n\t\t\t\t\treturn (isLeaf1 ? 1 : -1) * (order == 'asc' ? 1 : -1);\r\n\t\t\t\t}\r\n\t\t\t\treturn sortFunc(r1.text, r2.text) * (order == 'asc' ? 1 : -1);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Expands the whole category tree. Empty folders are left closed.\r\n\t */\r\n\texpandAlt() {\r\n\t\tvar inst = this;\r\n\t\tthis.traverse(function(row) {\r\n\t\t\tif (!inst.tree.tree('isLeaf', row.target)) {\r\n\t\t\t\tvar children = row.children;\r\n\t\t\t\tinst.openFolder(row, children && children.length);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Correct the Folder icons of the whole tree.\r\n\t */\r\n\tcorrectIcons() {\r\n\t\tvar inst = this;\r\n\t\tthis.traverse(function(node) {\r\n\t\t\tif (!inst.tree.tree('isLeaf', node.target)) {\r\n\t\t\t\tinst.correctIcon(node);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Correct the Folder icon of a single node.\r\n\t */\r\n\tcorrectIcon(node) {\r\n\t\tthis.findNode(node);\t\t\t\t\t\t\t\t\t// seems to be essential to get target\r\n\t\tvar icon = $(node.target).find('.tree-icon');\r\n\t\tif (icon.hasClass('tree-file')) {\r\n\t\t\ticon\r\n\t\t\t.removeClass('tree-file')\r\n\t\t\t.addClass('tree-folder');\r\n\t\t\ticon.prev()\r\n\t\t\t.removeClass('tree-indent')\r\n\t\t\t.addClass('tree-hit')\r\n\t\t\t.addClass('tree-collapsed');\r\n\t\t\t\r\n\t\t\tconsole.debug(`correctIcon for ${node.text} `);\t\t\t\r\n\t\t}\r\n\t\tif (icon.hasClass('tree-folder')) {\r\n\t\t\tconsole.debug(`correctIcon for ${node.text} already has class 'tree-folder' `);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Traverses the categories tree.\r\n\t * \r\n\t * For each node in tree invokes the given function with the given arguments.\r\n\t * \r\n\t * @param func - given function\r\n\t * @param args - arguments for function to modify its behavior\r\n\t */\r\n\ttraverse(func, ...args) {\r\n\t\tvar inst = this;\r\n\t\tvar nodes = inst.tree.tree('getRoots');\r\n\t\t_traverse(nodes, ...args);\r\n\r\n\t\tfunction _traverse(nodes, ...args) {\r\n\t\t\tfor (var node of nodes) {\r\n\t\t\t\tinst.findNode(node);\r\n\t\t\t\tfunc(node, ...args);\r\n\t\t\t\tvar children = node.children;\r\n\t\t\t\tif (children && children.length) {\r\n\t\t\t\t\t_traverse(children, ...args);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Given a node in the tree, determines and returns the path string.\r\n\t * \r\n\t * This serves the purpose to provide a better way to characterize the current \r\n\t * selection.\r\n\t * \r\n\t * @param node - a node of the tree\r\n\t * @returns the path string belonging to that node \r\n\t */\r\n\tpathFromNode(node) {\r\n\t\tlet current = node;\r\n\t\tlet path = '';\r\n\t\twhile(current !== null) {\r\n\t\t\tpath = `/${current.text}${path}`;\r\n\t\t\tcurrent = this.getParent(current);\r\n\t\t}\r\n\t\t\r\n\t\tconsole.debug(`CategoriesTree : pathFromNode : ${path} `);\r\n\t\treturn path;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Given the path string, determines and returns the appropriate node.\r\n\t * \r\n\t * @param {string} path - the path of a node in the tree\r\n\t * @returns the node belonging to that path or null\r\n\t */\r\n\tnodeFromPath(path) {\r\n\t\t\r\n\t\tlet pathComponents = path.split('/').slice(1);\r\n\t\tvar rest = pathComponents;\r\n\t\tvar first = null;\r\n\t\t\r\n\t\tvar node = null;\r\n\t\tvar nodes = this.tree.tree('getRoots');\r\n\t\treturn _traverse(nodes);\r\n\r\n\t\tfunction _traverse(nodes) {\r\n\t\t\t\r\n\t\t\tfirst = rest[0];\r\n\t\t\trest = rest.slice(1);\r\n\r\n\t\t\tfor (var node of nodes) {\r\n\t\t\t\tif (node.text === first) {\r\n\t\t\t\t\tif (rest.length === 0)\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar children = node.children;\r\n\t\t\t\t\tif (children && children.length) {\r\n\t\t\t\t\t\treturn _traverse(children);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Renumbers the ids of the nodes on tree to unique ones.\r\n\t */\r\n\trenumberIds() {\r\n\t\tlet id = 1;\r\n\t\tthis.traverse(function(node) {\r\n\t\t\tnode.id = id++;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the first free id of the node ids.\r\n\t */\r\n\tget freeId() {\r\n\t\tlet id = 0;\r\n\t\tthis.traverse(function(node) {\r\n\t\t\tif (node.id > id) id = node.id;\r\n\t\t});\r\n\t\treturn id + 1;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Opens or closes a folder.\r\n\t * \r\n\t * @param node - the folder node\r\n\t * @param open - the target state, true for open\r\n\t */\r\n\topenFolder(node, open) {\r\n\t\tthis.findNode(node);\t\t\t\t\t\t\t\t\t\t// seems to be essential to get target\r\n\t\tvar isLeaf = this.tree.tree('isLeaf', node.target);\r\n\t\tif (isLeaf) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (open) {\r\n\t\t\tthis.tree.tree('expand', node.target);\r\n\t\t\tnode.state = 'open';\r\n\t\t\tconsole.debug(`openFolder true : ${node.text} `);\t\t\t\r\n\t\t} else {\r\n\t\t\tthis.tree.tree('collapse', node.target);\r\n\t\t\tnode.state = 'closed';\r\n\t\t\tconsole.debug(`openFolder false : ${node.text} `);\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Determines the parent of the given node.\r\n\t */\r\n\tgetParent(node) {\r\n\t\tthis.findNode(node);\t\t\t\t\t\t\t\t\t\t// seems to be essential to get target\r\n\t\tvar parent = this.tree.tree('getParent', node.target);\r\n\t\treturn parent;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Checks the given node if it is a leaf node.\r\n\t */\t\r\n\tisLeaf(node) {\r\n\t\tthis.findNode(node);\t\t\t\t\t\t\t\t\t\t// seems to be essential to get target\r\n\t\tvar isLeaf = this.tree.tree('isLeaf', node.target);\r\n\t\treturn isLeaf;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Finds a node in the tree given an origin node object.\r\n\t * \r\n\t * @param node - origin node\r\n\t */\r\n\tfindNode(node) {\r\n\t\tif ('id' in node)\r\n\t\t\treturn this.tree.tree('find', { text: node.text, id: node.id });\r\n\t\telse\r\n\t\t\treturn this.tree.tree('find', { text: node.text });\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { CategoriesTree };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/categoriesTree.js?")},"./src/assets/js/codemirror/lib/codemirror.js":function(module){eval('// CodeMirror, copyright (c) by Marijn Haverbeke and others\r\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\r\n\r\n// This is CodeMirror (https://codemirror.net/5), a code editor\r\n// implemented in JavaScript on top of the browser\'s DOM.\r\n//\r\n// You can find some technical background for some of the code below\r\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\r\n\r\n(function (global, factory) {\r\n   true ? module.exports = factory() :\r\n  0;\r\n}(this, (function () { \'use strict\';\r\n\r\n  // Kludges for bugs and behavior differences that can\'t be feature\r\n  // detected are enabled based on userAgent etc sniffing.\r\n  var userAgent = navigator.userAgent;\r\n  var platform = navigator.platform;\r\n\r\n  var gecko = /gecko\\/\\d/i.test(userAgent);\r\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\r\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\r\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\r\n  var ie = ie_upto10 || ie_11up || edge;\r\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\r\n  var webkit = !edge && /WebKit\\//.test(userAgent);\r\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\r\n  var chrome = !edge && /Chrome\\/(\\d+)/.exec(userAgent);\r\n  var chrome_version = chrome && +chrome[1];\r\n  var presto = /Opera\\//.test(userAgent);\r\n  var safari = /Apple Computer/.test(navigator.vendor);\r\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\r\n  var phantom = /PhantomJS/.test(userAgent);\r\n\r\n  var ios = safari && (/Mobile\\/\\w+/.test(userAgent) || navigator.maxTouchPoints > 2);\r\n  var android = /Android/.test(userAgent);\r\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\r\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\r\n  var mac = ios || /Mac/.test(platform);\r\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\r\n  var windows = /win/i.test(platform);\r\n\r\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\r\n  if (presto_version) { presto_version = Number(presto_version[1]); }\r\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\r\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\r\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\r\n  var captureRightClick = gecko || (ie && ie_version >= 9);\r\n\r\n  function classTest(cls) { return new RegExp("(^|\\\\s)" + cls + "(?:$|\\\\s)\\\\s*") }\r\n\r\n  var rmClass = function(node, cls) {\r\n    var current = node.className;\r\n    var match = classTest(cls).exec(current);\r\n    if (match) {\r\n      var after = current.slice(match.index + match[0].length);\r\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : "");\r\n    }\r\n  };\r\n\r\n  function removeChildren(e) {\r\n    for (var count = e.childNodes.length; count > 0; --count)\r\n      { e.removeChild(e.firstChild); }\r\n    return e\r\n  }\r\n\r\n  function removeChildrenAndAdd(parent, e) {\r\n    return removeChildren(parent).appendChild(e)\r\n  }\r\n\r\n  function elt(tag, content, className, style) {\r\n    var e = document.createElement(tag);\r\n    if (className) { e.className = className; }\r\n    if (style) { e.style.cssText = style; }\r\n    if (typeof content == "string") { e.appendChild(document.createTextNode(content)); }\r\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\r\n    return e\r\n  }\r\n  // wrapper for elt, which removes the elt from the accessibility tree\r\n  function eltP(tag, content, className, style) {\r\n    var e = elt(tag, content, className, style);\r\n    e.setAttribute("role", "presentation");\r\n    return e\r\n  }\r\n\r\n  var range;\r\n  if (document.createRange) { range = function(node, start, end, endNode) {\r\n    var r = document.createRange();\r\n    r.setEnd(endNode || node, end);\r\n    r.setStart(node, start);\r\n    return r\r\n  }; }\r\n  else { range = function(node, start, end) {\r\n    var r = document.body.createTextRange();\r\n    try { r.moveToElementText(node.parentNode); }\r\n    catch(e) { return r }\r\n    r.collapse(true);\r\n    r.moveEnd("character", end);\r\n    r.moveStart("character", start);\r\n    return r\r\n  }; }\r\n\r\n  function contains(parent, child) {\r\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\r\n      { child = child.parentNode; }\r\n    if (parent.contains)\r\n      { return parent.contains(child) }\r\n    do {\r\n      if (child.nodeType == 11) { child = child.host; }\r\n      if (child == parent) { return true }\r\n    } while (child = child.parentNode)\r\n  }\r\n\r\n  function activeElt(rootNode) {\r\n    // IE and Edge may throw an "Unspecified Error" when accessing document.activeElement.\r\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\r\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\r\n    var doc = rootNode.ownerDocument || rootNode;\r\n    var activeElement;\r\n    try {\r\n      activeElement = rootNode.activeElement;\r\n    } catch(e) {\r\n      activeElement = doc.body || null;\r\n    }\r\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\r\n      { activeElement = activeElement.shadowRoot.activeElement; }\r\n    return activeElement\r\n  }\r\n\r\n  function addClass(node, cls) {\r\n    var current = node.className;\r\n    if (!classTest(cls).test(current)) { node.className += (current ? " " : "") + cls; }\r\n  }\r\n  function joinClasses(a, b) {\r\n    var as = a.split(" ");\r\n    for (var i = 0; i < as.length; i++)\r\n      { if (as[i] && !classTest(as[i]).test(b)) { b += " " + as[i]; } }\r\n    return b\r\n  }\r\n\r\n  var selectInput = function(node) { node.select(); };\r\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\r\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\r\n  else if (ie) // Suppress mysterious IE10 errors\r\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\r\n\r\n  function doc(cm) { return cm.display.wrapper.ownerDocument }\r\n\r\n  function root(cm) {\r\n    return rootNode(cm.display.wrapper)\r\n  }\r\n\r\n  function rootNode(element) {\r\n    // Detect modern browsers (2017+).\r\n    return element.getRootNode ? element.getRootNode() : element.ownerDocument\r\n  }\r\n\r\n  function win(cm) { return doc(cm).defaultView }\r\n\r\n  function bind(f) {\r\n    var args = Array.prototype.slice.call(arguments, 1);\r\n    return function(){return f.apply(null, args)}\r\n  }\r\n\r\n  function copyObj(obj, target, overwrite) {\r\n    if (!target) { target = {}; }\r\n    for (var prop in obj)\r\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\r\n        { target[prop] = obj[prop]; } }\r\n    return target\r\n  }\r\n\r\n  // Counts the column offset in a string, taking tabs into account.\r\n  // Used mostly to find indentation.\r\n  function countColumn(string, end, tabSize, startIndex, startValue) {\r\n    if (end == null) {\r\n      end = string.search(/[^\\s\\u00a0]/);\r\n      if (end == -1) { end = string.length; }\r\n    }\r\n    for (var i = startIndex || 0, n = startValue || 0;;) {\r\n      var nextTab = string.indexOf("\\t", i);\r\n      if (nextTab < 0 || nextTab >= end)\r\n        { return n + (end - i) }\r\n      n += nextTab - i;\r\n      n += tabSize - (n % tabSize);\r\n      i = nextTab + 1;\r\n    }\r\n  }\r\n\r\n  var Delayed = function() {\r\n    this.id = null;\r\n    this.f = null;\r\n    this.time = 0;\r\n    this.handler = bind(this.onTimeout, this);\r\n  };\r\n  Delayed.prototype.onTimeout = function (self) {\r\n    self.id = 0;\r\n    if (self.time <= +new Date) {\r\n      self.f();\r\n    } else {\r\n      setTimeout(self.handler, self.time - +new Date);\r\n    }\r\n  };\r\n  Delayed.prototype.set = function (ms, f) {\r\n    this.f = f;\r\n    var time = +new Date + ms;\r\n    if (!this.id || time < this.time) {\r\n      clearTimeout(this.id);\r\n      this.id = setTimeout(this.handler, ms);\r\n      this.time = time;\r\n    }\r\n  };\r\n\r\n  function indexOf(array, elt) {\r\n    for (var i = 0; i < array.length; ++i)\r\n      { if (array[i] == elt) { return i } }\r\n    return -1\r\n  }\r\n\r\n  // Number of pixels added to scroller and sizer to hide scrollbar\r\n  var scrollerGap = 50;\r\n\r\n  // Returned or thrown by various protocols to signal \'I\'m not\r\n  // handling this\'.\r\n  var Pass = {toString: function(){return "CodeMirror.Pass"}};\r\n\r\n  // Reused option objects for setSelection & friends\r\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: "*mouse"}, sel_move = {origin: "+move"};\r\n\r\n  // The inverse of countColumn -- find the offset that corresponds to\r\n  // a particular column.\r\n  function findColumn(string, goal, tabSize) {\r\n    for (var pos = 0, col = 0;;) {\r\n      var nextTab = string.indexOf("\\t", pos);\r\n      if (nextTab == -1) { nextTab = string.length; }\r\n      var skipped = nextTab - pos;\r\n      if (nextTab == string.length || col + skipped >= goal)\r\n        { return pos + Math.min(skipped, goal - col) }\r\n      col += nextTab - pos;\r\n      col += tabSize - (col % tabSize);\r\n      pos = nextTab + 1;\r\n      if (col >= goal) { return pos }\r\n    }\r\n  }\r\n\r\n  var spaceStrs = [""];\r\n  function spaceStr(n) {\r\n    while (spaceStrs.length <= n)\r\n      { spaceStrs.push(lst(spaceStrs) + " "); }\r\n    return spaceStrs[n]\r\n  }\r\n\r\n  function lst(arr) { return arr[arr.length-1] }\r\n\r\n  function map(array, f) {\r\n    var out = [];\r\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\r\n    return out\r\n  }\r\n\r\n  function insertSorted(array, value, score) {\r\n    var pos = 0, priority = score(value);\r\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\r\n    array.splice(pos, 0, value);\r\n  }\r\n\r\n  function nothing() {}\r\n\r\n  function createObj(base, props) {\r\n    var inst;\r\n    if (Object.create) {\r\n      inst = Object.create(base);\r\n    } else {\r\n      nothing.prototype = base;\r\n      inst = new nothing();\r\n    }\r\n    if (props) { copyObj(props, inst); }\r\n    return inst\r\n  }\r\n\r\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\r\n  function isWordCharBasic(ch) {\r\n    return /\\w/.test(ch) || ch > "\\x80" &&\r\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\r\n  }\r\n  function isWordChar(ch, helper) {\r\n    if (!helper) { return isWordCharBasic(ch) }\r\n    if (helper.source.indexOf("\\\\w") > -1 && isWordCharBasic(ch)) { return true }\r\n    return helper.test(ch)\r\n  }\r\n\r\n  function isEmpty(obj) {\r\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\r\n    return true\r\n  }\r\n\r\n  // Extending unicode characters. A series of a non-extending char +\r\n  // any number of extending chars is treated as a single unit as far\r\n  // as editing and measuring is concerned. This is not fully correct,\r\n  // since some scripts/fonts/browsers also treat other configurations\r\n  // of code points as a group.\r\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\r\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\r\n\r\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\r\n  function skipExtendingChars(str, pos, dir) {\r\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\r\n    return pos\r\n  }\r\n\r\n  // Returns the value from the range [`from`; `to`] that satisfies\r\n  // `pred` and is closest to `from`. Assumes that at least `to`\r\n  // satisfies `pred`. Supports `from` being greater than `to`.\r\n  function findFirst(pred, from, to) {\r\n    // At any point we are certain `to` satisfies `pred`, don\'t know\r\n    // whether `from` does.\r\n    var dir = from > to ? -1 : 1;\r\n    for (;;) {\r\n      if (from == to) { return from }\r\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\r\n      if (mid == from) { return pred(mid) ? from : to }\r\n      if (pred(mid)) { to = mid; }\r\n      else { from = mid + dir; }\r\n    }\r\n  }\r\n\r\n  // BIDI HELPERS\r\n\r\n  function iterateBidiSections(order, from, to, f) {\r\n    if (!order) { return f(from, to, "ltr", 0) }\r\n    var found = false;\r\n    for (var i = 0; i < order.length; ++i) {\r\n      var part = order[i];\r\n      if (part.from < to && part.to > from || from == to && part.to == from) {\r\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? "rtl" : "ltr", i);\r\n        found = true;\r\n      }\r\n    }\r\n    if (!found) { f(from, to, "ltr"); }\r\n  }\r\n\r\n  var bidiOther = null;\r\n  function getBidiPartAt(order, ch, sticky) {\r\n    var found;\r\n    bidiOther = null;\r\n    for (var i = 0; i < order.length; ++i) {\r\n      var cur = order[i];\r\n      if (cur.from < ch && cur.to > ch) { return i }\r\n      if (cur.to == ch) {\r\n        if (cur.from != cur.to && sticky == "before") { found = i; }\r\n        else { bidiOther = i; }\r\n      }\r\n      if (cur.from == ch) {\r\n        if (cur.from != cur.to && sticky != "before") { found = i; }\r\n        else { bidiOther = i; }\r\n      }\r\n    }\r\n    return found != null ? found : bidiOther\r\n  }\r\n\r\n  // Bidirectional ordering algorithm\r\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\r\n  // that this (partially) implements.\r\n\r\n  // One-char codes used for character types:\r\n  // L (L):   Left-to-Right\r\n  // R (R):   Right-to-Left\r\n  // r (AL):  Right-to-Left Arabic\r\n  // 1 (EN):  European Number\r\n  // + (ES):  European Number Separator\r\n  // % (ET):  European Number Terminator\r\n  // n (AN):  Arabic Number\r\n  // , (CS):  Common Number Separator\r\n  // m (NSM): Non-Spacing Mark\r\n  // b (BN):  Boundary Neutral\r\n  // s (B):   Paragraph Separator\r\n  // t (S):   Segment Separator\r\n  // w (WS):  Whitespace\r\n  // N (ON):  Other Neutrals\r\n\r\n  // Returns null if characters are ordered as they appear\r\n  // (left-to-right), or an array of sections ({from, to, level}\r\n  // objects) in the order in which they occur visually.\r\n  var bidiOrdering = (function() {\r\n    // Character types for codepoints 0 to 0xff\r\n    var lowTypes = "bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";\r\n    // Character types for codepoints 0x600 to 0x6f9\r\n    var arabicTypes = "nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";\r\n    function charType(code) {\r\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\r\n      else if (0x590 <= code && code <= 0x5f4) { return "R" }\r\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\r\n      else if (0x6ee <= code && code <= 0x8ac) { return "r" }\r\n      else if (0x2000 <= code && code <= 0x200b) { return "w" }\r\n      else if (code == 0x200c) { return "b" }\r\n      else { return "L" }\r\n    }\r\n\r\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\r\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\r\n\r\n    function BidiSpan(level, from, to) {\r\n      this.level = level;\r\n      this.from = from; this.to = to;\r\n    }\r\n\r\n    return function(str, direction) {\r\n      var outerType = direction == "ltr" ? "L" : "R";\r\n\r\n      if (str.length == 0 || direction == "ltr" && !bidiRE.test(str)) { return false }\r\n      var len = str.length, types = [];\r\n      for (var i = 0; i < len; ++i)\r\n        { types.push(charType(str.charCodeAt(i))); }\r\n\r\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\r\n      // change the type of the NSM to the type of the previous\r\n      // character. If the NSM is at the start of the level run, it will\r\n      // get the type of sor.\r\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\r\n        var type = types[i$1];\r\n        if (type == "m") { types[i$1] = prev; }\r\n        else { prev = type; }\r\n      }\r\n\r\n      // W2. Search backwards from each instance of a European number\r\n      // until the first strong type (R, L, AL, or sor) is found. If an\r\n      // AL is found, change the type of the European number to Arabic\r\n      // number.\r\n      // W3. Change all ALs to R.\r\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\r\n        var type$1 = types[i$2];\r\n        if (type$1 == "1" && cur == "r") { types[i$2] = "n"; }\r\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == "r") { types[i$2] = "R"; } }\r\n      }\r\n\r\n      // W4. A single European separator between two European numbers\r\n      // changes to a European number. A single common separator between\r\n      // two numbers of the same type changes to that type.\r\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\r\n        var type$2 = types[i$3];\r\n        if (type$2 == "+" && prev$1 == "1" && types[i$3+1] == "1") { types[i$3] = "1"; }\r\n        else if (type$2 == "," && prev$1 == types[i$3+1] &&\r\n                 (prev$1 == "1" || prev$1 == "n")) { types[i$3] = prev$1; }\r\n        prev$1 = type$2;\r\n      }\r\n\r\n      // W5. A sequence of European terminators adjacent to European\r\n      // numbers changes to all European numbers.\r\n      // W6. Otherwise, separators and terminators change to Other\r\n      // Neutral.\r\n      for (var i$4 = 0; i$4 < len; ++i$4) {\r\n        var type$3 = types[i$4];\r\n        if (type$3 == ",") { types[i$4] = "N"; }\r\n        else if (type$3 == "%") {\r\n          var end = (void 0);\r\n          for (end = i$4 + 1; end < len && types[end] == "%"; ++end) {}\r\n          var replace = (i$4 && types[i$4-1] == "!") || (end < len && types[end] == "1") ? "1" : "N";\r\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\r\n          i$4 = end - 1;\r\n        }\r\n      }\r\n\r\n      // W7. Search backwards from each instance of a European number\r\n      // until the first strong type (R, L, or sor) is found. If an L is\r\n      // found, then change the type of the European number to L.\r\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\r\n        var type$4 = types[i$5];\r\n        if (cur$1 == "L" && type$4 == "1") { types[i$5] = "L"; }\r\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\r\n      }\r\n\r\n      // N1. A sequence of neutrals takes the direction of the\r\n      // surrounding strong text if the text on both sides has the same\r\n      // direction. European and Arabic numbers act as if they were R in\r\n      // terms of their influence on neutrals. Start-of-level-run (sor)\r\n      // and end-of-level-run (eor) are used at level run boundaries.\r\n      // N2. Any remaining neutrals take the embedding direction.\r\n      for (var i$6 = 0; i$6 < len; ++i$6) {\r\n        if (isNeutral.test(types[i$6])) {\r\n          var end$1 = (void 0);\r\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\r\n          var before = (i$6 ? types[i$6-1] : outerType) == "L";\r\n          var after = (end$1 < len ? types[end$1] : outerType) == "L";\r\n          var replace$1 = before == after ? (before ? "L" : "R") : outerType;\r\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\r\n          i$6 = end$1 - 1;\r\n        }\r\n      }\r\n\r\n      // Here we depart from the documented algorithm, in order to avoid\r\n      // building up an actual levels array. Since there are only three\r\n      // levels (0, 1, 2) in an implementation that doesn\'t take\r\n      // explicit embedding into account, we can build up the order on\r\n      // the fly, without following the level-based algorithm.\r\n      var order = [], m;\r\n      for (var i$7 = 0; i$7 < len;) {\r\n        if (countsAsLeft.test(types[i$7])) {\r\n          var start = i$7;\r\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\r\n          order.push(new BidiSpan(0, start, i$7));\r\n        } else {\r\n          var pos = i$7, at = order.length, isRTL = direction == "rtl" ? 1 : 0;\r\n          for (++i$7; i$7 < len && types[i$7] != "L"; ++i$7) {}\r\n          for (var j$2 = pos; j$2 < i$7;) {\r\n            if (countsAsNum.test(types[j$2])) {\r\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\r\n              var nstart = j$2;\r\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\r\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\r\n              at += isRTL;\r\n              pos = j$2;\r\n            } else { ++j$2; }\r\n          }\r\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\r\n        }\r\n      }\r\n      if (direction == "ltr") {\r\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\r\n          order[0].from = m[0].length;\r\n          order.unshift(new BidiSpan(0, 0, m[0].length));\r\n        }\r\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\r\n          lst(order).to -= m[0].length;\r\n          order.push(new BidiSpan(0, len - m[0].length, len));\r\n        }\r\n      }\r\n\r\n      return direction == "rtl" ? order.reverse() : order\r\n    }\r\n  })();\r\n\r\n  // Get the bidi ordering for the given line (and cache it). Returns\r\n  // false for lines that are fully left-to-right, and an array of\r\n  // BidiSpan objects otherwise.\r\n  function getOrder(line, direction) {\r\n    var order = line.order;\r\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\r\n    return order\r\n  }\r\n\r\n  // EVENT HANDLING\r\n\r\n  // Lightweight event framework. on/off also work on DOM nodes,\r\n  // registering native DOM handlers.\r\n\r\n  var noHandlers = [];\r\n\r\n  var on = function(emitter, type, f) {\r\n    if (emitter.addEventListener) {\r\n      emitter.addEventListener(type, f, false);\r\n    } else if (emitter.attachEvent) {\r\n      emitter.attachEvent("on" + type, f);\r\n    } else {\r\n      var map = emitter._handlers || (emitter._handlers = {});\r\n      map[type] = (map[type] || noHandlers).concat(f);\r\n    }\r\n  };\r\n\r\n  function getHandlers(emitter, type) {\r\n    return emitter._handlers && emitter._handlers[type] || noHandlers\r\n  }\r\n\r\n  function off(emitter, type, f) {\r\n    if (emitter.removeEventListener) {\r\n      emitter.removeEventListener(type, f, false);\r\n    } else if (emitter.detachEvent) {\r\n      emitter.detachEvent("on" + type, f);\r\n    } else {\r\n      var map = emitter._handlers, arr = map && map[type];\r\n      if (arr) {\r\n        var index = indexOf(arr, f);\r\n        if (index > -1)\r\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\r\n      }\r\n    }\r\n  }\r\n\r\n  function signal(emitter, type /*, values...*/) {\r\n    var handlers = getHandlers(emitter, type);\r\n    if (!handlers.length) { return }\r\n    var args = Array.prototype.slice.call(arguments, 2);\r\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\r\n  }\r\n\r\n  // The DOM events that CodeMirror handles can be overridden by\r\n  // registering a (non-DOM) handler on the editor for the event name,\r\n  // and preventDefault-ing the event in that handler.\r\n  function signalDOMEvent(cm, e, override) {\r\n    if (typeof e == "string")\r\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\r\n    signal(cm, override || e.type, cm, e);\r\n    return e_defaultPrevented(e) || e.codemirrorIgnore\r\n  }\r\n\r\n  function signalCursorActivity(cm) {\r\n    var arr = cm._handlers && cm._handlers.cursorActivity;\r\n    if (!arr) { return }\r\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\r\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\r\n      { set.push(arr[i]); } }\r\n  }\r\n\r\n  function hasHandler(emitter, type) {\r\n    return getHandlers(emitter, type).length > 0\r\n  }\r\n\r\n  // Add on and off methods to a constructor\'s prototype, to make\r\n  // registering events on such objects more convenient.\r\n  function eventMixin(ctor) {\r\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\r\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\r\n  }\r\n\r\n  // Due to the fact that we still support jurassic IE versions, some\r\n  // compatibility wrappers are needed.\r\n\r\n  function e_preventDefault(e) {\r\n    if (e.preventDefault) { e.preventDefault(); }\r\n    else { e.returnValue = false; }\r\n  }\r\n  function e_stopPropagation(e) {\r\n    if (e.stopPropagation) { e.stopPropagation(); }\r\n    else { e.cancelBubble = true; }\r\n  }\r\n  function e_defaultPrevented(e) {\r\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\r\n  }\r\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\r\n\r\n  function e_target(e) {return e.target || e.srcElement}\r\n  function e_button(e) {\r\n    var b = e.which;\r\n    if (b == null) {\r\n      if (e.button & 1) { b = 1; }\r\n      else if (e.button & 2) { b = 3; }\r\n      else if (e.button & 4) { b = 2; }\r\n    }\r\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\r\n    return b\r\n  }\r\n\r\n  // Detect drag-and-drop\r\n  var dragAndDrop = function() {\r\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\r\n    // couldn\'t get it to work yet.\r\n    if (ie && ie_version < 9) { return false }\r\n    var div = elt(\'div\');\r\n    return "draggable" in div || "dragDrop" in div\r\n  }();\r\n\r\n  var zwspSupported;\r\n  function zeroWidthElement(measure) {\r\n    if (zwspSupported == null) {\r\n      var test = elt("span", "\\u200b");\r\n      removeChildrenAndAdd(measure, elt("span", [test, document.createTextNode("x")]));\r\n      if (measure.firstChild.offsetHeight != 0)\r\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\r\n    }\r\n    var node = zwspSupported ? elt("span", "\\u200b") :\r\n      elt("span", "\\u00a0", null, "display: inline-block; width: 1px; margin-right: -1px");\r\n    node.setAttribute("cm-text", "");\r\n    return node\r\n  }\r\n\r\n  // Feature-detect IE\'s crummy client rect reporting for bidi text\r\n  var badBidiRects;\r\n  function hasBadBidiRects(measure) {\r\n    if (badBidiRects != null) { return badBidiRects }\r\n    var txt = removeChildrenAndAdd(measure, document.createTextNode("A\\u062eA"));\r\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\r\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\r\n    removeChildren(measure);\r\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\r\n    return badBidiRects = (r1.right - r0.right < 3)\r\n  }\r\n\r\n  // See if "".split is the broken IE version, if so, provide an\r\n  // alternative way to split lines.\r\n  var splitLinesAuto = "\\n\\nb".split(/\\n/).length != 3 ? function (string) {\r\n    var pos = 0, result = [], l = string.length;\r\n    while (pos <= l) {\r\n      var nl = string.indexOf("\\n", pos);\r\n      if (nl == -1) { nl = string.length; }\r\n      var line = string.slice(pos, string.charAt(nl - 1) == "\\r" ? nl - 1 : nl);\r\n      var rt = line.indexOf("\\r");\r\n      if (rt != -1) {\r\n        result.push(line.slice(0, rt));\r\n        pos += rt + 1;\r\n      } else {\r\n        result.push(line);\r\n        pos = nl + 1;\r\n      }\r\n    }\r\n    return result\r\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\r\n\r\n  var hasSelection = window.getSelection ? function (te) {\r\n    try { return te.selectionStart != te.selectionEnd }\r\n    catch(e) { return false }\r\n  } : function (te) {\r\n    var range;\r\n    try {range = te.ownerDocument.selection.createRange();}\r\n    catch(e) {}\r\n    if (!range || range.parentElement() != te) { return false }\r\n    return range.compareEndPoints("StartToEnd", range) != 0\r\n  };\r\n\r\n  var hasCopyEvent = (function () {\r\n    var e = elt("div");\r\n    if ("oncopy" in e) { return true }\r\n    e.setAttribute("oncopy", "return;");\r\n    return typeof e.oncopy == "function"\r\n  })();\r\n\r\n  var badZoomedRects = null;\r\n  function hasBadZoomedRects(measure) {\r\n    if (badZoomedRects != null) { return badZoomedRects }\r\n    var node = removeChildrenAndAdd(measure, elt("span", "x"));\r\n    var normal = node.getBoundingClientRect();\r\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\r\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\r\n  }\r\n\r\n  // Known modes, by name and by MIME\r\n  var modes = {}, mimeModes = {};\r\n\r\n  // Extra arguments are stored as the mode\'s dependencies, which is\r\n  // used by (legacy) mechanisms like loadmode.js to automatically\r\n  // load a mode. (Preferred mechanism is the require/define calls.)\r\n  function defineMode(name, mode) {\r\n    if (arguments.length > 2)\r\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\r\n    modes[name] = mode;\r\n  }\r\n\r\n  function defineMIME(mime, spec) {\r\n    mimeModes[mime] = spec;\r\n  }\r\n\r\n  // Given a MIME type, a {name, ...options} config object, or a name\r\n  // string, return a mode config object.\r\n  function resolveMode(spec) {\r\n    if (typeof spec == "string" && mimeModes.hasOwnProperty(spec)) {\r\n      spec = mimeModes[spec];\r\n    } else if (spec && typeof spec.name == "string" && mimeModes.hasOwnProperty(spec.name)) {\r\n      var found = mimeModes[spec.name];\r\n      if (typeof found == "string") { found = {name: found}; }\r\n      spec = createObj(found, spec);\r\n      spec.name = found.name;\r\n    } else if (typeof spec == "string" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\r\n      return resolveMode("application/xml")\r\n    } else if (typeof spec == "string" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\r\n      return resolveMode("application/json")\r\n    }\r\n    if (typeof spec == "string") { return {name: spec} }\r\n    else { return spec || {name: "null"} }\r\n  }\r\n\r\n  // Given a mode spec (anything that resolveMode accepts), find and\r\n  // initialize an actual mode object.\r\n  function getMode(options, spec) {\r\n    spec = resolveMode(spec);\r\n    var mfactory = modes[spec.name];\r\n    if (!mfactory) { return getMode(options, "text/plain") }\r\n    var modeObj = mfactory(options, spec);\r\n    if (modeExtensions.hasOwnProperty(spec.name)) {\r\n      var exts = modeExtensions[spec.name];\r\n      for (var prop in exts) {\r\n        if (!exts.hasOwnProperty(prop)) { continue }\r\n        if (modeObj.hasOwnProperty(prop)) { modeObj["_" + prop] = modeObj[prop]; }\r\n        modeObj[prop] = exts[prop];\r\n      }\r\n    }\r\n    modeObj.name = spec.name;\r\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\r\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\r\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\r\n\r\n    return modeObj\r\n  }\r\n\r\n  // This can be used to attach properties to mode objects from\r\n  // outside the actual mode definition.\r\n  var modeExtensions = {};\r\n  function extendMode(mode, properties) {\r\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\r\n    copyObj(properties, exts);\r\n  }\r\n\r\n  function copyState(mode, state) {\r\n    if (state === true) { return state }\r\n    if (mode.copyState) { return mode.copyState(state) }\r\n    var nstate = {};\r\n    for (var n in state) {\r\n      var val = state[n];\r\n      if (val instanceof Array) { val = val.concat([]); }\r\n      nstate[n] = val;\r\n    }\r\n    return nstate\r\n  }\r\n\r\n  // Given a mode and a state (for that mode), find the inner mode and\r\n  // state at the position that the state refers to.\r\n  function innerMode(mode, state) {\r\n    var info;\r\n    while (mode.innerMode) {\r\n      info = mode.innerMode(state);\r\n      if (!info || info.mode == mode) { break }\r\n      state = info.state;\r\n      mode = info.mode;\r\n    }\r\n    return info || {mode: mode, state: state}\r\n  }\r\n\r\n  function startState(mode, a1, a2) {\r\n    return mode.startState ? mode.startState(a1, a2) : true\r\n  }\r\n\r\n  // STRING STREAM\r\n\r\n  // Fed to the mode parsers, provides helper functions to make\r\n  // parsers more succinct.\r\n\r\n  var StringStream = function(string, tabSize, lineOracle) {\r\n    this.pos = this.start = 0;\r\n    this.string = string;\r\n    this.tabSize = tabSize || 8;\r\n    this.lastColumnPos = this.lastColumnValue = 0;\r\n    this.lineStart = 0;\r\n    this.lineOracle = lineOracle;\r\n  };\r\n\r\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\r\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\r\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\r\n  StringStream.prototype.next = function () {\r\n    if (this.pos < this.string.length)\r\n      { return this.string.charAt(this.pos++) }\r\n  };\r\n  StringStream.prototype.eat = function (match) {\r\n    var ch = this.string.charAt(this.pos);\r\n    var ok;\r\n    if (typeof match == "string") { ok = ch == match; }\r\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\r\n    if (ok) {++this.pos; return ch}\r\n  };\r\n  StringStream.prototype.eatWhile = function (match) {\r\n    var start = this.pos;\r\n    while (this.eat(match)){}\r\n    return this.pos > start\r\n  };\r\n  StringStream.prototype.eatSpace = function () {\r\n    var start = this.pos;\r\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\r\n    return this.pos > start\r\n  };\r\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\r\n  StringStream.prototype.skipTo = function (ch) {\r\n    var found = this.string.indexOf(ch, this.pos);\r\n    if (found > -1) {this.pos = found; return true}\r\n  };\r\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\r\n  StringStream.prototype.column = function () {\r\n    if (this.lastColumnPos < this.start) {\r\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\r\n      this.lastColumnPos = this.start;\r\n    }\r\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\r\n  };\r\n  StringStream.prototype.indentation = function () {\r\n    return countColumn(this.string, null, this.tabSize) -\r\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\r\n  };\r\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\r\n    if (typeof pattern == "string") {\r\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\r\n      var substr = this.string.substr(this.pos, pattern.length);\r\n      if (cased(substr) == cased(pattern)) {\r\n        if (consume !== false) { this.pos += pattern.length; }\r\n        return true\r\n      }\r\n    } else {\r\n      var match = this.string.slice(this.pos).match(pattern);\r\n      if (match && match.index > 0) { return null }\r\n      if (match && consume !== false) { this.pos += match[0].length; }\r\n      return match\r\n    }\r\n  };\r\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\r\n  StringStream.prototype.hideFirstChars = function (n, inner) {\r\n    this.lineStart += n;\r\n    try { return inner() }\r\n    finally { this.lineStart -= n; }\r\n  };\r\n  StringStream.prototype.lookAhead = function (n) {\r\n    var oracle = this.lineOracle;\r\n    return oracle && oracle.lookAhead(n)\r\n  };\r\n  StringStream.prototype.baseToken = function () {\r\n    var oracle = this.lineOracle;\r\n    return oracle && oracle.baseToken(this.pos)\r\n  };\r\n\r\n  // Find the line object corresponding to the given line number.\r\n  function getLine(doc, n) {\r\n    n -= doc.first;\r\n    if (n < 0 || n >= doc.size) { throw new Error("There is no line " + (n + doc.first) + " in the document.") }\r\n    var chunk = doc;\r\n    while (!chunk.lines) {\r\n      for (var i = 0;; ++i) {\r\n        var child = chunk.children[i], sz = child.chunkSize();\r\n        if (n < sz) { chunk = child; break }\r\n        n -= sz;\r\n      }\r\n    }\r\n    return chunk.lines[n]\r\n  }\r\n\r\n  // Get the part of a document between two positions, as an array of\r\n  // strings.\r\n  function getBetween(doc, start, end) {\r\n    var out = [], n = start.line;\r\n    doc.iter(start.line, end.line + 1, function (line) {\r\n      var text = line.text;\r\n      if (n == end.line) { text = text.slice(0, end.ch); }\r\n      if (n == start.line) { text = text.slice(start.ch); }\r\n      out.push(text);\r\n      ++n;\r\n    });\r\n    return out\r\n  }\r\n  // Get the lines between from and to, as array of strings.\r\n  function getLines(doc, from, to) {\r\n    var out = [];\r\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\r\n    return out\r\n  }\r\n\r\n  // Update the height of a line, propagating the height change\r\n  // upwards to parent nodes.\r\n  function updateLineHeight(line, height) {\r\n    var diff = height - line.height;\r\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\r\n  }\r\n\r\n  // Given a line object, find its line number by walking up through\r\n  // its parent links.\r\n  function lineNo(line) {\r\n    if (line.parent == null) { return null }\r\n    var cur = line.parent, no = indexOf(cur.lines, line);\r\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\r\n      for (var i = 0;; ++i) {\r\n        if (chunk.children[i] == cur) { break }\r\n        no += chunk.children[i].chunkSize();\r\n      }\r\n    }\r\n    return no + cur.first\r\n  }\r\n\r\n  // Find the line at the given vertical position, using the height\r\n  // information in the document tree.\r\n  function lineAtHeight(chunk, h) {\r\n    var n = chunk.first;\r\n    outer: do {\r\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\r\n        var child = chunk.children[i$1], ch = child.height;\r\n        if (h < ch) { chunk = child; continue outer }\r\n        h -= ch;\r\n        n += child.chunkSize();\r\n      }\r\n      return n\r\n    } while (!chunk.lines)\r\n    var i = 0;\r\n    for (; i < chunk.lines.length; ++i) {\r\n      var line = chunk.lines[i], lh = line.height;\r\n      if (h < lh) { break }\r\n      h -= lh;\r\n    }\r\n    return n + i\r\n  }\r\n\r\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\r\n\r\n  function lineNumberFor(options, i) {\r\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\r\n  }\r\n\r\n  // A Pos instance represents a position within the text.\r\n  function Pos(line, ch, sticky) {\r\n    if ( sticky === void 0 ) sticky = null;\r\n\r\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\r\n    this.line = line;\r\n    this.ch = ch;\r\n    this.sticky = sticky;\r\n  }\r\n\r\n  // Compare two positions, return 0 if they are the same, a negative\r\n  // number when a is less, and a positive number otherwise.\r\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\r\n\r\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\r\n\r\n  function copyPos(x) {return Pos(x.line, x.ch)}\r\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\r\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\r\n\r\n  // Most of the external API clips given positions to make sure they\r\n  // actually exist within the document.\r\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\r\n  function clipPos(doc, pos) {\r\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\r\n    var last = doc.first + doc.size - 1;\r\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\r\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\r\n  }\r\n  function clipToLen(pos, linelen) {\r\n    var ch = pos.ch;\r\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\r\n    else if (ch < 0) { return Pos(pos.line, 0) }\r\n    else { return pos }\r\n  }\r\n  function clipPosArray(doc, array) {\r\n    var out = [];\r\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\r\n    return out\r\n  }\r\n\r\n  var SavedContext = function(state, lookAhead) {\r\n    this.state = state;\r\n    this.lookAhead = lookAhead;\r\n  };\r\n\r\n  var Context = function(doc, state, line, lookAhead) {\r\n    this.state = state;\r\n    this.doc = doc;\r\n    this.line = line;\r\n    this.maxLookAhead = lookAhead || 0;\r\n    this.baseTokens = null;\r\n    this.baseTokenPos = 1;\r\n  };\r\n\r\n  Context.prototype.lookAhead = function (n) {\r\n    var line = this.doc.getLine(this.line + n);\r\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\r\n    return line\r\n  };\r\n\r\n  Context.prototype.baseToken = function (n) {\r\n    if (!this.baseTokens) { return null }\r\n    while (this.baseTokens[this.baseTokenPos] <= n)\r\n      { this.baseTokenPos += 2; }\r\n    var type = this.baseTokens[this.baseTokenPos + 1];\r\n    return {type: type && type.replace(/( |^)overlay .*/, ""),\r\n            size: this.baseTokens[this.baseTokenPos] - n}\r\n  };\r\n\r\n  Context.prototype.nextLine = function () {\r\n    this.line++;\r\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\r\n  };\r\n\r\n  Context.fromSaved = function (doc, saved, line) {\r\n    if (saved instanceof SavedContext)\r\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\r\n    else\r\n      { return new Context(doc, copyState(doc.mode, saved), line) }\r\n  };\r\n\r\n  Context.prototype.save = function (copy) {\r\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\r\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\r\n  };\r\n\r\n\r\n  // Compute a style array (an array starting with a mode generation\r\n  // -- for invalidation -- followed by pairs of end positions and\r\n  // style strings), which is used to highlight the tokens on the\r\n  // line.\r\n  function highlightLine(cm, line, context, forceToEnd) {\r\n    // A styles array always starts with a number identifying the\r\n    // mode/overlays that it is based on (for easy invalidation).\r\n    var st = [cm.state.modeGen], lineClasses = {};\r\n    // Compute the base array of styles\r\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\r\n            lineClasses, forceToEnd);\r\n    var state = context.state;\r\n\r\n    // Run overlays, adjust style array.\r\n    var loop = function ( o ) {\r\n      context.baseTokens = st;\r\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\r\n      context.state = true;\r\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\r\n        var start = i;\r\n        // Ensure there\'s a token end at the current position, and that i points at it\r\n        while (at < end) {\r\n          var i_end = st[i];\r\n          if (i_end > end)\r\n            { st.splice(i, 1, end, st[i+1], i_end); }\r\n          i += 2;\r\n          at = Math.min(end, i_end);\r\n        }\r\n        if (!style) { return }\r\n        if (overlay.opaque) {\r\n          st.splice(start, i - start, end, "overlay " + style);\r\n          i = start + 2;\r\n        } else {\r\n          for (; start < i; start += 2) {\r\n            var cur = st[start+1];\r\n            st[start+1] = (cur ? cur + " " : "") + "overlay " + style;\r\n          }\r\n        }\r\n      }, lineClasses);\r\n      context.state = state;\r\n      context.baseTokens = null;\r\n      context.baseTokenPos = 1;\r\n    };\r\n\r\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\r\n\r\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\r\n  }\r\n\r\n  function getLineStyles(cm, line, updateFrontier) {\r\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\r\n      var context = getContextBefore(cm, lineNo(line));\r\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\r\n      var result = highlightLine(cm, line, context);\r\n      if (resetState) { context.state = resetState; }\r\n      line.stateAfter = context.save(!resetState);\r\n      line.styles = result.styles;\r\n      if (result.classes) { line.styleClasses = result.classes; }\r\n      else if (line.styleClasses) { line.styleClasses = null; }\r\n      if (updateFrontier === cm.doc.highlightFrontier)\r\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\r\n    }\r\n    return line.styles\r\n  }\r\n\r\n  function getContextBefore(cm, n, precise) {\r\n    var doc = cm.doc, display = cm.display;\r\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\r\n    var start = findStartLine(cm, n, precise);\r\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\r\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\r\n\r\n    doc.iter(start, n, function (line) {\r\n      processLine(cm, line.text, context);\r\n      var pos = context.line;\r\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\r\n      context.nextLine();\r\n    });\r\n    if (precise) { doc.modeFrontier = context.line; }\r\n    return context\r\n  }\r\n\r\n  // Lightweight form of highlight -- proceed over this line and\r\n  // update state, but don\'t save a style array. Used for lines that\r\n  // aren\'t currently visible.\r\n  function processLine(cm, text, context, startAt) {\r\n    var mode = cm.doc.mode;\r\n    var stream = new StringStream(text, cm.options.tabSize, context);\r\n    stream.start = stream.pos = startAt || 0;\r\n    if (text == "") { callBlankLine(mode, context.state); }\r\n    while (!stream.eol()) {\r\n      readToken(mode, stream, context.state);\r\n      stream.start = stream.pos;\r\n    }\r\n  }\r\n\r\n  function callBlankLine(mode, state) {\r\n    if (mode.blankLine) { return mode.blankLine(state) }\r\n    if (!mode.innerMode) { return }\r\n    var inner = innerMode(mode, state);\r\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\r\n  }\r\n\r\n  function readToken(mode, stream, state, inner) {\r\n    for (var i = 0; i < 10; i++) {\r\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\r\n      var style = mode.token(stream, state);\r\n      if (stream.pos > stream.start) { return style }\r\n    }\r\n    throw new Error("Mode " + mode.name + " failed to advance stream.")\r\n  }\r\n\r\n  var Token = function(stream, type, state) {\r\n    this.start = stream.start; this.end = stream.pos;\r\n    this.string = stream.current();\r\n    this.type = type || null;\r\n    this.state = state;\r\n  };\r\n\r\n  // Utility for getTokenAt and getLineTokens\r\n  function takeToken(cm, pos, precise, asArray) {\r\n    var doc = cm.doc, mode = doc.mode, style;\r\n    pos = clipPos(doc, pos);\r\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\r\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\r\n    if (asArray) { tokens = []; }\r\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\r\n      stream.start = stream.pos;\r\n      style = readToken(mode, stream, context.state);\r\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\r\n    }\r\n    return asArray ? tokens : new Token(stream, style, context.state)\r\n  }\r\n\r\n  function extractLineClasses(type, output) {\r\n    if (type) { for (;;) {\r\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\r\n      if (!lineClass) { break }\r\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\r\n      var prop = lineClass[1] ? "bgClass" : "textClass";\r\n      if (output[prop] == null)\r\n        { output[prop] = lineClass[2]; }\r\n      else if (!(new RegExp("(?:^|\\\\s)" + lineClass[2] + "(?:$|\\\\s)")).test(output[prop]))\r\n        { output[prop] += " " + lineClass[2]; }\r\n    } }\r\n    return type\r\n  }\r\n\r\n  // Run the given mode\'s parser over a line, calling f for each token.\r\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\r\n    var flattenSpans = mode.flattenSpans;\r\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\r\n    var curStart = 0, curStyle = null;\r\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\r\n    var inner = cm.options.addModeClass && [null];\r\n    if (text == "") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\r\n    while (!stream.eol()) {\r\n      if (stream.pos > cm.options.maxHighlightLength) {\r\n        flattenSpans = false;\r\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\r\n        stream.pos = text.length;\r\n        style = null;\r\n      } else {\r\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\r\n      }\r\n      if (inner) {\r\n        var mName = inner[0].name;\r\n        if (mName) { style = "m-" + (style ? mName + " " + style : mName); }\r\n      }\r\n      if (!flattenSpans || curStyle != style) {\r\n        while (curStart < stream.start) {\r\n          curStart = Math.min(stream.start, curStart + 5000);\r\n          f(curStart, curStyle);\r\n        }\r\n        curStyle = style;\r\n      }\r\n      stream.start = stream.pos;\r\n    }\r\n    while (curStart < stream.pos) {\r\n      // Webkit seems to refuse to render text nodes longer than 57444\r\n      // characters, and returns inaccurate measurements in nodes\r\n      // starting around 5000 chars.\r\n      var pos = Math.min(stream.pos, curStart + 5000);\r\n      f(pos, curStyle);\r\n      curStart = pos;\r\n    }\r\n  }\r\n\r\n  // Finds the line to start with when starting a parse. Tries to\r\n  // find a line with a stateAfter, so that it can start with a\r\n  // valid state. If that fails, it returns the line with the\r\n  // smallest indentation, which tends to need the least context to\r\n  // parse correctly.\r\n  function findStartLine(cm, n, precise) {\r\n    var minindent, minline, doc = cm.doc;\r\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\r\n    for (var search = n; search > lim; --search) {\r\n      if (search <= doc.first) { return doc.first }\r\n      var line = getLine(doc, search - 1), after = line.stateAfter;\r\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\r\n        { return search }\r\n      var indented = countColumn(line.text, null, cm.options.tabSize);\r\n      if (minline == null || minindent > indented) {\r\n        minline = search - 1;\r\n        minindent = indented;\r\n      }\r\n    }\r\n    return minline\r\n  }\r\n\r\n  function retreatFrontier(doc, n) {\r\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\r\n    if (doc.highlightFrontier < n - 10) { return }\r\n    var start = doc.first;\r\n    for (var line = n - 1; line > start; line--) {\r\n      var saved = getLine(doc, line).stateAfter;\r\n      // change is on 3\r\n      // state on line 1 looked ahead 2 -- so saw 3\r\n      // test 1 + 2 < 3 should cover this\r\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\r\n        start = line + 1;\r\n        break\r\n      }\r\n    }\r\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\r\n  }\r\n\r\n  // Optimize some code when these features are not used.\r\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\r\n\r\n  function seeReadOnlySpans() {\r\n    sawReadOnlySpans = true;\r\n  }\r\n\r\n  function seeCollapsedSpans() {\r\n    sawCollapsedSpans = true;\r\n  }\r\n\r\n  // TEXTMARKER SPANS\r\n\r\n  function MarkedSpan(marker, from, to) {\r\n    this.marker = marker;\r\n    this.from = from; this.to = to;\r\n  }\r\n\r\n  // Search an array of spans for a span matching the given marker.\r\n  function getMarkedSpanFor(spans, marker) {\r\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\r\n      var span = spans[i];\r\n      if (span.marker == marker) { return span }\r\n    } }\r\n  }\r\n\r\n  // Remove a span from an array, returning undefined if no spans are\r\n  // left (we don\'t store arrays for lines without spans).\r\n  function removeMarkedSpan(spans, span) {\r\n    var r;\r\n    for (var i = 0; i < spans.length; ++i)\r\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\r\n    return r\r\n  }\r\n\r\n  // Add a span to a line.\r\n  function addMarkedSpan(line, span, op) {\r\n    var inThisOp = op && window.WeakSet && (op.markedSpans || (op.markedSpans = new WeakSet));\r\n    if (inThisOp && line.markedSpans && inThisOp.has(line.markedSpans)) {\r\n      line.markedSpans.push(span);\r\n    } else {\r\n      line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\r\n      if (inThisOp) { inThisOp.add(line.markedSpans); }\r\n    }\r\n    span.marker.attachLine(line);\r\n  }\r\n\r\n  // Used for the algorithm that adjusts markers for a change in the\r\n  // document. These functions cut an array of spans at a given\r\n  // character position, returning an array of remaining chunks (or\r\n  // undefined if nothing remains).\r\n  function markedSpansBefore(old, startCh, isInsert) {\r\n    var nw;\r\n    if (old) { for (var i = 0; i < old.length; ++i) {\r\n      var span = old[i], marker = span.marker;\r\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\r\n      if (startsBefore || span.from == startCh && marker.type == "bookmark" && (!isInsert || !span.marker.insertLeft)) {\r\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\r\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\r\n      }\r\n    } }\r\n    return nw\r\n  }\r\n  function markedSpansAfter(old, endCh, isInsert) {\r\n    var nw;\r\n    if (old) { for (var i = 0; i < old.length; ++i) {\r\n      var span = old[i], marker = span.marker;\r\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\r\n      if (endsAfter || span.from == endCh && marker.type == "bookmark" && (!isInsert || span.marker.insertLeft)) {\r\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\r\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\r\n                                              span.to == null ? null : span.to - endCh));\r\n      }\r\n    } }\r\n    return nw\r\n  }\r\n\r\n  // Given a change object, compute the new set of marker spans that\r\n  // cover the line in which the change took place. Removes spans\r\n  // entirely within the change, reconnects spans belonging to the\r\n  // same marker that appear on both sides of the change, and cuts off\r\n  // spans partially within the change. Returns an array of span\r\n  // arrays with one element for each line in (after) the change.\r\n  function stretchSpansOverChange(doc, change) {\r\n    if (change.full) { return null }\r\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\r\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\r\n    if (!oldFirst && !oldLast) { return null }\r\n\r\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\r\n    // Get the spans that \'stick out\' on both sides\r\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\r\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\r\n\r\n    // Next, merge those two ends\r\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\r\n    if (first) {\r\n      // Fix up .to properties of first\r\n      for (var i = 0; i < first.length; ++i) {\r\n        var span = first[i];\r\n        if (span.to == null) {\r\n          var found = getMarkedSpanFor(last, span.marker);\r\n          if (!found) { span.to = startCh; }\r\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\r\n        }\r\n      }\r\n    }\r\n    if (last) {\r\n      // Fix up .from in last (or move them into first in case of sameLine)\r\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\r\n        var span$1 = last[i$1];\r\n        if (span$1.to != null) { span$1.to += offset; }\r\n        if (span$1.from == null) {\r\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\r\n          if (!found$1) {\r\n            span$1.from = offset;\r\n            if (sameLine) { (first || (first = [])).push(span$1); }\r\n          }\r\n        } else {\r\n          span$1.from += offset;\r\n          if (sameLine) { (first || (first = [])).push(span$1); }\r\n        }\r\n      }\r\n    }\r\n    // Make sure we didn\'t create any zero-length spans\r\n    if (first) { first = clearEmptySpans(first); }\r\n    if (last && last != first) { last = clearEmptySpans(last); }\r\n\r\n    var newMarkers = [first];\r\n    if (!sameLine) {\r\n      // Fill gap with whole-line-spans\r\n      var gap = change.text.length - 2, gapMarkers;\r\n      if (gap > 0 && first)\r\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\r\n          { if (first[i$2].to == null)\r\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\r\n      for (var i$3 = 0; i$3 < gap; ++i$3)\r\n        { newMarkers.push(gapMarkers); }\r\n      newMarkers.push(last);\r\n    }\r\n    return newMarkers\r\n  }\r\n\r\n  // Remove spans that are empty and don\'t have a clearWhenEmpty\r\n  // option of false.\r\n  function clearEmptySpans(spans) {\r\n    for (var i = 0; i < spans.length; ++i) {\r\n      var span = spans[i];\r\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\r\n        { spans.splice(i--, 1); }\r\n    }\r\n    if (!spans.length) { return null }\r\n    return spans\r\n  }\r\n\r\n  // Used to \'clip\' out readOnly ranges when making a change.\r\n  function removeReadOnlyRanges(doc, from, to) {\r\n    var markers = null;\r\n    doc.iter(from.line, to.line + 1, function (line) {\r\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\r\n        var mark = line.markedSpans[i].marker;\r\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\r\n          { (markers || (markers = [])).push(mark); }\r\n      } }\r\n    });\r\n    if (!markers) { return null }\r\n    var parts = [{from: from, to: to}];\r\n    for (var i = 0; i < markers.length; ++i) {\r\n      var mk = markers[i], m = mk.find(0);\r\n      for (var j = 0; j < parts.length; ++j) {\r\n        var p = parts[j];\r\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\r\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\r\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\r\n          { newParts.push({from: p.from, to: m.from}); }\r\n        if (dto > 0 || !mk.inclusiveRight && !dto)\r\n          { newParts.push({from: m.to, to: p.to}); }\r\n        parts.splice.apply(parts, newParts);\r\n        j += newParts.length - 3;\r\n      }\r\n    }\r\n    return parts\r\n  }\r\n\r\n  // Connect or disconnect spans from a line.\r\n  function detachMarkedSpans(line) {\r\n    var spans = line.markedSpans;\r\n    if (!spans) { return }\r\n    for (var i = 0; i < spans.length; ++i)\r\n      { spans[i].marker.detachLine(line); }\r\n    line.markedSpans = null;\r\n  }\r\n  function attachMarkedSpans(line, spans) {\r\n    if (!spans) { return }\r\n    for (var i = 0; i < spans.length; ++i)\r\n      { spans[i].marker.attachLine(line); }\r\n    line.markedSpans = spans;\r\n  }\r\n\r\n  // Helpers used when computing which overlapping collapsed span\r\n  // counts as the larger one.\r\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\r\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\r\n\r\n  // Returns a number indicating which of two overlapping collapsed\r\n  // spans is larger (and thus includes the other). Falls back to\r\n  // comparing ids when the spans cover exactly the same range.\r\n  function compareCollapsedMarkers(a, b) {\r\n    var lenDiff = a.lines.length - b.lines.length;\r\n    if (lenDiff != 0) { return lenDiff }\r\n    var aPos = a.find(), bPos = b.find();\r\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\r\n    if (fromCmp) { return -fromCmp }\r\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\r\n    if (toCmp) { return toCmp }\r\n    return b.id - a.id\r\n  }\r\n\r\n  // Find out whether a line ends or starts in a collapsed span. If\r\n  // so, return the marker for that span.\r\n  function collapsedSpanAtSide(line, start) {\r\n    var sps = sawCollapsedSpans && line.markedSpans, found;\r\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\r\n      sp = sps[i];\r\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\r\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\r\n        { found = sp.marker; }\r\n    } }\r\n    return found\r\n  }\r\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\r\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\r\n\r\n  function collapsedSpanAround(line, ch) {\r\n    var sps = sawCollapsedSpans && line.markedSpans, found;\r\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\r\n      var sp = sps[i];\r\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\r\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\r\n    } }\r\n    return found\r\n  }\r\n\r\n  // Test whether there exists a collapsed span that partially\r\n  // overlaps (covers the start or end, but not both) of a new span.\r\n  // Such overlap is not allowed.\r\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\r\n    var line = getLine(doc, lineNo);\r\n    var sps = sawCollapsedSpans && line.markedSpans;\r\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\r\n      var sp = sps[i];\r\n      if (!sp.marker.collapsed) { continue }\r\n      var found = sp.marker.find(0);\r\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\r\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\r\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\r\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\r\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\r\n        { return true }\r\n    } }\r\n  }\r\n\r\n  // A visual line is a line as drawn on the screen. Folding, for\r\n  // example, can cause multiple logical lines to appear on the same\r\n  // visual line. This finds the start of the visual line that the\r\n  // given line is part of (usually that is the line itself).\r\n  function visualLine(line) {\r\n    var merged;\r\n    while (merged = collapsedSpanAtStart(line))\r\n      { line = merged.find(-1, true).line; }\r\n    return line\r\n  }\r\n\r\n  function visualLineEnd(line) {\r\n    var merged;\r\n    while (merged = collapsedSpanAtEnd(line))\r\n      { line = merged.find(1, true).line; }\r\n    return line\r\n  }\r\n\r\n  // Returns an array of logical lines that continue the visual line\r\n  // started by the argument, or undefined if there are no such lines.\r\n  function visualLineContinued(line) {\r\n    var merged, lines;\r\n    while (merged = collapsedSpanAtEnd(line)) {\r\n      line = merged.find(1, true).line\r\n      ;(lines || (lines = [])).push(line);\r\n    }\r\n    return lines\r\n  }\r\n\r\n  // Get the line number of the start of the visual line that the\r\n  // given line number is part of.\r\n  function visualLineNo(doc, lineN) {\r\n    var line = getLine(doc, lineN), vis = visualLine(line);\r\n    if (line == vis) { return lineN }\r\n    return lineNo(vis)\r\n  }\r\n\r\n  // Get the line number of the start of the next visual line after\r\n  // the given line.\r\n  function visualLineEndNo(doc, lineN) {\r\n    if (lineN > doc.lastLine()) { return lineN }\r\n    var line = getLine(doc, lineN), merged;\r\n    if (!lineIsHidden(doc, line)) { return lineN }\r\n    while (merged = collapsedSpanAtEnd(line))\r\n      { line = merged.find(1, true).line; }\r\n    return lineNo(line) + 1\r\n  }\r\n\r\n  // Compute whether a line is hidden. Lines count as hidden when they\r\n  // are part of a visual line that starts with another line, or when\r\n  // they are entirely covered by collapsed, non-widget span.\r\n  function lineIsHidden(doc, line) {\r\n    var sps = sawCollapsedSpans && line.markedSpans;\r\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\r\n      sp = sps[i];\r\n      if (!sp.marker.collapsed) { continue }\r\n      if (sp.from == null) { return true }\r\n      if (sp.marker.widgetNode) { continue }\r\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\r\n        { return true }\r\n    } }\r\n  }\r\n  function lineIsHiddenInner(doc, line, span) {\r\n    if (span.to == null) {\r\n      var end = span.marker.find(1, true);\r\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\r\n    }\r\n    if (span.marker.inclusiveRight && span.to == line.text.length)\r\n      { return true }\r\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\r\n      sp = line.markedSpans[i];\r\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\r\n          (sp.to == null || sp.to != span.from) &&\r\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\r\n          lineIsHiddenInner(doc, line, sp)) { return true }\r\n    }\r\n  }\r\n\r\n  // Find the height above the given line.\r\n  function heightAtLine(lineObj) {\r\n    lineObj = visualLine(lineObj);\r\n\r\n    var h = 0, chunk = lineObj.parent;\r\n    for (var i = 0; i < chunk.lines.length; ++i) {\r\n      var line = chunk.lines[i];\r\n      if (line == lineObj) { break }\r\n      else { h += line.height; }\r\n    }\r\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\r\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\r\n        var cur = p.children[i$1];\r\n        if (cur == chunk) { break }\r\n        else { h += cur.height; }\r\n      }\r\n    }\r\n    return h\r\n  }\r\n\r\n  // Compute the character length of a line, taking into account\r\n  // collapsed ranges (see markText) that might hide parts, and join\r\n  // other lines onto it.\r\n  function lineLength(line) {\r\n    if (line.height == 0) { return 0 }\r\n    var len = line.text.length, merged, cur = line;\r\n    while (merged = collapsedSpanAtStart(cur)) {\r\n      var found = merged.find(0, true);\r\n      cur = found.from.line;\r\n      len += found.from.ch - found.to.ch;\r\n    }\r\n    cur = line;\r\n    while (merged = collapsedSpanAtEnd(cur)) {\r\n      var found$1 = merged.find(0, true);\r\n      len -= cur.text.length - found$1.from.ch;\r\n      cur = found$1.to.line;\r\n      len += cur.text.length - found$1.to.ch;\r\n    }\r\n    return len\r\n  }\r\n\r\n  // Find the longest line in the document.\r\n  function findMaxLine(cm) {\r\n    var d = cm.display, doc = cm.doc;\r\n    d.maxLine = getLine(doc, doc.first);\r\n    d.maxLineLength = lineLength(d.maxLine);\r\n    d.maxLineChanged = true;\r\n    doc.iter(function (line) {\r\n      var len = lineLength(line);\r\n      if (len > d.maxLineLength) {\r\n        d.maxLineLength = len;\r\n        d.maxLine = line;\r\n      }\r\n    });\r\n  }\r\n\r\n  // LINE DATA STRUCTURE\r\n\r\n  // Line objects. These hold state related to a line, including\r\n  // highlighting info (the styles array).\r\n  var Line = function(text, markedSpans, estimateHeight) {\r\n    this.text = text;\r\n    attachMarkedSpans(this, markedSpans);\r\n    this.height = estimateHeight ? estimateHeight(this) : 1;\r\n  };\r\n\r\n  Line.prototype.lineNo = function () { return lineNo(this) };\r\n  eventMixin(Line);\r\n\r\n  // Change the content (text, markers) of a line. Automatically\r\n  // invalidates cached information and tries to re-estimate the\r\n  // line\'s height.\r\n  function updateLine(line, text, markedSpans, estimateHeight) {\r\n    line.text = text;\r\n    if (line.stateAfter) { line.stateAfter = null; }\r\n    if (line.styles) { line.styles = null; }\r\n    if (line.order != null) { line.order = null; }\r\n    detachMarkedSpans(line);\r\n    attachMarkedSpans(line, markedSpans);\r\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\r\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\r\n  }\r\n\r\n  // Detach a line from the document tree and its markers.\r\n  function cleanUpLine(line) {\r\n    line.parent = null;\r\n    detachMarkedSpans(line);\r\n  }\r\n\r\n  // Convert a style as returned by a mode (either null, or a string\r\n  // containing one or more styles) to a CSS style. This is cached,\r\n  // and also looks for line-wide styles.\r\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\r\n  function interpretTokenStyle(style, options) {\r\n    if (!style || /^\\s*$/.test(style)) { return null }\r\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\r\n    return cache[style] ||\r\n      (cache[style] = style.replace(/\\S+/g, "cm-$&"))\r\n  }\r\n\r\n  // Render the DOM representation of the text of a line. Also builds\r\n  // up a \'line map\', which points at the DOM nodes that represent\r\n  // specific stretches of text, and is used by the measuring code.\r\n  // The returned object contains the DOM node, this map, and\r\n  // information about line-wide styles that were set by the mode.\r\n  function buildLineContent(cm, lineView) {\r\n    // The padding-right forces the element to have a \'border\', which\r\n    // is needed on Webkit to be able to get line-level bounding\r\n    // rectangles for it (in measureChar).\r\n    var content = eltP("span", null, null, webkit ? "padding-right: .1px" : null);\r\n    var builder = {pre: eltP("pre", [content], "CodeMirror-line"), content: content,\r\n                   col: 0, pos: 0, cm: cm,\r\n                   trailingSpace: false,\r\n                   splitSpaces: cm.getOption("lineWrapping")};\r\n    lineView.measure = {};\r\n\r\n    // Iterate over the logical lines that make up this visual line.\r\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\r\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\r\n      builder.pos = 0;\r\n      builder.addToken = buildToken;\r\n      // Optionally wire in some hacks into the token-rendering\r\n      // algorithm, to deal with browser quirks.\r\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\r\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\r\n      builder.map = [];\r\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\r\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\r\n      if (line.styleClasses) {\r\n        if (line.styleClasses.bgClass)\r\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || ""); }\r\n        if (line.styleClasses.textClass)\r\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || ""); }\r\n      }\r\n\r\n      // Ensure at least a single node is present, for measuring.\r\n      if (builder.map.length == 0)\r\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\r\n\r\n      // Store the map and a cache object for the current logical line\r\n      if (i == 0) {\r\n        lineView.measure.map = builder.map;\r\n        lineView.measure.cache = {};\r\n      } else {\r\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\r\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\r\n      }\r\n    }\r\n\r\n    // See issue #2901\r\n    if (webkit) {\r\n      var last = builder.content.lastChild;\r\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(".cm-tab")))\r\n        { builder.content.className = "cm-tab-wrap-hack"; }\r\n    }\r\n\r\n    signal(cm, "renderLine", cm, lineView.line, builder.pre);\r\n    if (builder.pre.className)\r\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || ""); }\r\n\r\n    return builder\r\n  }\r\n\r\n  function defaultSpecialCharPlaceholder(ch) {\r\n    var token = elt("span", "\\u2022", "cm-invalidchar");\r\n    token.title = "\\\\u" + ch.charCodeAt(0).toString(16);\r\n    token.setAttribute("aria-label", token.title);\r\n    return token\r\n  }\r\n\r\n  // Build up the DOM representation for a single token, and add it to\r\n  // the line map. Takes care to render special characters separately.\r\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\r\n    if (!text) { return }\r\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\r\n    var special = builder.cm.state.specialChars, mustWrap = false;\r\n    var content;\r\n    if (!special.test(text)) {\r\n      builder.col += text.length;\r\n      content = document.createTextNode(displayText);\r\n      builder.map.push(builder.pos, builder.pos + text.length, content);\r\n      if (ie && ie_version < 9) { mustWrap = true; }\r\n      builder.pos += text.length;\r\n    } else {\r\n      content = document.createDocumentFragment();\r\n      var pos = 0;\r\n      while (true) {\r\n        special.lastIndex = pos;\r\n        var m = special.exec(text);\r\n        var skipped = m ? m.index - pos : text.length - pos;\r\n        if (skipped) {\r\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\r\n          if (ie && ie_version < 9) { content.appendChild(elt("span", [txt])); }\r\n          else { content.appendChild(txt); }\r\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\r\n          builder.col += skipped;\r\n          builder.pos += skipped;\r\n        }\r\n        if (!m) { break }\r\n        pos += skipped + 1;\r\n        var txt$1 = (void 0);\r\n        if (m[0] == "\\t") {\r\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\r\n          txt$1 = content.appendChild(elt("span", spaceStr(tabWidth), "cm-tab"));\r\n          txt$1.setAttribute("role", "presentation");\r\n          txt$1.setAttribute("cm-text", "\\t");\r\n          builder.col += tabWidth;\r\n        } else if (m[0] == "\\r" || m[0] == "\\n") {\r\n          txt$1 = content.appendChild(elt("span", m[0] == "\\r" ? "\\u240d" : "\\u2424", "cm-invalidchar"));\r\n          txt$1.setAttribute("cm-text", m[0]);\r\n          builder.col += 1;\r\n        } else {\r\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\r\n          txt$1.setAttribute("cm-text", m[0]);\r\n          if (ie && ie_version < 9) { content.appendChild(elt("span", [txt$1])); }\r\n          else { content.appendChild(txt$1); }\r\n          builder.col += 1;\r\n        }\r\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\r\n        builder.pos++;\r\n      }\r\n    }\r\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\r\n    if (style || startStyle || endStyle || mustWrap || css || attributes) {\r\n      var fullStyle = style || "";\r\n      if (startStyle) { fullStyle += startStyle; }\r\n      if (endStyle) { fullStyle += endStyle; }\r\n      var token = elt("span", [content], fullStyle, css);\r\n      if (attributes) {\r\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != "style" && attr != "class")\r\n          { token.setAttribute(attr, attributes[attr]); } }\r\n      }\r\n      return builder.content.appendChild(token)\r\n    }\r\n    builder.content.appendChild(content);\r\n  }\r\n\r\n  // Change some spaces to NBSP to prevent the browser from collapsing\r\n  // trailing spaces at the end of a line when rendering text (issue #1362).\r\n  function splitSpaces(text, trailingBefore) {\r\n    if (text.length > 1 && !/  /.test(text)) { return text }\r\n    var spaceBefore = trailingBefore, result = "";\r\n    for (var i = 0; i < text.length; i++) {\r\n      var ch = text.charAt(i);\r\n      if (ch == " " && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\r\n        { ch = "\\u00a0"; }\r\n      result += ch;\r\n      spaceBefore = ch == " ";\r\n    }\r\n    return result\r\n  }\r\n\r\n  // Work around nonsense dimensions being reported for stretches of\r\n  // right-to-left text.\r\n  function buildTokenBadBidi(inner, order) {\r\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\r\n      style = style ? style + " cm-force-border" : "cm-force-border";\r\n      var start = builder.pos, end = start + text.length;\r\n      for (;;) {\r\n        // Find the part that overlaps with the start of this text\r\n        var part = (void 0);\r\n        for (var i = 0; i < order.length; i++) {\r\n          part = order[i];\r\n          if (part.to > start && part.from <= start) { break }\r\n        }\r\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\r\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\r\n        startStyle = null;\r\n        text = text.slice(part.to - start);\r\n        start = part.to;\r\n      }\r\n    }\r\n  }\r\n\r\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\r\n    var widget = !ignoreWidget && marker.widgetNode;\r\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\r\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\r\n      if (!widget)\r\n        { widget = builder.content.appendChild(document.createElement("span")); }\r\n      widget.setAttribute("cm-marker", marker.id);\r\n    }\r\n    if (widget) {\r\n      builder.cm.display.input.setUneditable(widget);\r\n      builder.content.appendChild(widget);\r\n    }\r\n    builder.pos += size;\r\n    builder.trailingSpace = false;\r\n  }\r\n\r\n  // Outputs a number of spans to make up a line, taking highlighting\r\n  // and marked text into account.\r\n  function insertLineContent(line, builder, styles) {\r\n    var spans = line.markedSpans, allText = line.text, at = 0;\r\n    if (!spans) {\r\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\r\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\r\n      return\r\n    }\r\n\r\n    var len = allText.length, pos = 0, i = 1, text = "", style, css;\r\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\r\n    for (;;) {\r\n      if (nextChange == pos) { // Update current marker set\r\n        spanStyle = spanEndStyle = spanStartStyle = css = "";\r\n        attributes = null;\r\n        collapsed = null; nextChange = Infinity;\r\n        var foundBookmarks = [], endStyles = (void 0);\r\n        for (var j = 0; j < spans.length; ++j) {\r\n          var sp = spans[j], m = sp.marker;\r\n          if (m.type == "bookmark" && sp.from == pos && m.widgetNode) {\r\n            foundBookmarks.push(m);\r\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\r\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\r\n              nextChange = sp.to;\r\n              spanEndStyle = "";\r\n            }\r\n            if (m.className) { spanStyle += " " + m.className; }\r\n            if (m.css) { css = (css ? css + ";" : "") + m.css; }\r\n            if (m.startStyle && sp.from == pos) { spanStartStyle += " " + m.startStyle; }\r\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\r\n            // support for the old title property\r\n            // https://github.com/codemirror/CodeMirror/pull/5673\r\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\r\n            if (m.attributes) {\r\n              for (var attr in m.attributes)\r\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\r\n            }\r\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\r\n              { collapsed = sp; }\r\n          } else if (sp.from > pos && nextChange > sp.from) {\r\n            nextChange = sp.from;\r\n          }\r\n        }\r\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\r\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += " " + endStyles[j$1]; } } }\r\n\r\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\r\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\r\n        if (collapsed && (collapsed.from || 0) == pos) {\r\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\r\n                             collapsed.marker, collapsed.from == null);\r\n          if (collapsed.to == null) { return }\r\n          if (collapsed.to == pos) { collapsed = false; }\r\n        }\r\n      }\r\n      if (pos >= len) { break }\r\n\r\n      var upto = Math.min(len, nextChange);\r\n      while (true) {\r\n        if (text) {\r\n          var end = pos + text.length;\r\n          if (!collapsed) {\r\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\r\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\r\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : "", css, attributes);\r\n          }\r\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\r\n          pos = end;\r\n          spanStartStyle = "";\r\n        }\r\n        text = allText.slice(at, at = styles[i++]);\r\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  // These objects are used to represent the visible (currently drawn)\r\n  // part of the document. A LineView may correspond to multiple\r\n  // logical lines, if those are connected by collapsed ranges.\r\n  function LineView(doc, line, lineN) {\r\n    // The starting line\r\n    this.line = line;\r\n    // Continuing lines, if any\r\n    this.rest = visualLineContinued(line);\r\n    // Number of logical lines in this visual line\r\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\r\n    this.node = this.text = null;\r\n    this.hidden = lineIsHidden(doc, line);\r\n  }\r\n\r\n  // Create a range of LineView objects for the given lines.\r\n  function buildViewArray(cm, from, to) {\r\n    var array = [], nextPos;\r\n    for (var pos = from; pos < to; pos = nextPos) {\r\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\r\n      nextPos = pos + view.size;\r\n      array.push(view);\r\n    }\r\n    return array\r\n  }\r\n\r\n  var operationGroup = null;\r\n\r\n  function pushOperation(op) {\r\n    if (operationGroup) {\r\n      operationGroup.ops.push(op);\r\n    } else {\r\n      op.ownsGroup = operationGroup = {\r\n        ops: [op],\r\n        delayedCallbacks: []\r\n      };\r\n    }\r\n  }\r\n\r\n  function fireCallbacksForOps(group) {\r\n    // Calls delayed callbacks and cursorActivity handlers until no\r\n    // new ones appear\r\n    var callbacks = group.delayedCallbacks, i = 0;\r\n    do {\r\n      for (; i < callbacks.length; i++)\r\n        { callbacks[i].call(null); }\r\n      for (var j = 0; j < group.ops.length; j++) {\r\n        var op = group.ops[j];\r\n        if (op.cursorActivityHandlers)\r\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\r\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\r\n      }\r\n    } while (i < callbacks.length)\r\n  }\r\n\r\n  function finishOperation(op, endCb) {\r\n    var group = op.ownsGroup;\r\n    if (!group) { return }\r\n\r\n    try { fireCallbacksForOps(group); }\r\n    finally {\r\n      operationGroup = null;\r\n      endCb(group);\r\n    }\r\n  }\r\n\r\n  var orphanDelayedCallbacks = null;\r\n\r\n  // Often, we want to signal events at a point where we are in the\r\n  // middle of some work, but don\'t want the handler to start calling\r\n  // other methods on the editor, which might be in an inconsistent\r\n  // state or simply not expect any other events to happen.\r\n  // signalLater looks whether there are any handlers, and schedules\r\n  // them to be executed when the last operation ends, or, if no\r\n  // operation is active, when a timeout fires.\r\n  function signalLater(emitter, type /*, values...*/) {\r\n    var arr = getHandlers(emitter, type);\r\n    if (!arr.length) { return }\r\n    var args = Array.prototype.slice.call(arguments, 2), list;\r\n    if (operationGroup) {\r\n      list = operationGroup.delayedCallbacks;\r\n    } else if (orphanDelayedCallbacks) {\r\n      list = orphanDelayedCallbacks;\r\n    } else {\r\n      list = orphanDelayedCallbacks = [];\r\n      setTimeout(fireOrphanDelayed, 0);\r\n    }\r\n    var loop = function ( i ) {\r\n      list.push(function () { return arr[i].apply(null, args); });\r\n    };\r\n\r\n    for (var i = 0; i < arr.length; ++i)\r\n      loop( i );\r\n  }\r\n\r\n  function fireOrphanDelayed() {\r\n    var delayed = orphanDelayedCallbacks;\r\n    orphanDelayedCallbacks = null;\r\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\r\n  }\r\n\r\n  // When an aspect of a line changes, a string is added to\r\n  // lineView.changes. This updates the relevant part of the line\'s\r\n  // DOM structure.\r\n  function updateLineForChanges(cm, lineView, lineN, dims) {\r\n    for (var j = 0; j < lineView.changes.length; j++) {\r\n      var type = lineView.changes[j];\r\n      if (type == "text") { updateLineText(cm, lineView); }\r\n      else if (type == "gutter") { updateLineGutter(cm, lineView, lineN, dims); }\r\n      else if (type == "class") { updateLineClasses(cm, lineView); }\r\n      else if (type == "widget") { updateLineWidgets(cm, lineView, dims); }\r\n    }\r\n    lineView.changes = null;\r\n  }\r\n\r\n  // Lines with gutter elements, widgets or a background class need to\r\n  // be wrapped, and have the extra elements added to the wrapper div\r\n  function ensureLineWrapped(lineView) {\r\n    if (lineView.node == lineView.text) {\r\n      lineView.node = elt("div", null, null, "position: relative");\r\n      if (lineView.text.parentNode)\r\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\r\n      lineView.node.appendChild(lineView.text);\r\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\r\n    }\r\n    return lineView.node\r\n  }\r\n\r\n  function updateLineBackground(cm, lineView) {\r\n    var cls = lineView.bgClass ? lineView.bgClass + " " + (lineView.line.bgClass || "") : lineView.line.bgClass;\r\n    if (cls) { cls += " CodeMirror-linebackground"; }\r\n    if (lineView.background) {\r\n      if (cls) { lineView.background.className = cls; }\r\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\r\n    } else if (cls) {\r\n      var wrap = ensureLineWrapped(lineView);\r\n      lineView.background = wrap.insertBefore(elt("div", null, cls), wrap.firstChild);\r\n      cm.display.input.setUneditable(lineView.background);\r\n    }\r\n  }\r\n\r\n  // Wrapper around buildLineContent which will reuse the structure\r\n  // in display.externalMeasured when possible.\r\n  function getLineContent(cm, lineView) {\r\n    var ext = cm.display.externalMeasured;\r\n    if (ext && ext.line == lineView.line) {\r\n      cm.display.externalMeasured = null;\r\n      lineView.measure = ext.measure;\r\n      return ext.built\r\n    }\r\n    return buildLineContent(cm, lineView)\r\n  }\r\n\r\n  // Redraw the line\'s text. Interacts with the background and text\r\n  // classes because the mode may output tokens that influence these\r\n  // classes.\r\n  function updateLineText(cm, lineView) {\r\n    var cls = lineView.text.className;\r\n    var built = getLineContent(cm, lineView);\r\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\r\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\r\n    lineView.text = built.pre;\r\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\r\n      lineView.bgClass = built.bgClass;\r\n      lineView.textClass = built.textClass;\r\n      updateLineClasses(cm, lineView);\r\n    } else if (cls) {\r\n      lineView.text.className = cls;\r\n    }\r\n  }\r\n\r\n  function updateLineClasses(cm, lineView) {\r\n    updateLineBackground(cm, lineView);\r\n    if (lineView.line.wrapClass)\r\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\r\n    else if (lineView.node != lineView.text)\r\n      { lineView.node.className = ""; }\r\n    var textClass = lineView.textClass ? lineView.textClass + " " + (lineView.line.textClass || "") : lineView.line.textClass;\r\n    lineView.text.className = textClass || "";\r\n  }\r\n\r\n  function updateLineGutter(cm, lineView, lineN, dims) {\r\n    if (lineView.gutter) {\r\n      lineView.node.removeChild(lineView.gutter);\r\n      lineView.gutter = null;\r\n    }\r\n    if (lineView.gutterBackground) {\r\n      lineView.node.removeChild(lineView.gutterBackground);\r\n      lineView.gutterBackground = null;\r\n    }\r\n    if (lineView.line.gutterClass) {\r\n      var wrap = ensureLineWrapped(lineView);\r\n      lineView.gutterBackground = elt("div", null, "CodeMirror-gutter-background " + lineView.line.gutterClass,\r\n                                      ("left: " + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + "px; width: " + (dims.gutterTotalWidth) + "px"));\r\n      cm.display.input.setUneditable(lineView.gutterBackground);\r\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\r\n    }\r\n    var markers = lineView.line.gutterMarkers;\r\n    if (cm.options.lineNumbers || markers) {\r\n      var wrap$1 = ensureLineWrapped(lineView);\r\n      var gutterWrap = lineView.gutter = elt("div", null, "CodeMirror-gutter-wrapper", ("left: " + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + "px"));\r\n      gutterWrap.setAttribute("aria-hidden", "true");\r\n      cm.display.input.setUneditable(gutterWrap);\r\n      wrap$1.insertBefore(gutterWrap, lineView.text);\r\n      if (lineView.line.gutterClass)\r\n        { gutterWrap.className += " " + lineView.line.gutterClass; }\r\n      if (cm.options.lineNumbers && (!markers || !markers["CodeMirror-linenumbers"]))\r\n        { lineView.lineNumber = gutterWrap.appendChild(\r\n          elt("div", lineNumberFor(cm.options, lineN),\r\n              "CodeMirror-linenumber CodeMirror-gutter-elt",\r\n              ("left: " + (dims.gutterLeft["CodeMirror-linenumbers"]) + "px; width: " + (cm.display.lineNumInnerWidth) + "px"))); }\r\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\r\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\r\n        if (found)\r\n          { gutterWrap.appendChild(elt("div", [found], "CodeMirror-gutter-elt",\r\n                                     ("left: " + (dims.gutterLeft[id]) + "px; width: " + (dims.gutterWidth[id]) + "px"))); }\r\n      } }\r\n    }\r\n  }\r\n\r\n  function updateLineWidgets(cm, lineView, dims) {\r\n    if (lineView.alignable) { lineView.alignable = null; }\r\n    var isWidget = classTest("CodeMirror-linewidget");\r\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\r\n      next = node.nextSibling;\r\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\r\n    }\r\n    insertLineWidgets(cm, lineView, dims);\r\n  }\r\n\r\n  // Build a line\'s DOM representation from scratch\r\n  function buildLineElement(cm, lineView, lineN, dims) {\r\n    var built = getLineContent(cm, lineView);\r\n    lineView.text = lineView.node = built.pre;\r\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\r\n    if (built.textClass) { lineView.textClass = built.textClass; }\r\n\r\n    updateLineClasses(cm, lineView);\r\n    updateLineGutter(cm, lineView, lineN, dims);\r\n    insertLineWidgets(cm, lineView, dims);\r\n    return lineView.node\r\n  }\r\n\r\n  // A lineView may contain multiple logical lines (when merged by\r\n  // collapsed spans). The widgets for all of them need to be drawn.\r\n  function insertLineWidgets(cm, lineView, dims) {\r\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\r\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\r\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\r\n  }\r\n\r\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\r\n    if (!line.widgets) { return }\r\n    var wrap = ensureLineWrapped(lineView);\r\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\r\n      var widget = ws[i], node = elt("div", [widget.node], "CodeMirror-linewidget" + (widget.className ? " " + widget.className : ""));\r\n      if (!widget.handleMouseEvents) { node.setAttribute("cm-ignore-events", "true"); }\r\n      positionLineWidget(widget, node, lineView, dims);\r\n      cm.display.input.setUneditable(node);\r\n      if (allowAbove && widget.above)\r\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\r\n      else\r\n        { wrap.appendChild(node); }\r\n      signalLater(widget, "redraw");\r\n    }\r\n  }\r\n\r\n  function positionLineWidget(widget, node, lineView, dims) {\r\n    if (widget.noHScroll) {\r\n  (lineView.alignable || (lineView.alignable = [])).push(node);\r\n      var width = dims.wrapperWidth;\r\n      node.style.left = dims.fixedPos + "px";\r\n      if (!widget.coverGutter) {\r\n        width -= dims.gutterTotalWidth;\r\n        node.style.paddingLeft = dims.gutterTotalWidth + "px";\r\n      }\r\n      node.style.width = width + "px";\r\n    }\r\n    if (widget.coverGutter) {\r\n      node.style.zIndex = 5;\r\n      node.style.position = "relative";\r\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + "px"; }\r\n    }\r\n  }\r\n\r\n  function widgetHeight(widget) {\r\n    if (widget.height != null) { return widget.height }\r\n    var cm = widget.doc.cm;\r\n    if (!cm) { return 0 }\r\n    if (!contains(document.body, widget.node)) {\r\n      var parentStyle = "position: relative;";\r\n      if (widget.coverGutter)\r\n        { parentStyle += "margin-left: -" + cm.display.gutters.offsetWidth + "px;"; }\r\n      if (widget.noHScroll)\r\n        { parentStyle += "width: " + cm.display.wrapper.clientWidth + "px;"; }\r\n      removeChildrenAndAdd(cm.display.measure, elt("div", [widget.node], null, parentStyle));\r\n    }\r\n    return widget.height = widget.node.parentNode.offsetHeight\r\n  }\r\n\r\n  // Return true when the given mouse event happened in a widget\r\n  function eventInWidget(display, e) {\r\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\r\n      if (!n || (n.nodeType == 1 && n.getAttribute("cm-ignore-events") == "true") ||\r\n          (n.parentNode == display.sizer && n != display.mover))\r\n        { return true }\r\n    }\r\n  }\r\n\r\n  // POSITION MEASUREMENT\r\n\r\n  function paddingTop(display) {return display.lineSpace.offsetTop}\r\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\r\n  function paddingH(display) {\r\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\r\n    var e = removeChildrenAndAdd(display.measure, elt("pre", "x", "CodeMirror-line-like"));\r\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\r\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\r\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\r\n    return data\r\n  }\r\n\r\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\r\n  function displayWidth(cm) {\r\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\r\n  }\r\n  function displayHeight(cm) {\r\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\r\n  }\r\n\r\n  // Ensure the lineView.wrapping.heights array is populated. This is\r\n  // an array of bottom offsets for the lines that make up a drawn\r\n  // line. When lineWrapping is on, there might be more than one\r\n  // height.\r\n  function ensureLineHeights(cm, lineView, rect) {\r\n    var wrapping = cm.options.lineWrapping;\r\n    var curWidth = wrapping && displayWidth(cm);\r\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\r\n      var heights = lineView.measure.heights = [];\r\n      if (wrapping) {\r\n        lineView.measure.width = curWidth;\r\n        var rects = lineView.text.firstChild.getClientRects();\r\n        for (var i = 0; i < rects.length - 1; i++) {\r\n          var cur = rects[i], next = rects[i + 1];\r\n          if (Math.abs(cur.bottom - next.bottom) > 2)\r\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\r\n        }\r\n      }\r\n      heights.push(rect.bottom - rect.top);\r\n    }\r\n  }\r\n\r\n  // Find a line map (mapping character offsets to text nodes) and a\r\n  // measurement cache for the given line number. (A line view might\r\n  // contain multiple lines when collapsed ranges are present.)\r\n  function mapFromLineView(lineView, line, lineN) {\r\n    if (lineView.line == line)\r\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\r\n    if (lineView.rest) {\r\n      for (var i = 0; i < lineView.rest.length; i++)\r\n        { if (lineView.rest[i] == line)\r\n          { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\r\n      for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\r\n        { if (lineNo(lineView.rest[i$1]) > lineN)\r\n          { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\r\n    }\r\n  }\r\n\r\n  // Render a line into the hidden node display.externalMeasured. Used\r\n  // when measurement is needed for a line that\'s not in the viewport.\r\n  function updateExternalMeasurement(cm, line) {\r\n    line = visualLine(line);\r\n    var lineN = lineNo(line);\r\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\r\n    view.lineN = lineN;\r\n    var built = view.built = buildLineContent(cm, view);\r\n    view.text = built.pre;\r\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\r\n    return view\r\n  }\r\n\r\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\r\n  // for a given character.\r\n  function measureChar(cm, line, ch, bias) {\r\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\r\n  }\r\n\r\n  // Find a line view that corresponds to the given line number.\r\n  function findViewForLine(cm, lineN) {\r\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\r\n      { return cm.display.view[findViewIndex(cm, lineN)] }\r\n    var ext = cm.display.externalMeasured;\r\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\r\n      { return ext }\r\n  }\r\n\r\n  // Measurement can be split in two steps, the set-up work that\r\n  // applies to the whole line, and the measurement of the actual\r\n  // character. Functions like coordsChar, that need to do a lot of\r\n  // measurements in a row, can thus ensure that the set-up work is\r\n  // only done once.\r\n  function prepareMeasureForLine(cm, line) {\r\n    var lineN = lineNo(line);\r\n    var view = findViewForLine(cm, lineN);\r\n    if (view && !view.text) {\r\n      view = null;\r\n    } else if (view && view.changes) {\r\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\r\n      cm.curOp.forceUpdate = true;\r\n    }\r\n    if (!view)\r\n      { view = updateExternalMeasurement(cm, line); }\r\n\r\n    var info = mapFromLineView(view, line, lineN);\r\n    return {\r\n      line: line, view: view, rect: null,\r\n      map: info.map, cache: info.cache, before: info.before,\r\n      hasHeights: false\r\n    }\r\n  }\r\n\r\n  // Given a prepared measurement object, measures the position of an\r\n  // actual character (or fetches it from the cache).\r\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\r\n    if (prepared.before) { ch = -1; }\r\n    var key = ch + (bias || ""), found;\r\n    if (prepared.cache.hasOwnProperty(key)) {\r\n      found = prepared.cache[key];\r\n    } else {\r\n      if (!prepared.rect)\r\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\r\n      if (!prepared.hasHeights) {\r\n        ensureLineHeights(cm, prepared.view, prepared.rect);\r\n        prepared.hasHeights = true;\r\n      }\r\n      found = measureCharInner(cm, prepared, ch, bias);\r\n      if (!found.bogus) { prepared.cache[key] = found; }\r\n    }\r\n    return {left: found.left, right: found.right,\r\n            top: varHeight ? found.rtop : found.top,\r\n            bottom: varHeight ? found.rbottom : found.bottom}\r\n  }\r\n\r\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\r\n\r\n  function nodeAndOffsetInLineMap(map, ch, bias) {\r\n    var node, start, end, collapse, mStart, mEnd;\r\n    // First, search the line map for the text node corresponding to,\r\n    // or closest to, the target character.\r\n    for (var i = 0; i < map.length; i += 3) {\r\n      mStart = map[i];\r\n      mEnd = map[i + 1];\r\n      if (ch < mStart) {\r\n        start = 0; end = 1;\r\n        collapse = "left";\r\n      } else if (ch < mEnd) {\r\n        start = ch - mStart;\r\n        end = start + 1;\r\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\r\n        end = mEnd - mStart;\r\n        start = end - 1;\r\n        if (ch >= mEnd) { collapse = "right"; }\r\n      }\r\n      if (start != null) {\r\n        node = map[i + 2];\r\n        if (mStart == mEnd && bias == (node.insertLeft ? "left" : "right"))\r\n          { collapse = bias; }\r\n        if (bias == "left" && start == 0)\r\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\r\n            node = map[(i -= 3) + 2];\r\n            collapse = "left";\r\n          } }\r\n        if (bias == "right" && start == mEnd - mStart)\r\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\r\n            node = map[(i += 3) + 2];\r\n            collapse = "right";\r\n          } }\r\n        break\r\n      }\r\n    }\r\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\r\n  }\r\n\r\n  function getUsefulRect(rects, bias) {\r\n    var rect = nullRect;\r\n    if (bias == "left") { for (var i = 0; i < rects.length; i++) {\r\n      if ((rect = rects[i]).left != rect.right) { break }\r\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\r\n      if ((rect = rects[i$1]).left != rect.right) { break }\r\n    } }\r\n    return rect\r\n  }\r\n\r\n  function measureCharInner(cm, prepared, ch, bias) {\r\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\r\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\r\n\r\n    var rect;\r\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\r\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\r\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\r\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\r\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\r\n          { rect = node.parentNode.getBoundingClientRect(); }\r\n        else\r\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\r\n        if (rect.left || rect.right || start == 0) { break }\r\n        end = start;\r\n        start = start - 1;\r\n        collapse = "right";\r\n      }\r\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\r\n    } else { // If it is a widget, simply get the box for the whole widget.\r\n      if (start > 0) { collapse = bias = "right"; }\r\n      var rects;\r\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\r\n        { rect = rects[bias == "right" ? rects.length - 1 : 0]; }\r\n      else\r\n        { rect = node.getBoundingClientRect(); }\r\n    }\r\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\r\n      var rSpan = node.parentNode.getClientRects()[0];\r\n      if (rSpan)\r\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\r\n      else\r\n        { rect = nullRect; }\r\n    }\r\n\r\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\r\n    var mid = (rtop + rbot) / 2;\r\n    var heights = prepared.view.measure.heights;\r\n    var i = 0;\r\n    for (; i < heights.length - 1; i++)\r\n      { if (mid < heights[i]) { break } }\r\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\r\n    var result = {left: (collapse == "right" ? rect.right : rect.left) - prepared.rect.left,\r\n                  right: (collapse == "left" ? rect.left : rect.right) - prepared.rect.left,\r\n                  top: top, bottom: bot};\r\n    if (!rect.left && !rect.right) { result.bogus = true; }\r\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\r\n\r\n    return result\r\n  }\r\n\r\n  // Work around problem with bounding client rects on ranges being\r\n  // returned incorrectly when zoomed on IE10 and below.\r\n  function maybeUpdateRectForZooming(measure, rect) {\r\n    if (!window.screen || screen.logicalXDPI == null ||\r\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\r\n      { return rect }\r\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\r\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\r\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\r\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\r\n  }\r\n\r\n  function clearLineMeasurementCacheFor(lineView) {\r\n    if (lineView.measure) {\r\n      lineView.measure.cache = {};\r\n      lineView.measure.heights = null;\r\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\r\n        { lineView.measure.caches[i] = {}; } }\r\n    }\r\n  }\r\n\r\n  function clearLineMeasurementCache(cm) {\r\n    cm.display.externalMeasure = null;\r\n    removeChildren(cm.display.lineMeasure);\r\n    for (var i = 0; i < cm.display.view.length; i++)\r\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\r\n  }\r\n\r\n  function clearCaches(cm) {\r\n    clearLineMeasurementCache(cm);\r\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\r\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\r\n    cm.display.lineNumChars = null;\r\n  }\r\n\r\n  function pageScrollX(doc) {\r\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\r\n    // which causes page_Offset and bounding client rects to use\r\n    // different reference viewports and invalidate our calculations.\r\n    if (chrome && android) { return -(doc.body.getBoundingClientRect().left - parseInt(getComputedStyle(doc.body).marginLeft)) }\r\n    return doc.defaultView.pageXOffset || (doc.documentElement || doc.body).scrollLeft\r\n  }\r\n  function pageScrollY(doc) {\r\n    if (chrome && android) { return -(doc.body.getBoundingClientRect().top - parseInt(getComputedStyle(doc.body).marginTop)) }\r\n    return doc.defaultView.pageYOffset || (doc.documentElement || doc.body).scrollTop\r\n  }\r\n\r\n  function widgetTopHeight(lineObj) {\r\n    var ref = visualLine(lineObj);\r\n    var widgets = ref.widgets;\r\n    var height = 0;\r\n    if (widgets) { for (var i = 0; i < widgets.length; ++i) { if (widgets[i].above)\r\n      { height += widgetHeight(widgets[i]); } } }\r\n    return height\r\n  }\r\n\r\n  // Converts a {top, bottom, left, right} box from line-local\r\n  // coordinates into another coordinate system. Context may be one of\r\n  // "line", "div" (display.lineDiv), "local"./null (editor), "window",\r\n  // or "page".\r\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\r\n    if (!includeWidgets) {\r\n      var height = widgetTopHeight(lineObj);\r\n      rect.top += height; rect.bottom += height;\r\n    }\r\n    if (context == "line") { return rect }\r\n    if (!context) { context = "local"; }\r\n    var yOff = heightAtLine(lineObj);\r\n    if (context == "local") { yOff += paddingTop(cm.display); }\r\n    else { yOff -= cm.display.viewOffset; }\r\n    if (context == "page" || context == "window") {\r\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\r\n      yOff += lOff.top + (context == "window" ? 0 : pageScrollY(doc(cm)));\r\n      var xOff = lOff.left + (context == "window" ? 0 : pageScrollX(doc(cm)));\r\n      rect.left += xOff; rect.right += xOff;\r\n    }\r\n    rect.top += yOff; rect.bottom += yOff;\r\n    return rect\r\n  }\r\n\r\n  // Coverts a box from "div" coords to another coordinate system.\r\n  // Context may be "window", "page", "div", or "local"./null.\r\n  function fromCoordSystem(cm, coords, context) {\r\n    if (context == "div") { return coords }\r\n    var left = coords.left, top = coords.top;\r\n    // First move into "page" coordinate system\r\n    if (context == "page") {\r\n      left -= pageScrollX(doc(cm));\r\n      top -= pageScrollY(doc(cm));\r\n    } else if (context == "local" || !context) {\r\n      var localBox = cm.display.sizer.getBoundingClientRect();\r\n      left += localBox.left;\r\n      top += localBox.top;\r\n    }\r\n\r\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\r\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\r\n  }\r\n\r\n  function charCoords(cm, pos, context, lineObj, bias) {\r\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\r\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\r\n  }\r\n\r\n  // Returns a box for a given cursor position, which may have an\r\n  // \'other\' property containing the position of the secondary cursor\r\n  // on a bidi boundary.\r\n  // A cursor Pos(line, char, "before") is on the same visual line as `char - 1`\r\n  // and after `char - 1` in writing order of `char - 1`\r\n  // A cursor Pos(line, char, "after") is on the same visual line as `char`\r\n  // and before `char` in writing order of `char`\r\n  // Examples (upper-case letters are RTL, lower-case are LTR):\r\n  //     Pos(0, 1, ...)\r\n  //     before   after\r\n  // ab     a|b     a|b\r\n  // aB     a|B     aB|\r\n  // Ab     |Ab     A|b\r\n  // AB     B|A     B|A\r\n  // Every position after the last character on a line is considered to stick\r\n  // to the last character on the line.\r\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\r\n    lineObj = lineObj || getLine(cm.doc, pos.line);\r\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\r\n    function get(ch, right) {\r\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? "right" : "left", varHeight);\r\n      if (right) { m.left = m.right; } else { m.right = m.left; }\r\n      return intoCoordSystem(cm, lineObj, m, context)\r\n    }\r\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\r\n    if (ch >= lineObj.text.length) {\r\n      ch = lineObj.text.length;\r\n      sticky = "before";\r\n    } else if (ch <= 0) {\r\n      ch = 0;\r\n      sticky = "after";\r\n    }\r\n    if (!order) { return get(sticky == "before" ? ch - 1 : ch, sticky == "before") }\r\n\r\n    function getBidi(ch, partPos, invert) {\r\n      var part = order[partPos], right = part.level == 1;\r\n      return get(invert ? ch - 1 : ch, right != invert)\r\n    }\r\n    var partPos = getBidiPartAt(order, ch, sticky);\r\n    var other = bidiOther;\r\n    var val = getBidi(ch, partPos, sticky == "before");\r\n    if (other != null) { val.other = getBidi(ch, other, sticky != "before"); }\r\n    return val\r\n  }\r\n\r\n  // Used to cheaply estimate the coordinates for a position. Used for\r\n  // intermediate scroll updates.\r\n  function estimateCoords(cm, pos) {\r\n    var left = 0;\r\n    pos = clipPos(cm.doc, pos);\r\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\r\n    var lineObj = getLine(cm.doc, pos.line);\r\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\r\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\r\n  }\r\n\r\n  // Positions returned by coordsChar contain some extra information.\r\n  // xRel is the relative x position of the input coordinates compared\r\n  // to the found position (so xRel > 0 means the coordinates are to\r\n  // the right of the character position, for example). When outside\r\n  // is true, that means the coordinates lie outside the line\'s\r\n  // vertical range.\r\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\r\n    var pos = Pos(line, ch, sticky);\r\n    pos.xRel = xRel;\r\n    if (outside) { pos.outside = outside; }\r\n    return pos\r\n  }\r\n\r\n  // Compute the character position closest to the given coordinates.\r\n  // Input must be lineSpace-local ("div" coordinate system).\r\n  function coordsChar(cm, x, y) {\r\n    var doc = cm.doc;\r\n    y += cm.display.viewOffset;\r\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\r\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\r\n    if (lineN > last)\r\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\r\n    if (x < 0) { x = 0; }\r\n\r\n    var lineObj = getLine(doc, lineN);\r\n    for (;;) {\r\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\r\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\r\n      if (!collapsed) { return found }\r\n      var rangeEnd = collapsed.find(1);\r\n      if (rangeEnd.line == lineN) { return rangeEnd }\r\n      lineObj = getLine(doc, lineN = rangeEnd.line);\r\n    }\r\n  }\r\n\r\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\r\n    y -= widgetTopHeight(lineObj);\r\n    var end = lineObj.text.length;\r\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\r\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\r\n    return {begin: begin, end: end}\r\n  }\r\n\r\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\r\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\r\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), "line").top;\r\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\r\n  }\r\n\r\n  // Returns true if the given side of a box is after the given\r\n  // coordinates, in top-to-bottom, left-to-right order.\r\n  function boxIsAfter(box, x, y, left) {\r\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\r\n  }\r\n\r\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\r\n    // Move y into line-local coordinate space\r\n    y -= heightAtLine(lineObj);\r\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\r\n    // When directly calling `measureCharPrepared`, we have to adjust\r\n    // for the widgets at this line.\r\n    var widgetHeight = widgetTopHeight(lineObj);\r\n    var begin = 0, end = lineObj.text.length, ltr = true;\r\n\r\n    var order = getOrder(lineObj, cm.doc.direction);\r\n    // If the line isn\'t plain left-to-right text, first figure out\r\n    // which bidi section the coordinates fall into.\r\n    if (order) {\r\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\r\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\r\n      ltr = part.level != 1;\r\n      // The awkward -1 offsets are needed because findFirst (called\r\n      // on these below) will treat its first bound as inclusive,\r\n      // second as exclusive, but we want to actually address the\r\n      // characters in the part\'s range\r\n      begin = ltr ? part.from : part.to - 1;\r\n      end = ltr ? part.to : part.from - 1;\r\n    }\r\n\r\n    // A binary search to find the first character whose bounding box\r\n    // starts after the coordinates. If we run across any whose box wrap\r\n    // the coordinates, store that.\r\n    var chAround = null, boxAround = null;\r\n    var ch = findFirst(function (ch) {\r\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\r\n      box.top += widgetHeight; box.bottom += widgetHeight;\r\n      if (!boxIsAfter(box, x, y, false)) { return false }\r\n      if (box.top <= y && box.left <= x) {\r\n        chAround = ch;\r\n        boxAround = box;\r\n      }\r\n      return true\r\n    }, begin, end);\r\n\r\n    var baseX, sticky, outside = false;\r\n    // If a box around the coordinates was found, use that\r\n    if (boxAround) {\r\n      // Distinguish coordinates nearer to the left or right side of the box\r\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\r\n      ch = chAround + (atStart ? 0 : 1);\r\n      sticky = atStart ? "after" : "before";\r\n      baseX = atLeft ? boxAround.left : boxAround.right;\r\n    } else {\r\n      // (Adjust for extended bound, if necessary.)\r\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\r\n      // To determine which side to associate with, get the box to the\r\n      // left of the character and compare it\'s vertical position to the\r\n      // coordinates\r\n      sticky = ch == 0 ? "after" : ch == lineObj.text.length ? "before" :\r\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\r\n        "after" : "before";\r\n      // Now get accurate coordinates for this place, in order to get a\r\n      // base X position\r\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), "line", lineObj, preparedMeasure);\r\n      baseX = coords.left;\r\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\r\n    }\r\n\r\n    ch = skipExtendingChars(lineObj.text, ch, 1);\r\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\r\n  }\r\n\r\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\r\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\r\n    // situation, we can take this ordering to correspond to the visual\r\n    // ordering. This finds the first part whose end is after the given\r\n    // coordinates.\r\n    var index = findFirst(function (i) {\r\n      var part = order[i], ltr = part.level != 1;\r\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? "before" : "after"),\r\n                                     "line", lineObj, preparedMeasure), x, y, true)\r\n    }, 0, order.length - 1);\r\n    var part = order[index];\r\n    // If this isn\'t the first part, the part\'s start is also after\r\n    // the coordinates, and the coordinates aren\'t on the same line as\r\n    // that start, move one part back.\r\n    if (index > 0) {\r\n      var ltr = part.level != 1;\r\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? "after" : "before"),\r\n                               "line", lineObj, preparedMeasure);\r\n      if (boxIsAfter(start, x, y, true) && start.top > y)\r\n        { part = order[index - 1]; }\r\n    }\r\n    return part\r\n  }\r\n\r\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\r\n    // In a wrapped line, rtl text on wrapping boundaries can do things\r\n    // that don\'t correspond to the ordering in our `order` array at\r\n    // all, so a binary search doesn\'t work, and we want to return a\r\n    // part that only spans one line so that the binary search in\r\n    // coordsCharInner is safe. As such, we first find the extent of the\r\n    // wrapped line, and then do a flat search in which we discard any\r\n    // spans that aren\'t on the line.\r\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\r\n    var begin = ref.begin;\r\n    var end = ref.end;\r\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\r\n    var part = null, closestDist = null;\r\n    for (var i = 0; i < order.length; i++) {\r\n      var p = order[i];\r\n      if (p.from >= end || p.to <= begin) { continue }\r\n      var ltr = p.level != 1;\r\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\r\n      // Weigh against spans ending before this, so that they are only\r\n      // picked if nothing ends after\r\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\r\n      if (!part || closestDist > dist) {\r\n        part = p;\r\n        closestDist = dist;\r\n      }\r\n    }\r\n    if (!part) { part = order[order.length - 1]; }\r\n    // Clip the part to the wrapped line.\r\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\r\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\r\n    return part\r\n  }\r\n\r\n  var measureText;\r\n  // Compute the default text height.\r\n  function textHeight(display) {\r\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\r\n    if (measureText == null) {\r\n      measureText = elt("pre", null, "CodeMirror-line-like");\r\n      // Measure a bunch of lines, for browsers that compute\r\n      // fractional heights.\r\n      for (var i = 0; i < 49; ++i) {\r\n        measureText.appendChild(document.createTextNode("x"));\r\n        measureText.appendChild(elt("br"));\r\n      }\r\n      measureText.appendChild(document.createTextNode("x"));\r\n    }\r\n    removeChildrenAndAdd(display.measure, measureText);\r\n    var height = measureText.offsetHeight / 50;\r\n    if (height > 3) { display.cachedTextHeight = height; }\r\n    removeChildren(display.measure);\r\n    return height || 1\r\n  }\r\n\r\n  // Compute the default character width.\r\n  function charWidth(display) {\r\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\r\n    var anchor = elt("span", "xxxxxxxxxx");\r\n    var pre = elt("pre", [anchor], "CodeMirror-line-like");\r\n    removeChildrenAndAdd(display.measure, pre);\r\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\r\n    if (width > 2) { display.cachedCharWidth = width; }\r\n    return width || 10\r\n  }\r\n\r\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\r\n  // view, so that we don\'t interleave reading and writing to the DOM.\r\n  function getDimensions(cm) {\r\n    var d = cm.display, left = {}, width = {};\r\n    var gutterLeft = d.gutters.clientLeft;\r\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\r\n      var id = cm.display.gutterSpecs[i].className;\r\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\r\n      width[id] = n.clientWidth;\r\n    }\r\n    return {fixedPos: compensateForHScroll(d),\r\n            gutterTotalWidth: d.gutters.offsetWidth,\r\n            gutterLeft: left,\r\n            gutterWidth: width,\r\n            wrapperWidth: d.wrapper.clientWidth}\r\n  }\r\n\r\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\r\n  // but using getBoundingClientRect to get a sub-pixel-accurate\r\n  // result.\r\n  function compensateForHScroll(display) {\r\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\r\n  }\r\n\r\n  // Returns a function that estimates the height of a line, to use as\r\n  // first approximation until the line becomes visible (and is thus\r\n  // properly measurable).\r\n  function estimateHeight(cm) {\r\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\r\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\r\n    return function (line) {\r\n      if (lineIsHidden(cm.doc, line)) { return 0 }\r\n\r\n      var widgetsHeight = 0;\r\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\r\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\r\n      } }\r\n\r\n      if (wrapping)\r\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\r\n      else\r\n        { return widgetsHeight + th }\r\n    }\r\n  }\r\n\r\n  function estimateLineHeights(cm) {\r\n    var doc = cm.doc, est = estimateHeight(cm);\r\n    doc.iter(function (line) {\r\n      var estHeight = est(line);\r\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\r\n    });\r\n  }\r\n\r\n  // Given a mouse event, find the corresponding position. If liberal\r\n  // is false, it checks whether a gutter or scrollbar was clicked,\r\n  // and returns null if it was. forRect is used by rectangular\r\n  // selections, and tries to estimate a character position even for\r\n  // coordinates beyond the right of the text.\r\n  function posFromMouse(cm, e, liberal, forRect) {\r\n    var display = cm.display;\r\n    if (!liberal && e_target(e).getAttribute("cm-not-content") == "true") { return null }\r\n\r\n    var x, y, space = display.lineSpace.getBoundingClientRect();\r\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\r\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\r\n    catch (e$1) { return null }\r\n    var coords = coordsChar(cm, x, y), line;\r\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\r\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\r\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\r\n    }\r\n    return coords\r\n  }\r\n\r\n  // Find the view element corresponding to a given line. Return null\r\n  // when the line isn\'t visible.\r\n  function findViewIndex(cm, n) {\r\n    if (n >= cm.display.viewTo) { return null }\r\n    n -= cm.display.viewFrom;\r\n    if (n < 0) { return null }\r\n    var view = cm.display.view;\r\n    for (var i = 0; i < view.length; i++) {\r\n      n -= view[i].size;\r\n      if (n < 0) { return i }\r\n    }\r\n  }\r\n\r\n  // Updates the display.view data structure for a given change to the\r\n  // document. From and to are in pre-change coordinates. Lendiff is\r\n  // the amount of lines added or subtracted by the change. This is\r\n  // used for changes that span multiple lines, or change the way\r\n  // lines are divided into visual lines. regLineChange (below)\r\n  // registers single-line changes.\r\n  function regChange(cm, from, to, lendiff) {\r\n    if (from == null) { from = cm.doc.first; }\r\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\r\n    if (!lendiff) { lendiff = 0; }\r\n\r\n    var display = cm.display;\r\n    if (lendiff && to < display.viewTo &&\r\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\r\n      { display.updateLineNumbers = from; }\r\n\r\n    cm.curOp.viewChanged = true;\r\n\r\n    if (from >= display.viewTo) { // Change after\r\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\r\n        { resetView(cm); }\r\n    } else if (to <= display.viewFrom) { // Change before\r\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\r\n        resetView(cm);\r\n      } else {\r\n        display.viewFrom += lendiff;\r\n        display.viewTo += lendiff;\r\n      }\r\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\r\n      resetView(cm);\r\n    } else if (from <= display.viewFrom) { // Top overlap\r\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\r\n      if (cut) {\r\n        display.view = display.view.slice(cut.index);\r\n        display.viewFrom = cut.lineN;\r\n        display.viewTo += lendiff;\r\n      } else {\r\n        resetView(cm);\r\n      }\r\n    } else if (to >= display.viewTo) { // Bottom overlap\r\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\r\n      if (cut$1) {\r\n        display.view = display.view.slice(0, cut$1.index);\r\n        display.viewTo = cut$1.lineN;\r\n      } else {\r\n        resetView(cm);\r\n      }\r\n    } else { // Gap in the middle\r\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\r\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\r\n      if (cutTop && cutBot) {\r\n        display.view = display.view.slice(0, cutTop.index)\r\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\r\n          .concat(display.view.slice(cutBot.index));\r\n        display.viewTo += lendiff;\r\n      } else {\r\n        resetView(cm);\r\n      }\r\n    }\r\n\r\n    var ext = display.externalMeasured;\r\n    if (ext) {\r\n      if (to < ext.lineN)\r\n        { ext.lineN += lendiff; }\r\n      else if (from < ext.lineN + ext.size)\r\n        { display.externalMeasured = null; }\r\n    }\r\n  }\r\n\r\n  // Register a change to a single line. Type must be one of "text",\r\n  // "gutter", "class", "widget"\r\n  function regLineChange(cm, line, type) {\r\n    cm.curOp.viewChanged = true;\r\n    var display = cm.display, ext = cm.display.externalMeasured;\r\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\r\n      { display.externalMeasured = null; }\r\n\r\n    if (line < display.viewFrom || line >= display.viewTo) { return }\r\n    var lineView = display.view[findViewIndex(cm, line)];\r\n    if (lineView.node == null) { return }\r\n    var arr = lineView.changes || (lineView.changes = []);\r\n    if (indexOf(arr, type) == -1) { arr.push(type); }\r\n  }\r\n\r\n  // Clear the view.\r\n  function resetView(cm) {\r\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\r\n    cm.display.view = [];\r\n    cm.display.viewOffset = 0;\r\n  }\r\n\r\n  function viewCuttingPoint(cm, oldN, newN, dir) {\r\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\r\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\r\n      { return {index: index, lineN: newN} }\r\n    var n = cm.display.viewFrom;\r\n    for (var i = 0; i < index; i++)\r\n      { n += view[i].size; }\r\n    if (n != oldN) {\r\n      if (dir > 0) {\r\n        if (index == view.length - 1) { return null }\r\n        diff = (n + view[index].size) - oldN;\r\n        index++;\r\n      } else {\r\n        diff = n - oldN;\r\n      }\r\n      oldN += diff; newN += diff;\r\n    }\r\n    while (visualLineNo(cm.doc, newN) != newN) {\r\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\r\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\r\n      index += dir;\r\n    }\r\n    return {index: index, lineN: newN}\r\n  }\r\n\r\n  // Force the view to cover a given range, adding empty view element\r\n  // or clipping off existing ones as needed.\r\n  function adjustView(cm, from, to) {\r\n    var display = cm.display, view = display.view;\r\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\r\n      display.view = buildViewArray(cm, from, to);\r\n      display.viewFrom = from;\r\n    } else {\r\n      if (display.viewFrom > from)\r\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\r\n      else if (display.viewFrom < from)\r\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\r\n      display.viewFrom = from;\r\n      if (display.viewTo < to)\r\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\r\n      else if (display.viewTo > to)\r\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\r\n    }\r\n    display.viewTo = to;\r\n  }\r\n\r\n  // Count the number of lines in the view whose DOM representation is\r\n  // out of date (or nonexistent).\r\n  function countDirtyView(cm) {\r\n    var view = cm.display.view, dirty = 0;\r\n    for (var i = 0; i < view.length; i++) {\r\n      var lineView = view[i];\r\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\r\n    }\r\n    return dirty\r\n  }\r\n\r\n  function updateSelection(cm) {\r\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\r\n  }\r\n\r\n  function prepareSelection(cm, primary) {\r\n    if ( primary === void 0 ) primary = true;\r\n\r\n    var doc = cm.doc, result = {};\r\n    var curFragment = result.cursors = document.createDocumentFragment();\r\n    var selFragment = result.selection = document.createDocumentFragment();\r\n\r\n    var customCursor = cm.options.$customCursor;\r\n    if (customCursor) { primary = true; }\r\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\r\n      if (!primary && i == doc.sel.primIndex) { continue }\r\n      var range = doc.sel.ranges[i];\r\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\r\n      var collapsed = range.empty();\r\n      if (customCursor) {\r\n        var head = customCursor(cm, range);\r\n        if (head) { drawSelectionCursor(cm, head, curFragment); }\r\n      } else if (collapsed || cm.options.showCursorWhenSelecting) {\r\n        drawSelectionCursor(cm, range.head, curFragment);\r\n      }\r\n      if (!collapsed)\r\n        { drawSelectionRange(cm, range, selFragment); }\r\n    }\r\n    return result\r\n  }\r\n\r\n  // Draws a cursor for the given range\r\n  function drawSelectionCursor(cm, head, output) {\r\n    var pos = cursorCoords(cm, head, "div", null, null, !cm.options.singleCursorHeightPerLine);\r\n\r\n    var cursor = output.appendChild(elt("div", "\\u00a0", "CodeMirror-cursor"));\r\n    cursor.style.left = pos.left + "px";\r\n    cursor.style.top = pos.top + "px";\r\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + "px";\r\n\r\n    if (/\\bcm-fat-cursor\\b/.test(cm.getWrapperElement().className)) {\r\n      var charPos = charCoords(cm, head, "div", null, null);\r\n      var width = charPos.right - charPos.left;\r\n      cursor.style.width = (width > 0 ? width : cm.defaultCharWidth()) + "px";\r\n    }\r\n\r\n    if (pos.other) {\r\n      // Secondary cursor, shown when on a \'jump\' in bi-directional text\r\n      var otherCursor = output.appendChild(elt("div", "\\u00a0", "CodeMirror-cursor CodeMirror-secondarycursor"));\r\n      otherCursor.style.display = "";\r\n      otherCursor.style.left = pos.other.left + "px";\r\n      otherCursor.style.top = pos.other.top + "px";\r\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + "px";\r\n    }\r\n  }\r\n\r\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\r\n\r\n  // Draws the given range as a highlighted selection\r\n  function drawSelectionRange(cm, range, output) {\r\n    var display = cm.display, doc = cm.doc;\r\n    var fragment = document.createDocumentFragment();\r\n    var padding = paddingH(cm.display), leftSide = padding.left;\r\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\r\n    var docLTR = doc.direction == "ltr";\r\n\r\n    function add(left, top, width, bottom) {\r\n      if (top < 0) { top = 0; }\r\n      top = Math.round(top);\r\n      bottom = Math.round(bottom);\r\n      fragment.appendChild(elt("div", null, "CodeMirror-selected", ("position: absolute; left: " + left + "px;\\n                             top: " + top + "px; width: " + (width == null ? rightSide - left : width) + "px;\\n                             height: " + (bottom - top) + "px")));\r\n    }\r\n\r\n    function drawForLine(line, fromArg, toArg) {\r\n      var lineObj = getLine(doc, line);\r\n      var lineLen = lineObj.text.length;\r\n      var start, end;\r\n      function coords(ch, bias) {\r\n        return charCoords(cm, Pos(line, ch), "div", lineObj, bias)\r\n      }\r\n\r\n      function wrapX(pos, dir, side) {\r\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\r\n        var prop = (dir == "ltr") == (side == "after") ? "left" : "right";\r\n        var ch = side == "after" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\r\n        return coords(ch, prop)[prop]\r\n      }\r\n\r\n      var order = getOrder(lineObj, doc.direction);\r\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\r\n        var ltr = dir == "ltr";\r\n        var fromPos = coords(from, ltr ? "left" : "right");\r\n        var toPos = coords(to - 1, ltr ? "right" : "left");\r\n\r\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\r\n        var first = i == 0, last = !order || i == order.length - 1;\r\n        if (toPos.top - fromPos.top <= 3) { // Single line\r\n          var openLeft = (docLTR ? openStart : openEnd) && first;\r\n          var openRight = (docLTR ? openEnd : openStart) && last;\r\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\r\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\r\n          add(left, fromPos.top, right - left, fromPos.bottom);\r\n        } else { // Multiple lines\r\n          var topLeft, topRight, botLeft, botRight;\r\n          if (ltr) {\r\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\r\n            topRight = docLTR ? rightSide : wrapX(from, dir, "before");\r\n            botLeft = docLTR ? leftSide : wrapX(to, dir, "after");\r\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\r\n          } else {\r\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, "before");\r\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\r\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\r\n            botRight = !docLTR ? rightSide : wrapX(to, dir, "after");\r\n          }\r\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\r\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\r\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\r\n        }\r\n\r\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\r\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\r\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\r\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\r\n      });\r\n      return {start: start, end: end}\r\n    }\r\n\r\n    var sFrom = range.from(), sTo = range.to();\r\n    if (sFrom.line == sTo.line) {\r\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\r\n    } else {\r\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\r\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\r\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\r\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\r\n      if (singleVLine) {\r\n        if (leftEnd.top < rightStart.top - 2) {\r\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\r\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\r\n        } else {\r\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\r\n        }\r\n      }\r\n      if (leftEnd.bottom < rightStart.top)\r\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\r\n    }\r\n\r\n    output.appendChild(fragment);\r\n  }\r\n\r\n  // Cursor-blinking\r\n  function restartBlink(cm) {\r\n    if (!cm.state.focused) { return }\r\n    var display = cm.display;\r\n    clearInterval(display.blinker);\r\n    var on = true;\r\n    display.cursorDiv.style.visibility = "";\r\n    if (cm.options.cursorBlinkRate > 0)\r\n      { display.blinker = setInterval(function () {\r\n        if (!cm.hasFocus()) { onBlur(cm); }\r\n        display.cursorDiv.style.visibility = (on = !on) ? "" : "hidden";\r\n      }, cm.options.cursorBlinkRate); }\r\n    else if (cm.options.cursorBlinkRate < 0)\r\n      { display.cursorDiv.style.visibility = "hidden"; }\r\n  }\r\n\r\n  function ensureFocus(cm) {\r\n    if (!cm.hasFocus()) {\r\n      cm.display.input.focus();\r\n      if (!cm.state.focused) { onFocus(cm); }\r\n    }\r\n  }\r\n\r\n  function delayBlurEvent(cm) {\r\n    cm.state.delayingBlurEvent = true;\r\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\r\n      cm.state.delayingBlurEvent = false;\r\n      if (cm.state.focused) { onBlur(cm); }\r\n    } }, 100);\r\n  }\r\n\r\n  function onFocus(cm, e) {\r\n    if (cm.state.delayingBlurEvent && !cm.state.draggingText) { cm.state.delayingBlurEvent = false; }\r\n\r\n    if (cm.options.readOnly == "nocursor") { return }\r\n    if (!cm.state.focused) {\r\n      signal(cm, "focus", cm, e);\r\n      cm.state.focused = true;\r\n      addClass(cm.display.wrapper, "CodeMirror-focused");\r\n      // This test prevents this from firing when a context\r\n      // menu is closed (since the input reset would kill the\r\n      // select-all detection hack)\r\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\r\n        cm.display.input.reset();\r\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\r\n      }\r\n      cm.display.input.receivedFocus();\r\n    }\r\n    restartBlink(cm);\r\n  }\r\n  function onBlur(cm, e) {\r\n    if (cm.state.delayingBlurEvent) { return }\r\n\r\n    if (cm.state.focused) {\r\n      signal(cm, "blur", cm, e);\r\n      cm.state.focused = false;\r\n      rmClass(cm.display.wrapper, "CodeMirror-focused");\r\n    }\r\n    clearInterval(cm.display.blinker);\r\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\r\n  }\r\n\r\n  // Read the actual heights of the rendered lines, and update their\r\n  // stored heights to match.\r\n  function updateHeightsInViewport(cm) {\r\n    var display = cm.display;\r\n    var prevBottom = display.lineDiv.offsetTop;\r\n    var viewTop = Math.max(0, display.scroller.getBoundingClientRect().top);\r\n    var oldHeight = display.lineDiv.getBoundingClientRect().top;\r\n    var mustScroll = 0;\r\n    for (var i = 0; i < display.view.length; i++) {\r\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\r\n      var height = (void 0), width = 0;\r\n      if (cur.hidden) { continue }\r\n      oldHeight += cur.line.height;\r\n      if (ie && ie_version < 8) {\r\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\r\n        height = bot - prevBottom;\r\n        prevBottom = bot;\r\n      } else {\r\n        var box = cur.node.getBoundingClientRect();\r\n        height = box.bottom - box.top;\r\n        // Check that lines don\'t extend past the right of the current\r\n        // editor width\r\n        if (!wrapping && cur.text.firstChild)\r\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\r\n      }\r\n      var diff = cur.line.height - height;\r\n      if (diff > .005 || diff < -.005) {\r\n        if (oldHeight < viewTop) { mustScroll -= diff; }\r\n        updateLineHeight(cur.line, height);\r\n        updateWidgetHeight(cur.line);\r\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\r\n          { updateWidgetHeight(cur.rest[j]); } }\r\n      }\r\n      if (width > cm.display.sizerWidth) {\r\n        var chWidth = Math.ceil(width / charWidth(cm.display));\r\n        if (chWidth > cm.display.maxLineLength) {\r\n          cm.display.maxLineLength = chWidth;\r\n          cm.display.maxLine = cur.line;\r\n          cm.display.maxLineChanged = true;\r\n        }\r\n      }\r\n    }\r\n    if (Math.abs(mustScroll) > 2) { display.scroller.scrollTop += mustScroll; }\r\n  }\r\n\r\n  // Read and store the height of line widgets associated with the\r\n  // given line.\r\n  function updateWidgetHeight(line) {\r\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\r\n      var w = line.widgets[i], parent = w.node.parentNode;\r\n      if (parent) { w.height = parent.offsetHeight; }\r\n    } }\r\n  }\r\n\r\n  // Compute the lines that are visible in a given viewport (defaults\r\n  // the current scroll position). viewport may contain top,\r\n  // height, and ensure (see op.scrollToPos) properties.\r\n  function visibleLines(display, doc, viewport) {\r\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\r\n    top = Math.floor(top - paddingTop(display));\r\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\r\n\r\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\r\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\r\n    // forces those lines into the viewport (if possible).\r\n    if (viewport && viewport.ensure) {\r\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\r\n      if (ensureFrom < from) {\r\n        from = ensureFrom;\r\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\r\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\r\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\r\n        to = ensureTo;\r\n      }\r\n    }\r\n    return {from: from, to: Math.max(to, from + 1)}\r\n  }\r\n\r\n  // SCROLLING THINGS INTO VIEW\r\n\r\n  // If an editor sits on the top or bottom of the window, partially\r\n  // scrolled out of view, this ensures that the cursor is visible.\r\n  function maybeScrollWindow(cm, rect) {\r\n    if (signalDOMEvent(cm, "scrollCursorIntoView")) { return }\r\n\r\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\r\n    var doc = display.wrapper.ownerDocument;\r\n    if (rect.top + box.top < 0) { doScroll = true; }\r\n    else if (rect.bottom + box.top > (doc.defaultView.innerHeight || doc.documentElement.clientHeight)) { doScroll = false; }\r\n    if (doScroll != null && !phantom) {\r\n      var scrollNode = elt("div", "\\u200b", null, ("position: absolute;\\n                         top: " + (rect.top - display.viewOffset - paddingTop(cm.display)) + "px;\\n                         height: " + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + "px;\\n                         left: " + (rect.left) + "px; width: " + (Math.max(2, rect.right - rect.left)) + "px;"));\r\n      cm.display.lineSpace.appendChild(scrollNode);\r\n      scrollNode.scrollIntoView(doScroll);\r\n      cm.display.lineSpace.removeChild(scrollNode);\r\n    }\r\n  }\r\n\r\n  // Scroll a given position into view (immediately), verifying that\r\n  // it actually became visible (as line heights are accurately\r\n  // measured, the position of something may \'drift\' during drawing).\r\n  function scrollPosIntoView(cm, pos, end, margin) {\r\n    if (margin == null) { margin = 0; }\r\n    var rect;\r\n    if (!cm.options.lineWrapping && pos == end) {\r\n      // Set pos and end to the cursor positions around the character pos sticks to\r\n      // If pos.sticky == "before", that is around pos.ch - 1, otherwise around pos.ch\r\n      // If pos == Pos(_, 0, "before"), pos and end are unchanged\r\n      end = pos.sticky == "before" ? Pos(pos.line, pos.ch + 1, "before") : pos;\r\n      pos = pos.ch ? Pos(pos.line, pos.sticky == "before" ? pos.ch - 1 : pos.ch, "after") : pos;\r\n    }\r\n    for (var limit = 0; limit < 5; limit++) {\r\n      var changed = false;\r\n      var coords = cursorCoords(cm, pos);\r\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\r\n      rect = {left: Math.min(coords.left, endCoords.left),\r\n              top: Math.min(coords.top, endCoords.top) - margin,\r\n              right: Math.max(coords.left, endCoords.left),\r\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\r\n      var scrollPos = calculateScrollPos(cm, rect);\r\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\r\n      if (scrollPos.scrollTop != null) {\r\n        updateScrollTop(cm, scrollPos.scrollTop);\r\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\r\n      }\r\n      if (scrollPos.scrollLeft != null) {\r\n        setScrollLeft(cm, scrollPos.scrollLeft);\r\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\r\n      }\r\n      if (!changed) { break }\r\n    }\r\n    return rect\r\n  }\r\n\r\n  // Scroll a given set of coordinates into view (immediately).\r\n  function scrollIntoView(cm, rect) {\r\n    var scrollPos = calculateScrollPos(cm, rect);\r\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\r\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\r\n  }\r\n\r\n  // Calculate a new scroll position needed to scroll the given\r\n  // rectangle into view. Returns an object with scrollTop and\r\n  // scrollLeft properties. When these are undefined, the\r\n  // vertical/horizontal position does not need to be adjusted.\r\n  function calculateScrollPos(cm, rect) {\r\n    var display = cm.display, snapMargin = textHeight(cm.display);\r\n    if (rect.top < 0) { rect.top = 0; }\r\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\r\n    var screen = displayHeight(cm), result = {};\r\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\r\n    var docBottom = cm.doc.height + paddingVert(display);\r\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\r\n    if (rect.top < screentop) {\r\n      result.scrollTop = atTop ? 0 : rect.top;\r\n    } else if (rect.bottom > screentop + screen) {\r\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\r\n      if (newTop != screentop) { result.scrollTop = newTop; }\r\n    }\r\n\r\n    var gutterSpace = cm.options.fixedGutter ? 0 : display.gutters.offsetWidth;\r\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft - gutterSpace;\r\n    var screenw = displayWidth(cm) - display.gutters.offsetWidth;\r\n    var tooWide = rect.right - rect.left > screenw;\r\n    if (tooWide) { rect.right = rect.left + screenw; }\r\n    if (rect.left < 10)\r\n      { result.scrollLeft = 0; }\r\n    else if (rect.left < screenleft)\r\n      { result.scrollLeft = Math.max(0, rect.left + gutterSpace - (tooWide ? 0 : 10)); }\r\n    else if (rect.right > screenw + screenleft - 3)\r\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\r\n    return result\r\n  }\r\n\r\n  // Store a relative adjustment to the scroll position in the current\r\n  // operation (to be applied when the operation finishes).\r\n  function addToScrollTop(cm, top) {\r\n    if (top == null) { return }\r\n    resolveScrollToPos(cm);\r\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\r\n  }\r\n\r\n  // Make sure that at the end of the operation the current cursor is\r\n  // shown.\r\n  function ensureCursorVisible(cm) {\r\n    resolveScrollToPos(cm);\r\n    var cur = cm.getCursor();\r\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\r\n  }\r\n\r\n  function scrollToCoords(cm, x, y) {\r\n    if (x != null || y != null) { resolveScrollToPos(cm); }\r\n    if (x != null) { cm.curOp.scrollLeft = x; }\r\n    if (y != null) { cm.curOp.scrollTop = y; }\r\n  }\r\n\r\n  function scrollToRange(cm, range) {\r\n    resolveScrollToPos(cm);\r\n    cm.curOp.scrollToPos = range;\r\n  }\r\n\r\n  // When an operation has its scrollToPos property set, and another\r\n  // scroll action is applied before the end of the operation, this\r\n  // \'simulates\' scrolling that position into view in a cheap way, so\r\n  // that the effect of intermediate scroll commands is not ignored.\r\n  function resolveScrollToPos(cm) {\r\n    var range = cm.curOp.scrollToPos;\r\n    if (range) {\r\n      cm.curOp.scrollToPos = null;\r\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\r\n      scrollToCoordsRange(cm, from, to, range.margin);\r\n    }\r\n  }\r\n\r\n  function scrollToCoordsRange(cm, from, to, margin) {\r\n    var sPos = calculateScrollPos(cm, {\r\n      left: Math.min(from.left, to.left),\r\n      top: Math.min(from.top, to.top) - margin,\r\n      right: Math.max(from.right, to.right),\r\n      bottom: Math.max(from.bottom, to.bottom) + margin\r\n    });\r\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\r\n  }\r\n\r\n  // Sync the scrollable area and scrollbars, ensure the viewport\r\n  // covers the visible area.\r\n  function updateScrollTop(cm, val) {\r\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\r\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\r\n    setScrollTop(cm, val, true);\r\n    if (gecko) { updateDisplaySimple(cm); }\r\n    startWorker(cm, 100);\r\n  }\r\n\r\n  function setScrollTop(cm, val, forceScroll) {\r\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\r\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\r\n    cm.doc.scrollTop = val;\r\n    cm.display.scrollbars.setScrollTop(val);\r\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\r\n  }\r\n\r\n  // Sync scroller and scrollbar, ensure the gutter elements are\r\n  // aligned.\r\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\r\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\r\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\r\n    cm.doc.scrollLeft = val;\r\n    alignHorizontally(cm);\r\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\r\n    cm.display.scrollbars.setScrollLeft(val);\r\n  }\r\n\r\n  // SCROLLBARS\r\n\r\n  // Prepare DOM reads needed to update the scrollbars. Done in one\r\n  // shot to minimize update/measure roundtrips.\r\n  function measureForScrollbars(cm) {\r\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\r\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\r\n    return {\r\n      clientHeight: d.scroller.clientHeight,\r\n      viewHeight: d.wrapper.clientHeight,\r\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\r\n      viewWidth: d.wrapper.clientWidth,\r\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\r\n      docHeight: docH,\r\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\r\n      nativeBarWidth: d.nativeBarWidth,\r\n      gutterWidth: gutterW\r\n    }\r\n  }\r\n\r\n  var NativeScrollbars = function(place, scroll, cm) {\r\n    this.cm = cm;\r\n    var vert = this.vert = elt("div", [elt("div", null, null, "min-width: 1px")], "CodeMirror-vscrollbar");\r\n    var horiz = this.horiz = elt("div", [elt("div", null, null, "height: 100%; min-height: 1px")], "CodeMirror-hscrollbar");\r\n    vert.tabIndex = horiz.tabIndex = -1;\r\n    place(vert); place(horiz);\r\n\r\n    on(vert, "scroll", function () {\r\n      if (vert.clientHeight) { scroll(vert.scrollTop, "vertical"); }\r\n    });\r\n    on(horiz, "scroll", function () {\r\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, "horizontal"); }\r\n    });\r\n\r\n    this.checkedZeroWidth = false;\r\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\r\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = "18px"; }\r\n  };\r\n\r\n  NativeScrollbars.prototype.update = function (measure) {\r\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\r\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\r\n    var sWidth = measure.nativeBarWidth;\r\n\r\n    if (needsV) {\r\n      this.vert.style.display = "block";\r\n      this.vert.style.bottom = needsH ? sWidth + "px" : "0";\r\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\r\n      // A bug in IE8 can cause this value to be negative, so guard it.\r\n      this.vert.firstChild.style.height =\r\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + "px";\r\n    } else {\r\n      this.vert.scrollTop = 0;\r\n      this.vert.style.display = "";\r\n      this.vert.firstChild.style.height = "0";\r\n    }\r\n\r\n    if (needsH) {\r\n      this.horiz.style.display = "block";\r\n      this.horiz.style.right = needsV ? sWidth + "px" : "0";\r\n      this.horiz.style.left = measure.barLeft + "px";\r\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\r\n      this.horiz.firstChild.style.width =\r\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + "px";\r\n    } else {\r\n      this.horiz.style.display = "";\r\n      this.horiz.firstChild.style.width = "0";\r\n    }\r\n\r\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\r\n      if (sWidth == 0) { this.zeroWidthHack(); }\r\n      this.checkedZeroWidth = true;\r\n    }\r\n\r\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\r\n  };\r\n\r\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\r\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\r\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, "horiz"); }\r\n  };\r\n\r\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\r\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\r\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, "vert"); }\r\n  };\r\n\r\n  NativeScrollbars.prototype.zeroWidthHack = function () {\r\n    var w = mac && !mac_geMountainLion ? "12px" : "18px";\r\n    this.horiz.style.height = this.vert.style.width = w;\r\n    this.horiz.style.visibility = this.vert.style.visibility = "hidden";\r\n    this.disableHoriz = new Delayed;\r\n    this.disableVert = new Delayed;\r\n  };\r\n\r\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\r\n    bar.style.visibility = "";\r\n    function maybeDisable() {\r\n      // To find out whether the scrollbar is still visible, we\r\n      // check whether the element under the pixel in the bottom\r\n      // right corner of the scrollbar box is the scrollbar box\r\n      // itself (when the bar is still visible) or its filler child\r\n      // (when the bar is hidden). If it is still visible, we keep\r\n      // it enabled, if it\'s hidden, we disable pointer events.\r\n      var box = bar.getBoundingClientRect();\r\n      var elt = type == "vert" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\r\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\r\n      if (elt != bar) { bar.style.visibility = "hidden"; }\r\n      else { delay.set(1000, maybeDisable); }\r\n    }\r\n    delay.set(1000, maybeDisable);\r\n  };\r\n\r\n  NativeScrollbars.prototype.clear = function () {\r\n    var parent = this.horiz.parentNode;\r\n    parent.removeChild(this.horiz);\r\n    parent.removeChild(this.vert);\r\n  };\r\n\r\n  var NullScrollbars = function () {};\r\n\r\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\r\n  NullScrollbars.prototype.setScrollLeft = function () {};\r\n  NullScrollbars.prototype.setScrollTop = function () {};\r\n  NullScrollbars.prototype.clear = function () {};\r\n\r\n  function updateScrollbars(cm, measure) {\r\n    if (!measure) { measure = measureForScrollbars(cm); }\r\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\r\n    updateScrollbarsInner(cm, measure);\r\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\r\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\r\n        { updateHeightsInViewport(cm); }\r\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\r\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\r\n    }\r\n  }\r\n\r\n  // Re-synchronize the fake scrollbars with the actual size of the\r\n  // content.\r\n  function updateScrollbarsInner(cm, measure) {\r\n    var d = cm.display;\r\n    var sizes = d.scrollbars.update(measure);\r\n\r\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + "px";\r\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + "px";\r\n    d.heightForcer.style.borderBottom = sizes.bottom + "px solid transparent";\r\n\r\n    if (sizes.right && sizes.bottom) {\r\n      d.scrollbarFiller.style.display = "block";\r\n      d.scrollbarFiller.style.height = sizes.bottom + "px";\r\n      d.scrollbarFiller.style.width = sizes.right + "px";\r\n    } else { d.scrollbarFiller.style.display = ""; }\r\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\r\n      d.gutterFiller.style.display = "block";\r\n      d.gutterFiller.style.height = sizes.bottom + "px";\r\n      d.gutterFiller.style.width = measure.gutterWidth + "px";\r\n    } else { d.gutterFiller.style.display = ""; }\r\n  }\r\n\r\n  var scrollbarModel = {"native": NativeScrollbars, "null": NullScrollbars};\r\n\r\n  function initScrollbars(cm) {\r\n    if (cm.display.scrollbars) {\r\n      cm.display.scrollbars.clear();\r\n      if (cm.display.scrollbars.addClass)\r\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\r\n    }\r\n\r\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\r\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\r\n      // Prevent clicks in the scrollbars from killing focus\r\n      on(node, "mousedown", function () {\r\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\r\n      });\r\n      node.setAttribute("cm-not-content", "true");\r\n    }, function (pos, axis) {\r\n      if (axis == "horizontal") { setScrollLeft(cm, pos); }\r\n      else { updateScrollTop(cm, pos); }\r\n    }, cm);\r\n    if (cm.display.scrollbars.addClass)\r\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\r\n  }\r\n\r\n  // Operations are used to wrap a series of changes to the editor\r\n  // state in such a way that each change won\'t have to update the\r\n  // cursor and display (which would be awkward, slow, and\r\n  // error-prone). Instead, display updates are batched and then all\r\n  // combined and executed at once.\r\n\r\n  var nextOpId = 0;\r\n  // Start a new operation.\r\n  function startOperation(cm) {\r\n    cm.curOp = {\r\n      cm: cm,\r\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\r\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\r\n      forceUpdate: false,      // Used to force a redraw\r\n      updateInput: 0,       // Whether to reset the input textarea\r\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\r\n      changeObjs: null,        // Accumulated changes, for firing change events\r\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\r\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\r\n      selectionChanged: false, // Whether the selection needs to be redrawn\r\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\r\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\r\n      scrollToPos: null,       // Used to scroll to a specific position\r\n      focus: false,\r\n      id: ++nextOpId,          // Unique ID\r\n      markArrays: null         // Used by addMarkedSpan\r\n    };\r\n    pushOperation(cm.curOp);\r\n  }\r\n\r\n  // Finish an operation, updating the display and signalling delayed events\r\n  function endOperation(cm) {\r\n    var op = cm.curOp;\r\n    if (op) { finishOperation(op, function (group) {\r\n      for (var i = 0; i < group.ops.length; i++)\r\n        { group.ops[i].cm.curOp = null; }\r\n      endOperations(group);\r\n    }); }\r\n  }\r\n\r\n  // The DOM updates done when an operation finishes are batched so\r\n  // that the minimum number of relayouts are required.\r\n  function endOperations(group) {\r\n    var ops = group.ops;\r\n    for (var i = 0; i < ops.length; i++) // Read DOM\r\n      { endOperation_R1(ops[i]); }\r\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\r\n      { endOperation_W1(ops[i$1]); }\r\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\r\n      { endOperation_R2(ops[i$2]); }\r\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\r\n      { endOperation_W2(ops[i$3]); }\r\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\r\n      { endOperation_finish(ops[i$4]); }\r\n  }\r\n\r\n  function endOperation_R1(op) {\r\n    var cm = op.cm, display = cm.display;\r\n    maybeClipScrollbars(cm);\r\n    if (op.updateMaxLine) { findMaxLine(cm); }\r\n\r\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\r\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\r\n                         op.scrollToPos.to.line >= display.viewTo) ||\r\n      display.maxLineChanged && cm.options.lineWrapping;\r\n    op.update = op.mustUpdate &&\r\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\r\n  }\r\n\r\n  function endOperation_W1(op) {\r\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\r\n  }\r\n\r\n  function endOperation_R2(op) {\r\n    var cm = op.cm, display = cm.display;\r\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\r\n\r\n    op.barMeasure = measureForScrollbars(cm);\r\n\r\n    // If the max line changed since it was last measured, measure it,\r\n    // and ensure the document\'s width matches it.\r\n    // updateDisplay_W2 will use these properties to do the actual resizing\r\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\r\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\r\n      cm.display.sizerWidth = op.adjustWidthTo;\r\n      op.barMeasure.scrollWidth =\r\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\r\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\r\n    }\r\n\r\n    if (op.updatedDisplay || op.selectionChanged)\r\n      { op.preparedSelection = display.input.prepareSelection(); }\r\n  }\r\n\r\n  function endOperation_W2(op) {\r\n    var cm = op.cm;\r\n\r\n    if (op.adjustWidthTo != null) {\r\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + "px";\r\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\r\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\r\n      cm.display.maxLineChanged = false;\r\n    }\r\n\r\n    var takeFocus = op.focus && op.focus == activeElt(root(cm));\r\n    if (op.preparedSelection)\r\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\r\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\r\n      { updateScrollbars(cm, op.barMeasure); }\r\n    if (op.updatedDisplay)\r\n      { setDocumentHeight(cm, op.barMeasure); }\r\n\r\n    if (op.selectionChanged) { restartBlink(cm); }\r\n\r\n    if (cm.state.focused && op.updateInput)\r\n      { cm.display.input.reset(op.typing); }\r\n    if (takeFocus) { ensureFocus(op.cm); }\r\n  }\r\n\r\n  function endOperation_finish(op) {\r\n    var cm = op.cm, display = cm.display, doc = cm.doc;\r\n\r\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\r\n\r\n    // Abort mouse wheel delta measurement, when scrolling explicitly\r\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\r\n      { display.wheelStartX = display.wheelStartY = null; }\r\n\r\n    // Propagate the scroll position to the actual DOM scroller\r\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\r\n\r\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\r\n    // If we need to scroll a specific position into view, do so.\r\n    if (op.scrollToPos) {\r\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\r\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\r\n      maybeScrollWindow(cm, rect);\r\n    }\r\n\r\n    // Fire events for markers that are hidden/unidden by editing or\r\n    // undoing\r\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\r\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\r\n      { if (!hidden[i].lines.length) { signal(hidden[i], "hide"); } } }\r\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\r\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], "unhide"); } } }\r\n\r\n    if (display.wrapper.offsetHeight)\r\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\r\n\r\n    // Fire change events, and delayed event handlers\r\n    if (op.changeObjs)\r\n      { signal(cm, "changes", cm, op.changeObjs); }\r\n    if (op.update)\r\n      { op.update.finish(); }\r\n  }\r\n\r\n  // Run the given function in an operation\r\n  function runInOp(cm, f) {\r\n    if (cm.curOp) { return f() }\r\n    startOperation(cm);\r\n    try { return f() }\r\n    finally { endOperation(cm); }\r\n  }\r\n  // Wraps a function in an operation. Returns the wrapped function.\r\n  function operation(cm, f) {\r\n    return function() {\r\n      if (cm.curOp) { return f.apply(cm, arguments) }\r\n      startOperation(cm);\r\n      try { return f.apply(cm, arguments) }\r\n      finally { endOperation(cm); }\r\n    }\r\n  }\r\n  // Used to add methods to editor and doc instances, wrapping them in\r\n  // operations.\r\n  function methodOp(f) {\r\n    return function() {\r\n      if (this.curOp) { return f.apply(this, arguments) }\r\n      startOperation(this);\r\n      try { return f.apply(this, arguments) }\r\n      finally { endOperation(this); }\r\n    }\r\n  }\r\n  function docMethodOp(f) {\r\n    return function() {\r\n      var cm = this.cm;\r\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\r\n      startOperation(cm);\r\n      try { return f.apply(this, arguments) }\r\n      finally { endOperation(cm); }\r\n    }\r\n  }\r\n\r\n  // HIGHLIGHT WORKER\r\n\r\n  function startWorker(cm, time) {\r\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\r\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\r\n  }\r\n\r\n  function highlightWorker(cm) {\r\n    var doc = cm.doc;\r\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\r\n    var end = +new Date + cm.options.workTime;\r\n    var context = getContextBefore(cm, doc.highlightFrontier);\r\n    var changedLines = [];\r\n\r\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\r\n      if (context.line >= cm.display.viewFrom) { // Visible\r\n        var oldStyles = line.styles;\r\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\r\n        var highlighted = highlightLine(cm, line, context, true);\r\n        if (resetState) { context.state = resetState; }\r\n        line.styles = highlighted.styles;\r\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\r\n        if (newCls) { line.styleClasses = newCls; }\r\n        else if (oldCls) { line.styleClasses = null; }\r\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\r\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\r\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\r\n        if (ischange) { changedLines.push(context.line); }\r\n        line.stateAfter = context.save();\r\n        context.nextLine();\r\n      } else {\r\n        if (line.text.length <= cm.options.maxHighlightLength)\r\n          { processLine(cm, line.text, context); }\r\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\r\n        context.nextLine();\r\n      }\r\n      if (+new Date > end) {\r\n        startWorker(cm, cm.options.workDelay);\r\n        return true\r\n      }\r\n    });\r\n    doc.highlightFrontier = context.line;\r\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\r\n    if (changedLines.length) { runInOp(cm, function () {\r\n      for (var i = 0; i < changedLines.length; i++)\r\n        { regLineChange(cm, changedLines[i], "text"); }\r\n    }); }\r\n  }\r\n\r\n  // DISPLAY DRAWING\r\n\r\n  var DisplayUpdate = function(cm, viewport, force) {\r\n    var display = cm.display;\r\n\r\n    this.viewport = viewport;\r\n    // Store some values that we\'ll need later (but don\'t want to force a relayout for)\r\n    this.visible = visibleLines(display, cm.doc, viewport);\r\n    this.editorIsHidden = !display.wrapper.offsetWidth;\r\n    this.wrapperHeight = display.wrapper.clientHeight;\r\n    this.wrapperWidth = display.wrapper.clientWidth;\r\n    this.oldDisplayWidth = displayWidth(cm);\r\n    this.force = force;\r\n    this.dims = getDimensions(cm);\r\n    this.events = [];\r\n  };\r\n\r\n  DisplayUpdate.prototype.signal = function (emitter, type) {\r\n    if (hasHandler(emitter, type))\r\n      { this.events.push(arguments); }\r\n  };\r\n  DisplayUpdate.prototype.finish = function () {\r\n    for (var i = 0; i < this.events.length; i++)\r\n      { signal.apply(null, this.events[i]); }\r\n  };\r\n\r\n  function maybeClipScrollbars(cm) {\r\n    var display = cm.display;\r\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\r\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\r\n      display.heightForcer.style.height = scrollGap(cm) + "px";\r\n      display.sizer.style.marginBottom = -display.nativeBarWidth + "px";\r\n      display.sizer.style.borderRightWidth = scrollGap(cm) + "px";\r\n      display.scrollbarsClipped = true;\r\n    }\r\n  }\r\n\r\n  function selectionSnapshot(cm) {\r\n    if (cm.hasFocus()) { return null }\r\n    var active = activeElt(root(cm));\r\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\r\n    var result = {activeElt: active};\r\n    if (window.getSelection) {\r\n      var sel = win(cm).getSelection();\r\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\r\n        result.anchorNode = sel.anchorNode;\r\n        result.anchorOffset = sel.anchorOffset;\r\n        result.focusNode = sel.focusNode;\r\n        result.focusOffset = sel.focusOffset;\r\n      }\r\n    }\r\n    return result\r\n  }\r\n\r\n  function restoreSelection(snapshot) {\r\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt(rootNode(snapshot.activeElt))) { return }\r\n    snapshot.activeElt.focus();\r\n    if (!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName) &&\r\n        snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\r\n      var doc = snapshot.activeElt.ownerDocument;\r\n      var sel = doc.defaultView.getSelection(), range = doc.createRange();\r\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\r\n      range.collapse(false);\r\n      sel.removeAllRanges();\r\n      sel.addRange(range);\r\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\r\n    }\r\n  }\r\n\r\n  // Does the actual updating of the line display. Bails out\r\n  // (returning false) when there is nothing to be done and forced is\r\n  // false.\r\n  function updateDisplayIfNeeded(cm, update) {\r\n    var display = cm.display, doc = cm.doc;\r\n\r\n    if (update.editorIsHidden) {\r\n      resetView(cm);\r\n      return false\r\n    }\r\n\r\n    // Bail out if the visible area is already rendered and nothing changed.\r\n    if (!update.force &&\r\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\r\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\r\n        display.renderedView == display.view && countDirtyView(cm) == 0)\r\n      { return false }\r\n\r\n    if (maybeUpdateLineNumberWidth(cm)) {\r\n      resetView(cm);\r\n      update.dims = getDimensions(cm);\r\n    }\r\n\r\n    // Compute a suitable new viewport (from & to)\r\n    var end = doc.first + doc.size;\r\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\r\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\r\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\r\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\r\n    if (sawCollapsedSpans) {\r\n      from = visualLineNo(cm.doc, from);\r\n      to = visualLineEndNo(cm.doc, to);\r\n    }\r\n\r\n    var different = from != display.viewFrom || to != display.viewTo ||\r\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\r\n    adjustView(cm, from, to);\r\n\r\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\r\n    // Position the mover div to align with the current scroll position\r\n    cm.display.mover.style.top = display.viewOffset + "px";\r\n\r\n    var toUpdate = countDirtyView(cm);\r\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\r\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\r\n      { return false }\r\n\r\n    // For big changes, we hide the enclosing element during the\r\n    // update, since that speeds up the operations on most browsers.\r\n    var selSnapshot = selectionSnapshot(cm);\r\n    if (toUpdate > 4) { display.lineDiv.style.display = "none"; }\r\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\r\n    if (toUpdate > 4) { display.lineDiv.style.display = ""; }\r\n    display.renderedView = display.view;\r\n    // There might have been a widget with a focused element that got\r\n    // hidden or updated, if so re-focus it.\r\n    restoreSelection(selSnapshot);\r\n\r\n    // Prevent selection and cursors from interfering with the scroll\r\n    // width and height.\r\n    removeChildren(display.cursorDiv);\r\n    removeChildren(display.selectionDiv);\r\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\r\n\r\n    if (different) {\r\n      display.lastWrapHeight = update.wrapperHeight;\r\n      display.lastWrapWidth = update.wrapperWidth;\r\n      startWorker(cm, 400);\r\n    }\r\n\r\n    display.updateLineNumbers = null;\r\n\r\n    return true\r\n  }\r\n\r\n  function postUpdateDisplay(cm, update) {\r\n    var viewport = update.viewport;\r\n\r\n    for (var first = true;; first = false) {\r\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\r\n        // Clip forced viewport to actual scrollable area.\r\n        if (viewport && viewport.top != null)\r\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\r\n        // Updated line heights might result in the drawn area not\r\n        // actually covering the viewport. Keep looping until it does.\r\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\r\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\r\n          { break }\r\n      } else if (first) {\r\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\r\n      }\r\n      if (!updateDisplayIfNeeded(cm, update)) { break }\r\n      updateHeightsInViewport(cm);\r\n      var barMeasure = measureForScrollbars(cm);\r\n      updateSelection(cm);\r\n      updateScrollbars(cm, barMeasure);\r\n      setDocumentHeight(cm, barMeasure);\r\n      update.force = false;\r\n    }\r\n\r\n    update.signal(cm, "update", cm);\r\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\r\n      update.signal(cm, "viewportChange", cm, cm.display.viewFrom, cm.display.viewTo);\r\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\r\n    }\r\n  }\r\n\r\n  function updateDisplaySimple(cm, viewport) {\r\n    var update = new DisplayUpdate(cm, viewport);\r\n    if (updateDisplayIfNeeded(cm, update)) {\r\n      updateHeightsInViewport(cm);\r\n      postUpdateDisplay(cm, update);\r\n      var barMeasure = measureForScrollbars(cm);\r\n      updateSelection(cm);\r\n      updateScrollbars(cm, barMeasure);\r\n      setDocumentHeight(cm, barMeasure);\r\n      update.finish();\r\n    }\r\n  }\r\n\r\n  // Sync the actual display DOM structure with display.view, removing\r\n  // nodes for lines that are no longer in view, and creating the ones\r\n  // that are not there yet, and updating the ones that are out of\r\n  // date.\r\n  function patchDisplay(cm, updateNumbersFrom, dims) {\r\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\r\n    var container = display.lineDiv, cur = container.firstChild;\r\n\r\n    function rm(node) {\r\n      var next = node.nextSibling;\r\n      // Works around a throw-scroll bug in OS X Webkit\r\n      if (webkit && mac && cm.display.currentWheelTarget == node)\r\n        { node.style.display = "none"; }\r\n      else\r\n        { node.parentNode.removeChild(node); }\r\n      return next\r\n    }\r\n\r\n    var view = display.view, lineN = display.viewFrom;\r\n    // Loop over the elements in the view, syncing cur (the DOM nodes\r\n    // in display.lineDiv) with the view as we go.\r\n    for (var i = 0; i < view.length; i++) {\r\n      var lineView = view[i];\r\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\r\n        var node = buildLineElement(cm, lineView, lineN, dims);\r\n        container.insertBefore(node, cur);\r\n      } else { // Already drawn\r\n        while (cur != lineView.node) { cur = rm(cur); }\r\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\r\n          updateNumbersFrom <= lineN && lineView.lineNumber;\r\n        if (lineView.changes) {\r\n          if (indexOf(lineView.changes, "gutter") > -1) { updateNumber = false; }\r\n          updateLineForChanges(cm, lineView, lineN, dims);\r\n        }\r\n        if (updateNumber) {\r\n          removeChildren(lineView.lineNumber);\r\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\r\n        }\r\n        cur = lineView.node.nextSibling;\r\n      }\r\n      lineN += lineView.size;\r\n    }\r\n    while (cur) { cur = rm(cur); }\r\n  }\r\n\r\n  function updateGutterSpace(display) {\r\n    var width = display.gutters.offsetWidth;\r\n    display.sizer.style.marginLeft = width + "px";\r\n    // Send an event to consumers responding to changes in gutter width.\r\n    signalLater(display, "gutterChanged", display);\r\n  }\r\n\r\n  function setDocumentHeight(cm, measure) {\r\n    cm.display.sizer.style.minHeight = measure.docHeight + "px";\r\n    cm.display.heightForcer.style.top = measure.docHeight + "px";\r\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + "px";\r\n  }\r\n\r\n  // Re-align line numbers and gutter marks to compensate for\r\n  // horizontal scrolling.\r\n  function alignHorizontally(cm) {\r\n    var display = cm.display, view = display.view;\r\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\r\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\r\n    var gutterW = display.gutters.offsetWidth, left = comp + "px";\r\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\r\n      if (cm.options.fixedGutter) {\r\n        if (view[i].gutter)\r\n          { view[i].gutter.style.left = left; }\r\n        if (view[i].gutterBackground)\r\n          { view[i].gutterBackground.style.left = left; }\r\n      }\r\n      var align = view[i].alignable;\r\n      if (align) { for (var j = 0; j < align.length; j++)\r\n        { align[j].style.left = left; } }\r\n    } }\r\n    if (cm.options.fixedGutter)\r\n      { display.gutters.style.left = (comp + gutterW) + "px"; }\r\n  }\r\n\r\n  // Used to ensure that the line number gutter is still the right\r\n  // size for the current document size. Returns true when an update\r\n  // is needed.\r\n  function maybeUpdateLineNumberWidth(cm) {\r\n    if (!cm.options.lineNumbers) { return false }\r\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\r\n    if (last.length != display.lineNumChars) {\r\n      var test = display.measure.appendChild(elt("div", [elt("div", last)],\r\n                                                 "CodeMirror-linenumber CodeMirror-gutter-elt"));\r\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\r\n      display.lineGutter.style.width = "";\r\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\r\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\r\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\r\n      display.lineGutter.style.width = display.lineNumWidth + "px";\r\n      updateGutterSpace(cm.display);\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  function getGutters(gutters, lineNumbers) {\r\n    var result = [], sawLineNumbers = false;\r\n    for (var i = 0; i < gutters.length; i++) {\r\n      var name = gutters[i], style = null;\r\n      if (typeof name != "string") { style = name.style; name = name.className; }\r\n      if (name == "CodeMirror-linenumbers") {\r\n        if (!lineNumbers) { continue }\r\n        else { sawLineNumbers = true; }\r\n      }\r\n      result.push({className: name, style: style});\r\n    }\r\n    if (lineNumbers && !sawLineNumbers) { result.push({className: "CodeMirror-linenumbers", style: null}); }\r\n    return result\r\n  }\r\n\r\n  // Rebuild the gutter elements, ensure the margin to the left of the\r\n  // code matches their width.\r\n  function renderGutters(display) {\r\n    var gutters = display.gutters, specs = display.gutterSpecs;\r\n    removeChildren(gutters);\r\n    display.lineGutter = null;\r\n    for (var i = 0; i < specs.length; ++i) {\r\n      var ref = specs[i];\r\n      var className = ref.className;\r\n      var style = ref.style;\r\n      var gElt = gutters.appendChild(elt("div", null, "CodeMirror-gutter " + className));\r\n      if (style) { gElt.style.cssText = style; }\r\n      if (className == "CodeMirror-linenumbers") {\r\n        display.lineGutter = gElt;\r\n        gElt.style.width = (display.lineNumWidth || 1) + "px";\r\n      }\r\n    }\r\n    gutters.style.display = specs.length ? "" : "none";\r\n    updateGutterSpace(display);\r\n  }\r\n\r\n  function updateGutters(cm) {\r\n    renderGutters(cm.display);\r\n    regChange(cm);\r\n    alignHorizontally(cm);\r\n  }\r\n\r\n  // The display handles the DOM integration, both for input reading\r\n  // and content drawing. It holds references to DOM nodes and\r\n  // display-related state.\r\n\r\n  function Display(place, doc, input, options) {\r\n    var d = this;\r\n    this.input = input;\r\n\r\n    // Covers bottom-right square when both scrollbars are present.\r\n    d.scrollbarFiller = elt("div", null, "CodeMirror-scrollbar-filler");\r\n    d.scrollbarFiller.setAttribute("cm-not-content", "true");\r\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\r\n    // and h scrollbar is present.\r\n    d.gutterFiller = elt("div", null, "CodeMirror-gutter-filler");\r\n    d.gutterFiller.setAttribute("cm-not-content", "true");\r\n    // Will contain the actual code, positioned to cover the viewport.\r\n    d.lineDiv = eltP("div", null, "CodeMirror-code");\r\n    // Elements are added to these to represent selection and cursors.\r\n    d.selectionDiv = elt("div", null, null, "position: relative; z-index: 1");\r\n    d.cursorDiv = elt("div", null, "CodeMirror-cursors");\r\n    // A visibility: hidden element used to find the size of things.\r\n    d.measure = elt("div", null, "CodeMirror-measure");\r\n    // When lines outside of the viewport are measured, they are drawn in this.\r\n    d.lineMeasure = elt("div", null, "CodeMirror-measure");\r\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\r\n    d.lineSpace = eltP("div", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\r\n                      null, "position: relative; outline: none");\r\n    var lines = eltP("div", [d.lineSpace], "CodeMirror-lines");\r\n    // Moved around its parent to cover visible view.\r\n    d.mover = elt("div", [lines], null, "position: relative");\r\n    // Set to the height of the document, allowing scrolling.\r\n    d.sizer = elt("div", [d.mover], "CodeMirror-sizer");\r\n    d.sizerWidth = null;\r\n    // Behavior of elts with overflow: auto and padding is\r\n    // inconsistent across browsers. This is used to ensure the\r\n    // scrollable area is big enough.\r\n    d.heightForcer = elt("div", null, null, "position: absolute; height: " + scrollerGap + "px; width: 1px;");\r\n    // Will contain the gutters, if any.\r\n    d.gutters = elt("div", null, "CodeMirror-gutters");\r\n    d.lineGutter = null;\r\n    // Actual scrollable element.\r\n    d.scroller = elt("div", [d.sizer, d.heightForcer, d.gutters], "CodeMirror-scroll");\r\n    d.scroller.setAttribute("tabIndex", "-1");\r\n    // The element in which the editor lives.\r\n    d.wrapper = elt("div", [d.scrollbarFiller, d.gutterFiller, d.scroller], "CodeMirror");\r\n    // See #6982. FIXME remove when this has been fixed for a while in Chrome\r\n    if (chrome && chrome_version >= 105) { d.wrapper.style.clipPath = "inset(0px)"; }\r\n\r\n    // This attribute is respected by automatic translation systems such as Google Translate,\r\n    // and may also be respected by tools used by human translators.\r\n    d.wrapper.setAttribute(\'translate\', \'no\');\r\n\r\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\r\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\r\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\r\n\r\n    if (place) {\r\n      if (place.appendChild) { place.appendChild(d.wrapper); }\r\n      else { place(d.wrapper); }\r\n    }\r\n\r\n    // Current rendered range (may be bigger than the view window).\r\n    d.viewFrom = d.viewTo = doc.first;\r\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\r\n    // Information about the rendered lines.\r\n    d.view = [];\r\n    d.renderedView = null;\r\n    // Holds info about a single rendered line when it was rendered\r\n    // for measurement, while not in view.\r\n    d.externalMeasured = null;\r\n    // Empty space (in pixels) above the view\r\n    d.viewOffset = 0;\r\n    d.lastWrapHeight = d.lastWrapWidth = 0;\r\n    d.updateLineNumbers = null;\r\n\r\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\r\n    d.scrollbarsClipped = false;\r\n\r\n    // Used to only resize the line number gutter when necessary (when\r\n    // the amount of lines crosses a boundary that makes its width change)\r\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\r\n    // Set to true when a non-horizontal-scrolling line widget is\r\n    // added. As an optimization, line widget aligning is skipped when\r\n    // this is false.\r\n    d.alignWidgets = false;\r\n\r\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\r\n\r\n    // Tracks the maximum line length so that the horizontal scrollbar\r\n    // can be kept static when scrolling.\r\n    d.maxLine = null;\r\n    d.maxLineLength = 0;\r\n    d.maxLineChanged = false;\r\n\r\n    // Used for measuring wheel scrolling granularity\r\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\r\n\r\n    // True when shift is held down.\r\n    d.shift = false;\r\n\r\n    // Used to track whether anything happened since the context menu\r\n    // was opened.\r\n    d.selForContextMenu = null;\r\n\r\n    d.activeTouch = null;\r\n\r\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\r\n    renderGutters(d);\r\n\r\n    input.init(d);\r\n  }\r\n\r\n  // Since the delta values reported on mouse wheel events are\r\n  // unstandardized between browsers and even browser versions, and\r\n  // generally horribly unpredictable, this code starts by measuring\r\n  // the scroll effect that the first few mouse wheel events have,\r\n  // and, from that, detects the way it can convert deltas to pixel\r\n  // offsets afterwards.\r\n  //\r\n  // The reason we want to know the amount a wheel event will scroll\r\n  // is that it gives us a chance to update the display before the\r\n  // actual scrolling happens, reducing flickering.\r\n\r\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\r\n  // Fill in a browser-detected starting value on browsers where we\r\n  // know one. These don\'t have to be accurate -- the result of them\r\n  // being wrong would just be a slight flicker on the first wheel\r\n  // scroll (if it is large enough).\r\n  if (ie) { wheelPixelsPerUnit = -.53; }\r\n  else if (gecko) { wheelPixelsPerUnit = 15; }\r\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\r\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\r\n\r\n  function wheelEventDelta(e) {\r\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\r\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\r\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\r\n    else if (dy == null) { dy = e.wheelDelta; }\r\n    return {x: dx, y: dy}\r\n  }\r\n  function wheelEventPixels(e) {\r\n    var delta = wheelEventDelta(e);\r\n    delta.x *= wheelPixelsPerUnit;\r\n    delta.y *= wheelPixelsPerUnit;\r\n    return delta\r\n  }\r\n\r\n  function onScrollWheel(cm, e) {\r\n    // On Chrome 102, viewport updates somehow stop wheel-based\r\n    // scrolling. Turning off pointer events during the scroll seems\r\n    // to avoid the issue.\r\n    if (chrome && chrome_version == 102) {\r\n      if (cm.display.chromeScrollHack == null) { cm.display.sizer.style.pointerEvents = "none"; }\r\n      else { clearTimeout(cm.display.chromeScrollHack); }\r\n      cm.display.chromeScrollHack = setTimeout(function () {\r\n        cm.display.chromeScrollHack = null;\r\n        cm.display.sizer.style.pointerEvents = "";\r\n      }, 100);\r\n    }\r\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\r\n    var pixelsPerUnit = wheelPixelsPerUnit;\r\n    if (e.deltaMode === 0) {\r\n      dx = e.deltaX;\r\n      dy = e.deltaY;\r\n      pixelsPerUnit = 1;\r\n    }\r\n\r\n    var display = cm.display, scroll = display.scroller;\r\n    // Quit if there\'s nothing to scroll here\r\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\r\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\r\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\r\n\r\n    // Webkit browsers on OS X abort momentum scrolls when the target\r\n    // of the scroll event is removed from the scrollable element.\r\n    // This hack (see related code in patchDisplay) makes sure the\r\n    // element is kept around.\r\n    if (dy && mac && webkit) {\r\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\r\n        for (var i = 0; i < view.length; i++) {\r\n          if (view[i].node == cur) {\r\n            cm.display.currentWheelTarget = cur;\r\n            break outer\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // On some browsers, horizontal scrolling will cause redraws to\r\n    // happen before the gutter has been realigned, causing it to\r\n    // wriggle around in a most unseemly way. When we have an\r\n    // estimated pixels/delta value, we just handle horizontal\r\n    // scrolling entirely here. It\'ll be slightly off from native, but\r\n    // better than glitching out.\r\n    if (dx && !gecko && !presto && pixelsPerUnit != null) {\r\n      if (dy && canScrollY)\r\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * pixelsPerUnit)); }\r\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * pixelsPerUnit));\r\n      // Only prevent default scrolling if vertical scrolling is\r\n      // actually possible. Otherwise, it causes vertical scroll\r\n      // jitter on OSX trackpads when deltaX is small and deltaY\r\n      // is large (issue #3579)\r\n      if (!dy || (dy && canScrollY))\r\n        { e_preventDefault(e); }\r\n      display.wheelStartX = null; // Abort measurement, if in progress\r\n      return\r\n    }\r\n\r\n    // \'Project\' the visible viewport to cover the area that is being\r\n    // scrolled into view (if we know enough to estimate it).\r\n    if (dy && pixelsPerUnit != null) {\r\n      var pixels = dy * pixelsPerUnit;\r\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\r\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\r\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\r\n      updateDisplaySimple(cm, {top: top, bottom: bot});\r\n    }\r\n\r\n    if (wheelSamples < 20 && e.deltaMode !== 0) {\r\n      if (display.wheelStartX == null) {\r\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\r\n        display.wheelDX = dx; display.wheelDY = dy;\r\n        setTimeout(function () {\r\n          if (display.wheelStartX == null) { return }\r\n          var movedX = scroll.scrollLeft - display.wheelStartX;\r\n          var movedY = scroll.scrollTop - display.wheelStartY;\r\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\r\n            (movedX && display.wheelDX && movedX / display.wheelDX);\r\n          display.wheelStartX = display.wheelStartY = null;\r\n          if (!sample) { return }\r\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\r\n          ++wheelSamples;\r\n        }, 200);\r\n      } else {\r\n        display.wheelDX += dx; display.wheelDY += dy;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Selection objects are immutable. A new one is created every time\r\n  // the selection changes. A selection is one or more non-overlapping\r\n  // (and non-touching) ranges, sorted, and an integer that indicates\r\n  // which one is the primary selection (the one that\'s scrolled into\r\n  // view, that getCursor returns, etc).\r\n  var Selection = function(ranges, primIndex) {\r\n    this.ranges = ranges;\r\n    this.primIndex = primIndex;\r\n  };\r\n\r\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\r\n\r\n  Selection.prototype.equals = function (other) {\r\n    if (other == this) { return true }\r\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\r\n    for (var i = 0; i < this.ranges.length; i++) {\r\n      var here = this.ranges[i], there = other.ranges[i];\r\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\r\n    }\r\n    return true\r\n  };\r\n\r\n  Selection.prototype.deepCopy = function () {\r\n    var out = [];\r\n    for (var i = 0; i < this.ranges.length; i++)\r\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\r\n    return new Selection(out, this.primIndex)\r\n  };\r\n\r\n  Selection.prototype.somethingSelected = function () {\r\n    for (var i = 0; i < this.ranges.length; i++)\r\n      { if (!this.ranges[i].empty()) { return true } }\r\n    return false\r\n  };\r\n\r\n  Selection.prototype.contains = function (pos, end) {\r\n    if (!end) { end = pos; }\r\n    for (var i = 0; i < this.ranges.length; i++) {\r\n      var range = this.ranges[i];\r\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\r\n        { return i }\r\n    }\r\n    return -1\r\n  };\r\n\r\n  var Range = function(anchor, head) {\r\n    this.anchor = anchor; this.head = head;\r\n  };\r\n\r\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\r\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\r\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\r\n\r\n  // Take an unsorted, potentially overlapping set of ranges, and\r\n  // build a selection out of it. \'Consumes\' ranges array (modifying\r\n  // it).\r\n  function normalizeSelection(cm, ranges, primIndex) {\r\n    var mayTouch = cm && cm.options.selectionsMayTouch;\r\n    var prim = ranges[primIndex];\r\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\r\n    primIndex = indexOf(ranges, prim);\r\n    for (var i = 1; i < ranges.length; i++) {\r\n      var cur = ranges[i], prev = ranges[i - 1];\r\n      var diff = cmp(prev.to(), cur.from());\r\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\r\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\r\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\r\n        if (i <= primIndex) { --primIndex; }\r\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\r\n      }\r\n    }\r\n    return new Selection(ranges, primIndex)\r\n  }\r\n\r\n  function simpleSelection(anchor, head) {\r\n    return new Selection([new Range(anchor, head || anchor)], 0)\r\n  }\r\n\r\n  // Compute the position of the end of a change (its \'to\' property\r\n  // refers to the pre-change end).\r\n  function changeEnd(change) {\r\n    if (!change.text) { return change.to }\r\n    return Pos(change.from.line + change.text.length - 1,\r\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\r\n  }\r\n\r\n  // Adjust a position to refer to the post-change position of the\r\n  // same text, or the end of the change if the change covers it.\r\n  function adjustForChange(pos, change) {\r\n    if (cmp(pos, change.from) < 0) { return pos }\r\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\r\n\r\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\r\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\r\n    return Pos(line, ch)\r\n  }\r\n\r\n  function computeSelAfterChange(doc, change) {\r\n    var out = [];\r\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\r\n      var range = doc.sel.ranges[i];\r\n      out.push(new Range(adjustForChange(range.anchor, change),\r\n                         adjustForChange(range.head, change)));\r\n    }\r\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\r\n  }\r\n\r\n  function offsetPos(pos, old, nw) {\r\n    if (pos.line == old.line)\r\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\r\n    else\r\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\r\n  }\r\n\r\n  // Used by replaceSelections to allow moving the selection to the\r\n  // start or around the replaced test. Hint may be "start" or "around".\r\n  function computeReplacedSel(doc, changes, hint) {\r\n    var out = [];\r\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\r\n    for (var i = 0; i < changes.length; i++) {\r\n      var change = changes[i];\r\n      var from = offsetPos(change.from, oldPrev, newPrev);\r\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\r\n      oldPrev = change.to;\r\n      newPrev = to;\r\n      if (hint == "around") {\r\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\r\n        out[i] = new Range(inv ? to : from, inv ? from : to);\r\n      } else {\r\n        out[i] = new Range(from, from);\r\n      }\r\n    }\r\n    return new Selection(out, doc.sel.primIndex)\r\n  }\r\n\r\n  // Used to get the editor into a consistent state again when options change.\r\n\r\n  function loadMode(cm) {\r\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\r\n    resetModeState(cm);\r\n  }\r\n\r\n  function resetModeState(cm) {\r\n    cm.doc.iter(function (line) {\r\n      if (line.stateAfter) { line.stateAfter = null; }\r\n      if (line.styles) { line.styles = null; }\r\n    });\r\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\r\n    startWorker(cm, 100);\r\n    cm.state.modeGen++;\r\n    if (cm.curOp) { regChange(cm); }\r\n  }\r\n\r\n  // DOCUMENT DATA STRUCTURE\r\n\r\n  // By default, updates that start and end at the beginning of a line\r\n  // are treated specially, in order to make the association of line\r\n  // widgets and marker elements with the text behave more intuitive.\r\n  function isWholeLineUpdate(doc, change) {\r\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == "" &&\r\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\r\n  }\r\n\r\n  // Perform a change on the document data structure.\r\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\r\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\r\n    function update(line, text, spans) {\r\n      updateLine(line, text, spans, estimateHeight);\r\n      signalLater(line, "change", line, change);\r\n    }\r\n    function linesFor(start, end) {\r\n      var result = [];\r\n      for (var i = start; i < end; ++i)\r\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\r\n      return result\r\n    }\r\n\r\n    var from = change.from, to = change.to, text = change.text;\r\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\r\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\r\n\r\n    // Adjust the line structure\r\n    if (change.full) {\r\n      doc.insert(0, linesFor(0, text.length));\r\n      doc.remove(text.length, doc.size - text.length);\r\n    } else if (isWholeLineUpdate(doc, change)) {\r\n      // This is a whole-line replace. Treated specially to make\r\n      // sure line objects move the way they are supposed to.\r\n      var added = linesFor(0, text.length - 1);\r\n      update(lastLine, lastLine.text, lastSpans);\r\n      if (nlines) { doc.remove(from.line, nlines); }\r\n      if (added.length) { doc.insert(from.line, added); }\r\n    } else if (firstLine == lastLine) {\r\n      if (text.length == 1) {\r\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\r\n      } else {\r\n        var added$1 = linesFor(1, text.length - 1);\r\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\r\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\r\n        doc.insert(from.line + 1, added$1);\r\n      }\r\n    } else if (text.length == 1) {\r\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\r\n      doc.remove(from.line + 1, nlines);\r\n    } else {\r\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\r\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\r\n      var added$2 = linesFor(1, text.length - 1);\r\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\r\n      doc.insert(from.line + 1, added$2);\r\n    }\r\n\r\n    signalLater(doc, "change", doc, change);\r\n  }\r\n\r\n  // Call f for all linked documents.\r\n  function linkedDocs(doc, f, sharedHistOnly) {\r\n    function propagate(doc, skip, sharedHist) {\r\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\r\n        var rel = doc.linked[i];\r\n        if (rel.doc == skip) { continue }\r\n        var shared = sharedHist && rel.sharedHist;\r\n        if (sharedHistOnly && !shared) { continue }\r\n        f(rel.doc, shared);\r\n        propagate(rel.doc, doc, shared);\r\n      } }\r\n    }\r\n    propagate(doc, null, true);\r\n  }\r\n\r\n  // Attach a document to an editor.\r\n  function attachDoc(cm, doc) {\r\n    if (doc.cm) { throw new Error("This document is already in use.") }\r\n    cm.doc = doc;\r\n    doc.cm = cm;\r\n    estimateLineHeights(cm);\r\n    loadMode(cm);\r\n    setDirectionClass(cm);\r\n    cm.options.direction = doc.direction;\r\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\r\n    cm.options.mode = doc.modeOption;\r\n    regChange(cm);\r\n  }\r\n\r\n  function setDirectionClass(cm) {\r\n  (cm.doc.direction == "rtl" ? addClass : rmClass)(cm.display.lineDiv, "CodeMirror-rtl");\r\n  }\r\n\r\n  function directionChanged(cm) {\r\n    runInOp(cm, function () {\r\n      setDirectionClass(cm);\r\n      regChange(cm);\r\n    });\r\n  }\r\n\r\n  function History(prev) {\r\n    // Arrays of change events and selections. Doing something adds an\r\n    // event to done and clears undo. Undoing moves events from done\r\n    // to undone, redoing moves them in the other direction.\r\n    this.done = []; this.undone = [];\r\n    this.undoDepth = prev ? prev.undoDepth : Infinity;\r\n    // Used to track when changes can be merged into a single undo\r\n    // event\r\n    this.lastModTime = this.lastSelTime = 0;\r\n    this.lastOp = this.lastSelOp = null;\r\n    this.lastOrigin = this.lastSelOrigin = null;\r\n    // Used by the isClean() method\r\n    this.generation = this.maxGeneration = prev ? prev.maxGeneration : 1;\r\n  }\r\n\r\n  // Create a history change event from an updateDoc-style change\r\n  // object.\r\n  function historyChangeFromChange(doc, change) {\r\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\r\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\r\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\r\n    return histChange\r\n  }\r\n\r\n  // Pop all selection events off the end of a history array. Stop at\r\n  // a change event.\r\n  function clearSelectionEvents(array) {\r\n    while (array.length) {\r\n      var last = lst(array);\r\n      if (last.ranges) { array.pop(); }\r\n      else { break }\r\n    }\r\n  }\r\n\r\n  // Find the top change event in the history. Pop off selection\r\n  // events that are in the way.\r\n  function lastChangeEvent(hist, force) {\r\n    if (force) {\r\n      clearSelectionEvents(hist.done);\r\n      return lst(hist.done)\r\n    } else if (hist.done.length && !lst(hist.done).ranges) {\r\n      return lst(hist.done)\r\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\r\n      hist.done.pop();\r\n      return lst(hist.done)\r\n    }\r\n  }\r\n\r\n  // Register a change in the history. Merges changes that are within\r\n  // a single operation, or are close together with an origin that\r\n  // allows merging (starting with "+") into a single event.\r\n  function addChangeToHistory(doc, change, selAfter, opId) {\r\n    var hist = doc.history;\r\n    hist.undone.length = 0;\r\n    var time = +new Date, cur;\r\n    var last;\r\n\r\n    if ((hist.lastOp == opId ||\r\n         hist.lastOrigin == change.origin && change.origin &&\r\n         ((change.origin.charAt(0) == "+" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\r\n          change.origin.charAt(0) == "*")) &&\r\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\r\n      // Merge this change into the last event\r\n      last = lst(cur.changes);\r\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\r\n        // Optimized case for simple insertion -- don\'t want to add\r\n        // new changesets for every character typed\r\n        last.to = changeEnd(change);\r\n      } else {\r\n        // Add new sub-event\r\n        cur.changes.push(historyChangeFromChange(doc, change));\r\n      }\r\n    } else {\r\n      // Can not be merged, start a new event.\r\n      var before = lst(hist.done);\r\n      if (!before || !before.ranges)\r\n        { pushSelectionToHistory(doc.sel, hist.done); }\r\n      cur = {changes: [historyChangeFromChange(doc, change)],\r\n             generation: hist.generation};\r\n      hist.done.push(cur);\r\n      while (hist.done.length > hist.undoDepth) {\r\n        hist.done.shift();\r\n        if (!hist.done[0].ranges) { hist.done.shift(); }\r\n      }\r\n    }\r\n    hist.done.push(selAfter);\r\n    hist.generation = ++hist.maxGeneration;\r\n    hist.lastModTime = hist.lastSelTime = time;\r\n    hist.lastOp = hist.lastSelOp = opId;\r\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\r\n\r\n    if (!last) { signal(doc, "historyAdded"); }\r\n  }\r\n\r\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\r\n    var ch = origin.charAt(0);\r\n    return ch == "*" ||\r\n      ch == "+" &&\r\n      prev.ranges.length == sel.ranges.length &&\r\n      prev.somethingSelected() == sel.somethingSelected() &&\r\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\r\n  }\r\n\r\n  // Called whenever the selection changes, sets the new selection as\r\n  // the pending selection in the history, and pushes the old pending\r\n  // selection into the \'done\' array when it was significantly\r\n  // different (in number of selected ranges, emptiness, or time).\r\n  function addSelectionToHistory(doc, sel, opId, options) {\r\n    var hist = doc.history, origin = options && options.origin;\r\n\r\n    // A new event is started when the previous origin does not match\r\n    // the current, or the origins don\'t allow matching. Origins\r\n    // starting with * are always merged, those starting with + are\r\n    // merged when similar and close together in time.\r\n    if (opId == hist.lastSelOp ||\r\n        (origin && hist.lastSelOrigin == origin &&\r\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\r\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\r\n      { hist.done[hist.done.length - 1] = sel; }\r\n    else\r\n      { pushSelectionToHistory(sel, hist.done); }\r\n\r\n    hist.lastSelTime = +new Date;\r\n    hist.lastSelOrigin = origin;\r\n    hist.lastSelOp = opId;\r\n    if (options && options.clearRedo !== false)\r\n      { clearSelectionEvents(hist.undone); }\r\n  }\r\n\r\n  function pushSelectionToHistory(sel, dest) {\r\n    var top = lst(dest);\r\n    if (!(top && top.ranges && top.equals(sel)))\r\n      { dest.push(sel); }\r\n  }\r\n\r\n  // Used to store marked span information in the history.\r\n  function attachLocalSpans(doc, change, from, to) {\r\n    var existing = change["spans_" + doc.id], n = 0;\r\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\r\n      if (line.markedSpans)\r\n        { (existing || (existing = change["spans_" + doc.id] = {}))[n] = line.markedSpans; }\r\n      ++n;\r\n    });\r\n  }\r\n\r\n  // When un/re-doing restores text containing marked spans, those\r\n  // that have been explicitly cleared should not be restored.\r\n  function removeClearedSpans(spans) {\r\n    if (!spans) { return null }\r\n    var out;\r\n    for (var i = 0; i < spans.length; ++i) {\r\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\r\n      else if (out) { out.push(spans[i]); }\r\n    }\r\n    return !out ? spans : out.length ? out : null\r\n  }\r\n\r\n  // Retrieve and filter the old marked spans stored in a change event.\r\n  function getOldSpans(doc, change) {\r\n    var found = change["spans_" + doc.id];\r\n    if (!found) { return null }\r\n    var nw = [];\r\n    for (var i = 0; i < change.text.length; ++i)\r\n      { nw.push(removeClearedSpans(found[i])); }\r\n    return nw\r\n  }\r\n\r\n  // Used for un/re-doing changes from the history. Combines the\r\n  // result of computing the existing spans with the set of spans that\r\n  // existed in the history (so that deleting around a span and then\r\n  // undoing brings back the span).\r\n  function mergeOldSpans(doc, change) {\r\n    var old = getOldSpans(doc, change);\r\n    var stretched = stretchSpansOverChange(doc, change);\r\n    if (!old) { return stretched }\r\n    if (!stretched) { return old }\r\n\r\n    for (var i = 0; i < old.length; ++i) {\r\n      var oldCur = old[i], stretchCur = stretched[i];\r\n      if (oldCur && stretchCur) {\r\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\r\n          var span = stretchCur[j];\r\n          for (var k = 0; k < oldCur.length; ++k)\r\n            { if (oldCur[k].marker == span.marker) { continue spans } }\r\n          oldCur.push(span);\r\n        }\r\n      } else if (stretchCur) {\r\n        old[i] = stretchCur;\r\n      }\r\n    }\r\n    return old\r\n  }\r\n\r\n  // Used both to provide a JSON-safe object in .getHistory, and, when\r\n  // detaching a document, to split the history in two\r\n  function copyHistoryArray(events, newGroup, instantiateSel) {\r\n    var copy = [];\r\n    for (var i = 0; i < events.length; ++i) {\r\n      var event = events[i];\r\n      if (event.ranges) {\r\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\r\n        continue\r\n      }\r\n      var changes = event.changes, newChanges = [];\r\n      copy.push({changes: newChanges});\r\n      for (var j = 0; j < changes.length; ++j) {\r\n        var change = changes[j], m = (void 0);\r\n        newChanges.push({from: change.from, to: change.to, text: change.text});\r\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\r\n          if (indexOf(newGroup, Number(m[1])) > -1) {\r\n            lst(newChanges)[prop] = change[prop];\r\n            delete change[prop];\r\n          }\r\n        } } }\r\n      }\r\n    }\r\n    return copy\r\n  }\r\n\r\n  // The \'scroll\' parameter given to many of these indicated whether\r\n  // the new cursor position should be scrolled into view after\r\n  // modifying the selection.\r\n\r\n  // If shift is held or the extend flag is set, extends a range to\r\n  // include a given position (and optionally a second position).\r\n  // Otherwise, simply returns the range between the given positions.\r\n  // Used for cursor motion and such.\r\n  function extendRange(range, head, other, extend) {\r\n    if (extend) {\r\n      var anchor = range.anchor;\r\n      if (other) {\r\n        var posBefore = cmp(head, anchor) < 0;\r\n        if (posBefore != (cmp(other, anchor) < 0)) {\r\n          anchor = head;\r\n          head = other;\r\n        } else if (posBefore != (cmp(head, other) < 0)) {\r\n          head = other;\r\n        }\r\n      }\r\n      return new Range(anchor, head)\r\n    } else {\r\n      return new Range(other || head, head)\r\n    }\r\n  }\r\n\r\n  // Extend the primary selection range, discard the rest.\r\n  function extendSelection(doc, head, other, options, extend) {\r\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\r\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\r\n  }\r\n\r\n  // Extend all selections (pos is an array of selections with length\r\n  // equal the number of selections)\r\n  function extendSelections(doc, heads, options) {\r\n    var out = [];\r\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\r\n    for (var i = 0; i < doc.sel.ranges.length; i++)\r\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\r\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\r\n    setSelection(doc, newSel, options);\r\n  }\r\n\r\n  // Updates a single range in the selection.\r\n  function replaceOneSelection(doc, i, range, options) {\r\n    var ranges = doc.sel.ranges.slice(0);\r\n    ranges[i] = range;\r\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\r\n  }\r\n\r\n  // Reset the selection to a single range.\r\n  function setSimpleSelection(doc, anchor, head, options) {\r\n    setSelection(doc, simpleSelection(anchor, head), options);\r\n  }\r\n\r\n  // Give beforeSelectionChange handlers a change to influence a\r\n  // selection update.\r\n  function filterSelectionChange(doc, sel, options) {\r\n    var obj = {\r\n      ranges: sel.ranges,\r\n      update: function(ranges) {\r\n        this.ranges = [];\r\n        for (var i = 0; i < ranges.length; i++)\r\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\r\n                                     clipPos(doc, ranges[i].head)); }\r\n      },\r\n      origin: options && options.origin\r\n    };\r\n    signal(doc, "beforeSelectionChange", doc, obj);\r\n    if (doc.cm) { signal(doc.cm, "beforeSelectionChange", doc.cm, obj); }\r\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\r\n    else { return sel }\r\n  }\r\n\r\n  function setSelectionReplaceHistory(doc, sel, options) {\r\n    var done = doc.history.done, last = lst(done);\r\n    if (last && last.ranges) {\r\n      done[done.length - 1] = sel;\r\n      setSelectionNoUndo(doc, sel, options);\r\n    } else {\r\n      setSelection(doc, sel, options);\r\n    }\r\n  }\r\n\r\n  // Set a new selection.\r\n  function setSelection(doc, sel, options) {\r\n    setSelectionNoUndo(doc, sel, options);\r\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\r\n  }\r\n\r\n  function setSelectionNoUndo(doc, sel, options) {\r\n    if (hasHandler(doc, "beforeSelectionChange") || doc.cm && hasHandler(doc.cm, "beforeSelectionChange"))\r\n      { sel = filterSelectionChange(doc, sel, options); }\r\n\r\n    var bias = options && options.bias ||\r\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\r\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\r\n\r\n    if (!(options && options.scroll === false) && doc.cm && doc.cm.getOption("readOnly") != "nocursor")\r\n      { ensureCursorVisible(doc.cm); }\r\n  }\r\n\r\n  function setSelectionInner(doc, sel) {\r\n    if (sel.equals(doc.sel)) { return }\r\n\r\n    doc.sel = sel;\r\n\r\n    if (doc.cm) {\r\n      doc.cm.curOp.updateInput = 1;\r\n      doc.cm.curOp.selectionChanged = true;\r\n      signalCursorActivity(doc.cm);\r\n    }\r\n    signalLater(doc, "cursorActivity", doc);\r\n  }\r\n\r\n  // Verify that the selection does not partially select any atomic\r\n  // marked ranges.\r\n  function reCheckSelection(doc) {\r\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\r\n  }\r\n\r\n  // Return a selection that does not partially select any atomic\r\n  // ranges.\r\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\r\n    var out;\r\n    for (var i = 0; i < sel.ranges.length; i++) {\r\n      var range = sel.ranges[i];\r\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\r\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\r\n      var newHead = range.head == range.anchor ? newAnchor : skipAtomic(doc, range.head, old && old.head, bias, mayClear);\r\n      if (out || newAnchor != range.anchor || newHead != range.head) {\r\n        if (!out) { out = sel.ranges.slice(0, i); }\r\n        out[i] = new Range(newAnchor, newHead);\r\n      }\r\n    }\r\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\r\n  }\r\n\r\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\r\n    var line = getLine(doc, pos.line);\r\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\r\n      var sp = line.markedSpans[i], m = sp.marker;\r\n\r\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\r\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\r\n      // is with selectLeft/Right\r\n      var preventCursorLeft = ("selectLeft" in m) ? !m.selectLeft : m.inclusiveLeft;\r\n      var preventCursorRight = ("selectRight" in m) ? !m.selectRight : m.inclusiveRight;\r\n\r\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\r\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\r\n        if (mayClear) {\r\n          signal(m, "beforeCursorEnter");\r\n          if (m.explicitlyCleared) {\r\n            if (!line.markedSpans) { break }\r\n            else {--i; continue}\r\n          }\r\n        }\r\n        if (!m.atomic) { continue }\r\n\r\n        if (oldPos) {\r\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\r\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\r\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\r\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\r\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\r\n        }\r\n\r\n        var far = m.find(dir < 0 ? -1 : 1);\r\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\r\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\r\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\r\n      }\r\n    } }\r\n    return pos\r\n  }\r\n\r\n  // Ensure a given position is not inside an atomic range.\r\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\r\n    var dir = bias || 1;\r\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\r\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\r\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\r\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\r\n    if (!found) {\r\n      doc.cantEdit = true;\r\n      return Pos(doc.first, 0)\r\n    }\r\n    return found\r\n  }\r\n\r\n  function movePos(doc, pos, dir, line) {\r\n    if (dir < 0 && pos.ch == 0) {\r\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\r\n      else { return null }\r\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\r\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\r\n      else { return null }\r\n    } else {\r\n      return new Pos(pos.line, pos.ch + dir)\r\n    }\r\n  }\r\n\r\n  function selectAll(cm) {\r\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\r\n  }\r\n\r\n  // UPDATING\r\n\r\n  // Allow "beforeChange" event handlers to influence a change\r\n  function filterChange(doc, change, update) {\r\n    var obj = {\r\n      canceled: false,\r\n      from: change.from,\r\n      to: change.to,\r\n      text: change.text,\r\n      origin: change.origin,\r\n      cancel: function () { return obj.canceled = true; }\r\n    };\r\n    if (update) { obj.update = function (from, to, text, origin) {\r\n      if (from) { obj.from = clipPos(doc, from); }\r\n      if (to) { obj.to = clipPos(doc, to); }\r\n      if (text) { obj.text = text; }\r\n      if (origin !== undefined) { obj.origin = origin; }\r\n    }; }\r\n    signal(doc, "beforeChange", doc, obj);\r\n    if (doc.cm) { signal(doc.cm, "beforeChange", doc.cm, obj); }\r\n\r\n    if (obj.canceled) {\r\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\r\n      return null\r\n    }\r\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\r\n  }\r\n\r\n  // Apply a change to a document, and add it to the document\'s\r\n  // history, and propagating it to all linked documents.\r\n  function makeChange(doc, change, ignoreReadOnly) {\r\n    if (doc.cm) {\r\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\r\n      if (doc.cm.state.suppressEdits) { return }\r\n    }\r\n\r\n    if (hasHandler(doc, "beforeChange") || doc.cm && hasHandler(doc.cm, "beforeChange")) {\r\n      change = filterChange(doc, change, true);\r\n      if (!change) { return }\r\n    }\r\n\r\n    // Possibly split or suppress the update based on the presence\r\n    // of read-only spans in its range.\r\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\r\n    if (split) {\r\n      for (var i = split.length - 1; i >= 0; --i)\r\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [""] : change.text, origin: change.origin}); }\r\n    } else {\r\n      makeChangeInner(doc, change);\r\n    }\r\n  }\r\n\r\n  function makeChangeInner(doc, change) {\r\n    if (change.text.length == 1 && change.text[0] == "" && cmp(change.from, change.to) == 0) { return }\r\n    var selAfter = computeSelAfterChange(doc, change);\r\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\r\n\r\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\r\n    var rebased = [];\r\n\r\n    linkedDocs(doc, function (doc, sharedHist) {\r\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\r\n        rebaseHist(doc.history, change);\r\n        rebased.push(doc.history);\r\n      }\r\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\r\n    });\r\n  }\r\n\r\n  // Revert a change stored in a document\'s history.\r\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\r\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\r\n    if (suppress && !allowSelectionOnly) { return }\r\n\r\n    var hist = doc.history, event, selAfter = doc.sel;\r\n    var source = type == "undo" ? hist.done : hist.undone, dest = type == "undo" ? hist.undone : hist.done;\r\n\r\n    // Verify that there is a useable event (so that ctrl-z won\'t\r\n    // needlessly clear selection events)\r\n    var i = 0;\r\n    for (; i < source.length; i++) {\r\n      event = source[i];\r\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\r\n        { break }\r\n    }\r\n    if (i == source.length) { return }\r\n    hist.lastOrigin = hist.lastSelOrigin = null;\r\n\r\n    for (;;) {\r\n      event = source.pop();\r\n      if (event.ranges) {\r\n        pushSelectionToHistory(event, dest);\r\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\r\n          setSelection(doc, event, {clearRedo: false});\r\n          return\r\n        }\r\n        selAfter = event;\r\n      } else if (suppress) {\r\n        source.push(event);\r\n        return\r\n      } else { break }\r\n    }\r\n\r\n    // Build up a reverse change object to add to the opposite history\r\n    // stack (redo when undoing, and vice versa).\r\n    var antiChanges = [];\r\n    pushSelectionToHistory(selAfter, dest);\r\n    dest.push({changes: antiChanges, generation: hist.generation});\r\n    hist.generation = event.generation || ++hist.maxGeneration;\r\n\r\n    var filter = hasHandler(doc, "beforeChange") || doc.cm && hasHandler(doc.cm, "beforeChange");\r\n\r\n    var loop = function ( i ) {\r\n      var change = event.changes[i];\r\n      change.origin = type;\r\n      if (filter && !filterChange(doc, change, false)) {\r\n        source.length = 0;\r\n        return {}\r\n      }\r\n\r\n      antiChanges.push(historyChangeFromChange(doc, change));\r\n\r\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\r\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\r\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\r\n      var rebased = [];\r\n\r\n      // Propagate to the linked documents\r\n      linkedDocs(doc, function (doc, sharedHist) {\r\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\r\n          rebaseHist(doc.history, change);\r\n          rebased.push(doc.history);\r\n        }\r\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\r\n      });\r\n    };\r\n\r\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\r\n      var returned = loop( i$1 );\r\n\r\n      if ( returned ) return returned.v;\r\n    }\r\n  }\r\n\r\n  // Sub-views need their line numbers shifted when text is added\r\n  // above or below them in the parent document.\r\n  function shiftDoc(doc, distance) {\r\n    if (distance == 0) { return }\r\n    doc.first += distance;\r\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\r\n      Pos(range.anchor.line + distance, range.anchor.ch),\r\n      Pos(range.head.line + distance, range.head.ch)\r\n    ); }), doc.sel.primIndex);\r\n    if (doc.cm) {\r\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\r\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\r\n        { regLineChange(doc.cm, l, "gutter"); }\r\n    }\r\n  }\r\n\r\n  // More lower-level change function, handling only a single document\r\n  // (not linked ones).\r\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\r\n    if (doc.cm && !doc.cm.curOp)\r\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\r\n\r\n    if (change.to.line < doc.first) {\r\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\r\n      return\r\n    }\r\n    if (change.from.line > doc.lastLine()) { return }\r\n\r\n    // Clip the change to the size of this doc\r\n    if (change.from.line < doc.first) {\r\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\r\n      shiftDoc(doc, shift);\r\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\r\n                text: [lst(change.text)], origin: change.origin};\r\n    }\r\n    var last = doc.lastLine();\r\n    if (change.to.line > last) {\r\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\r\n                text: [change.text[0]], origin: change.origin};\r\n    }\r\n\r\n    change.removed = getBetween(doc, change.from, change.to);\r\n\r\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\r\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\r\n    else { updateDoc(doc, change, spans); }\r\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\r\n\r\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\r\n      { doc.cantEdit = false; }\r\n  }\r\n\r\n  // Handle the interaction of a change to a document with the editor\r\n  // that this document is part of.\r\n  function makeChangeSingleDocInEditor(cm, change, spans) {\r\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\r\n\r\n    var recomputeMaxLength = false, checkWidthStart = from.line;\r\n    if (!cm.options.lineWrapping) {\r\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\r\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\r\n        if (line == display.maxLine) {\r\n          recomputeMaxLength = true;\r\n          return true\r\n        }\r\n      });\r\n    }\r\n\r\n    if (doc.sel.contains(change.from, change.to) > -1)\r\n      { signalCursorActivity(cm); }\r\n\r\n    updateDoc(doc, change, spans, estimateHeight(cm));\r\n\r\n    if (!cm.options.lineWrapping) {\r\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\r\n        var len = lineLength(line);\r\n        if (len > display.maxLineLength) {\r\n          display.maxLine = line;\r\n          display.maxLineLength = len;\r\n          display.maxLineChanged = true;\r\n          recomputeMaxLength = false;\r\n        }\r\n      });\r\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\r\n    }\r\n\r\n    retreatFrontier(doc, from.line);\r\n    startWorker(cm, 400);\r\n\r\n    var lendiff = change.text.length - (to.line - from.line) - 1;\r\n    // Remember that these lines changed, for updating the display\r\n    if (change.full)\r\n      { regChange(cm); }\r\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\r\n      { regLineChange(cm, from.line, "text"); }\r\n    else\r\n      { regChange(cm, from.line, to.line + 1, lendiff); }\r\n\r\n    var changesHandler = hasHandler(cm, "changes"), changeHandler = hasHandler(cm, "change");\r\n    if (changeHandler || changesHandler) {\r\n      var obj = {\r\n        from: from, to: to,\r\n        text: change.text,\r\n        removed: change.removed,\r\n        origin: change.origin\r\n      };\r\n      if (changeHandler) { signalLater(cm, "change", cm, obj); }\r\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\r\n    }\r\n    cm.display.selForContextMenu = null;\r\n  }\r\n\r\n  function replaceRange(doc, code, from, to, origin) {\r\n    var assign;\r\n\r\n    if (!to) { to = from; }\r\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\r\n    if (typeof code == "string") { code = doc.splitLines(code); }\r\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\r\n  }\r\n\r\n  // Rebasing/resetting history to deal with externally-sourced changes\r\n\r\n  function rebaseHistSelSingle(pos, from, to, diff) {\r\n    if (to < pos.line) {\r\n      pos.line += diff;\r\n    } else if (from < pos.line) {\r\n      pos.line = from;\r\n      pos.ch = 0;\r\n    }\r\n  }\r\n\r\n  // Tries to rebase an array of history events given a change in the\r\n  // document. If the change touches the same lines as the event, the\r\n  // event, and everything \'behind\' it, is discarded. If the change is\r\n  // before the event, the event\'s positions are updated. Uses a\r\n  // copy-on-write scheme for the positions, to avoid having to\r\n  // reallocate them all on every rebase, but also avoid problems with\r\n  // shared position objects being unsafely updated.\r\n  function rebaseHistArray(array, from, to, diff) {\r\n    for (var i = 0; i < array.length; ++i) {\r\n      var sub = array[i], ok = true;\r\n      if (sub.ranges) {\r\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\r\n        for (var j = 0; j < sub.ranges.length; j++) {\r\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\r\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\r\n        }\r\n        continue\r\n      }\r\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\r\n        var cur = sub.changes[j$1];\r\n        if (to < cur.from.line) {\r\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\r\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\r\n        } else if (from <= cur.to.line) {\r\n          ok = false;\r\n          break\r\n        }\r\n      }\r\n      if (!ok) {\r\n        array.splice(0, i + 1);\r\n        i = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  function rebaseHist(hist, change) {\r\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\r\n    rebaseHistArray(hist.done, from, to, diff);\r\n    rebaseHistArray(hist.undone, from, to, diff);\r\n  }\r\n\r\n  // Utility for applying a change to a line by handle or number,\r\n  // returning the number and optionally registering the line as\r\n  // changed.\r\n  function changeLine(doc, handle, changeType, op) {\r\n    var no = handle, line = handle;\r\n    if (typeof handle == "number") { line = getLine(doc, clipLine(doc, handle)); }\r\n    else { no = lineNo(handle); }\r\n    if (no == null) { return null }\r\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\r\n    return line\r\n  }\r\n\r\n  // The document is represented as a BTree consisting of leaves, with\r\n  // chunk of lines in them, and branches, with up to ten leaves or\r\n  // other branch nodes below them. The top node is always a branch\r\n  // node, and is the document object itself (meaning it has\r\n  // additional methods and properties).\r\n  //\r\n  // All nodes have parent links. The tree is used both to go from\r\n  // line numbers to line objects, and to go from objects to numbers.\r\n  // It also indexes by height, and is used to convert between height\r\n  // and line object, and to find the total height of the document.\r\n  //\r\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\r\n\r\n  function LeafChunk(lines) {\r\n    this.lines = lines;\r\n    this.parent = null;\r\n    var height = 0;\r\n    for (var i = 0; i < lines.length; ++i) {\r\n      lines[i].parent = this;\r\n      height += lines[i].height;\r\n    }\r\n    this.height = height;\r\n  }\r\n\r\n  LeafChunk.prototype = {\r\n    chunkSize: function() { return this.lines.length },\r\n\r\n    // Remove the n lines at offset \'at\'.\r\n    removeInner: function(at, n) {\r\n      for (var i = at, e = at + n; i < e; ++i) {\r\n        var line = this.lines[i];\r\n        this.height -= line.height;\r\n        cleanUpLine(line);\r\n        signalLater(line, "delete");\r\n      }\r\n      this.lines.splice(at, n);\r\n    },\r\n\r\n    // Helper used to collapse a small branch into a single leaf.\r\n    collapse: function(lines) {\r\n      lines.push.apply(lines, this.lines);\r\n    },\r\n\r\n    // Insert the given array of lines at offset \'at\', count them as\r\n    // having the given height.\r\n    insertInner: function(at, lines, height) {\r\n      this.height += height;\r\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\r\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\r\n    },\r\n\r\n    // Used to iterate over a part of the tree.\r\n    iterN: function(at, n, op) {\r\n      for (var e = at + n; at < e; ++at)\r\n        { if (op(this.lines[at])) { return true } }\r\n    }\r\n  };\r\n\r\n  function BranchChunk(children) {\r\n    this.children = children;\r\n    var size = 0, height = 0;\r\n    for (var i = 0; i < children.length; ++i) {\r\n      var ch = children[i];\r\n      size += ch.chunkSize(); height += ch.height;\r\n      ch.parent = this;\r\n    }\r\n    this.size = size;\r\n    this.height = height;\r\n    this.parent = null;\r\n  }\r\n\r\n  BranchChunk.prototype = {\r\n    chunkSize: function() { return this.size },\r\n\r\n    removeInner: function(at, n) {\r\n      this.size -= n;\r\n      for (var i = 0; i < this.children.length; ++i) {\r\n        var child = this.children[i], sz = child.chunkSize();\r\n        if (at < sz) {\r\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\r\n          child.removeInner(at, rm);\r\n          this.height -= oldHeight - child.height;\r\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\r\n          if ((n -= rm) == 0) { break }\r\n          at = 0;\r\n        } else { at -= sz; }\r\n      }\r\n      // If the result is smaller than 25 lines, ensure that it is a\r\n      // single leaf node.\r\n      if (this.size - n < 25 &&\r\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\r\n        var lines = [];\r\n        this.collapse(lines);\r\n        this.children = [new LeafChunk(lines)];\r\n        this.children[0].parent = this;\r\n      }\r\n    },\r\n\r\n    collapse: function(lines) {\r\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\r\n    },\r\n\r\n    insertInner: function(at, lines, height) {\r\n      this.size += lines.length;\r\n      this.height += height;\r\n      for (var i = 0; i < this.children.length; ++i) {\r\n        var child = this.children[i], sz = child.chunkSize();\r\n        if (at <= sz) {\r\n          child.insertInner(at, lines, height);\r\n          if (child.lines && child.lines.length > 50) {\r\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it\'s never spliced.\r\n            // Instead, small slices are taken. They\'re taken in order because sequential memory accesses are fastest.\r\n            var remaining = child.lines.length % 25 + 25;\r\n            for (var pos = remaining; pos < child.lines.length;) {\r\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\r\n              child.height -= leaf.height;\r\n              this.children.splice(++i, 0, leaf);\r\n              leaf.parent = this;\r\n            }\r\n            child.lines = child.lines.slice(0, remaining);\r\n            this.maybeSpill();\r\n          }\r\n          break\r\n        }\r\n        at -= sz;\r\n      }\r\n    },\r\n\r\n    // When a node has grown, check whether it should be split.\r\n    maybeSpill: function() {\r\n      if (this.children.length <= 10) { return }\r\n      var me = this;\r\n      do {\r\n        var spilled = me.children.splice(me.children.length - 5, 5);\r\n        var sibling = new BranchChunk(spilled);\r\n        if (!me.parent) { // Become the parent node\r\n          var copy = new BranchChunk(me.children);\r\n          copy.parent = me;\r\n          me.children = [copy, sibling];\r\n          me = copy;\r\n       } else {\r\n          me.size -= sibling.size;\r\n          me.height -= sibling.height;\r\n          var myIndex = indexOf(me.parent.children, me);\r\n          me.parent.children.splice(myIndex + 1, 0, sibling);\r\n        }\r\n        sibling.parent = me.parent;\r\n      } while (me.children.length > 10)\r\n      me.parent.maybeSpill();\r\n    },\r\n\r\n    iterN: function(at, n, op) {\r\n      for (var i = 0; i < this.children.length; ++i) {\r\n        var child = this.children[i], sz = child.chunkSize();\r\n        if (at < sz) {\r\n          var used = Math.min(n, sz - at);\r\n          if (child.iterN(at, used, op)) { return true }\r\n          if ((n -= used) == 0) { break }\r\n          at = 0;\r\n        } else { at -= sz; }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Line widgets are block elements displayed above or below a line.\r\n\r\n  var LineWidget = function(doc, node, options) {\r\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\r\n      { this[opt] = options[opt]; } } }\r\n    this.doc = doc;\r\n    this.node = node;\r\n  };\r\n\r\n  LineWidget.prototype.clear = function () {\r\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\r\n    if (no == null || !ws) { return }\r\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\r\n    if (!ws.length) { line.widgets = null; }\r\n    var height = widgetHeight(this);\r\n    updateLineHeight(line, Math.max(0, line.height - height));\r\n    if (cm) {\r\n      runInOp(cm, function () {\r\n        adjustScrollWhenAboveVisible(cm, line, -height);\r\n        regLineChange(cm, no, "widget");\r\n      });\r\n      signalLater(cm, "lineWidgetCleared", cm, this, no);\r\n    }\r\n  };\r\n\r\n  LineWidget.prototype.changed = function () {\r\n      var this$1 = this;\r\n\r\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\r\n    this.height = null;\r\n    var diff = widgetHeight(this) - oldH;\r\n    if (!diff) { return }\r\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\r\n    if (cm) {\r\n      runInOp(cm, function () {\r\n        cm.curOp.forceUpdate = true;\r\n        adjustScrollWhenAboveVisible(cm, line, diff);\r\n        signalLater(cm, "lineWidgetChanged", cm, this$1, lineNo(line));\r\n      });\r\n    }\r\n  };\r\n  eventMixin(LineWidget);\r\n\r\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\r\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\r\n      { addToScrollTop(cm, diff); }\r\n  }\r\n\r\n  function addLineWidget(doc, handle, node, options) {\r\n    var widget = new LineWidget(doc, node, options);\r\n    var cm = doc.cm;\r\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\r\n    changeLine(doc, handle, "widget", function (line) {\r\n      var widgets = line.widgets || (line.widgets = []);\r\n      if (widget.insertAt == null) { widgets.push(widget); }\r\n      else { widgets.splice(Math.min(widgets.length, Math.max(0, widget.insertAt)), 0, widget); }\r\n      widget.line = line;\r\n      if (cm && !lineIsHidden(doc, line)) {\r\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\r\n        updateLineHeight(line, line.height + widgetHeight(widget));\r\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\r\n        cm.curOp.forceUpdate = true;\r\n      }\r\n      return true\r\n    });\r\n    if (cm) { signalLater(cm, "lineWidgetAdded", cm, widget, typeof handle == "number" ? handle : lineNo(handle)); }\r\n    return widget\r\n  }\r\n\r\n  // TEXTMARKERS\r\n\r\n  // Created with markText and setBookmark methods. A TextMarker is a\r\n  // handle that can be used to clear or find a marked position in the\r\n  // document. Line objects hold arrays (markedSpans) containing\r\n  // {from, to, marker} object pointing to such marker objects, and\r\n  // indicating that such a marker is present on that line. Multiple\r\n  // lines may point to the same marker when it spans across lines.\r\n  // The spans will have null for their from/to properties when the\r\n  // marker continues beyond the start/end of the line. Markers have\r\n  // links back to the lines they currently touch.\r\n\r\n  // Collapsed markers have unique ids, in order to be able to order\r\n  // them, which is needed for uniquely determining an outer marker\r\n  // when they overlap (they may nest, but not partially overlap).\r\n  var nextMarkerId = 0;\r\n\r\n  var TextMarker = function(doc, type) {\r\n    this.lines = [];\r\n    this.type = type;\r\n    this.doc = doc;\r\n    this.id = ++nextMarkerId;\r\n  };\r\n\r\n  // Clear the marker.\r\n  TextMarker.prototype.clear = function () {\r\n    if (this.explicitlyCleared) { return }\r\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\r\n    if (withOp) { startOperation(cm); }\r\n    if (hasHandler(this, "clear")) {\r\n      var found = this.find();\r\n      if (found) { signalLater(this, "clear", found.from, found.to); }\r\n    }\r\n    var min = null, max = null;\r\n    for (var i = 0; i < this.lines.length; ++i) {\r\n      var line = this.lines[i];\r\n      var span = getMarkedSpanFor(line.markedSpans, this);\r\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), "text"); }\r\n      else if (cm) {\r\n        if (span.to != null) { max = lineNo(line); }\r\n        if (span.from != null) { min = lineNo(line); }\r\n      }\r\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\r\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\r\n        { updateLineHeight(line, textHeight(cm.display)); }\r\n    }\r\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\r\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\r\n      if (len > cm.display.maxLineLength) {\r\n        cm.display.maxLine = visual;\r\n        cm.display.maxLineLength = len;\r\n        cm.display.maxLineChanged = true;\r\n      }\r\n    } }\r\n\r\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\r\n    this.lines.length = 0;\r\n    this.explicitlyCleared = true;\r\n    if (this.atomic && this.doc.cantEdit) {\r\n      this.doc.cantEdit = false;\r\n      if (cm) { reCheckSelection(cm.doc); }\r\n    }\r\n    if (cm) { signalLater(cm, "markerCleared", cm, this, min, max); }\r\n    if (withOp) { endOperation(cm); }\r\n    if (this.parent) { this.parent.clear(); }\r\n  };\r\n\r\n  // Find the position of the marker in the document. Returns a {from,\r\n  // to} object by default. Side can be passed to get a specific side\r\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\r\n  // Pos objects returned contain a line object, rather than a line\r\n  // number (used to prevent looking up the same line twice).\r\n  TextMarker.prototype.find = function (side, lineObj) {\r\n    if (side == null && this.type == "bookmark") { side = 1; }\r\n    var from, to;\r\n    for (var i = 0; i < this.lines.length; ++i) {\r\n      var line = this.lines[i];\r\n      var span = getMarkedSpanFor(line.markedSpans, this);\r\n      if (span.from != null) {\r\n        from = Pos(lineObj ? line : lineNo(line), span.from);\r\n        if (side == -1) { return from }\r\n      }\r\n      if (span.to != null) {\r\n        to = Pos(lineObj ? line : lineNo(line), span.to);\r\n        if (side == 1) { return to }\r\n      }\r\n    }\r\n    return from && {from: from, to: to}\r\n  };\r\n\r\n  // Signals that the marker\'s widget changed, and surrounding layout\r\n  // should be recomputed.\r\n  TextMarker.prototype.changed = function () {\r\n      var this$1 = this;\r\n\r\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\r\n    if (!pos || !cm) { return }\r\n    runInOp(cm, function () {\r\n      var line = pos.line, lineN = lineNo(pos.line);\r\n      var view = findViewForLine(cm, lineN);\r\n      if (view) {\r\n        clearLineMeasurementCacheFor(view);\r\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\r\n      }\r\n      cm.curOp.updateMaxLine = true;\r\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\r\n        var oldHeight = widget.height;\r\n        widget.height = null;\r\n        var dHeight = widgetHeight(widget) - oldHeight;\r\n        if (dHeight)\r\n          { updateLineHeight(line, line.height + dHeight); }\r\n      }\r\n      signalLater(cm, "markerChanged", cm, this$1);\r\n    });\r\n  };\r\n\r\n  TextMarker.prototype.attachLine = function (line) {\r\n    if (!this.lines.length && this.doc.cm) {\r\n      var op = this.doc.cm.curOp;\r\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\r\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\r\n    }\r\n    this.lines.push(line);\r\n  };\r\n\r\n  TextMarker.prototype.detachLine = function (line) {\r\n    this.lines.splice(indexOf(this.lines, line), 1);\r\n    if (!this.lines.length && this.doc.cm) {\r\n      var op = this.doc.cm.curOp\r\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\r\n    }\r\n  };\r\n  eventMixin(TextMarker);\r\n\r\n  // Create a marker, wire it up to the right lines, and\r\n  function markText(doc, from, to, options, type) {\r\n    // Shared markers (across linked documents) are handled separately\r\n    // (markTextShared will call out to this again, once per\r\n    // document).\r\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\r\n    // Ensure we are in an operation.\r\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\r\n\r\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\r\n    if (options) { copyObj(options, marker, false); }\r\n    // Don\'t connect empty markers unless clearWhenEmpty is false\r\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\r\n      { return marker }\r\n    if (marker.replacedWith) {\r\n      // Showing up as a widget implies collapsed (widget replaces text)\r\n      marker.collapsed = true;\r\n      marker.widgetNode = eltP("span", [marker.replacedWith], "CodeMirror-widget");\r\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute("cm-ignore-events", "true"); }\r\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\r\n    }\r\n    if (marker.collapsed) {\r\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\r\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\r\n        { throw new Error("Inserting collapsed marker partially overlapping an existing one") }\r\n      seeCollapsedSpans();\r\n    }\r\n\r\n    if (marker.addToHistory)\r\n      { addChangeToHistory(doc, {from: from, to: to, origin: "markText"}, doc.sel, NaN); }\r\n\r\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\r\n    doc.iter(curLine, to.line + 1, function (line) {\r\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\r\n        { updateMaxLine = true; }\r\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\r\n      addMarkedSpan(line, new MarkedSpan(marker,\r\n                                         curLine == from.line ? from.ch : null,\r\n                                         curLine == to.line ? to.ch : null), doc.cm && doc.cm.curOp);\r\n      ++curLine;\r\n    });\r\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\r\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\r\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\r\n    }); }\r\n\r\n    if (marker.clearOnEnter) { on(marker, "beforeCursorEnter", function () { return marker.clear(); }); }\r\n\r\n    if (marker.readOnly) {\r\n      seeReadOnlySpans();\r\n      if (doc.history.done.length || doc.history.undone.length)\r\n        { doc.clearHistory(); }\r\n    }\r\n    if (marker.collapsed) {\r\n      marker.id = ++nextMarkerId;\r\n      marker.atomic = true;\r\n    }\r\n    if (cm) {\r\n      // Sync editor state\r\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\r\n      if (marker.collapsed)\r\n        { regChange(cm, from.line, to.line + 1); }\r\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\r\n               marker.attributes || marker.title)\r\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, "text"); } }\r\n      if (marker.atomic) { reCheckSelection(cm.doc); }\r\n      signalLater(cm, "markerAdded", cm, marker);\r\n    }\r\n    return marker\r\n  }\r\n\r\n  // SHARED TEXTMARKERS\r\n\r\n  // A shared marker spans multiple linked documents. It is\r\n  // implemented as a meta-marker-object controlling multiple normal\r\n  // markers.\r\n  var SharedTextMarker = function(markers, primary) {\r\n    this.markers = markers;\r\n    this.primary = primary;\r\n    for (var i = 0; i < markers.length; ++i)\r\n      { markers[i].parent = this; }\r\n  };\r\n\r\n  SharedTextMarker.prototype.clear = function () {\r\n    if (this.explicitlyCleared) { return }\r\n    this.explicitlyCleared = true;\r\n    for (var i = 0; i < this.markers.length; ++i)\r\n      { this.markers[i].clear(); }\r\n    signalLater(this, "clear");\r\n  };\r\n\r\n  SharedTextMarker.prototype.find = function (side, lineObj) {\r\n    return this.primary.find(side, lineObj)\r\n  };\r\n  eventMixin(SharedTextMarker);\r\n\r\n  function markTextShared(doc, from, to, options, type) {\r\n    options = copyObj(options);\r\n    options.shared = false;\r\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\r\n    var widget = options.widgetNode;\r\n    linkedDocs(doc, function (doc) {\r\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\r\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\r\n      for (var i = 0; i < doc.linked.length; ++i)\r\n        { if (doc.linked[i].isParent) { return } }\r\n      primary = lst(markers);\r\n    });\r\n    return new SharedTextMarker(markers, primary)\r\n  }\r\n\r\n  function findSharedMarkers(doc) {\r\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\r\n  }\r\n\r\n  function copySharedMarkers(doc, markers) {\r\n    for (var i = 0; i < markers.length; i++) {\r\n      var marker = markers[i], pos = marker.find();\r\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\r\n      if (cmp(mFrom, mTo)) {\r\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\r\n        marker.markers.push(subMark);\r\n        subMark.parent = marker;\r\n      }\r\n    }\r\n  }\r\n\r\n  function detachSharedMarkers(markers) {\r\n    var loop = function ( i ) {\r\n      var marker = markers[i], linked = [marker.primary.doc];\r\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\r\n      for (var j = 0; j < marker.markers.length; j++) {\r\n        var subMarker = marker.markers[j];\r\n        if (indexOf(linked, subMarker.doc) == -1) {\r\n          subMarker.parent = null;\r\n          marker.markers.splice(j--, 1);\r\n        }\r\n      }\r\n    };\r\n\r\n    for (var i = 0; i < markers.length; i++) loop( i );\r\n  }\r\n\r\n  var nextDocId = 0;\r\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\r\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\r\n    if (firstLine == null) { firstLine = 0; }\r\n\r\n    BranchChunk.call(this, [new LeafChunk([new Line("", null)])]);\r\n    this.first = firstLine;\r\n    this.scrollTop = this.scrollLeft = 0;\r\n    this.cantEdit = false;\r\n    this.cleanGeneration = 1;\r\n    this.modeFrontier = this.highlightFrontier = firstLine;\r\n    var start = Pos(firstLine, 0);\r\n    this.sel = simpleSelection(start);\r\n    this.history = new History(null);\r\n    this.id = ++nextDocId;\r\n    this.modeOption = mode;\r\n    this.lineSep = lineSep;\r\n    this.direction = (direction == "rtl") ? "rtl" : "ltr";\r\n    this.extend = false;\r\n\r\n    if (typeof text == "string") { text = this.splitLines(text); }\r\n    updateDoc(this, {from: start, to: start, text: text});\r\n    setSelection(this, simpleSelection(start), sel_dontScroll);\r\n  };\r\n\r\n  Doc.prototype = createObj(BranchChunk.prototype, {\r\n    constructor: Doc,\r\n    // Iterate over the document. Supports two forms -- with only one\r\n    // argument, it calls that for each line in the document. With\r\n    // three, it iterates over the range given by the first two (with\r\n    // the second being non-inclusive).\r\n    iter: function(from, to, op) {\r\n      if (op) { this.iterN(from - this.first, to - from, op); }\r\n      else { this.iterN(this.first, this.first + this.size, from); }\r\n    },\r\n\r\n    // Non-public interface for adding and removing lines.\r\n    insert: function(at, lines) {\r\n      var height = 0;\r\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\r\n      this.insertInner(at - this.first, lines, height);\r\n    },\r\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\r\n\r\n    // From here, the methods are part of the public interface. Most\r\n    // are also available from CodeMirror (editor) instances.\r\n\r\n    getValue: function(lineSep) {\r\n      var lines = getLines(this, this.first, this.first + this.size);\r\n      if (lineSep === false) { return lines }\r\n      return lines.join(lineSep || this.lineSeparator())\r\n    },\r\n    setValue: docMethodOp(function(code) {\r\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\r\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\r\n                        text: this.splitLines(code), origin: "setValue", full: true}, true);\r\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\r\n      setSelection(this, simpleSelection(top), sel_dontScroll);\r\n    }),\r\n    replaceRange: function(code, from, to, origin) {\r\n      from = clipPos(this, from);\r\n      to = to ? clipPos(this, to) : from;\r\n      replaceRange(this, code, from, to, origin);\r\n    },\r\n    getRange: function(from, to, lineSep) {\r\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\r\n      if (lineSep === false) { return lines }\r\n      if (lineSep === \'\') { return lines.join(\'\') }\r\n      return lines.join(lineSep || this.lineSeparator())\r\n    },\r\n\r\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\r\n\r\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\r\n    getLineNumber: function(line) {return lineNo(line)},\r\n\r\n    getLineHandleVisualStart: function(line) {\r\n      if (typeof line == "number") { line = getLine(this, line); }\r\n      return visualLine(line)\r\n    },\r\n\r\n    lineCount: function() {return this.size},\r\n    firstLine: function() {return this.first},\r\n    lastLine: function() {return this.first + this.size - 1},\r\n\r\n    clipPos: function(pos) {return clipPos(this, pos)},\r\n\r\n    getCursor: function(start) {\r\n      var range = this.sel.primary(), pos;\r\n      if (start == null || start == "head") { pos = range.head; }\r\n      else if (start == "anchor") { pos = range.anchor; }\r\n      else if (start == "end" || start == "to" || start === false) { pos = range.to(); }\r\n      else { pos = range.from(); }\r\n      return pos\r\n    },\r\n    listSelections: function() { return this.sel.ranges },\r\n    somethingSelected: function() {return this.sel.somethingSelected()},\r\n\r\n    setCursor: docMethodOp(function(line, ch, options) {\r\n      setSimpleSelection(this, clipPos(this, typeof line == "number" ? Pos(line, ch || 0) : line), null, options);\r\n    }),\r\n    setSelection: docMethodOp(function(anchor, head, options) {\r\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\r\n    }),\r\n    extendSelection: docMethodOp(function(head, other, options) {\r\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\r\n    }),\r\n    extendSelections: docMethodOp(function(heads, options) {\r\n      extendSelections(this, clipPosArray(this, heads), options);\r\n    }),\r\n    extendSelectionsBy: docMethodOp(function(f, options) {\r\n      var heads = map(this.sel.ranges, f);\r\n      extendSelections(this, clipPosArray(this, heads), options);\r\n    }),\r\n    setSelections: docMethodOp(function(ranges, primary, options) {\r\n      if (!ranges.length) { return }\r\n      var out = [];\r\n      for (var i = 0; i < ranges.length; i++)\r\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\r\n                           clipPos(this, ranges[i].head || ranges[i].anchor)); }\r\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\r\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\r\n    }),\r\n    addSelection: docMethodOp(function(anchor, head, options) {\r\n      var ranges = this.sel.ranges.slice(0);\r\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\r\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\r\n    }),\r\n\r\n    getSelection: function(lineSep) {\r\n      var ranges = this.sel.ranges, lines;\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\r\n        lines = lines ? lines.concat(sel) : sel;\r\n      }\r\n      if (lineSep === false) { return lines }\r\n      else { return lines.join(lineSep || this.lineSeparator()) }\r\n    },\r\n    getSelections: function(lineSep) {\r\n      var parts = [], ranges = this.sel.ranges;\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\r\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\r\n        parts[i] = sel;\r\n      }\r\n      return parts\r\n    },\r\n    replaceSelection: function(code, collapse, origin) {\r\n      var dup = [];\r\n      for (var i = 0; i < this.sel.ranges.length; i++)\r\n        { dup[i] = code; }\r\n      this.replaceSelections(dup, collapse, origin || "+input");\r\n    },\r\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\r\n      var changes = [], sel = this.sel;\r\n      for (var i = 0; i < sel.ranges.length; i++) {\r\n        var range = sel.ranges[i];\r\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\r\n      }\r\n      var newSel = collapse && collapse != "end" && computeReplacedSel(this, changes, collapse);\r\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\r\n        { makeChange(this, changes[i$1]); }\r\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\r\n      else if (this.cm) { ensureCursorVisible(this.cm); }\r\n    }),\r\n    undo: docMethodOp(function() {makeChangeFromHistory(this, "undo");}),\r\n    redo: docMethodOp(function() {makeChangeFromHistory(this, "redo");}),\r\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, "undo", true);}),\r\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, "redo", true);}),\r\n\r\n    setExtending: function(val) {this.extend = val;},\r\n    getExtending: function() {return this.extend},\r\n\r\n    historySize: function() {\r\n      var hist = this.history, done = 0, undone = 0;\r\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\r\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\r\n      return {undo: done, redo: undone}\r\n    },\r\n    clearHistory: function() {\r\n      var this$1 = this;\r\n\r\n      this.history = new History(this.history);\r\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\r\n    },\r\n\r\n    markClean: function() {\r\n      this.cleanGeneration = this.changeGeneration(true);\r\n    },\r\n    changeGeneration: function(forceSplit) {\r\n      if (forceSplit)\r\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\r\n      return this.history.generation\r\n    },\r\n    isClean: function (gen) {\r\n      return this.history.generation == (gen || this.cleanGeneration)\r\n    },\r\n\r\n    getHistory: function() {\r\n      return {done: copyHistoryArray(this.history.done),\r\n              undone: copyHistoryArray(this.history.undone)}\r\n    },\r\n    setHistory: function(histData) {\r\n      var hist = this.history = new History(this.history);\r\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\r\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\r\n    },\r\n\r\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\r\n      return changeLine(this, line, "gutter", function (line) {\r\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\r\n        markers[gutterID] = value;\r\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\r\n        return true\r\n      })\r\n    }),\r\n\r\n    clearGutter: docMethodOp(function(gutterID) {\r\n      var this$1 = this;\r\n\r\n      this.iter(function (line) {\r\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\r\n          changeLine(this$1, line, "gutter", function () {\r\n            line.gutterMarkers[gutterID] = null;\r\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\r\n            return true\r\n          });\r\n        }\r\n      });\r\n    }),\r\n\r\n    lineInfo: function(line) {\r\n      var n;\r\n      if (typeof line == "number") {\r\n        if (!isLine(this, line)) { return null }\r\n        n = line;\r\n        line = getLine(this, line);\r\n        if (!line) { return null }\r\n      } else {\r\n        n = lineNo(line);\r\n        if (n == null) { return null }\r\n      }\r\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\r\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\r\n              widgets: line.widgets}\r\n    },\r\n\r\n    addLineClass: docMethodOp(function(handle, where, cls) {\r\n      return changeLine(this, handle, where == "gutter" ? "gutter" : "class", function (line) {\r\n        var prop = where == "text" ? "textClass"\r\n                 : where == "background" ? "bgClass"\r\n                 : where == "gutter" ? "gutterClass" : "wrapClass";\r\n        if (!line[prop]) { line[prop] = cls; }\r\n        else if (classTest(cls).test(line[prop])) { return false }\r\n        else { line[prop] += " " + cls; }\r\n        return true\r\n      })\r\n    }),\r\n    removeLineClass: docMethodOp(function(handle, where, cls) {\r\n      return changeLine(this, handle, where == "gutter" ? "gutter" : "class", function (line) {\r\n        var prop = where == "text" ? "textClass"\r\n                 : where == "background" ? "bgClass"\r\n                 : where == "gutter" ? "gutterClass" : "wrapClass";\r\n        var cur = line[prop];\r\n        if (!cur) { return false }\r\n        else if (cls == null) { line[prop] = null; }\r\n        else {\r\n          var found = cur.match(classTest(cls));\r\n          if (!found) { return false }\r\n          var end = found.index + found[0].length;\r\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? "" : " ") + cur.slice(end) || null;\r\n        }\r\n        return true\r\n      })\r\n    }),\r\n\r\n    addLineWidget: docMethodOp(function(handle, node, options) {\r\n      return addLineWidget(this, handle, node, options)\r\n    }),\r\n    removeLineWidget: function(widget) { widget.clear(); },\r\n\r\n    markText: function(from, to, options) {\r\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || "range")\r\n    },\r\n    setBookmark: function(pos, options) {\r\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\r\n                      insertLeft: options && options.insertLeft,\r\n                      clearWhenEmpty: false, shared: options && options.shared,\r\n                      handleMouseEvents: options && options.handleMouseEvents};\r\n      pos = clipPos(this, pos);\r\n      return markText(this, pos, pos, realOpts, "bookmark")\r\n    },\r\n    findMarksAt: function(pos) {\r\n      pos = clipPos(this, pos);\r\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\r\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\r\n        var span = spans[i];\r\n        if ((span.from == null || span.from <= pos.ch) &&\r\n            (span.to == null || span.to >= pos.ch))\r\n          { markers.push(span.marker.parent || span.marker); }\r\n      } }\r\n      return markers\r\n    },\r\n    findMarks: function(from, to, filter) {\r\n      from = clipPos(this, from); to = clipPos(this, to);\r\n      var found = [], lineNo = from.line;\r\n      this.iter(from.line, to.line + 1, function (line) {\r\n        var spans = line.markedSpans;\r\n        if (spans) { for (var i = 0; i < spans.length; i++) {\r\n          var span = spans[i];\r\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\r\n                span.from == null && lineNo != from.line ||\r\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\r\n              (!filter || filter(span.marker)))\r\n            { found.push(span.marker.parent || span.marker); }\r\n        } }\r\n        ++lineNo;\r\n      });\r\n      return found\r\n    },\r\n    getAllMarks: function() {\r\n      var markers = [];\r\n      this.iter(function (line) {\r\n        var sps = line.markedSpans;\r\n        if (sps) { for (var i = 0; i < sps.length; ++i)\r\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\r\n      });\r\n      return markers\r\n    },\r\n\r\n    posFromIndex: function(off) {\r\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\r\n      this.iter(function (line) {\r\n        var sz = line.text.length + sepSize;\r\n        if (sz > off) { ch = off; return true }\r\n        off -= sz;\r\n        ++lineNo;\r\n      });\r\n      return clipPos(this, Pos(lineNo, ch))\r\n    },\r\n    indexFromPos: function (coords) {\r\n      coords = clipPos(this, coords);\r\n      var index = coords.ch;\r\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\r\n      var sepSize = this.lineSeparator().length;\r\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\r\n        index += line.text.length + sepSize;\r\n      });\r\n      return index\r\n    },\r\n\r\n    copy: function(copyHistory) {\r\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\r\n                        this.modeOption, this.first, this.lineSep, this.direction);\r\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\r\n      doc.sel = this.sel;\r\n      doc.extend = false;\r\n      if (copyHistory) {\r\n        doc.history.undoDepth = this.history.undoDepth;\r\n        doc.setHistory(this.getHistory());\r\n      }\r\n      return doc\r\n    },\r\n\r\n    linkedDoc: function(options) {\r\n      if (!options) { options = {}; }\r\n      var from = this.first, to = this.first + this.size;\r\n      if (options.from != null && options.from > from) { from = options.from; }\r\n      if (options.to != null && options.to < to) { to = options.to; }\r\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\r\n      if (options.sharedHist) { copy.history = this.history\r\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\r\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\r\n      copySharedMarkers(copy, findSharedMarkers(this));\r\n      return copy\r\n    },\r\n    unlinkDoc: function(other) {\r\n      if (other instanceof CodeMirror) { other = other.doc; }\r\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\r\n        var link = this.linked[i];\r\n        if (link.doc != other) { continue }\r\n        this.linked.splice(i, 1);\r\n        other.unlinkDoc(this);\r\n        detachSharedMarkers(findSharedMarkers(this));\r\n        break\r\n      } }\r\n      // If the histories were shared, split them again\r\n      if (other.history == this.history) {\r\n        var splitIds = [other.id];\r\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\r\n        other.history = new History(null);\r\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\r\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\r\n      }\r\n    },\r\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\r\n\r\n    getMode: function() {return this.mode},\r\n    getEditor: function() {return this.cm},\r\n\r\n    splitLines: function(str) {\r\n      if (this.lineSep) { return str.split(this.lineSep) }\r\n      return splitLinesAuto(str)\r\n    },\r\n    lineSeparator: function() { return this.lineSep || "\\n" },\r\n\r\n    setDirection: docMethodOp(function (dir) {\r\n      if (dir != "rtl") { dir = "ltr"; }\r\n      if (dir == this.direction) { return }\r\n      this.direction = dir;\r\n      this.iter(function (line) { return line.order = null; });\r\n      if (this.cm) { directionChanged(this.cm); }\r\n    })\r\n  });\r\n\r\n  // Public alias.\r\n  Doc.prototype.eachLine = Doc.prototype.iter;\r\n\r\n  // Kludge to work around strange IE behavior where it\'ll sometimes\r\n  // re-fire a series of drag-related events right after the drop (#1551)\r\n  var lastDrop = 0;\r\n\r\n  function onDrop(e) {\r\n    var cm = this;\r\n    clearDragCursor(cm);\r\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\r\n      { return }\r\n    e_preventDefault(e);\r\n    if (ie) { lastDrop = +new Date; }\r\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\r\n    if (!pos || cm.isReadOnly()) { return }\r\n    // Might be a file drop, in which case we simply extract the text\r\n    // and insert it.\r\n    if (files && files.length && window.FileReader && window.File) {\r\n      var n = files.length, text = Array(n), read = 0;\r\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\r\n        if (++read == n) {\r\n          operation(cm, function () {\r\n            pos = clipPos(cm.doc, pos);\r\n            var change = {from: pos, to: pos,\r\n                          text: cm.doc.splitLines(\r\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\r\n                          origin: "paste"};\r\n            makeChange(cm.doc, change);\r\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\r\n          })();\r\n        }\r\n      };\r\n      var readTextFromFile = function (file, i) {\r\n        if (cm.options.allowDropFileTypes &&\r\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\r\n          markAsReadAndPasteIfAllFilesAreRead();\r\n          return\r\n        }\r\n        var reader = new FileReader;\r\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\r\n        reader.onload = function () {\r\n          var content = reader.result;\r\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\r\n            markAsReadAndPasteIfAllFilesAreRead();\r\n            return\r\n          }\r\n          text[i] = content;\r\n          markAsReadAndPasteIfAllFilesAreRead();\r\n        };\r\n        reader.readAsText(file);\r\n      };\r\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\r\n    } else { // Normal drop\r\n      // Don\'t do a replace if the drop happened inside of the selected text.\r\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\r\n        cm.state.draggingText(e);\r\n        // Ensure the editor is re-focused\r\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\r\n        return\r\n      }\r\n      try {\r\n        var text$1 = e.dataTransfer.getData("Text");\r\n        if (text$1) {\r\n          var selected;\r\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\r\n            { selected = cm.listSelections(); }\r\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\r\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\r\n            { replaceRange(cm.doc, "", selected[i$1].anchor, selected[i$1].head, "drag"); } }\r\n          cm.replaceSelection(text$1, "around", "paste");\r\n          cm.display.input.focus();\r\n        }\r\n      }\r\n      catch(e$1){}\r\n    }\r\n  }\r\n\r\n  function onDragStart(cm, e) {\r\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\r\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\r\n\r\n    e.dataTransfer.setData("Text", cm.getSelection());\r\n    e.dataTransfer.effectAllowed = "copyMove";\r\n\r\n    // Use dummy image instead of default browsers image.\r\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don\'t do it there.\r\n    if (e.dataTransfer.setDragImage && !safari) {\r\n      var img = elt("img", null, null, "position: fixed; left: 0; top: 0;");\r\n      img.src = "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";\r\n      if (presto) {\r\n        img.width = img.height = 1;\r\n        cm.display.wrapper.appendChild(img);\r\n        // Force a relayout, or Opera won\'t use our image for some obscure reason\r\n        img._top = img.offsetTop;\r\n      }\r\n      e.dataTransfer.setDragImage(img, 0, 0);\r\n      if (presto) { img.parentNode.removeChild(img); }\r\n    }\r\n  }\r\n\r\n  function onDragOver(cm, e) {\r\n    var pos = posFromMouse(cm, e);\r\n    if (!pos) { return }\r\n    var frag = document.createDocumentFragment();\r\n    drawSelectionCursor(cm, pos, frag);\r\n    if (!cm.display.dragCursor) {\r\n      cm.display.dragCursor = elt("div", null, "CodeMirror-cursors CodeMirror-dragcursors");\r\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\r\n    }\r\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\r\n  }\r\n\r\n  function clearDragCursor(cm) {\r\n    if (cm.display.dragCursor) {\r\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\r\n      cm.display.dragCursor = null;\r\n    }\r\n  }\r\n\r\n  // These must be handled carefully, because naively registering a\r\n  // handler for each editor will cause the editors to never be\r\n  // garbage collected.\r\n\r\n  function forEachCodeMirror(f) {\r\n    if (!document.getElementsByClassName) { return }\r\n    var byClass = document.getElementsByClassName("CodeMirror"), editors = [];\r\n    for (var i = 0; i < byClass.length; i++) {\r\n      var cm = byClass[i].CodeMirror;\r\n      if (cm) { editors.push(cm); }\r\n    }\r\n    if (editors.length) { editors[0].operation(function () {\r\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\r\n    }); }\r\n  }\r\n\r\n  var globalsRegistered = false;\r\n  function ensureGlobalHandlers() {\r\n    if (globalsRegistered) { return }\r\n    registerGlobalHandlers();\r\n    globalsRegistered = true;\r\n  }\r\n  function registerGlobalHandlers() {\r\n    // When the window resizes, we need to refresh active editors.\r\n    var resizeTimer;\r\n    on(window, "resize", function () {\r\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\r\n        resizeTimer = null;\r\n        forEachCodeMirror(onResize);\r\n      }, 100); }\r\n    });\r\n    // When the window loses focus, we want to show the editor as blurred\r\n    on(window, "blur", function () { return forEachCodeMirror(onBlur); });\r\n  }\r\n  // Called when the window resizes\r\n  function onResize(cm) {\r\n    var d = cm.display;\r\n    // Might be a text scaling operation, clear size caches.\r\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\r\n    d.scrollbarsClipped = false;\r\n    cm.setSize();\r\n  }\r\n\r\n  var keyNames = {\r\n    3: "Pause", 8: "Backspace", 9: "Tab", 13: "Enter", 16: "Shift", 17: "Ctrl", 18: "Alt",\r\n    19: "Pause", 20: "CapsLock", 27: "Esc", 32: "Space", 33: "PageUp", 34: "PageDown", 35: "End",\r\n    36: "Home", 37: "Left", 38: "Up", 39: "Right", 40: "Down", 44: "PrintScrn", 45: "Insert",\r\n    46: "Delete", 59: ";", 61: "=", 91: "Mod", 92: "Mod", 93: "Mod",\r\n    106: "*", 107: "=", 109: "-", 110: ".", 111: "/", 145: "ScrollLock",\r\n    173: "-", 186: ";", 187: "=", 188: ",", 189: "-", 190: ".", 191: "/", 192: "`", 219: "[", 220: "\\\\",\r\n    221: "]", 222: "\'", 224: "Mod", 63232: "Up", 63233: "Down", 63234: "Left", 63235: "Right", 63272: "Delete",\r\n    63273: "Home", 63275: "End", 63276: "PageUp", 63277: "PageDown", 63302: "Insert"\r\n  };\r\n\r\n  // Number keys\r\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\r\n  // Alphabetic keys\r\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\r\n  // Function keys\r\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = "F" + i$2; }\r\n\r\n  var keyMap = {};\r\n\r\n  keyMap.basic = {\r\n    "Left": "goCharLeft", "Right": "goCharRight", "Up": "goLineUp", "Down": "goLineDown",\r\n    "End": "goLineEnd", "Home": "goLineStartSmart", "PageUp": "goPageUp", "PageDown": "goPageDown",\r\n    "Delete": "delCharAfter", "Backspace": "delCharBefore", "Shift-Backspace": "delCharBefore",\r\n    "Tab": "defaultTab", "Shift-Tab": "indentAuto",\r\n    "Enter": "newlineAndIndent", "Insert": "toggleOverwrite",\r\n    "Esc": "singleSelection"\r\n  };\r\n  // Note that the save and find-related commands aren\'t defined by\r\n  // default. User code or addons can define them. Unknown commands\r\n  // are simply ignored.\r\n  keyMap.pcDefault = {\r\n    "Ctrl-A": "selectAll", "Ctrl-D": "deleteLine", "Ctrl-Z": "undo", "Shift-Ctrl-Z": "redo", "Ctrl-Y": "redo",\r\n    "Ctrl-Home": "goDocStart", "Ctrl-End": "goDocEnd", "Ctrl-Up": "goLineUp", "Ctrl-Down": "goLineDown",\r\n    "Ctrl-Left": "goGroupLeft", "Ctrl-Right": "goGroupRight", "Alt-Left": "goLineStart", "Alt-Right": "goLineEnd",\r\n    "Ctrl-Backspace": "delGroupBefore", "Ctrl-Delete": "delGroupAfter", "Ctrl-S": "save", "Ctrl-F": "find",\r\n    "Ctrl-G": "findNext", "Shift-Ctrl-G": "findPrev", "Shift-Ctrl-F": "replace", "Shift-Ctrl-R": "replaceAll",\r\n    "Ctrl-[": "indentLess", "Ctrl-]": "indentMore",\r\n    "Ctrl-U": "undoSelection", "Shift-Ctrl-U": "redoSelection", "Alt-U": "redoSelection",\r\n    "fallthrough": "basic"\r\n  };\r\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\r\n  keyMap.emacsy = {\r\n    "Ctrl-F": "goCharRight", "Ctrl-B": "goCharLeft", "Ctrl-P": "goLineUp", "Ctrl-N": "goLineDown",\r\n    "Ctrl-A": "goLineStart", "Ctrl-E": "goLineEnd", "Ctrl-V": "goPageDown", "Shift-Ctrl-V": "goPageUp",\r\n    "Ctrl-D": "delCharAfter", "Ctrl-H": "delCharBefore", "Alt-Backspace": "delWordBefore", "Ctrl-K": "killLine",\r\n    "Ctrl-T": "transposeChars", "Ctrl-O": "openLine"\r\n  };\r\n  keyMap.macDefault = {\r\n    "Cmd-A": "selectAll", "Cmd-D": "deleteLine", "Cmd-Z": "undo", "Shift-Cmd-Z": "redo", "Cmd-Y": "redo",\r\n    "Cmd-Home": "goDocStart", "Cmd-Up": "goDocStart", "Cmd-End": "goDocEnd", "Cmd-Down": "goDocEnd", "Alt-Left": "goGroupLeft",\r\n    "Alt-Right": "goGroupRight", "Cmd-Left": "goLineLeft", "Cmd-Right": "goLineRight", "Alt-Backspace": "delGroupBefore",\r\n    "Ctrl-Alt-Backspace": "delGroupAfter", "Alt-Delete": "delGroupAfter", "Cmd-S": "save", "Cmd-F": "find",\r\n    "Cmd-G": "findNext", "Shift-Cmd-G": "findPrev", "Cmd-Alt-F": "replace", "Shift-Cmd-Alt-F": "replaceAll",\r\n    "Cmd-[": "indentLess", "Cmd-]": "indentMore", "Cmd-Backspace": "delWrappedLineLeft", "Cmd-Delete": "delWrappedLineRight",\r\n    "Cmd-U": "undoSelection", "Shift-Cmd-U": "redoSelection", "Ctrl-Up": "goDocStart", "Ctrl-Down": "goDocEnd",\r\n    "fallthrough": ["basic", "emacsy"]\r\n  };\r\n  keyMap["default"] = mac ? keyMap.macDefault : keyMap.pcDefault;\r\n\r\n  // KEYMAP DISPATCH\r\n\r\n  function normalizeKeyName(name) {\r\n    var parts = name.split(/-(?!$)/);\r\n    name = parts[parts.length - 1];\r\n    var alt, ctrl, shift, cmd;\r\n    for (var i = 0; i < parts.length - 1; i++) {\r\n      var mod = parts[i];\r\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\r\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\r\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\r\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\r\n      else { throw new Error("Unrecognized modifier name: " + mod) }\r\n    }\r\n    if (alt) { name = "Alt-" + name; }\r\n    if (ctrl) { name = "Ctrl-" + name; }\r\n    if (cmd) { name = "Cmd-" + name; }\r\n    if (shift) { name = "Shift-" + name; }\r\n    return name\r\n  }\r\n\r\n  // This is a kludge to keep keymaps mostly working as raw objects\r\n  // (backwards compatibility) while at the same time support features\r\n  // like normalization and multi-stroke key bindings. It compiles a\r\n  // new normalized keymap, and then updates the old object to reflect\r\n  // this.\r\n  function normalizeKeyMap(keymap) {\r\n    var copy = {};\r\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\r\n      var value = keymap[keyname];\r\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\r\n      if (value == "...") { delete keymap[keyname]; continue }\r\n\r\n      var keys = map(keyname.split(" "), normalizeKeyName);\r\n      for (var i = 0; i < keys.length; i++) {\r\n        var val = (void 0), name = (void 0);\r\n        if (i == keys.length - 1) {\r\n          name = keys.join(" ");\r\n          val = value;\r\n        } else {\r\n          name = keys.slice(0, i + 1).join(" ");\r\n          val = "...";\r\n        }\r\n        var prev = copy[name];\r\n        if (!prev) { copy[name] = val; }\r\n        else if (prev != val) { throw new Error("Inconsistent bindings for " + name) }\r\n      }\r\n      delete keymap[keyname];\r\n    } }\r\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\r\n    return keymap\r\n  }\r\n\r\n  function lookupKey(key, map, handle, context) {\r\n    map = getKeyMap(map);\r\n    var found = map.call ? map.call(key, context) : map[key];\r\n    if (found === false) { return "nothing" }\r\n    if (found === "...") { return "multi" }\r\n    if (found != null && handle(found)) { return "handled" }\r\n\r\n    if (map.fallthrough) {\r\n      if (Object.prototype.toString.call(map.fallthrough) != "[object Array]")\r\n        { return lookupKey(key, map.fallthrough, handle, context) }\r\n      for (var i = 0; i < map.fallthrough.length; i++) {\r\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\r\n        if (result) { return result }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Modifier key presses don\'t count as \'real\' key presses for the\r\n  // purpose of keymap fallthrough.\r\n  function isModifierKey(value) {\r\n    var name = typeof value == "string" ? value : keyNames[value.keyCode];\r\n    return name == "Ctrl" || name == "Alt" || name == "Shift" || name == "Mod"\r\n  }\r\n\r\n  function addModifierNames(name, event, noShift) {\r\n    var base = name;\r\n    if (event.altKey && base != "Alt") { name = "Alt-" + name; }\r\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != "Ctrl") { name = "Ctrl-" + name; }\r\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != "Mod") { name = "Cmd-" + name; }\r\n    if (!noShift && event.shiftKey && base != "Shift") { name = "Shift-" + name; }\r\n    return name\r\n  }\r\n\r\n  // Look up the name of a key as indicated by an event object.\r\n  function keyName(event, noShift) {\r\n    if (presto && event.keyCode == 34 && event["char"]) { return false }\r\n    var name = keyNames[event.keyCode];\r\n    if (name == null || event.altGraphKey) { return false }\r\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\r\n    // so we\'ll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\r\n    if (event.keyCode == 3 && event.code) { name = event.code; }\r\n    return addModifierNames(name, event, noShift)\r\n  }\r\n\r\n  function getKeyMap(val) {\r\n    return typeof val == "string" ? keyMap[val] : val\r\n  }\r\n\r\n  // Helper for deleting text near the selection(s), used to implement\r\n  // backspace, delete, and similar functionality.\r\n  function deleteNearSelection(cm, compute) {\r\n    var ranges = cm.doc.sel.ranges, kill = [];\r\n    // Build up a set of ranges to kill first, merging overlapping\r\n    // ranges.\r\n    for (var i = 0; i < ranges.length; i++) {\r\n      var toKill = compute(ranges[i]);\r\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\r\n        var replaced = kill.pop();\r\n        if (cmp(replaced.from, toKill.from) < 0) {\r\n          toKill.from = replaced.from;\r\n          break\r\n        }\r\n      }\r\n      kill.push(toKill);\r\n    }\r\n    // Next, remove those actual ranges.\r\n    runInOp(cm, function () {\r\n      for (var i = kill.length - 1; i >= 0; i--)\r\n        { replaceRange(cm.doc, "", kill[i].from, kill[i].to, "+delete"); }\r\n      ensureCursorVisible(cm);\r\n    });\r\n  }\r\n\r\n  function moveCharLogically(line, ch, dir) {\r\n    var target = skipExtendingChars(line.text, ch + dir, dir);\r\n    return target < 0 || target > line.text.length ? null : target\r\n  }\r\n\r\n  function moveLogically(line, start, dir) {\r\n    var ch = moveCharLogically(line, start.ch, dir);\r\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? "after" : "before")\r\n  }\r\n\r\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\r\n    if (visually) {\r\n      if (cm.doc.direction == "rtl") { dir = -dir; }\r\n      var order = getOrder(lineObj, cm.doc.direction);\r\n      if (order) {\r\n        var part = dir < 0 ? lst(order) : order[0];\r\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\r\n        var sticky = moveInStorageOrder ? "after" : "before";\r\n        var ch;\r\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\r\n        // it could be that the last bidi part is not on the last visual line,\r\n        // since visual lines contain content order-consecutive chunks.\r\n        // Thus, in rtl, we are looking for the first (content-order) character\r\n        // in the rtl chunk that is on the last line (that is, the same line\r\n        // as the last (content-order) character).\r\n        if (part.level > 0 || cm.doc.direction == "rtl") {\r\n          var prep = prepareMeasureForLine(cm, lineObj);\r\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\r\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\r\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\r\n          if (sticky == "before") { ch = moveCharLogically(lineObj, ch, 1); }\r\n        } else { ch = dir < 0 ? part.to : part.from; }\r\n        return new Pos(lineNo, ch, sticky)\r\n      }\r\n    }\r\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? "before" : "after")\r\n  }\r\n\r\n  function moveVisually(cm, line, start, dir) {\r\n    var bidi = getOrder(line, cm.doc.direction);\r\n    if (!bidi) { return moveLogically(line, start, dir) }\r\n    if (start.ch >= line.text.length) {\r\n      start.ch = line.text.length;\r\n      start.sticky = "before";\r\n    } else if (start.ch <= 0) {\r\n      start.ch = 0;\r\n      start.sticky = "after";\r\n    }\r\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\r\n    if (cm.doc.direction == "ltr" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\r\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\r\n      // nothing interesting happens.\r\n      return moveLogically(line, start, dir)\r\n    }\r\n\r\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\r\n    var prep;\r\n    var getWrappedLineExtent = function (ch) {\r\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\r\n      prep = prep || prepareMeasureForLine(cm, line);\r\n      return wrappedLineExtentChar(cm, line, prep, ch)\r\n    };\r\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == "before" ? mv(start, -1) : start.ch);\r\n\r\n    if (cm.doc.direction == "rtl" || part.level == 1) {\r\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\r\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\r\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\r\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\r\n        var sticky = moveInStorageOrder ? "before" : "after";\r\n        return new Pos(start.line, ch, sticky)\r\n      }\r\n    }\r\n\r\n    // Case 3: Could not move within this bidi part in this visual line, so leave\r\n    // the current bidi part\r\n\r\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\r\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\r\n        ? new Pos(start.line, mv(ch, 1), "before")\r\n        : new Pos(start.line, ch, "after"); };\r\n\r\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\r\n        var part = bidi[partPos];\r\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\r\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\r\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\r\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\r\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\r\n      }\r\n    };\r\n\r\n    // Case 3a: Look for other bidi parts on the same visual line\r\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\r\n    if (res) { return res }\r\n\r\n    // Case 3b: Look for other bidi parts on the next visual line\r\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\r\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\r\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\r\n      if (res) { return res }\r\n    }\r\n\r\n    // Case 4: Nowhere to move\r\n    return null\r\n  }\r\n\r\n  // Commands are parameter-less actions that can be performed on an\r\n  // editor, mostly used for keybindings.\r\n  var commands = {\r\n    selectAll: selectAll,\r\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor("anchor"), cm.getCursor("head"), sel_dontScroll); },\r\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\r\n      if (range.empty()) {\r\n        var len = getLine(cm.doc, range.head.line).text.length;\r\n        if (range.head.ch == len && range.head.line < cm.lastLine())\r\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\r\n        else\r\n          { return {from: range.head, to: Pos(range.head.line, len)} }\r\n      } else {\r\n        return {from: range.from(), to: range.to()}\r\n      }\r\n    }); },\r\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\r\n      from: Pos(range.from().line, 0),\r\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\r\n    }); }); },\r\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\r\n      from: Pos(range.from().line, 0), to: range.from()\r\n    }); }); },\r\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\r\n      var top = cm.charCoords(range.head, "div").top + 5;\r\n      var leftPos = cm.coordsChar({left: 0, top: top}, "div");\r\n      return {from: leftPos, to: range.from()}\r\n    }); },\r\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\r\n      var top = cm.charCoords(range.head, "div").top + 5;\r\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, "div");\r\n      return {from: range.from(), to: rightPos }\r\n    }); },\r\n    undo: function (cm) { return cm.undo(); },\r\n    redo: function (cm) { return cm.redo(); },\r\n    undoSelection: function (cm) { return cm.undoSelection(); },\r\n    redoSelection: function (cm) { return cm.redoSelection(); },\r\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\r\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\r\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\r\n      {origin: "+move", bias: 1}\r\n    ); },\r\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\r\n      {origin: "+move", bias: 1}\r\n    ); },\r\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\r\n      {origin: "+move", bias: -1}\r\n    ); },\r\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n      var top = cm.cursorCoords(range.head, "div").top + 5;\r\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, "div")\r\n    }, sel_move); },\r\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n      var top = cm.cursorCoords(range.head, "div").top + 5;\r\n      return cm.coordsChar({left: 0, top: top}, "div")\r\n    }, sel_move); },\r\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n      var top = cm.cursorCoords(range.head, "div").top + 5;\r\n      var pos = cm.coordsChar({left: 0, top: top}, "div");\r\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\r\n      return pos\r\n    }, sel_move); },\r\n    goLineUp: function (cm) { return cm.moveV(-1, "line"); },\r\n    goLineDown: function (cm) { return cm.moveV(1, "line"); },\r\n    goPageUp: function (cm) { return cm.moveV(-1, "page"); },\r\n    goPageDown: function (cm) { return cm.moveV(1, "page"); },\r\n    goCharLeft: function (cm) { return cm.moveH(-1, "char"); },\r\n    goCharRight: function (cm) { return cm.moveH(1, "char"); },\r\n    goColumnLeft: function (cm) { return cm.moveH(-1, "column"); },\r\n    goColumnRight: function (cm) { return cm.moveH(1, "column"); },\r\n    goWordLeft: function (cm) { return cm.moveH(-1, "word"); },\r\n    goGroupRight: function (cm) { return cm.moveH(1, "group"); },\r\n    goGroupLeft: function (cm) { return cm.moveH(-1, "group"); },\r\n    goWordRight: function (cm) { return cm.moveH(1, "word"); },\r\n    delCharBefore: function (cm) { return cm.deleteH(-1, "codepoint"); },\r\n    delCharAfter: function (cm) { return cm.deleteH(1, "char"); },\r\n    delWordBefore: function (cm) { return cm.deleteH(-1, "word"); },\r\n    delWordAfter: function (cm) { return cm.deleteH(1, "word"); },\r\n    delGroupBefore: function (cm) { return cm.deleteH(-1, "group"); },\r\n    delGroupAfter: function (cm) { return cm.deleteH(1, "group"); },\r\n    indentAuto: function (cm) { return cm.indentSelection("smart"); },\r\n    indentMore: function (cm) { return cm.indentSelection("add"); },\r\n    indentLess: function (cm) { return cm.indentSelection("subtract"); },\r\n    insertTab: function (cm) { return cm.replaceSelection("\\t"); },\r\n    insertSoftTab: function (cm) {\r\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var pos = ranges[i].from();\r\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\r\n        spaces.push(spaceStr(tabSize - col % tabSize));\r\n      }\r\n      cm.replaceSelections(spaces);\r\n    },\r\n    defaultTab: function (cm) {\r\n      if (cm.somethingSelected()) { cm.indentSelection("add"); }\r\n      else { cm.execCommand("insertTab"); }\r\n    },\r\n    // Swap the two chars left and right of each selection\'s head.\r\n    // Move cursor behind the two swapped characters afterwards.\r\n    //\r\n    // Doesn\'t consider line feeds a character.\r\n    // Doesn\'t scan more than one line above to find a character.\r\n    // Doesn\'t do anything on an empty line.\r\n    // Doesn\'t do anything with non-empty selections.\r\n    transposeChars: function (cm) { return runInOp(cm, function () {\r\n      var ranges = cm.listSelections(), newSel = [];\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        if (!ranges[i].empty()) { continue }\r\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\r\n        if (line) {\r\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\r\n          if (cur.ch > 0) {\r\n            cur = new Pos(cur.line, cur.ch + 1);\r\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\r\n                            Pos(cur.line, cur.ch - 2), cur, "+transpose");\r\n          } else if (cur.line > cm.doc.first) {\r\n            var prev = getLine(cm.doc, cur.line - 1).text;\r\n            if (prev) {\r\n              cur = new Pos(cur.line, 1);\r\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\r\n                              prev.charAt(prev.length - 1),\r\n                              Pos(cur.line - 1, prev.length - 1), cur, "+transpose");\r\n            }\r\n          }\r\n        }\r\n        newSel.push(new Range(cur, cur));\r\n      }\r\n      cm.setSelections(newSel);\r\n    }); },\r\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\r\n      var sels = cm.listSelections();\r\n      for (var i = sels.length - 1; i >= 0; i--)\r\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, "+input"); }\r\n      sels = cm.listSelections();\r\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\r\n        { cm.indentLine(sels[i$1].from().line, null, true); }\r\n      ensureCursorVisible(cm);\r\n    }); },\r\n    openLine: function (cm) { return cm.replaceSelection("\\n", "start"); },\r\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\r\n  };\r\n\r\n\r\n  function lineStart(cm, lineN) {\r\n    var line = getLine(cm.doc, lineN);\r\n    var visual = visualLine(line);\r\n    if (visual != line) { lineN = lineNo(visual); }\r\n    return endOfLine(true, cm, visual, lineN, 1)\r\n  }\r\n  function lineEnd(cm, lineN) {\r\n    var line = getLine(cm.doc, lineN);\r\n    var visual = visualLineEnd(line);\r\n    if (visual != line) { lineN = lineNo(visual); }\r\n    return endOfLine(true, cm, line, lineN, -1)\r\n  }\r\n  function lineStartSmart(cm, pos) {\r\n    var start = lineStart(cm, pos.line);\r\n    var line = getLine(cm.doc, start.line);\r\n    var order = getOrder(line, cm.doc.direction);\r\n    if (!order || order[0].level == 0) {\r\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\r\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\r\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\r\n    }\r\n    return start\r\n  }\r\n\r\n  // Run a handler that was bound to a key.\r\n  function doHandleBinding(cm, bound, dropShift) {\r\n    if (typeof bound == "string") {\r\n      bound = commands[bound];\r\n      if (!bound) { return false }\r\n    }\r\n    // Ensure previous input has been read, so that the handler sees a\r\n    // consistent view of the document\r\n    cm.display.input.ensurePolled();\r\n    var prevShift = cm.display.shift, done = false;\r\n    try {\r\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\r\n      if (dropShift) { cm.display.shift = false; }\r\n      done = bound(cm) != Pass;\r\n    } finally {\r\n      cm.display.shift = prevShift;\r\n      cm.state.suppressEdits = false;\r\n    }\r\n    return done\r\n  }\r\n\r\n  function lookupKeyForEditor(cm, name, handle) {\r\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\r\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\r\n      if (result) { return result }\r\n    }\r\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\r\n      || lookupKey(name, cm.options.keyMap, handle, cm)\r\n  }\r\n\r\n  // Note that, despite the name, this function is also used to check\r\n  // for bound mouse clicks.\r\n\r\n  var stopSeq = new Delayed;\r\n\r\n  function dispatchKey(cm, name, e, handle) {\r\n    var seq = cm.state.keySeq;\r\n    if (seq) {\r\n      if (isModifierKey(name)) { return "handled" }\r\n      if (/\\\'$/.test(name))\r\n        { cm.state.keySeq = null; }\r\n      else\r\n        { stopSeq.set(50, function () {\r\n          if (cm.state.keySeq == seq) {\r\n            cm.state.keySeq = null;\r\n            cm.display.input.reset();\r\n          }\r\n        }); }\r\n      if (dispatchKeyInner(cm, seq + " " + name, e, handle)) { return true }\r\n    }\r\n    return dispatchKeyInner(cm, name, e, handle)\r\n  }\r\n\r\n  function dispatchKeyInner(cm, name, e, handle) {\r\n    var result = lookupKeyForEditor(cm, name, handle);\r\n\r\n    if (result == "multi")\r\n      { cm.state.keySeq = name; }\r\n    if (result == "handled")\r\n      { signalLater(cm, "keyHandled", cm, name, e); }\r\n\r\n    if (result == "handled" || result == "multi") {\r\n      e_preventDefault(e);\r\n      restartBlink(cm);\r\n    }\r\n\r\n    return !!result\r\n  }\r\n\r\n  // Handle a key from the keydown event.\r\n  function handleKeyBinding(cm, e) {\r\n    var name = keyName(e, true);\r\n    if (!name) { return false }\r\n\r\n    if (e.shiftKey && !cm.state.keySeq) {\r\n      // First try to resolve full name (including \'Shift-\'). Failing\r\n      // that, see if there is a cursor-motion command (starting with\r\n      // \'go\') bound to the keyname without \'Shift-\'.\r\n      return dispatchKey(cm, "Shift-" + name, e, function (b) { return doHandleBinding(cm, b, true); })\r\n          || dispatchKey(cm, name, e, function (b) {\r\n               if (typeof b == "string" ? /^go[A-Z]/.test(b) : b.motion)\r\n                 { return doHandleBinding(cm, b) }\r\n             })\r\n    } else {\r\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\r\n    }\r\n  }\r\n\r\n  // Handle a key from the keypress event\r\n  function handleCharBinding(cm, e, ch) {\r\n    return dispatchKey(cm, "\'" + ch + "\'", e, function (b) { return doHandleBinding(cm, b, true); })\r\n  }\r\n\r\n  var lastStoppedKey = null;\r\n  function onKeyDown(e) {\r\n    var cm = this;\r\n    if (e.target && e.target != cm.display.input.getField()) { return }\r\n    cm.curOp.focus = activeElt(root(cm));\r\n    if (signalDOMEvent(cm, e)) { return }\r\n    // IE does strange things with escape.\r\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\r\n    var code = e.keyCode;\r\n    cm.display.shift = code == 16 || e.shiftKey;\r\n    var handled = handleKeyBinding(cm, e);\r\n    if (presto) {\r\n      lastStoppedKey = handled ? code : null;\r\n      // Opera has no cut event... we try to at least catch the key combo\r\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\r\n        { cm.replaceSelection("", null, "cut"); }\r\n    }\r\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\r\n      { document.execCommand("cut"); }\r\n\r\n    // Turn mouse into crosshair when Alt is held on Mac.\r\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\r\n      { showCrossHair(cm); }\r\n  }\r\n\r\n  function showCrossHair(cm) {\r\n    var lineDiv = cm.display.lineDiv;\r\n    addClass(lineDiv, "CodeMirror-crosshair");\r\n\r\n    function up(e) {\r\n      if (e.keyCode == 18 || !e.altKey) {\r\n        rmClass(lineDiv, "CodeMirror-crosshair");\r\n        off(document, "keyup", up);\r\n        off(document, "mouseover", up);\r\n      }\r\n    }\r\n    on(document, "keyup", up);\r\n    on(document, "mouseover", up);\r\n  }\r\n\r\n  function onKeyUp(e) {\r\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\r\n    signalDOMEvent(this, e);\r\n  }\r\n\r\n  function onKeyPress(e) {\r\n    var cm = this;\r\n    if (e.target && e.target != cm.display.input.getField()) { return }\r\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\r\n    var keyCode = e.keyCode, charCode = e.charCode;\r\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\r\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\r\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\r\n    // Some browsers fire keypress events for backspace\r\n    if (ch == "\\x08") { return }\r\n    if (handleCharBinding(cm, e, ch)) { return }\r\n    cm.display.input.onKeyPress(e);\r\n  }\r\n\r\n  var DOUBLECLICK_DELAY = 400;\r\n\r\n  var PastClick = function(time, pos, button) {\r\n    this.time = time;\r\n    this.pos = pos;\r\n    this.button = button;\r\n  };\r\n\r\n  PastClick.prototype.compare = function (time, pos, button) {\r\n    return this.time + DOUBLECLICK_DELAY > time &&\r\n      cmp(pos, this.pos) == 0 && button == this.button\r\n  };\r\n\r\n  var lastClick, lastDoubleClick;\r\n  function clickRepeat(pos, button) {\r\n    var now = +new Date;\r\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\r\n      lastClick = lastDoubleClick = null;\r\n      return "triple"\r\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\r\n      lastDoubleClick = new PastClick(now, pos, button);\r\n      lastClick = null;\r\n      return "double"\r\n    } else {\r\n      lastClick = new PastClick(now, pos, button);\r\n      lastDoubleClick = null;\r\n      return "single"\r\n    }\r\n  }\r\n\r\n  // A mouse down can be a single click, double click, triple click,\r\n  // start of selection drag, start of text drag, new cursor\r\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\r\n  // middle-click-paste. Or it might be a click on something we should\r\n  // not interfere with, such as a scrollbar or widget.\r\n  function onMouseDown(e) {\r\n    var cm = this, display = cm.display;\r\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\r\n    display.input.ensurePolled();\r\n    display.shift = e.shiftKey;\r\n\r\n    if (eventInWidget(display, e)) {\r\n      if (!webkit) {\r\n        // Briefly turn off draggability, to allow widgets to do\r\n        // normal dragging things.\r\n        display.scroller.draggable = false;\r\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\r\n      }\r\n      return\r\n    }\r\n    if (clickInGutter(cm, e)) { return }\r\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : "single";\r\n    win(cm).focus();\r\n\r\n    // #3261: make sure, that we\'re not starting a second selection\r\n    if (button == 1 && cm.state.selectingText)\r\n      { cm.state.selectingText(e); }\r\n\r\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\r\n\r\n    if (button == 1) {\r\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\r\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\r\n    } else if (button == 2) {\r\n      if (pos) { extendSelection(cm.doc, pos); }\r\n      setTimeout(function () { return display.input.focus(); }, 20);\r\n    } else if (button == 3) {\r\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\r\n      else { delayBlurEvent(cm); }\r\n    }\r\n  }\r\n\r\n  function handleMappedButton(cm, button, pos, repeat, event) {\r\n    var name = "Click";\r\n    if (repeat == "double") { name = "Double" + name; }\r\n    else if (repeat == "triple") { name = "Triple" + name; }\r\n    name = (button == 1 ? "Left" : button == 2 ? "Middle" : "Right") + name;\r\n\r\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\r\n      if (typeof bound == "string") { bound = commands[bound]; }\r\n      if (!bound) { return false }\r\n      var done = false;\r\n      try {\r\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\r\n        done = bound(cm, pos) != Pass;\r\n      } finally {\r\n        cm.state.suppressEdits = false;\r\n      }\r\n      return done\r\n    })\r\n  }\r\n\r\n  function configureMouse(cm, repeat, event) {\r\n    var option = cm.getOption("configureMouse");\r\n    var value = option ? option(cm, repeat, event) : {};\r\n    if (value.unit == null) {\r\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\r\n      value.unit = rect ? "rectangle" : repeat == "single" ? "char" : repeat == "double" ? "word" : "line";\r\n    }\r\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\r\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\r\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\r\n    return value\r\n  }\r\n\r\n  function leftButtonDown(cm, pos, repeat, event) {\r\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\r\n    else { cm.curOp.focus = activeElt(root(cm)); }\r\n\r\n    var behavior = configureMouse(cm, repeat, event);\r\n\r\n    var sel = cm.doc.sel, contained;\r\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\r\n        repeat == "single" && (contained = sel.contains(pos)) > -1 &&\r\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\r\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\r\n      { leftButtonStartDrag(cm, event, pos, behavior); }\r\n    else\r\n      { leftButtonSelect(cm, event, pos, behavior); }\r\n  }\r\n\r\n  // Start a text drag. When it ends, see if any dragging actually\r\n  // happen, and treat as a click if it didn\'t.\r\n  function leftButtonStartDrag(cm, event, pos, behavior) {\r\n    var display = cm.display, moved = false;\r\n    var dragEnd = operation(cm, function (e) {\r\n      if (webkit) { display.scroller.draggable = false; }\r\n      cm.state.draggingText = false;\r\n      if (cm.state.delayingBlurEvent) {\r\n        if (cm.hasFocus()) { cm.state.delayingBlurEvent = false; }\r\n        else { delayBlurEvent(cm); }\r\n      }\r\n      off(display.wrapper.ownerDocument, "mouseup", dragEnd);\r\n      off(display.wrapper.ownerDocument, "mousemove", mouseMove);\r\n      off(display.scroller, "dragstart", dragStart);\r\n      off(display.scroller, "drop", dragEnd);\r\n      if (!moved) {\r\n        e_preventDefault(e);\r\n        if (!behavior.addNew)\r\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\r\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\r\n        if ((webkit && !safari) || ie && ie_version == 9)\r\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus({preventScroll: true}); display.input.focus();}, 20); }\r\n        else\r\n          { display.input.focus(); }\r\n      }\r\n    });\r\n    var mouseMove = function(e2) {\r\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\r\n    };\r\n    var dragStart = function () { return moved = true; };\r\n    // Let the drag handler handle this.\r\n    if (webkit) { display.scroller.draggable = true; }\r\n    cm.state.draggingText = dragEnd;\r\n    dragEnd.copy = !behavior.moveOnDrag;\r\n    on(display.wrapper.ownerDocument, "mouseup", dragEnd);\r\n    on(display.wrapper.ownerDocument, "mousemove", mouseMove);\r\n    on(display.scroller, "dragstart", dragStart);\r\n    on(display.scroller, "drop", dragEnd);\r\n\r\n    cm.state.delayingBlurEvent = true;\r\n    setTimeout(function () { return display.input.focus(); }, 20);\r\n    // IE\'s approach to draggable\r\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\r\n  }\r\n\r\n  function rangeForUnit(cm, pos, unit) {\r\n    if (unit == "char") { return new Range(pos, pos) }\r\n    if (unit == "word") { return cm.findWordAt(pos) }\r\n    if (unit == "line") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\r\n    var result = unit(cm, pos);\r\n    return new Range(result.from, result.to)\r\n  }\r\n\r\n  // Normal selection, as opposed to text dragging.\r\n  function leftButtonSelect(cm, event, start, behavior) {\r\n    if (ie) { delayBlurEvent(cm); }\r\n    var display = cm.display, doc = cm.doc;\r\n    e_preventDefault(event);\r\n\r\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\r\n    if (behavior.addNew && !behavior.extend) {\r\n      ourIndex = doc.sel.contains(start);\r\n      if (ourIndex > -1)\r\n        { ourRange = ranges[ourIndex]; }\r\n      else\r\n        { ourRange = new Range(start, start); }\r\n    } else {\r\n      ourRange = doc.sel.primary();\r\n      ourIndex = doc.sel.primIndex;\r\n    }\r\n\r\n    if (behavior.unit == "rectangle") {\r\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\r\n      start = posFromMouse(cm, event, true, true);\r\n      ourIndex = -1;\r\n    } else {\r\n      var range = rangeForUnit(cm, start, behavior.unit);\r\n      if (behavior.extend)\r\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\r\n      else\r\n        { ourRange = range; }\r\n    }\r\n\r\n    if (!behavior.addNew) {\r\n      ourIndex = 0;\r\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\r\n      startSel = doc.sel;\r\n    } else if (ourIndex == -1) {\r\n      ourIndex = ranges.length;\r\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\r\n                   {scroll: false, origin: "*mouse"});\r\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == "char" && !behavior.extend) {\r\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\r\n                   {scroll: false, origin: "*mouse"});\r\n      startSel = doc.sel;\r\n    } else {\r\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\r\n    }\r\n\r\n    var lastPos = start;\r\n    function extendTo(pos) {\r\n      if (cmp(lastPos, pos) == 0) { return }\r\n      lastPos = pos;\r\n\r\n      if (behavior.unit == "rectangle") {\r\n        var ranges = [], tabSize = cm.options.tabSize;\r\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\r\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\r\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\r\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\r\n             line <= end; line++) {\r\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\r\n          if (left == right)\r\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\r\n          else if (text.length > leftPos)\r\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\r\n        }\r\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\r\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\r\n                     {origin: "*mouse", scroll: false});\r\n        cm.scrollIntoView(pos);\r\n      } else {\r\n        var oldRange = ourRange;\r\n        var range = rangeForUnit(cm, pos, behavior.unit);\r\n        var anchor = oldRange.anchor, head;\r\n        if (cmp(range.anchor, anchor) > 0) {\r\n          head = range.head;\r\n          anchor = minPos(oldRange.from(), range.anchor);\r\n        } else {\r\n          head = range.anchor;\r\n          anchor = maxPos(oldRange.to(), range.head);\r\n        }\r\n        var ranges$1 = startSel.ranges.slice(0);\r\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\r\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\r\n      }\r\n    }\r\n\r\n    var editorSize = display.wrapper.getBoundingClientRect();\r\n    // Used to ensure timeout re-tries don\'t fire when another extend\r\n    // happened in the meantime (clearTimeout isn\'t reliable -- at\r\n    // least on Chrome, the timeouts still happen even when cleared,\r\n    // if the clear happens after their scheduled firing time).\r\n    var counter = 0;\r\n\r\n    function extend(e) {\r\n      var curCount = ++counter;\r\n      var cur = posFromMouse(cm, e, true, behavior.unit == "rectangle");\r\n      if (!cur) { return }\r\n      if (cmp(cur, lastPos) != 0) {\r\n        cm.curOp.focus = activeElt(root(cm));\r\n        extendTo(cur);\r\n        var visible = visibleLines(display, doc);\r\n        if (cur.line >= visible.to || cur.line < visible.from)\r\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\r\n      } else {\r\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\r\n        if (outside) { setTimeout(operation(cm, function () {\r\n          if (counter != curCount) { return }\r\n          display.scroller.scrollTop += outside;\r\n          extend(e);\r\n        }), 50); }\r\n      }\r\n    }\r\n\r\n    function done(e) {\r\n      cm.state.selectingText = false;\r\n      counter = Infinity;\r\n      // If e is null or undefined we interpret this as someone trying\r\n      // to explicitly cancel the selection rather than the user\r\n      // letting go of the mouse button.\r\n      if (e) {\r\n        e_preventDefault(e);\r\n        display.input.focus();\r\n      }\r\n      off(display.wrapper.ownerDocument, "mousemove", move);\r\n      off(display.wrapper.ownerDocument, "mouseup", up);\r\n      doc.history.lastSelOrigin = null;\r\n    }\r\n\r\n    var move = operation(cm, function (e) {\r\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\r\n      else { extend(e); }\r\n    });\r\n    var up = operation(cm, done);\r\n    cm.state.selectingText = up;\r\n    on(display.wrapper.ownerDocument, "mousemove", move);\r\n    on(display.wrapper.ownerDocument, "mouseup", up);\r\n  }\r\n\r\n  // Used when mouse-selecting to adjust the anchor to the proper side\r\n  // of a bidi jump depending on the visual position of the head.\r\n  function bidiSimplify(cm, range) {\r\n    var anchor = range.anchor;\r\n    var head = range.head;\r\n    var anchorLine = getLine(cm.doc, anchor.line);\r\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\r\n    var order = getOrder(anchorLine);\r\n    if (!order) { return range }\r\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\r\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\r\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\r\n    if (boundary == 0 || boundary == order.length) { return range }\r\n\r\n    // Compute the relative visual position of the head compared to the\r\n    // anchor (<0 is to the left, >0 to the right)\r\n    var leftSide;\r\n    if (head.line != anchor.line) {\r\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == "ltr" ? 1 : -1) > 0;\r\n    } else {\r\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\r\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\r\n      if (headIndex == boundary - 1 || headIndex == boundary)\r\n        { leftSide = dir < 0; }\r\n      else\r\n        { leftSide = dir > 0; }\r\n    }\r\n\r\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\r\n    var from = leftSide == (usePart.level == 1);\r\n    var ch = from ? usePart.from : usePart.to, sticky = from ? "after" : "before";\r\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\r\n  }\r\n\r\n\r\n  // Determines whether an event happened in the gutter, and fires the\r\n  // handlers for the corresponding event.\r\n  function gutterEvent(cm, e, type, prevent) {\r\n    var mX, mY;\r\n    if (e.touches) {\r\n      mX = e.touches[0].clientX;\r\n      mY = e.touches[0].clientY;\r\n    } else {\r\n      try { mX = e.clientX; mY = e.clientY; }\r\n      catch(e$1) { return false }\r\n    }\r\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\r\n    if (prevent) { e_preventDefault(e); }\r\n\r\n    var display = cm.display;\r\n    var lineBox = display.lineDiv.getBoundingClientRect();\r\n\r\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\r\n    mY -= lineBox.top - display.viewOffset;\r\n\r\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\r\n      var g = display.gutters.childNodes[i];\r\n      if (g && g.getBoundingClientRect().right >= mX) {\r\n        var line = lineAtHeight(cm.doc, mY);\r\n        var gutter = cm.display.gutterSpecs[i];\r\n        signal(cm, type, cm, line, gutter.className, e);\r\n        return e_defaultPrevented(e)\r\n      }\r\n    }\r\n  }\r\n\r\n  function clickInGutter(cm, e) {\r\n    return gutterEvent(cm, e, "gutterClick", true)\r\n  }\r\n\r\n  // CONTEXT MENU HANDLING\r\n\r\n  // To make the context menu work, we need to briefly unhide the\r\n  // textarea (making it as unobtrusive as possible) to let the\r\n  // right-click take effect on it.\r\n  function onContextMenu(cm, e) {\r\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\r\n    if (signalDOMEvent(cm, e, "contextmenu")) { return }\r\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\r\n  }\r\n\r\n  function contextMenuInGutter(cm, e) {\r\n    if (!hasHandler(cm, "gutterContextMenu")) { return false }\r\n    return gutterEvent(cm, e, "gutterContextMenu", false)\r\n  }\r\n\r\n  function themeChanged(cm) {\r\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, "") +\r\n      cm.options.theme.replace(/(^|\\s)\\s*/g, " cm-s-");\r\n    clearCaches(cm);\r\n  }\r\n\r\n  var Init = {toString: function(){return "CodeMirror.Init"}};\r\n\r\n  var defaults = {};\r\n  var optionHandlers = {};\r\n\r\n  function defineOptions(CodeMirror) {\r\n    var optionHandlers = CodeMirror.optionHandlers;\r\n\r\n    function option(name, deflt, handle, notOnInit) {\r\n      CodeMirror.defaults[name] = deflt;\r\n      if (handle) { optionHandlers[name] =\r\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\r\n    }\r\n\r\n    CodeMirror.defineOption = option;\r\n\r\n    // Passed to option handlers when there is no old value.\r\n    CodeMirror.Init = Init;\r\n\r\n    // These two are, on init, called from the constructor because they\r\n    // have to be initialized before the editor can start at all.\r\n    option("value", "", function (cm, val) { return cm.setValue(val); }, true);\r\n    option("mode", null, function (cm, val) {\r\n      cm.doc.modeOption = val;\r\n      loadMode(cm);\r\n    }, true);\r\n\r\n    option("indentUnit", 2, loadMode, true);\r\n    option("indentWithTabs", false);\r\n    option("smartIndent", true);\r\n    option("tabSize", 4, function (cm) {\r\n      resetModeState(cm);\r\n      clearCaches(cm);\r\n      regChange(cm);\r\n    }, true);\r\n\r\n    option("lineSeparator", null, function (cm, val) {\r\n      cm.doc.lineSep = val;\r\n      if (!val) { return }\r\n      var newBreaks = [], lineNo = cm.doc.first;\r\n      cm.doc.iter(function (line) {\r\n        for (var pos = 0;;) {\r\n          var found = line.text.indexOf(val, pos);\r\n          if (found == -1) { break }\r\n          pos = found + val.length;\r\n          newBreaks.push(Pos(lineNo, found));\r\n        }\r\n        lineNo++;\r\n      });\r\n      for (var i = newBreaks.length - 1; i >= 0; i--)\r\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\r\n    });\r\n    option("specialChars", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b\\u200e\\u200f\\u2028\\u2029\\u202d\\u202e\\u2066\\u2067\\u2069\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\r\n      cm.state.specialChars = new RegExp(val.source + (val.test("\\t") ? "" : "|\\t"), "g");\r\n      if (old != Init) { cm.refresh(); }\r\n    });\r\n    option("specialCharPlaceholder", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\r\n    option("electricChars", true);\r\n    option("inputStyle", mobile ? "contenteditable" : "textarea", function () {\r\n      throw new Error("inputStyle can not (yet) be changed in a running editor") // FIXME\r\n    }, true);\r\n    option("spellcheck", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\r\n    option("autocorrect", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\r\n    option("autocapitalize", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\r\n    option("rtlMoveVisually", !windows);\r\n    option("wholeLineUpdateBefore", true);\r\n\r\n    option("theme", "default", function (cm) {\r\n      themeChanged(cm);\r\n      updateGutters(cm);\r\n    }, true);\r\n    option("keyMap", "default", function (cm, val, old) {\r\n      var next = getKeyMap(val);\r\n      var prev = old != Init && getKeyMap(old);\r\n      if (prev && prev.detach) { prev.detach(cm, next); }\r\n      if (next.attach) { next.attach(cm, prev || null); }\r\n    });\r\n    option("extraKeys", null);\r\n    option("configureMouse", null);\r\n\r\n    option("lineWrapping", false, wrappingChanged, true);\r\n    option("gutters", [], function (cm, val) {\r\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\r\n      updateGutters(cm);\r\n    }, true);\r\n    option("fixedGutter", true, function (cm, val) {\r\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + "px" : "0";\r\n      cm.refresh();\r\n    }, true);\r\n    option("coverGutterNextToScrollbar", false, function (cm) { return updateScrollbars(cm); }, true);\r\n    option("scrollbarStyle", "native", function (cm) {\r\n      initScrollbars(cm);\r\n      updateScrollbars(cm);\r\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\r\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\r\n    }, true);\r\n    option("lineNumbers", false, function (cm, val) {\r\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\r\n      updateGutters(cm);\r\n    }, true);\r\n    option("firstLineNumber", 1, updateGutters, true);\r\n    option("lineNumberFormatter", function (integer) { return integer; }, updateGutters, true);\r\n    option("showCursorWhenSelecting", false, updateSelection, true);\r\n\r\n    option("resetSelectionOnContextMenu", true);\r\n    option("lineWiseCopyCut", true);\r\n    option("pasteLinesPerSelection", true);\r\n    option("selectionsMayTouch", false);\r\n\r\n    option("readOnly", false, function (cm, val) {\r\n      if (val == "nocursor") {\r\n        onBlur(cm);\r\n        cm.display.input.blur();\r\n      }\r\n      cm.display.input.readOnlyChanged(val);\r\n    });\r\n\r\n    option("screenReaderLabel", null, function (cm, val) {\r\n      val = (val === \'\') ? null : val;\r\n      cm.display.input.screenReaderLabelChanged(val);\r\n    });\r\n\r\n    option("disableInput", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\r\n    option("dragDrop", true, dragDropChanged);\r\n    option("allowDropFileTypes", null);\r\n\r\n    option("cursorBlinkRate", 530);\r\n    option("cursorScrollMargin", 0);\r\n    option("cursorHeight", 1, updateSelection, true);\r\n    option("singleCursorHeightPerLine", true, updateSelection, true);\r\n    option("workTime", 100);\r\n    option("workDelay", 100);\r\n    option("flattenSpans", true, resetModeState, true);\r\n    option("addModeClass", false, resetModeState, true);\r\n    option("pollInterval", 100);\r\n    option("undoDepth", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\r\n    option("historyEventDelay", 1250);\r\n    option("viewportMargin", 10, function (cm) { return cm.refresh(); }, true);\r\n    option("maxHighlightLength", 10000, resetModeState, true);\r\n    option("moveInputWithCursor", true, function (cm, val) {\r\n      if (!val) { cm.display.input.resetPosition(); }\r\n    });\r\n\r\n    option("tabindex", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || ""; });\r\n    option("autofocus", null);\r\n    option("direction", "ltr", function (cm, val) { return cm.doc.setDirection(val); }, true);\r\n    option("phrases", null);\r\n  }\r\n\r\n  function dragDropChanged(cm, value, old) {\r\n    var wasOn = old && old != Init;\r\n    if (!value != !wasOn) {\r\n      var funcs = cm.display.dragFunctions;\r\n      var toggle = value ? on : off;\r\n      toggle(cm.display.scroller, "dragstart", funcs.start);\r\n      toggle(cm.display.scroller, "dragenter", funcs.enter);\r\n      toggle(cm.display.scroller, "dragover", funcs.over);\r\n      toggle(cm.display.scroller, "dragleave", funcs.leave);\r\n      toggle(cm.display.scroller, "drop", funcs.drop);\r\n    }\r\n  }\r\n\r\n  function wrappingChanged(cm) {\r\n    if (cm.options.lineWrapping) {\r\n      addClass(cm.display.wrapper, "CodeMirror-wrap");\r\n      cm.display.sizer.style.minWidth = "";\r\n      cm.display.sizerWidth = null;\r\n    } else {\r\n      rmClass(cm.display.wrapper, "CodeMirror-wrap");\r\n      findMaxLine(cm);\r\n    }\r\n    estimateLineHeights(cm);\r\n    regChange(cm);\r\n    clearCaches(cm);\r\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\r\n  }\r\n\r\n  // A CodeMirror instance represents an editor. This is the object\r\n  // that user code is usually dealing with.\r\n\r\n  function CodeMirror(place, options) {\r\n    var this$1 = this;\r\n\r\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\r\n\r\n    this.options = options = options ? copyObj(options) : {};\r\n    // Determine effective options based on given values and defaults.\r\n    copyObj(defaults, options, false);\r\n\r\n    var doc = options.value;\r\n    if (typeof doc == "string") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\r\n    else if (options.mode) { doc.modeOption = options.mode; }\r\n    this.doc = doc;\r\n\r\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\r\n    var display = this.display = new Display(place, doc, input, options);\r\n    display.wrapper.CodeMirror = this;\r\n    themeChanged(this);\r\n    if (options.lineWrapping)\r\n      { this.display.wrapper.className += " CodeMirror-wrap"; }\r\n    initScrollbars(this);\r\n\r\n    this.state = {\r\n      keyMaps: [],  // stores maps added by addKeyMap\r\n      overlays: [], // highlighting overlays, as added by addOverlay\r\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\r\n      overwrite: false,\r\n      delayingBlurEvent: false,\r\n      focused: false,\r\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\r\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\r\n      selectingText: false,\r\n      draggingText: false,\r\n      highlight: new Delayed(), // stores highlight worker timeout\r\n      keySeq: null,  // Unfinished key sequence\r\n      specialChars: null\r\n    };\r\n\r\n    if (options.autofocus && !mobile) { display.input.focus(); }\r\n\r\n    // Override magic textarea content restore that IE sometimes does\r\n    // on our hidden textarea on reload\r\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\r\n\r\n    registerEventHandlers(this);\r\n    ensureGlobalHandlers();\r\n\r\n    startOperation(this);\r\n    this.curOp.forceUpdate = true;\r\n    attachDoc(this, doc);\r\n\r\n    if ((options.autofocus && !mobile) || this.hasFocus())\r\n      { setTimeout(function () {\r\n        if (this$1.hasFocus() && !this$1.state.focused) { onFocus(this$1); }\r\n      }, 20); }\r\n    else\r\n      { onBlur(this); }\r\n\r\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\r\n      { optionHandlers[opt](this, options[opt], Init); } }\r\n    maybeUpdateLineNumberWidth(this);\r\n    if (options.finishInit) { options.finishInit(this); }\r\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\r\n    endOperation(this);\r\n    // Suppress optimizelegibility in Webkit, since it breaks text\r\n    // measuring on line wrapping boundaries.\r\n    if (webkit && options.lineWrapping &&\r\n        getComputedStyle(display.lineDiv).textRendering == "optimizelegibility")\r\n      { display.lineDiv.style.textRendering = "auto"; }\r\n  }\r\n\r\n  // The default configuration options.\r\n  CodeMirror.defaults = defaults;\r\n  // Functions to run when options are changed.\r\n  CodeMirror.optionHandlers = optionHandlers;\r\n\r\n  // Attach the necessary event handlers when initializing the editor\r\n  function registerEventHandlers(cm) {\r\n    var d = cm.display;\r\n    on(d.scroller, "mousedown", operation(cm, onMouseDown));\r\n    // Older IE\'s will not fire a second mousedown for a double click\r\n    if (ie && ie_version < 11)\r\n      { on(d.scroller, "dblclick", operation(cm, function (e) {\r\n        if (signalDOMEvent(cm, e)) { return }\r\n        var pos = posFromMouse(cm, e);\r\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\r\n        e_preventDefault(e);\r\n        var word = cm.findWordAt(pos);\r\n        extendSelection(cm.doc, word.anchor, word.head);\r\n      })); }\r\n    else\r\n      { on(d.scroller, "dblclick", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\r\n    // Some browsers fire contextmenu *after* opening the menu, at\r\n    // which point we can\'t mess with it anymore. Context menu is\r\n    // handled in onMouseDown for these browsers.\r\n    on(d.scroller, "contextmenu", function (e) { return onContextMenu(cm, e); });\r\n    on(d.input.getField(), "contextmenu", function (e) {\r\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\r\n    });\r\n\r\n    // Used to suppress mouse event handling when a touch happens\r\n    var touchFinished, prevTouch = {end: 0};\r\n    function finishTouch() {\r\n      if (d.activeTouch) {\r\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\r\n        prevTouch = d.activeTouch;\r\n        prevTouch.end = +new Date;\r\n      }\r\n    }\r\n    function isMouseLikeTouchEvent(e) {\r\n      if (e.touches.length != 1) { return false }\r\n      var touch = e.touches[0];\r\n      return touch.radiusX <= 1 && touch.radiusY <= 1\r\n    }\r\n    function farAway(touch, other) {\r\n      if (other.left == null) { return true }\r\n      var dx = other.left - touch.left, dy = other.top - touch.top;\r\n      return dx * dx + dy * dy > 20 * 20\r\n    }\r\n    on(d.scroller, "touchstart", function (e) {\r\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\r\n        d.input.ensurePolled();\r\n        clearTimeout(touchFinished);\r\n        var now = +new Date;\r\n        d.activeTouch = {start: now, moved: false,\r\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\r\n        if (e.touches.length == 1) {\r\n          d.activeTouch.left = e.touches[0].pageX;\r\n          d.activeTouch.top = e.touches[0].pageY;\r\n        }\r\n      }\r\n    });\r\n    on(d.scroller, "touchmove", function () {\r\n      if (d.activeTouch) { d.activeTouch.moved = true; }\r\n    });\r\n    on(d.scroller, "touchend", function (e) {\r\n      var touch = d.activeTouch;\r\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\r\n          !touch.moved && new Date - touch.start < 300) {\r\n        var pos = cm.coordsChar(d.activeTouch, "page"), range;\r\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\r\n          { range = new Range(pos, pos); }\r\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\r\n          { range = cm.findWordAt(pos); }\r\n        else // Triple tap\r\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\r\n        cm.setSelection(range.anchor, range.head);\r\n        cm.focus();\r\n        e_preventDefault(e);\r\n      }\r\n      finishTouch();\r\n    });\r\n    on(d.scroller, "touchcancel", finishTouch);\r\n\r\n    // Sync scrolling between fake scrollbars and real scrollable\r\n    // area, ensure viewport is updated when scrolling.\r\n    on(d.scroller, "scroll", function () {\r\n      if (d.scroller.clientHeight) {\r\n        updateScrollTop(cm, d.scroller.scrollTop);\r\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\r\n        signal(cm, "scroll", cm);\r\n      }\r\n    });\r\n\r\n    // Listen to wheel events in order to try and update the viewport on time.\r\n    on(d.scroller, "mousewheel", function (e) { return onScrollWheel(cm, e); });\r\n    on(d.scroller, "DOMMouseScroll", function (e) { return onScrollWheel(cm, e); });\r\n\r\n    // Prevent wrapper from ever scrolling\r\n    on(d.wrapper, "scroll", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\r\n\r\n    d.dragFunctions = {\r\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\r\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\r\n      start: function (e) { return onDragStart(cm, e); },\r\n      drop: operation(cm, onDrop),\r\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\r\n    };\r\n\r\n    var inp = d.input.getField();\r\n    on(inp, "keyup", function (e) { return onKeyUp.call(cm, e); });\r\n    on(inp, "keydown", operation(cm, onKeyDown));\r\n    on(inp, "keypress", operation(cm, onKeyPress));\r\n    on(inp, "focus", function (e) { return onFocus(cm, e); });\r\n    on(inp, "blur", function (e) { return onBlur(cm, e); });\r\n  }\r\n\r\n  var initHooks = [];\r\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\r\n\r\n  // Indent the given line. The how parameter can be "smart",\r\n  // "add"/null, "subtract", or "prev". When aggressive is false\r\n  // (typically set to true for forced single-line indents), empty\r\n  // lines are not indented, and places where the mode returns Pass\r\n  // are left alone.\r\n  function indentLine(cm, n, how, aggressive) {\r\n    var doc = cm.doc, state;\r\n    if (how == null) { how = "add"; }\r\n    if (how == "smart") {\r\n      // Fall back to "prev" when the mode doesn\'t have an indentation\r\n      // method.\r\n      if (!doc.mode.indent) { how = "prev"; }\r\n      else { state = getContextBefore(cm, n).state; }\r\n    }\r\n\r\n    var tabSize = cm.options.tabSize;\r\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\r\n    if (line.stateAfter) { line.stateAfter = null; }\r\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\r\n    if (!aggressive && !/\\S/.test(line.text)) {\r\n      indentation = 0;\r\n      how = "not";\r\n    } else if (how == "smart") {\r\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\r\n      if (indentation == Pass || indentation > 150) {\r\n        if (!aggressive) { return }\r\n        how = "prev";\r\n      }\r\n    }\r\n    if (how == "prev") {\r\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\r\n      else { indentation = 0; }\r\n    } else if (how == "add") {\r\n      indentation = curSpace + cm.options.indentUnit;\r\n    } else if (how == "subtract") {\r\n      indentation = curSpace - cm.options.indentUnit;\r\n    } else if (typeof how == "number") {\r\n      indentation = curSpace + how;\r\n    }\r\n    indentation = Math.max(0, indentation);\r\n\r\n    var indentString = "", pos = 0;\r\n    if (cm.options.indentWithTabs)\r\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += "\\t";} }\r\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\r\n\r\n    if (indentString != curSpaceString) {\r\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), "+input");\r\n      line.stateAfter = null;\r\n      return true\r\n    } else {\r\n      // Ensure that, if the cursor was in the whitespace at the start\r\n      // of the line, it is moved to the end of that space.\r\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\r\n        var range = doc.sel.ranges[i$1];\r\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\r\n          var pos$1 = Pos(n, curSpaceString.length);\r\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\r\n          break\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // This will be set to a {lineWise: bool, text: [string]} object, so\r\n  // that, when pasting, we know what kind of selections the copied\r\n  // text was made out of.\r\n  var lastCopied = null;\r\n\r\n  function setLastCopied(newLastCopied) {\r\n    lastCopied = newLastCopied;\r\n  }\r\n\r\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\r\n    var doc = cm.doc;\r\n    cm.display.shift = false;\r\n    if (!sel) { sel = doc.sel; }\r\n\r\n    var recent = +new Date - 200;\r\n    var paste = origin == "paste" || cm.state.pasteIncoming > recent;\r\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\r\n    // When pasting N lines into N selections, insert one line per selection\r\n    if (paste && sel.ranges.length > 1) {\r\n      if (lastCopied && lastCopied.text.join("\\n") == inserted) {\r\n        if (sel.ranges.length % lastCopied.text.length == 0) {\r\n          multiPaste = [];\r\n          for (var i = 0; i < lastCopied.text.length; i++)\r\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\r\n        }\r\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\r\n        multiPaste = map(textLines, function (l) { return [l]; });\r\n      }\r\n    }\r\n\r\n    var updateInput = cm.curOp.updateInput;\r\n    // Normal behavior is to insert the new text into every selection\r\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\r\n      var range = sel.ranges[i$1];\r\n      var from = range.from(), to = range.to();\r\n      if (range.empty()) {\r\n        if (deleted && deleted > 0) // Handle deletion\r\n          { from = Pos(from.line, from.ch - deleted); }\r\n        else if (cm.state.overwrite && !paste) // Handle overwrite\r\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\r\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join("\\n") == textLines.join("\\n"))\r\n          { from = to = Pos(from.line, 0); }\r\n      }\r\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\r\n                         origin: origin || (paste ? "paste" : cm.state.cutIncoming > recent ? "cut" : "+input")};\r\n      makeChange(cm.doc, changeEvent);\r\n      signalLater(cm, "inputRead", cm, changeEvent);\r\n    }\r\n    if (inserted && !paste)\r\n      { triggerElectric(cm, inserted); }\r\n\r\n    ensureCursorVisible(cm);\r\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\r\n    cm.curOp.typing = true;\r\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\r\n  }\r\n\r\n  function handlePaste(e, cm) {\r\n    var pasted = e.clipboardData && e.clipboardData.getData("Text");\r\n    if (pasted) {\r\n      e.preventDefault();\r\n      if (!cm.isReadOnly() && !cm.options.disableInput && cm.hasFocus())\r\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, "paste"); }); }\r\n      return true\r\n    }\r\n  }\r\n\r\n  function triggerElectric(cm, inserted) {\r\n    // When an \'electric\' character is inserted, immediately trigger a reindent\r\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\r\n    var sel = cm.doc.sel;\r\n\r\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\r\n      var range = sel.ranges[i];\r\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\r\n      var mode = cm.getModeAt(range.head);\r\n      var indented = false;\r\n      if (mode.electricChars) {\r\n        for (var j = 0; j < mode.electricChars.length; j++)\r\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\r\n            indented = indentLine(cm, range.head.line, "smart");\r\n            break\r\n          } }\r\n      } else if (mode.electricInput) {\r\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\r\n          { indented = indentLine(cm, range.head.line, "smart"); }\r\n      }\r\n      if (indented) { signalLater(cm, "electricInput", cm, range.head.line); }\r\n    }\r\n  }\r\n\r\n  function copyableRanges(cm) {\r\n    var text = [], ranges = [];\r\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\r\n      var line = cm.doc.sel.ranges[i].head.line;\r\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\r\n      ranges.push(lineRange);\r\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\r\n    }\r\n    return {text: text, ranges: ranges}\r\n  }\r\n\r\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\r\n    field.setAttribute("autocorrect", autocorrect ? "on" : "off");\r\n    field.setAttribute("autocapitalize", autocapitalize ? "on" : "off");\r\n    field.setAttribute("spellcheck", !!spellcheck);\r\n  }\r\n\r\n  function hiddenTextarea() {\r\n    var te = elt("textarea", null, null, "position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none");\r\n    var div = elt("div", [te], null, "overflow: hidden; position: relative; width: 3px; height: 0px;");\r\n    // The textarea is kept positioned near the cursor to prevent the\r\n    // fact that it\'ll be scrolled into view on input from scrolling\r\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\r\n    // very slow. So make the area wide instead.\r\n    if (webkit) { te.style.width = "1000px"; }\r\n    else { te.setAttribute("wrap", "off"); }\r\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\r\n    if (ios) { te.style.border = "1px solid black"; }\r\n    return div\r\n  }\r\n\r\n  // The publicly visible API. Note that methodOp(f) means\r\n  // \'wrap f in an operation, performed on its `this` parameter\'.\r\n\r\n  // This is not the complete set of editor methods. Most of the\r\n  // methods defined on the Doc type are also injected into\r\n  // CodeMirror.prototype, for backwards compatibility and\r\n  // convenience.\r\n\r\n  function addEditorMethods(CodeMirror) {\r\n    var optionHandlers = CodeMirror.optionHandlers;\r\n\r\n    var helpers = CodeMirror.helpers = {};\r\n\r\n    CodeMirror.prototype = {\r\n      constructor: CodeMirror,\r\n      focus: function(){win(this).focus(); this.display.input.focus();},\r\n\r\n      setOption: function(option, value) {\r\n        var options = this.options, old = options[option];\r\n        if (options[option] == value && option != "mode") { return }\r\n        options[option] = value;\r\n        if (optionHandlers.hasOwnProperty(option))\r\n          { operation(this, optionHandlers[option])(this, value, old); }\r\n        signal(this, "optionChange", this, option);\r\n      },\r\n\r\n      getOption: function(option) {return this.options[option]},\r\n      getDoc: function() {return this.doc},\r\n\r\n      addKeyMap: function(map, bottom) {\r\n        this.state.keyMaps[bottom ? "push" : "unshift"](getKeyMap(map));\r\n      },\r\n      removeKeyMap: function(map) {\r\n        var maps = this.state.keyMaps;\r\n        for (var i = 0; i < maps.length; ++i)\r\n          { if (maps[i] == map || maps[i].name == map) {\r\n            maps.splice(i, 1);\r\n            return true\r\n          } }\r\n      },\r\n\r\n      addOverlay: methodOp(function(spec, options) {\r\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\r\n        if (mode.startState) { throw new Error("Overlays may not be stateful.") }\r\n        insertSorted(this.state.overlays,\r\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\r\n                      priority: (options && options.priority) || 0},\r\n                     function (overlay) { return overlay.priority; });\r\n        this.state.modeGen++;\r\n        regChange(this);\r\n      }),\r\n      removeOverlay: methodOp(function(spec) {\r\n        var overlays = this.state.overlays;\r\n        for (var i = 0; i < overlays.length; ++i) {\r\n          var cur = overlays[i].modeSpec;\r\n          if (cur == spec || typeof spec == "string" && cur.name == spec) {\r\n            overlays.splice(i, 1);\r\n            this.state.modeGen++;\r\n            regChange(this);\r\n            return\r\n          }\r\n        }\r\n      }),\r\n\r\n      indentLine: methodOp(function(n, dir, aggressive) {\r\n        if (typeof dir != "string" && typeof dir != "number") {\r\n          if (dir == null) { dir = this.options.smartIndent ? "smart" : "prev"; }\r\n          else { dir = dir ? "add" : "subtract"; }\r\n        }\r\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\r\n      }),\r\n      indentSelection: methodOp(function(how) {\r\n        var ranges = this.doc.sel.ranges, end = -1;\r\n        for (var i = 0; i < ranges.length; i++) {\r\n          var range = ranges[i];\r\n          if (!range.empty()) {\r\n            var from = range.from(), to = range.to();\r\n            var start = Math.max(end, from.line);\r\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\r\n            for (var j = start; j < end; ++j)\r\n              { indentLine(this, j, how); }\r\n            var newRanges = this.doc.sel.ranges;\r\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\r\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\r\n          } else if (range.head.line > end) {\r\n            indentLine(this, range.head.line, how, true);\r\n            end = range.head.line;\r\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\r\n          }\r\n        }\r\n      }),\r\n\r\n      // Fetch the parser token for a given character. Useful for hacks\r\n      // that want to inspect the mode state (say, for completion).\r\n      getTokenAt: function(pos, precise) {\r\n        return takeToken(this, pos, precise)\r\n      },\r\n\r\n      getLineTokens: function(line, precise) {\r\n        return takeToken(this, Pos(line), precise, true)\r\n      },\r\n\r\n      getTokenTypeAt: function(pos) {\r\n        pos = clipPos(this.doc, pos);\r\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\r\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\r\n        var type;\r\n        if (ch == 0) { type = styles[2]; }\r\n        else { for (;;) {\r\n          var mid = (before + after) >> 1;\r\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\r\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\r\n          else { type = styles[mid * 2 + 2]; break }\r\n        } }\r\n        var cut = type ? type.indexOf("overlay ") : -1;\r\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\r\n      },\r\n\r\n      getModeAt: function(pos) {\r\n        var mode = this.doc.mode;\r\n        if (!mode.innerMode) { return mode }\r\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\r\n      },\r\n\r\n      getHelper: function(pos, type) {\r\n        return this.getHelpers(pos, type)[0]\r\n      },\r\n\r\n      getHelpers: function(pos, type) {\r\n        var found = [];\r\n        if (!helpers.hasOwnProperty(type)) { return found }\r\n        var help = helpers[type], mode = this.getModeAt(pos);\r\n        if (typeof mode[type] == "string") {\r\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\r\n        } else if (mode[type]) {\r\n          for (var i = 0; i < mode[type].length; i++) {\r\n            var val = help[mode[type][i]];\r\n            if (val) { found.push(val); }\r\n          }\r\n        } else if (mode.helperType && help[mode.helperType]) {\r\n          found.push(help[mode.helperType]);\r\n        } else if (help[mode.name]) {\r\n          found.push(help[mode.name]);\r\n        }\r\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\r\n          var cur = help._global[i$1];\r\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\r\n            { found.push(cur.val); }\r\n        }\r\n        return found\r\n      },\r\n\r\n      getStateAfter: function(line, precise) {\r\n        var doc = this.doc;\r\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\r\n        return getContextBefore(this, line + 1, precise).state\r\n      },\r\n\r\n      cursorCoords: function(start, mode) {\r\n        var pos, range = this.doc.sel.primary();\r\n        if (start == null) { pos = range.head; }\r\n        else if (typeof start == "object") { pos = clipPos(this.doc, start); }\r\n        else { pos = start ? range.from() : range.to(); }\r\n        return cursorCoords(this, pos, mode || "page")\r\n      },\r\n\r\n      charCoords: function(pos, mode) {\r\n        return charCoords(this, clipPos(this.doc, pos), mode || "page")\r\n      },\r\n\r\n      coordsChar: function(coords, mode) {\r\n        coords = fromCoordSystem(this, coords, mode || "page");\r\n        return coordsChar(this, coords.left, coords.top)\r\n      },\r\n\r\n      lineAtHeight: function(height, mode) {\r\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || "page").top;\r\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\r\n      },\r\n      heightAtLine: function(line, mode, includeWidgets) {\r\n        var end = false, lineObj;\r\n        if (typeof line == "number") {\r\n          var last = this.doc.first + this.doc.size - 1;\r\n          if (line < this.doc.first) { line = this.doc.first; }\r\n          else if (line > last) { line = last; end = true; }\r\n          lineObj = getLine(this.doc, line);\r\n        } else {\r\n          lineObj = line;\r\n        }\r\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || "page", includeWidgets || end).top +\r\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\r\n      },\r\n\r\n      defaultTextHeight: function() { return textHeight(this.display) },\r\n      defaultCharWidth: function() { return charWidth(this.display) },\r\n\r\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\r\n\r\n      addWidget: function(pos, node, scroll, vert, horiz) {\r\n        var display = this.display;\r\n        pos = cursorCoords(this, clipPos(this.doc, pos));\r\n        var top = pos.bottom, left = pos.left;\r\n        node.style.position = "absolute";\r\n        node.setAttribute("cm-ignore-events", "true");\r\n        this.display.input.setUneditable(node);\r\n        display.sizer.appendChild(node);\r\n        if (vert == "over") {\r\n          top = pos.top;\r\n        } else if (vert == "above" || vert == "near") {\r\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\r\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\r\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\r\n          if ((vert == \'above\' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\r\n            { top = pos.top - node.offsetHeight; }\r\n          else if (pos.bottom + node.offsetHeight <= vspace)\r\n            { top = pos.bottom; }\r\n          if (left + node.offsetWidth > hspace)\r\n            { left = hspace - node.offsetWidth; }\r\n        }\r\n        node.style.top = top + "px";\r\n        node.style.left = node.style.right = "";\r\n        if (horiz == "right") {\r\n          left = display.sizer.clientWidth - node.offsetWidth;\r\n          node.style.right = "0px";\r\n        } else {\r\n          if (horiz == "left") { left = 0; }\r\n          else if (horiz == "middle") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\r\n          node.style.left = left + "px";\r\n        }\r\n        if (scroll)\r\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\r\n      },\r\n\r\n      triggerOnKeyDown: methodOp(onKeyDown),\r\n      triggerOnKeyPress: methodOp(onKeyPress),\r\n      triggerOnKeyUp: onKeyUp,\r\n      triggerOnMouseDown: methodOp(onMouseDown),\r\n\r\n      execCommand: function(cmd) {\r\n        if (commands.hasOwnProperty(cmd))\r\n          { return commands[cmd].call(null, this) }\r\n      },\r\n\r\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\r\n\r\n      findPosH: function(from, amount, unit, visually) {\r\n        var dir = 1;\r\n        if (amount < 0) { dir = -1; amount = -amount; }\r\n        var cur = clipPos(this.doc, from);\r\n        for (var i = 0; i < amount; ++i) {\r\n          cur = findPosH(this.doc, cur, dir, unit, visually);\r\n          if (cur.hitSide) { break }\r\n        }\r\n        return cur\r\n      },\r\n\r\n      moveH: methodOp(function(dir, unit) {\r\n        var this$1 = this;\r\n\r\n        this.extendSelectionsBy(function (range) {\r\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\r\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\r\n          else\r\n            { return dir < 0 ? range.from() : range.to() }\r\n        }, sel_move);\r\n      }),\r\n\r\n      deleteH: methodOp(function(dir, unit) {\r\n        var sel = this.doc.sel, doc = this.doc;\r\n        if (sel.somethingSelected())\r\n          { doc.replaceSelection("", null, "+delete"); }\r\n        else\r\n          { deleteNearSelection(this, function (range) {\r\n            var other = findPosH(doc, range.head, dir, unit, false);\r\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\r\n          }); }\r\n      }),\r\n\r\n      findPosV: function(from, amount, unit, goalColumn) {\r\n        var dir = 1, x = goalColumn;\r\n        if (amount < 0) { dir = -1; amount = -amount; }\r\n        var cur = clipPos(this.doc, from);\r\n        for (var i = 0; i < amount; ++i) {\r\n          var coords = cursorCoords(this, cur, "div");\r\n          if (x == null) { x = coords.left; }\r\n          else { coords.left = x; }\r\n          cur = findPosV(this, coords, dir, unit);\r\n          if (cur.hitSide) { break }\r\n        }\r\n        return cur\r\n      },\r\n\r\n      moveV: methodOp(function(dir, unit) {\r\n        var this$1 = this;\r\n\r\n        var doc = this.doc, goals = [];\r\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\r\n        doc.extendSelectionsBy(function (range) {\r\n          if (collapse)\r\n            { return dir < 0 ? range.from() : range.to() }\r\n          var headPos = cursorCoords(this$1, range.head, "div");\r\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\r\n          goals.push(headPos.left);\r\n          var pos = findPosV(this$1, headPos, dir, unit);\r\n          if (unit == "page" && range == doc.sel.primary())\r\n            { addToScrollTop(this$1, charCoords(this$1, pos, "div").top - headPos.top); }\r\n          return pos\r\n        }, sel_move);\r\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\r\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\r\n      }),\r\n\r\n      // Find the word at the given position (as returned by coordsChar).\r\n      findWordAt: function(pos) {\r\n        var doc = this.doc, line = getLine(doc, pos.line).text;\r\n        var start = pos.ch, end = pos.ch;\r\n        if (line) {\r\n          var helper = this.getHelper(pos, "wordChars");\r\n          if ((pos.sticky == "before" || end == line.length) && start) { --start; } else { ++end; }\r\n          var startChar = line.charAt(start);\r\n          var check = isWordChar(startChar, helper)\r\n            ? function (ch) { return isWordChar(ch, helper); }\r\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\r\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\r\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\r\n          while (end < line.length && check(line.charAt(end))) { ++end; }\r\n        }\r\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\r\n      },\r\n\r\n      toggleOverwrite: function(value) {\r\n        if (value != null && value == this.state.overwrite) { return }\r\n        if (this.state.overwrite = !this.state.overwrite)\r\n          { addClass(this.display.cursorDiv, "CodeMirror-overwrite"); }\r\n        else\r\n          { rmClass(this.display.cursorDiv, "CodeMirror-overwrite"); }\r\n\r\n        signal(this, "overwriteToggle", this, this.state.overwrite);\r\n      },\r\n      hasFocus: function() { return this.display.input.getField() == activeElt(root(this)) },\r\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\r\n\r\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\r\n      getScrollInfo: function() {\r\n        var scroller = this.display.scroller;\r\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\r\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\r\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\r\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\r\n      },\r\n\r\n      scrollIntoView: methodOp(function(range, margin) {\r\n        if (range == null) {\r\n          range = {from: this.doc.sel.primary().head, to: null};\r\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\r\n        } else if (typeof range == "number") {\r\n          range = {from: Pos(range, 0), to: null};\r\n        } else if (range.from == null) {\r\n          range = {from: range, to: null};\r\n        }\r\n        if (!range.to) { range.to = range.from; }\r\n        range.margin = margin || 0;\r\n\r\n        if (range.from.line != null) {\r\n          scrollToRange(this, range);\r\n        } else {\r\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\r\n        }\r\n      }),\r\n\r\n      setSize: methodOp(function(width, height) {\r\n        var this$1 = this;\r\n\r\n        var interpret = function (val) { return typeof val == "number" || /^\\d+$/.test(String(val)) ? val + "px" : val; };\r\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\r\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\r\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\r\n        var lineNo = this.display.viewFrom;\r\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\r\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\r\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, "widget"); break } } }\r\n          ++lineNo;\r\n        });\r\n        this.curOp.forceUpdate = true;\r\n        signal(this, "refresh", this);\r\n      }),\r\n\r\n      operation: function(f){return runInOp(this, f)},\r\n      startOperation: function(){return startOperation(this)},\r\n      endOperation: function(){return endOperation(this)},\r\n\r\n      refresh: methodOp(function() {\r\n        var oldHeight = this.display.cachedTextHeight;\r\n        regChange(this);\r\n        this.curOp.forceUpdate = true;\r\n        clearCaches(this);\r\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\r\n        updateGutterSpace(this.display);\r\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5 || this.options.lineWrapping)\r\n          { estimateLineHeights(this); }\r\n        signal(this, "refresh", this);\r\n      }),\r\n\r\n      swapDoc: methodOp(function(doc) {\r\n        var old = this.doc;\r\n        old.cm = null;\r\n        // Cancel the current text selection if any (#5821)\r\n        if (this.state.selectingText) { this.state.selectingText(); }\r\n        attachDoc(this, doc);\r\n        clearCaches(this);\r\n        this.display.input.reset();\r\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\r\n        this.curOp.forceScroll = true;\r\n        signalLater(this, "swapDoc", this, old);\r\n        return old\r\n      }),\r\n\r\n      phrase: function(phraseText) {\r\n        var phrases = this.options.phrases;\r\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\r\n      },\r\n\r\n      getInputField: function(){return this.display.input.getField()},\r\n      getWrapperElement: function(){return this.display.wrapper},\r\n      getScrollerElement: function(){return this.display.scroller},\r\n      getGutterElement: function(){return this.display.gutters}\r\n    };\r\n    eventMixin(CodeMirror);\r\n\r\n    CodeMirror.registerHelper = function(type, name, value) {\r\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\r\n      helpers[type][name] = value;\r\n    };\r\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\r\n      CodeMirror.registerHelper(type, name, value);\r\n      helpers[type]._global.push({pred: predicate, val: value});\r\n    };\r\n  }\r\n\r\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\r\n  // right), unit can be "codepoint", "char", "column" (like char, but\r\n  // doesn\'t cross line boundaries), "word" (across next word), or\r\n  // "group" (to the start of next group of word or\r\n  // non-word-non-whitespace chars). The visually param controls\r\n  // whether, in right-to-left text, direction 1 means to move towards\r\n  // the next index in the string, or towards the character to the right\r\n  // of the current position. The resulting position will have a\r\n  // hitSide=true property if it reached the end of the document.\r\n  function findPosH(doc, pos, dir, unit, visually) {\r\n    var oldPos = pos;\r\n    var origDir = dir;\r\n    var lineObj = getLine(doc, pos.line);\r\n    var lineDir = visually && doc.direction == "rtl" ? -dir : dir;\r\n    function findNextLine() {\r\n      var l = pos.line + lineDir;\r\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\r\n      pos = new Pos(l, pos.ch, pos.sticky);\r\n      return lineObj = getLine(doc, l)\r\n    }\r\n    function moveOnce(boundToLine) {\r\n      var next;\r\n      if (unit == "codepoint") {\r\n        var ch = lineObj.text.charCodeAt(pos.ch + (dir > 0 ? 0 : -1));\r\n        if (isNaN(ch)) {\r\n          next = null;\r\n        } else {\r\n          var astral = dir > 0 ? ch >= 0xD800 && ch < 0xDC00 : ch >= 0xDC00 && ch < 0xDFFF;\r\n          next = new Pos(pos.line, Math.max(0, Math.min(lineObj.text.length, pos.ch + dir * (astral ? 2 : 1))), -dir);\r\n        }\r\n      } else if (visually) {\r\n        next = moveVisually(doc.cm, lineObj, pos, dir);\r\n      } else {\r\n        next = moveLogically(lineObj, pos, dir);\r\n      }\r\n      if (next == null) {\r\n        if (!boundToLine && findNextLine())\r\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\r\n        else\r\n          { return false }\r\n      } else {\r\n        pos = next;\r\n      }\r\n      return true\r\n    }\r\n\r\n    if (unit == "char" || unit == "codepoint") {\r\n      moveOnce();\r\n    } else if (unit == "column") {\r\n      moveOnce(true);\r\n    } else if (unit == "word" || unit == "group") {\r\n      var sawType = null, group = unit == "group";\r\n      var helper = doc.cm && doc.cm.getHelper(pos, "wordChars");\r\n      for (var first = true;; first = false) {\r\n        if (dir < 0 && !moveOnce(!first)) { break }\r\n        var cur = lineObj.text.charAt(pos.ch) || "\\n";\r\n        var type = isWordChar(cur, helper) ? "w"\r\n          : group && cur == "\\n" ? "n"\r\n          : !group || /\\s/.test(cur) ? null\r\n          : "p";\r\n        if (group && !first && !type) { type = "s"; }\r\n        if (sawType && sawType != type) {\r\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = "after";}\r\n          break\r\n        }\r\n\r\n        if (type) { sawType = type; }\r\n        if (dir > 0 && !moveOnce(!first)) { break }\r\n      }\r\n    }\r\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\r\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\r\n    return result\r\n  }\r\n\r\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\r\n  // "page" or "line". The resulting position will have a hitSide=true\r\n  // property if it reached the end of the document.\r\n  function findPosV(cm, pos, dir, unit) {\r\n    var doc = cm.doc, x = pos.left, y;\r\n    if (unit == "page") {\r\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, win(cm).innerHeight || doc(cm).documentElement.clientHeight);\r\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\r\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\r\n\r\n    } else if (unit == "line") {\r\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\r\n    }\r\n    var target;\r\n    for (;;) {\r\n      target = coordsChar(cm, x, y);\r\n      if (!target.outside) { break }\r\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\r\n      y += dir * 5;\r\n    }\r\n    return target\r\n  }\r\n\r\n  // CONTENTEDITABLE INPUT STYLE\r\n\r\n  var ContentEditableInput = function(cm) {\r\n    this.cm = cm;\r\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\r\n    this.polling = new Delayed();\r\n    this.composing = null;\r\n    this.gracePeriod = false;\r\n    this.readDOMTimeout = null;\r\n  };\r\n\r\n  ContentEditableInput.prototype.init = function (display) {\r\n      var this$1 = this;\r\n\r\n    var input = this, cm = input.cm;\r\n    var div = input.div = display.lineDiv;\r\n    div.contentEditable = true;\r\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\r\n\r\n    function belongsToInput(e) {\r\n      for (var t = e.target; t; t = t.parentNode) {\r\n        if (t == div) { return true }\r\n        if (/\\bCodeMirror-(?:line)?widget\\b/.test(t.className)) { break }\r\n      }\r\n      return false\r\n    }\r\n\r\n    on(div, "paste", function (e) {\r\n      if (!belongsToInput(e) || signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\r\n      // IE doesn\'t fire input events, so we schedule a read for the pasted content in this way\r\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\r\n    });\r\n\r\n    on(div, "compositionstart", function (e) {\r\n      this$1.composing = {data: e.data, done: false};\r\n    });\r\n    on(div, "compositionupdate", function (e) {\r\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\r\n    });\r\n    on(div, "compositionend", function (e) {\r\n      if (this$1.composing) {\r\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\r\n        this$1.composing.done = true;\r\n      }\r\n    });\r\n\r\n    on(div, "touchstart", function () { return input.forceCompositionEnd(); });\r\n\r\n    on(div, "input", function () {\r\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\r\n    });\r\n\r\n    function onCopyCut(e) {\r\n      if (!belongsToInput(e) || signalDOMEvent(cm, e)) { return }\r\n      if (cm.somethingSelected()) {\r\n        setLastCopied({lineWise: false, text: cm.getSelections()});\r\n        if (e.type == "cut") { cm.replaceSelection("", null, "cut"); }\r\n      } else if (!cm.options.lineWiseCopyCut) {\r\n        return\r\n      } else {\r\n        var ranges = copyableRanges(cm);\r\n        setLastCopied({lineWise: true, text: ranges.text});\r\n        if (e.type == "cut") {\r\n          cm.operation(function () {\r\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\r\n            cm.replaceSelection("", null, "cut");\r\n          });\r\n        }\r\n      }\r\n      if (e.clipboardData) {\r\n        e.clipboardData.clearData();\r\n        var content = lastCopied.text.join("\\n");\r\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\r\n        e.clipboardData.setData("Text", content);\r\n        if (e.clipboardData.getData("Text") == content) {\r\n          e.preventDefault();\r\n          return\r\n        }\r\n      }\r\n      // Old-fashioned briefly-focus-a-textarea hack\r\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\r\n      disableBrowserMagic(te);\r\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\r\n      te.value = lastCopied.text.join("\\n");\r\n      var hadFocus = activeElt(rootNode(div));\r\n      selectInput(te);\r\n      setTimeout(function () {\r\n        cm.display.lineSpace.removeChild(kludge);\r\n        hadFocus.focus();\r\n        if (hadFocus == div) { input.showPrimarySelection(); }\r\n      }, 50);\r\n    }\r\n    on(div, "copy", onCopyCut);\r\n    on(div, "cut", onCopyCut);\r\n  };\r\n\r\n  ContentEditableInput.prototype.screenReaderLabelChanged = function (label) {\r\n    // Label for screenreaders, accessibility\r\n    if(label) {\r\n      this.div.setAttribute(\'aria-label\', label);\r\n    } else {\r\n      this.div.removeAttribute(\'aria-label\');\r\n    }\r\n  };\r\n\r\n  ContentEditableInput.prototype.prepareSelection = function () {\r\n    var result = prepareSelection(this.cm, false);\r\n    result.focus = activeElt(rootNode(this.div)) == this.div;\r\n    return result\r\n  };\r\n\r\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\r\n    if (!info || !this.cm.display.view.length) { return }\r\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\r\n    this.showMultipleSelections(info);\r\n  };\r\n\r\n  ContentEditableInput.prototype.getSelection = function () {\r\n    return this.cm.display.wrapper.ownerDocument.getSelection()\r\n  };\r\n\r\n  ContentEditableInput.prototype.showPrimarySelection = function () {\r\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\r\n    var from = prim.from(), to = prim.to();\r\n\r\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\r\n      sel.removeAllRanges();\r\n      return\r\n    }\r\n\r\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\r\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\r\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\r\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\r\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\r\n      { return }\r\n\r\n    var view = cm.display.view;\r\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\r\n        {node: view[0].measure.map[2], offset: 0};\r\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\r\n    if (!end) {\r\n      var measure = view[view.length - 1].measure;\r\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\r\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\r\n    }\r\n\r\n    if (!start || !end) {\r\n      sel.removeAllRanges();\r\n      return\r\n    }\r\n\r\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\r\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\r\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\r\n    if (rng) {\r\n      if (!gecko && cm.state.focused) {\r\n        sel.collapse(start.node, start.offset);\r\n        if (!rng.collapsed) {\r\n          sel.removeAllRanges();\r\n          sel.addRange(rng);\r\n        }\r\n      } else {\r\n        sel.removeAllRanges();\r\n        sel.addRange(rng);\r\n      }\r\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\r\n      else if (gecko) { this.startGracePeriod(); }\r\n    }\r\n    this.rememberSelection();\r\n  };\r\n\r\n  ContentEditableInput.prototype.startGracePeriod = function () {\r\n      var this$1 = this;\r\n\r\n    clearTimeout(this.gracePeriod);\r\n    this.gracePeriod = setTimeout(function () {\r\n      this$1.gracePeriod = false;\r\n      if (this$1.selectionChanged())\r\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\r\n    }, 20);\r\n  };\r\n\r\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\r\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\r\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\r\n  };\r\n\r\n  ContentEditableInput.prototype.rememberSelection = function () {\r\n    var sel = this.getSelection();\r\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\r\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\r\n  };\r\n\r\n  ContentEditableInput.prototype.selectionInEditor = function () {\r\n    var sel = this.getSelection();\r\n    if (!sel.rangeCount) { return false }\r\n    var node = sel.getRangeAt(0).commonAncestorContainer;\r\n    return contains(this.div, node)\r\n  };\r\n\r\n  ContentEditableInput.prototype.focus = function () {\r\n    if (this.cm.options.readOnly != "nocursor") {\r\n      if (!this.selectionInEditor() || activeElt(rootNode(this.div)) != this.div)\r\n        { this.showSelection(this.prepareSelection(), true); }\r\n      this.div.focus();\r\n    }\r\n  };\r\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\r\n  ContentEditableInput.prototype.getField = function () { return this.div };\r\n\r\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\r\n\r\n  ContentEditableInput.prototype.receivedFocus = function () {\r\n      var this$1 = this;\r\n\r\n    var input = this;\r\n    if (this.selectionInEditor())\r\n      { setTimeout(function () { return this$1.pollSelection(); }, 20); }\r\n    else\r\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\r\n\r\n    function poll() {\r\n      if (input.cm.state.focused) {\r\n        input.pollSelection();\r\n        input.polling.set(input.cm.options.pollInterval, poll);\r\n      }\r\n    }\r\n    this.polling.set(this.cm.options.pollInterval, poll);\r\n  };\r\n\r\n  ContentEditableInput.prototype.selectionChanged = function () {\r\n    var sel = this.getSelection();\r\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\r\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\r\n  };\r\n\r\n  ContentEditableInput.prototype.pollSelection = function () {\r\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\r\n    var sel = this.getSelection(), cm = this.cm;\r\n    // On Android Chrome (version 56, at least), backspacing into an\r\n    // uneditable block element will put the cursor in that element,\r\n    // and then, because it\'s not editable, hide the virtual keyboard.\r\n    // Because Android doesn\'t allow us to actually detect backspace\r\n    // presses in a sane way, this code checks for when that happens\r\n    // and simulates a backspace press in this case.\r\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\r\n      this.cm.triggerOnKeyDown({type: "keydown", keyCode: 8, preventDefault: Math.abs});\r\n      this.blur();\r\n      this.focus();\r\n      return\r\n    }\r\n    if (this.composing) { return }\r\n    this.rememberSelection();\r\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\r\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\r\n    if (anchor && head) { runInOp(cm, function () {\r\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\r\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\r\n    }); }\r\n  };\r\n\r\n  ContentEditableInput.prototype.pollContent = function () {\r\n    if (this.readDOMTimeout != null) {\r\n      clearTimeout(this.readDOMTimeout);\r\n      this.readDOMTimeout = null;\r\n    }\r\n\r\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\r\n    var from = sel.from(), to = sel.to();\r\n    if (from.ch == 0 && from.line > cm.firstLine())\r\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\r\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\r\n      { to = Pos(to.line + 1, 0); }\r\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\r\n\r\n    var fromIndex, fromLine, fromNode;\r\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\r\n      fromLine = lineNo(display.view[0].line);\r\n      fromNode = display.view[0].node;\r\n    } else {\r\n      fromLine = lineNo(display.view[fromIndex].line);\r\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\r\n    }\r\n    var toIndex = findViewIndex(cm, to.line);\r\n    var toLine, toNode;\r\n    if (toIndex == display.view.length - 1) {\r\n      toLine = display.viewTo - 1;\r\n      toNode = display.lineDiv.lastChild;\r\n    } else {\r\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\r\n      toNode = display.view[toIndex + 1].node.previousSibling;\r\n    }\r\n\r\n    if (!fromNode) { return false }\r\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\r\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\r\n    while (newText.length > 1 && oldText.length > 1) {\r\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\r\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\r\n      else { break }\r\n    }\r\n\r\n    var cutFront = 0, cutEnd = 0;\r\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\r\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\r\n      { ++cutFront; }\r\n    var newBot = lst(newText), oldBot = lst(oldText);\r\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\r\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\r\n    while (cutEnd < maxCutEnd &&\r\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\r\n      { ++cutEnd; }\r\n    // Try to move start of change to start of selection if ambiguous\r\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\r\n      while (cutFront && cutFront > from.ch &&\r\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\r\n        cutFront--;\r\n        cutEnd++;\r\n      }\r\n    }\r\n\r\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, "");\r\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, "");\r\n\r\n    var chFrom = Pos(fromLine, cutFront);\r\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\r\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\r\n      replaceRange(cm.doc, newText, chFrom, chTo, "+input");\r\n      return true\r\n    }\r\n  };\r\n\r\n  ContentEditableInput.prototype.ensurePolled = function () {\r\n    this.forceCompositionEnd();\r\n  };\r\n  ContentEditableInput.prototype.reset = function () {\r\n    this.forceCompositionEnd();\r\n  };\r\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\r\n    if (!this.composing) { return }\r\n    clearTimeout(this.readDOMTimeout);\r\n    this.composing = null;\r\n    this.updateFromDOM();\r\n    this.div.blur();\r\n    this.div.focus();\r\n  };\r\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\r\n      var this$1 = this;\r\n\r\n    if (this.readDOMTimeout != null) { return }\r\n    this.readDOMTimeout = setTimeout(function () {\r\n      this$1.readDOMTimeout = null;\r\n      if (this$1.composing) {\r\n        if (this$1.composing.done) { this$1.composing = null; }\r\n        else { return }\r\n      }\r\n      this$1.updateFromDOM();\r\n    }, 80);\r\n  };\r\n\r\n  ContentEditableInput.prototype.updateFromDOM = function () {\r\n      var this$1 = this;\r\n\r\n    if (this.cm.isReadOnly() || !this.pollContent())\r\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\r\n  };\r\n\r\n  ContentEditableInput.prototype.setUneditable = function (node) {\r\n    node.contentEditable = "false";\r\n  };\r\n\r\n  ContentEditableInput.prototype.onKeyPress = function (e) {\r\n    if (e.charCode == 0 || this.composing) { return }\r\n    e.preventDefault();\r\n    if (!this.cm.isReadOnly())\r\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\r\n  };\r\n\r\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\r\n    this.div.contentEditable = String(val != "nocursor");\r\n  };\r\n\r\n  ContentEditableInput.prototype.onContextMenu = function () {};\r\n  ContentEditableInput.prototype.resetPosition = function () {};\r\n\r\n  ContentEditableInput.prototype.needsContentAttribute = true;\r\n\r\n  function posToDOM(cm, pos) {\r\n    var view = findViewForLine(cm, pos.line);\r\n    if (!view || view.hidden) { return null }\r\n    var line = getLine(cm.doc, pos.line);\r\n    var info = mapFromLineView(view, line, pos.line);\r\n\r\n    var order = getOrder(line, cm.doc.direction), side = "left";\r\n    if (order) {\r\n      var partPos = getBidiPartAt(order, pos.ch);\r\n      side = partPos % 2 ? "right" : "left";\r\n    }\r\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\r\n    result.offset = result.collapse == "right" ? result.end : result.start;\r\n    return result\r\n  }\r\n\r\n  function isInGutter(node) {\r\n    for (var scan = node; scan; scan = scan.parentNode)\r\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\r\n    return false\r\n  }\r\n\r\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\r\n\r\n  function domTextBetween(cm, from, to, fromLine, toLine) {\r\n    var text = "", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\r\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\r\n    function close() {\r\n      if (closing) {\r\n        text += lineSep;\r\n        if (extraLinebreak) { text += lineSep; }\r\n        closing = extraLinebreak = false;\r\n      }\r\n    }\r\n    function addText(str) {\r\n      if (str) {\r\n        close();\r\n        text += str;\r\n      }\r\n    }\r\n    function walk(node) {\r\n      if (node.nodeType == 1) {\r\n        var cmText = node.getAttribute("cm-text");\r\n        if (cmText) {\r\n          addText(cmText);\r\n          return\r\n        }\r\n        var markerID = node.getAttribute("cm-marker"), range;\r\n        if (markerID) {\r\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\r\n          if (found.length && (range = found[0].find(0)))\r\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\r\n          return\r\n        }\r\n        if (node.getAttribute("contenteditable") == "false") { return }\r\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\r\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\r\n\r\n        if (isBlock) { close(); }\r\n        for (var i = 0; i < node.childNodes.length; i++)\r\n          { walk(node.childNodes[i]); }\r\n\r\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\r\n        if (isBlock) { closing = true; }\r\n      } else if (node.nodeType == 3) {\r\n        addText(node.nodeValue.replace(/\\u200b/g, "").replace(/\\u00a0/g, " "));\r\n      }\r\n    }\r\n    for (;;) {\r\n      walk(from);\r\n      if (from == to) { break }\r\n      from = from.nextSibling;\r\n      extraLinebreak = false;\r\n    }\r\n    return text\r\n  }\r\n\r\n  function domToPos(cm, node, offset) {\r\n    var lineNode;\r\n    if (node == cm.display.lineDiv) {\r\n      lineNode = cm.display.lineDiv.childNodes[offset];\r\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\r\n      node = null; offset = 0;\r\n    } else {\r\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\r\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\r\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\r\n      }\r\n    }\r\n    for (var i = 0; i < cm.display.view.length; i++) {\r\n      var lineView = cm.display.view[i];\r\n      if (lineView.node == lineNode)\r\n        { return locateNodeInLineView(lineView, node, offset) }\r\n    }\r\n  }\r\n\r\n  function locateNodeInLineView(lineView, node, offset) {\r\n    var wrapper = lineView.text.firstChild, bad = false;\r\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\r\n    if (node == wrapper) {\r\n      bad = true;\r\n      node = wrapper.childNodes[offset];\r\n      offset = 0;\r\n      if (!node) {\r\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\r\n        return badPos(Pos(lineNo(line), line.text.length), bad)\r\n      }\r\n    }\r\n\r\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\r\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\r\n      textNode = node.firstChild;\r\n      if (offset) { offset = textNode.nodeValue.length; }\r\n    }\r\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\r\n    var measure = lineView.measure, maps = measure.maps;\r\n\r\n    function find(textNode, topNode, offset) {\r\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\r\n        var map = i < 0 ? measure.map : maps[i];\r\n        for (var j = 0; j < map.length; j += 3) {\r\n          var curNode = map[j + 2];\r\n          if (curNode == textNode || curNode == topNode) {\r\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\r\n            var ch = map[j] + offset;\r\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\r\n            return Pos(line, ch)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    var found = find(textNode, topNode, offset);\r\n    if (found) { return badPos(found, bad) }\r\n\r\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\r\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\r\n      found = find(after, after.firstChild, 0);\r\n      if (found)\r\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\r\n      else\r\n        { dist += after.textContent.length; }\r\n    }\r\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\r\n      found = find(before, before.firstChild, -1);\r\n      if (found)\r\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\r\n      else\r\n        { dist$1 += before.textContent.length; }\r\n    }\r\n  }\r\n\r\n  // TEXTAREA INPUT STYLE\r\n\r\n  var TextareaInput = function(cm) {\r\n    this.cm = cm;\r\n    // See input.poll and input.reset\r\n    this.prevInput = "";\r\n\r\n    // Flag that indicates whether we expect input to appear real soon\r\n    // now (after some event like \'keypress\' or \'input\') and are\r\n    // polling intensively.\r\n    this.pollingFast = false;\r\n    // Self-resetting timeout for the poller\r\n    this.polling = new Delayed();\r\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\r\n    this.hasSelection = false;\r\n    this.composing = null;\r\n    this.resetting = false;\r\n  };\r\n\r\n  TextareaInput.prototype.init = function (display) {\r\n      var this$1 = this;\r\n\r\n    var input = this, cm = this.cm;\r\n    this.createField(display);\r\n    var te = this.textarea;\r\n\r\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\r\n\r\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn\'t seem to work in iOS 8 anymore)\r\n    if (ios) { te.style.width = "0px"; }\r\n\r\n    on(te, "input", function () {\r\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\r\n      input.poll();\r\n    });\r\n\r\n    on(te, "paste", function (e) {\r\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\r\n\r\n      cm.state.pasteIncoming = +new Date;\r\n      input.fastPoll();\r\n    });\r\n\r\n    function prepareCopyCut(e) {\r\n      if (signalDOMEvent(cm, e)) { return }\r\n      if (cm.somethingSelected()) {\r\n        setLastCopied({lineWise: false, text: cm.getSelections()});\r\n      } else if (!cm.options.lineWiseCopyCut) {\r\n        return\r\n      } else {\r\n        var ranges = copyableRanges(cm);\r\n        setLastCopied({lineWise: true, text: ranges.text});\r\n        if (e.type == "cut") {\r\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\r\n        } else {\r\n          input.prevInput = "";\r\n          te.value = ranges.text.join("\\n");\r\n          selectInput(te);\r\n        }\r\n      }\r\n      if (e.type == "cut") { cm.state.cutIncoming = +new Date; }\r\n    }\r\n    on(te, "cut", prepareCopyCut);\r\n    on(te, "copy", prepareCopyCut);\r\n\r\n    on(display.scroller, "paste", function (e) {\r\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\r\n      if (!te.dispatchEvent) {\r\n        cm.state.pasteIncoming = +new Date;\r\n        input.focus();\r\n        return\r\n      }\r\n\r\n      // Pass the `paste` event to the textarea so it\'s handled by its event listener.\r\n      var event = new Event("paste");\r\n      event.clipboardData = e.clipboardData;\r\n      te.dispatchEvent(event);\r\n    });\r\n\r\n    // Prevent normal selection in the editor (we handle our own)\r\n    on(display.lineSpace, "selectstart", function (e) {\r\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\r\n    });\r\n\r\n    on(te, "compositionstart", function () {\r\n      var start = cm.getCursor("from");\r\n      if (input.composing) { input.composing.range.clear(); }\r\n      input.composing = {\r\n        start: start,\r\n        range: cm.markText(start, cm.getCursor("to"), {className: "CodeMirror-composing"})\r\n      };\r\n    });\r\n    on(te, "compositionend", function () {\r\n      if (input.composing) {\r\n        input.poll();\r\n        input.composing.range.clear();\r\n        input.composing = null;\r\n      }\r\n    });\r\n  };\r\n\r\n  TextareaInput.prototype.createField = function (_display) {\r\n    // Wraps and hides input textarea\r\n    this.wrapper = hiddenTextarea();\r\n    // The semihidden textarea that is focused when the editor is\r\n    // focused, and receives input.\r\n    this.textarea = this.wrapper.firstChild;\r\n    var opts = this.cm.options;\r\n    disableBrowserMagic(this.textarea, opts.spellcheck, opts.autocorrect, opts.autocapitalize);\r\n  };\r\n\r\n  TextareaInput.prototype.screenReaderLabelChanged = function (label) {\r\n    // Label for screenreaders, accessibility\r\n    if(label) {\r\n      this.textarea.setAttribute(\'aria-label\', label);\r\n    } else {\r\n      this.textarea.removeAttribute(\'aria-label\');\r\n    }\r\n  };\r\n\r\n  TextareaInput.prototype.prepareSelection = function () {\r\n    // Redraw the selection and/or cursor\r\n    var cm = this.cm, display = cm.display, doc = cm.doc;\r\n    var result = prepareSelection(cm);\r\n\r\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\r\n    if (cm.options.moveInputWithCursor) {\r\n      var headPos = cursorCoords(cm, doc.sel.primary().head, "div");\r\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\r\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\r\n                                          headPos.top + lineOff.top - wrapOff.top));\r\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\r\n                                           headPos.left + lineOff.left - wrapOff.left));\r\n    }\r\n\r\n    return result\r\n  };\r\n\r\n  TextareaInput.prototype.showSelection = function (drawn) {\r\n    var cm = this.cm, display = cm.display;\r\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\r\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\r\n    if (drawn.teTop != null) {\r\n      this.wrapper.style.top = drawn.teTop + "px";\r\n      this.wrapper.style.left = drawn.teLeft + "px";\r\n    }\r\n  };\r\n\r\n  // Reset the input to correspond to the selection (or to be empty,\r\n  // when not typing and nothing is selected)\r\n  TextareaInput.prototype.reset = function (typing) {\r\n    if (this.contextMenuPending || this.composing && typing) { return }\r\n    var cm = this.cm;\r\n    this.resetting = true;\r\n    if (cm.somethingSelected()) {\r\n      this.prevInput = "";\r\n      var content = cm.getSelection();\r\n      this.textarea.value = content;\r\n      if (cm.state.focused) { selectInput(this.textarea); }\r\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\r\n    } else if (!typing) {\r\n      this.prevInput = this.textarea.value = "";\r\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\r\n    }\r\n    this.resetting = false;\r\n  };\r\n\r\n  TextareaInput.prototype.getField = function () { return this.textarea };\r\n\r\n  TextareaInput.prototype.supportsTouch = function () { return false };\r\n\r\n  TextareaInput.prototype.focus = function () {\r\n    if (this.cm.options.readOnly != "nocursor" && (!mobile || activeElt(rootNode(this.textarea)) != this.textarea)) {\r\n      try { this.textarea.focus(); }\r\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\r\n    }\r\n  };\r\n\r\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\r\n\r\n  TextareaInput.prototype.resetPosition = function () {\r\n    this.wrapper.style.top = this.wrapper.style.left = 0;\r\n  };\r\n\r\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\r\n\r\n  // Poll for input changes, using the normal rate of polling. This\r\n  // runs as long as the editor is focused.\r\n  TextareaInput.prototype.slowPoll = function () {\r\n      var this$1 = this;\r\n\r\n    if (this.pollingFast) { return }\r\n    this.polling.set(this.cm.options.pollInterval, function () {\r\n      this$1.poll();\r\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\r\n    });\r\n  };\r\n\r\n  // When an event has just come in that is likely to add or change\r\n  // something in the input textarea, we poll faster, to ensure that\r\n  // the change appears on the screen quickly.\r\n  TextareaInput.prototype.fastPoll = function () {\r\n    var missed = false, input = this;\r\n    input.pollingFast = true;\r\n    function p() {\r\n      var changed = input.poll();\r\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\r\n      else {input.pollingFast = false; input.slowPoll();}\r\n    }\r\n    input.polling.set(20, p);\r\n  };\r\n\r\n  // Read input from the textarea, and update the document to match.\r\n  // When something is selected, it is present in the textarea, and\r\n  // selected (unless it is huge, in which case a placeholder is\r\n  // used). When nothing is selected, the cursor sits after previously\r\n  // seen text (can be empty), which is stored in prevInput (we must\r\n  // not reset the textarea when typing, because that breaks IME).\r\n  TextareaInput.prototype.poll = function () {\r\n      var this$1 = this;\r\n\r\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\r\n    // Since this is called a *lot*, try to bail out as cheaply as\r\n    // possible when it is clear that nothing happened. hasSelection\r\n    // will be the case when there is a lot of text in the textarea,\r\n    // in which case reading its value would be expensive.\r\n    if (this.contextMenuPending || this.resetting || !cm.state.focused ||\r\n        (hasSelection(input) && !prevInput && !this.composing) ||\r\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\r\n      { return false }\r\n\r\n    var text = input.value;\r\n    // If nothing changed, bail.\r\n    if (text == prevInput && !cm.somethingSelected()) { return false }\r\n    // Work around nonsensical selection resetting in IE9/10, and\r\n    // inexplicable appearance of private area unicode characters on\r\n    // some key combos in Mac (#2689).\r\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\r\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\r\n      cm.display.input.reset();\r\n      return false\r\n    }\r\n\r\n    if (cm.doc.sel == cm.display.selForContextMenu) {\r\n      var first = text.charCodeAt(0);\r\n      if (first == 0x200b && !prevInput) { prevInput = "\\u200b"; }\r\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand("undo") }\r\n    }\r\n    // Find the part of the input that is actually new\r\n    var same = 0, l = Math.min(prevInput.length, text.length);\r\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\r\n\r\n    runInOp(cm, function () {\r\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\r\n                     null, this$1.composing ? "*compose" : null);\r\n\r\n      // Don\'t leave long text in the textarea, since it makes further polling slow\r\n      if (text.length > 1000 || text.indexOf("\\n") > -1) { input.value = this$1.prevInput = ""; }\r\n      else { this$1.prevInput = text; }\r\n\r\n      if (this$1.composing) {\r\n        this$1.composing.range.clear();\r\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor("to"),\r\n                                           {className: "CodeMirror-composing"});\r\n      }\r\n    });\r\n    return true\r\n  };\r\n\r\n  TextareaInput.prototype.ensurePolled = function () {\r\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\r\n  };\r\n\r\n  TextareaInput.prototype.onKeyPress = function () {\r\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\r\n    this.fastPoll();\r\n  };\r\n\r\n  TextareaInput.prototype.onContextMenu = function (e) {\r\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\r\n    if (input.contextMenuPending) { input.contextMenuPending(); }\r\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\r\n    if (!pos || presto) { return } // Opera is difficult.\r\n\r\n    // Reset the current text selection only if the click is done outside of the selection\r\n    // and \'resetSelectionOnContextMenu\' option is true.\r\n    var reset = cm.options.resetSelectionOnContextMenu;\r\n    if (reset && cm.doc.sel.contains(pos) == -1)\r\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\r\n\r\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\r\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\r\n    input.wrapper.style.cssText = "position: static";\r\n    te.style.cssText = "position: absolute; width: 30px; height: 30px;\\n      top: " + (e.clientY - wrapperBox.top - 5) + "px; left: " + (e.clientX - wrapperBox.left - 5) + "px;\\n      z-index: 1000; background: " + (ie ? "rgba(255, 255, 255, .05)" : "transparent") + ";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";\r\n    var oldScrollY;\r\n    if (webkit) { oldScrollY = te.ownerDocument.defaultView.scrollY; } // Work around Chrome issue (#2712)\r\n    display.input.focus();\r\n    if (webkit) { te.ownerDocument.defaultView.scrollTo(null, oldScrollY); }\r\n    display.input.reset();\r\n    // Adds "Select all" to context menu in FF\r\n    if (!cm.somethingSelected()) { te.value = input.prevInput = " "; }\r\n    input.contextMenuPending = rehide;\r\n    display.selForContextMenu = cm.doc.sel;\r\n    clearTimeout(display.detectingSelectAll);\r\n\r\n    // Select-all will be greyed out if there\'s nothing to select, so\r\n    // this adds a zero-width space so that we can later check whether\r\n    // it got selected.\r\n    function prepareSelectAllHack() {\r\n      if (te.selectionStart != null) {\r\n        var selected = cm.somethingSelected();\r\n        var extval = "\\u200b" + (selected ? te.value : "");\r\n        te.value = "\\u21da"; // Used to catch context-menu undo\r\n        te.value = extval;\r\n        input.prevInput = selected ? "" : "\\u200b";\r\n        te.selectionStart = 1; te.selectionEnd = extval.length;\r\n        // Re-set this, in case some other handler touched the\r\n        // selection in the meantime.\r\n        display.selForContextMenu = cm.doc.sel;\r\n      }\r\n    }\r\n    function rehide() {\r\n      if (input.contextMenuPending != rehide) { return }\r\n      input.contextMenuPending = false;\r\n      input.wrapper.style.cssText = oldWrapperCSS;\r\n      te.style.cssText = oldCSS;\r\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\r\n\r\n      // Try to detect the user choosing select-all\r\n      if (te.selectionStart != null) {\r\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\r\n        var i = 0, poll = function () {\r\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\r\n              te.selectionEnd > 0 && input.prevInput == "\\u200b") {\r\n            operation(cm, selectAll)(cm);\r\n          } else if (i++ < 10) {\r\n            display.detectingSelectAll = setTimeout(poll, 500);\r\n          } else {\r\n            display.selForContextMenu = null;\r\n            display.input.reset();\r\n          }\r\n        };\r\n        display.detectingSelectAll = setTimeout(poll, 200);\r\n      }\r\n    }\r\n\r\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\r\n    if (captureRightClick) {\r\n      e_stop(e);\r\n      var mouseup = function () {\r\n        off(window, "mouseup", mouseup);\r\n        setTimeout(rehide, 20);\r\n      };\r\n      on(window, "mouseup", mouseup);\r\n    } else {\r\n      setTimeout(rehide, 50);\r\n    }\r\n  };\r\n\r\n  TextareaInput.prototype.readOnlyChanged = function (val) {\r\n    if (!val) { this.reset(); }\r\n    this.textarea.disabled = val == "nocursor";\r\n    this.textarea.readOnly = !!val;\r\n  };\r\n\r\n  TextareaInput.prototype.setUneditable = function () {};\r\n\r\n  TextareaInput.prototype.needsContentAttribute = false;\r\n\r\n  function fromTextArea(textarea, options) {\r\n    options = options ? copyObj(options) : {};\r\n    options.value = textarea.value;\r\n    if (!options.tabindex && textarea.tabIndex)\r\n      { options.tabindex = textarea.tabIndex; }\r\n    if (!options.placeholder && textarea.placeholder)\r\n      { options.placeholder = textarea.placeholder; }\r\n    // Set autofocus to true if this textarea is focused, or if it has\r\n    // autofocus and no other element is focused.\r\n    if (options.autofocus == null) {\r\n      var hasFocus = activeElt(rootNode(textarea));\r\n      options.autofocus = hasFocus == textarea ||\r\n        textarea.getAttribute("autofocus") != null && hasFocus == document.body;\r\n    }\r\n\r\n    function save() {textarea.value = cm.getValue();}\r\n\r\n    var realSubmit;\r\n    if (textarea.form) {\r\n      on(textarea.form, "submit", save);\r\n      // Deplorable hack to make the submit method do the right thing.\r\n      if (!options.leaveSubmitMethodAlone) {\r\n        var form = textarea.form;\r\n        realSubmit = form.submit;\r\n        try {\r\n          var wrappedSubmit = form.submit = function () {\r\n            save();\r\n            form.submit = realSubmit;\r\n            form.submit();\r\n            form.submit = wrappedSubmit;\r\n          };\r\n        } catch(e) {}\r\n      }\r\n    }\r\n\r\n    options.finishInit = function (cm) {\r\n      cm.save = save;\r\n      cm.getTextArea = function () { return textarea; };\r\n      cm.toTextArea = function () {\r\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\r\n        save();\r\n        textarea.parentNode.removeChild(cm.getWrapperElement());\r\n        textarea.style.display = "";\r\n        if (textarea.form) {\r\n          off(textarea.form, "submit", save);\r\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == "function")\r\n            { textarea.form.submit = realSubmit; }\r\n        }\r\n      };\r\n    };\r\n\r\n    textarea.style.display = "none";\r\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\r\n      options);\r\n    return cm\r\n  }\r\n\r\n  function addLegacyProps(CodeMirror) {\r\n    CodeMirror.off = off;\r\n    CodeMirror.on = on;\r\n    CodeMirror.wheelEventPixels = wheelEventPixels;\r\n    CodeMirror.Doc = Doc;\r\n    CodeMirror.splitLines = splitLinesAuto;\r\n    CodeMirror.countColumn = countColumn;\r\n    CodeMirror.findColumn = findColumn;\r\n    CodeMirror.isWordChar = isWordCharBasic;\r\n    CodeMirror.Pass = Pass;\r\n    CodeMirror.signal = signal;\r\n    CodeMirror.Line = Line;\r\n    CodeMirror.changeEnd = changeEnd;\r\n    CodeMirror.scrollbarModel = scrollbarModel;\r\n    CodeMirror.Pos = Pos;\r\n    CodeMirror.cmpPos = cmp;\r\n    CodeMirror.modes = modes;\r\n    CodeMirror.mimeModes = mimeModes;\r\n    CodeMirror.resolveMode = resolveMode;\r\n    CodeMirror.getMode = getMode;\r\n    CodeMirror.modeExtensions = modeExtensions;\r\n    CodeMirror.extendMode = extendMode;\r\n    CodeMirror.copyState = copyState;\r\n    CodeMirror.startState = startState;\r\n    CodeMirror.innerMode = innerMode;\r\n    CodeMirror.commands = commands;\r\n    CodeMirror.keyMap = keyMap;\r\n    CodeMirror.keyName = keyName;\r\n    CodeMirror.isModifierKey = isModifierKey;\r\n    CodeMirror.lookupKey = lookupKey;\r\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\r\n    CodeMirror.StringStream = StringStream;\r\n    CodeMirror.SharedTextMarker = SharedTextMarker;\r\n    CodeMirror.TextMarker = TextMarker;\r\n    CodeMirror.LineWidget = LineWidget;\r\n    CodeMirror.e_preventDefault = e_preventDefault;\r\n    CodeMirror.e_stopPropagation = e_stopPropagation;\r\n    CodeMirror.e_stop = e_stop;\r\n    CodeMirror.addClass = addClass;\r\n    CodeMirror.contains = contains;\r\n    CodeMirror.rmClass = rmClass;\r\n    CodeMirror.keyNames = keyNames;\r\n  }\r\n\r\n  // EDITOR CONSTRUCTOR\r\n\r\n  defineOptions(CodeMirror);\r\n\r\n  addEditorMethods(CodeMirror);\r\n\r\n  // Set up methods on CodeMirror\'s prototype to redirect to the editor\'s document.\r\n  var dontDelegate = "iter insert remove copy getEditor constructor".split(" ");\r\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\r\n    { CodeMirror.prototype[prop] = (function(method) {\r\n      return function() {return method.apply(this.doc, arguments)}\r\n    })(Doc.prototype[prop]); } }\r\n\r\n  eventMixin(Doc);\r\n  CodeMirror.inputStyles = {"textarea": TextareaInput, "contenteditable": ContentEditableInput};\r\n\r\n  // Extra arguments are stored as the mode\'s dependencies, which is\r\n  // used by (legacy) mechanisms like loadmode.js to automatically\r\n  // load a mode. (Preferred mechanism is the require/define calls.)\r\n  CodeMirror.defineMode = function(name/*, mode, …*/) {\r\n    if (!CodeMirror.defaults.mode && name != "null") { CodeMirror.defaults.mode = name; }\r\n    defineMode.apply(this, arguments);\r\n  };\r\n\r\n  CodeMirror.defineMIME = defineMIME;\r\n\r\n  // Minimal default mode.\r\n  CodeMirror.defineMode("null", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\r\n  CodeMirror.defineMIME("text/plain", "null");\r\n\r\n  // EXTENSIONS\r\n\r\n  CodeMirror.defineExtension = function (name, func) {\r\n    CodeMirror.prototype[name] = func;\r\n  };\r\n  CodeMirror.defineDocExtension = function (name, func) {\r\n    Doc.prototype[name] = func;\r\n  };\r\n\r\n  CodeMirror.fromTextArea = fromTextArea;\r\n\r\n  addLegacyProps(CodeMirror);\r\n\r\n  CodeMirror.version = "5.65.19";\r\n\r\n  return CodeMirror;\r\n\r\n})));\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/codemirror/lib/codemirror.js?')},"./src/assets/js/codemirror/mode/stex/stex.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{eval('// CodeMirror, copyright (c) by Marijn Haverbeke and others\r\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\r\n\r\n/*\r\n * Author: Constantin Jucovschi (c.jucovschi@jacobs-university.de)\r\n * Licence: MIT\r\n */\r\n\r\n(function(mod) {\r\n  if (true) // CommonJS\r\n    mod(__webpack_require__(/*! ../../lib/codemirror */ "./src/assets/js/codemirror/lib/codemirror.js"));\r\n  else {}\r\n})(function(CodeMirror) {\r\n  "use strict";\r\n\r\n  CodeMirror.defineMode("stex", function(_config, parserConfig) {\r\n    "use strict";\r\n\r\n    function pushCommand(state, command) {\r\n      state.cmdState.push(command);\r\n    }\r\n\r\n    function peekCommand(state) {\r\n      if (state.cmdState.length > 0) {\r\n        return state.cmdState[state.cmdState.length - 1];\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    function popCommand(state) {\r\n      var plug = state.cmdState.pop();\r\n      if (plug) {\r\n        plug.closeBracket();\r\n      }\r\n    }\r\n\r\n    // returns the non-default plugin closest to the end of the list\r\n    function getMostPowerful(state) {\r\n      var context = state.cmdState;\r\n      for (var i = context.length - 1; i >= 0; i--) {\r\n        var plug = context[i];\r\n        if (plug.name == "DEFAULT") {\r\n          continue;\r\n        }\r\n        return plug;\r\n      }\r\n      return { styleIdentifier: function() { return null; } };\r\n    }\r\n\r\n    function addPluginPattern(pluginName, cmdStyle, styles) {\r\n      return function () {\r\n        this.name = pluginName;\r\n        this.bracketNo = 0;\r\n        this.style = cmdStyle;\r\n        this.styles = styles;\r\n        this.argument = null;   // \\begin and \\end have arguments that follow. These are stored in the plugin\r\n\r\n        this.styleIdentifier = function() {\r\n          return this.styles[this.bracketNo - 1] || null;\r\n        };\r\n        this.openBracket = function() {\r\n          this.bracketNo++;\r\n          return "bracket";\r\n        };\r\n        this.closeBracket = function() {};\r\n      };\r\n    }\r\n\r\n    var plugins = {};\r\n\r\n    plugins["importmodule"] = addPluginPattern("importmodule", "tag", ["string", "builtin"]);\r\n    plugins["documentclass"] = addPluginPattern("documentclass", "tag", ["", "atom"]);\r\n    plugins["usepackage"] = addPluginPattern("usepackage", "tag", ["atom"]);\r\n    plugins["begin"] = addPluginPattern("begin", "tag", ["atom"]);\r\n    plugins["end"] = addPluginPattern("end", "tag", ["atom"]);\r\n\r\n    plugins["label"    ] = addPluginPattern("label"    , "tag", ["atom"]);\r\n    plugins["ref"      ] = addPluginPattern("ref"      , "tag", ["atom"]);\r\n    plugins["eqref"    ] = addPluginPattern("eqref"    , "tag", ["atom"]);\r\n    plugins["cite"     ] = addPluginPattern("cite"     , "tag", ["atom"]);\r\n    plugins["bibitem"  ] = addPluginPattern("bibitem"  , "tag", ["atom"]);\r\n    plugins["Bibitem"  ] = addPluginPattern("Bibitem"  , "tag", ["atom"]);\r\n    plugins["RBibitem" ] = addPluginPattern("RBibitem" , "tag", ["atom"]);\r\n\r\n    plugins["DEFAULT"] = function () {\r\n      this.name = "DEFAULT";\r\n      this.style = "tag";\r\n\r\n      this.styleIdentifier = this.openBracket = this.closeBracket = function() {};\r\n    };\r\n\r\n    function setState(state, f) {\r\n      state.f = f;\r\n    }\r\n\r\n    // called when in a normal (no environment) context\r\n    function normal(source, state) {\r\n      var plug;\r\n      // Do we look like \'\\command\' ?  If so, attempt to apply the plugin \'command\'\r\n      if (source.match(/^\\\\[a-zA-Z@]+/)) {\r\n        var cmdName = source.current().slice(1);\r\n        plug = plugins.hasOwnProperty(cmdName) ? plugins[cmdName] : plugins["DEFAULT"];\r\n        plug = new plug();\r\n        pushCommand(state, plug);\r\n        setState(state, beginParams);\r\n        return plug.style;\r\n      }\r\n\r\n      // escape characters\r\n      if (source.match(/^\\\\[$&%#{}_]/)) {\r\n        return "tag";\r\n      }\r\n\r\n      // white space control characters\r\n      if (source.match(/^\\\\[,;!\\/\\\\]/)) {\r\n        return "tag";\r\n      }\r\n\r\n      // find if we\'re starting various math modes\r\n      if (source.match("\\\\[")) {\r\n        setState(state, function(source, state){ return inMathMode(source, state, "\\\\]"); });\r\n        return "keyword";\r\n      }\r\n      if (source.match("\\\\(")) {\r\n        setState(state, function(source, state){ return inMathMode(source, state, "\\\\)"); });\r\n        return "keyword";\r\n      }\r\n      if (source.match("$$")) {\r\n        setState(state, function(source, state){ return inMathMode(source, state, "$$"); });\r\n        return "keyword";\r\n      }\r\n      if (source.match("$")) {\r\n        setState(state, function(source, state){ return inMathMode(source, state, "$"); });\r\n        return "keyword";\r\n      }\r\n\r\n      var ch = source.next();\r\n      if (ch == "%") {\r\n        source.skipToEnd();\r\n        return "comment";\r\n      } else if (ch == \'}\' || ch == \']\') {\r\n        plug = peekCommand(state);\r\n        if (plug) {\r\n          plug.closeBracket(ch);\r\n          setState(state, beginParams);\r\n        } else {\r\n          return "error";\r\n        }\r\n        return "bracket";\r\n      } else if (ch == \'{\' || ch == \'[\') {\r\n        plug = plugins["DEFAULT"];\r\n        plug = new plug();\r\n        pushCommand(state, plug);\r\n        return "bracket";\r\n      } else if (/\\d/.test(ch)) {\r\n        source.eatWhile(/[\\w.%]/);\r\n        return "atom";\r\n      } else {\r\n        source.eatWhile(/[\\w\\-_]/);\r\n        plug = getMostPowerful(state);\r\n        if (plug.name == \'begin\') {\r\n          plug.argument = source.current();\r\n        }\r\n        return plug.styleIdentifier();\r\n      }\r\n    }\r\n\r\n    function inMathMode(source, state, endModeSeq) {\r\n      if (source.eatSpace()) {\r\n        return null;\r\n      }\r\n      if (endModeSeq && source.match(endModeSeq)) {\r\n        setState(state, normal);\r\n        return "keyword";\r\n      }\r\n      if (source.match(/^\\\\[a-zA-Z@]+/)) {\r\n        return "tag";\r\n      }\r\n      if (source.match(/^[a-zA-Z]+/)) {\r\n        return "variable-2";\r\n      }\r\n      // escape characters\r\n      if (source.match(/^\\\\[$&%#{}_]/)) {\r\n        return "tag";\r\n      }\r\n      // white space control characters\r\n      if (source.match(/^\\\\[,;!\\/]/)) {\r\n        return "tag";\r\n      }\r\n      // special math-mode characters\r\n      if (source.match(/^[\\^_&]/)) {\r\n        return "tag";\r\n      }\r\n      // non-special characters\r\n      if (source.match(/^[+\\-<>|=,\\/@!*:;\'"`~#?]/)) {\r\n        return null;\r\n      }\r\n      if (source.match(/^(\\d+\\.\\d*|\\d*\\.\\d+|\\d+)/)) {\r\n        return "number";\r\n      }\r\n      var ch = source.next();\r\n      if (ch == "{" || ch == "}" || ch == "[" || ch == "]" || ch == "(" || ch == ")") {\r\n        return "bracket";\r\n      }\r\n\r\n      if (ch == "%") {\r\n        source.skipToEnd();\r\n        return "comment";\r\n      }\r\n      return "error";\r\n    }\r\n\r\n    function beginParams(source, state) {\r\n      var ch = source.peek(), lastPlug;\r\n      if (ch == \'{\' || ch == \'[\') {\r\n        lastPlug = peekCommand(state);\r\n        lastPlug.openBracket(ch);\r\n        source.eat(ch);\r\n        setState(state, normal);\r\n        return "bracket";\r\n      }\r\n      if (/[ \\t\\r]/.test(ch)) {\r\n        source.eat(ch);\r\n        return null;\r\n      }\r\n      setState(state, normal);\r\n      popCommand(state);\r\n\r\n      return normal(source, state);\r\n    }\r\n\r\n    return {\r\n      startState: function() {\r\n        var f = parserConfig.inMathMode ? function(source, state){ return inMathMode(source, state); } : normal;\r\n        return {\r\n          cmdState: [],\r\n          f: f\r\n        };\r\n      },\r\n      copyState: function(s) {\r\n        return {\r\n          cmdState: s.cmdState.slice(),\r\n          f: s.f\r\n        };\r\n      },\r\n      token: function(stream, state) {\r\n        return state.f(stream, state);\r\n      },\r\n      blankLine: function(state) {\r\n        state.f = normal;\r\n        state.cmdState.length = 0;\r\n      },\r\n      lineComment: "%"\r\n    };\r\n  });\r\n\r\n  CodeMirror.defineMIME("text/x-stex", "stex");\r\n  CodeMirror.defineMIME("text/x-latex", "stex");\r\n\r\n});\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/codemirror/mode/stex/stex.js?')},"./src/assets/js/dialog.css":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/dialog.css?")},"./src/assets/js/dialog.js":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KatexInputHelper: () => (/* binding */ KatexInputHelper)\n/* harmony export */ });\n/* harmony import */ var _dialog_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dialog.css */ "./src/assets/js/dialog.css");\n/* harmony import */ var _keyboard_keyboard__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./keyboard/keyboard */ "./src/assets/js/keyboard/keyboard.js");\n/* harmony import */ var _codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./codemirror/lib/codemirror */ "./src/assets/js/codemirror/lib/codemirror.js");\n/* harmony import */ var _codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _codemirror_mode_stex_stex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./codemirror/mode/stex/stex */ "./src/assets/js/codemirror/mode/stex/stex.js");\n/* harmony import */ var _codemirror_mode_stex_stex__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_codemirror_mode_stex_stex__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _parameters__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./parameters */ "./src/assets/js/parameters.js");\n/* harmony import */ var _localization__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./localization */ "./src/assets/js/localization.js");\n/* harmony import */ var _themes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./themes */ "./src/assets/js/themes.js");\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers */ "./src/assets/js/helpers.js");\n/* harmony import */ var _parserExtension__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./parserExtension */ "./src/assets/js/parserExtension.js");\n/* harmony import */ var _math__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./math */ "./src/assets/js/math.js");\n/* harmony import */ var _panels__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./panels */ "./src/assets/js/panels.js");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\t// manual recommendation\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar console; \r\nif (window.console) console = window.console; else console = { log: function(msg) { }, error: function(msg) { } }; \r\n\r\n/**\r\n * @abstract Responsible for showing documentation.\r\n */\r\nclass Documentations {\r\n\r\n\twindowIsOpening = false;\r\n\trunLocal = false;\r\n\tbaseLocation = "";\r\n\tbaseInfo = null;\r\n\tparams = [];\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t * \r\n\t * @param runLocal - true for local source\r\n\t * @param baseLocation - to be used for local document path\r\n\t */\r\n\tconstructor(runLocal, baseLocation) {\r\n\t\tthis.runLocal = runLocal;\r\n\t\tthis.baseLocation = baseLocation;\r\n\t\t\r\n\t\tthis.baseInfo = {\r\n\t\t\tLATEX: {\r\n\t\t\t\tfile: "symbols-a4.pdf",\r\n\t\t\t\turl: "https://www.tug.org/twg/mactex/tutorials/ltxprimer-1.0.pdf",\r\n\t\t\t\tname: "wLATEX_DOCUMENTATION"\r\n\t\t\t},\r\n\t\t\tMHCHEM: {\r\n\t\t\t\tfile: "mhchem.pdf",\r\n\t\t\t\turl: "https://mirror.dogado.de/tex-archive/macros/latex/contrib/mhchem/mhchem.pdf",\r\n\t\t\t\tname: "wMHCHEM_DOCUMENTATION"\r\n\t\t\t},\r\n\t\t\tAMSCD: {\r\n\t\t\t\tfile: "Mamscd.pdf",\r\n\t\t\t\turl: "https://ctan.math.washington.edu/tex-archive/macros/latex/required/amsmath/amscd.pdf",\r\n\t\t\t\tname: "wAMSCD_DOCUMENTATION"\r\n\t\t\t},\r\n\t\t\tMATHML: {\r\n\t\t\t\tfile: "mathml.pdf",\r\n\t\t\t\turl: "https://www.w3.org/TR/MathML2/mathml-s.pdf",\r\n\t\t\t\tname: "wMATH_ML_SPECIFICATIONS"\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.params = [\r\n\t\t\t\'width=780\',\r\n\t\t\t\'height=580\',\r\n\t\t\t\'top=100\',\r\n\t\t\t\'left=100\',\r\n\t\t\t\'status=yes\',\r\n\t\t\t\'toolbar=no\',\r\n\t\t\t\'menubar=no\',\r\n\t\t\t\'location=no\',\r\n\t\t\t\'resizable=yes\',\r\n\t\t\t\'scrollbars=yes\',\r\n\t\t\t\'modal=no\',\r\n\t\t\t\'dependable=yes\'\t\t\t\r\n\t\t];\r\n\t}\r\n\t\r\n\tshowLatexDocumentation() {\r\n\t\treturn this.showWindow(\'LATEX\');\r\n\t}\r\n\r\n\tshowMhchemDocumentation() {\r\n\t\treturn this.showWindow(\'MHCHEM\');\r\n\t}\r\n\r\n\tshowAmscdDocumentation() {\r\n\t\treturn this.showWindow(\'AMSCD\');\r\n\t}\r\n\r\n\tshowMathmlSpecifications() {\r\n\t\treturn this.showWindow(\'MATHML\');\r\n\t}\r\n\r\n\tgetUrl(key) {\r\n\t\tvar info = this.baseInfo[key];\r\n\t\treturn this.runLocal ? (this.baseLocation + \'doc/\' + info.file) : info.url;\r\n\t}\r\n\r\n\tshowWindow(key) {\r\n\t\tif (!this.windowIsOpening) {\r\n\t\t\tvar url = this.getUrl(key);\r\n\t\t\tvar name = this.baseInfo[key].name; \r\n\r\n\t\t\tthis.windowIsOpening = true; \r\n\t\t\tvar params = this.params.join(\',\');\r\n\t\t\tvar win = window.open(url, name, params); \r\n\t\t\t// TODO: always returns null\r\n\t\t\t// win.focus(); \r\n\t\t\tthis.windowIsOpening = false; \r\n\t\t\treturn win; \r\n\t\t} else { \r\n\t\t\treturn null; \r\n\t\t} \r\n\t}\t\r\n}\r\n\r\n\r\n/**\r\n * @abstract The main class Katex Input Helper\r\n */\r\nclass KatexInputHelper {\r\n\r\n\tversion = "2.0.0"; \r\n\tcodeType = \'Latex\'; \r\n\tsaveOptionInCookies = false; \r\n\tisBuild = false; \r\n\twindowIsOpenning = false; \r\n\ttextareaIgnore = false; \r\n\ttextareaID = null; \r\n\tcodeMirrorEditor = null;\r\n\tcodeMirrorTheme = \'\';\r\n\tsymbolPanelsLoaded = []; \r\n\tlatexMathjaxCodesListLoaded = false; \r\n\tuniCodesListLoaded = false; \r\n\tautoUpdateOutputTimeout = null; \r\n\tnotAllowedKeys = [9, 16, 17, 18, 19, 20, 27, 33, 34, 35, 36, 37, 38, 39, 40, 44, 45, 91, 93, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 144, 145]; \r\n\tallowedCtrlKeys = [86, 88, 89, 90]\r\n\tnotAllowedCtrlKeys = []; \r\n\tnotAllowedAltKeys = []; \r\n\t\r\n\t// The Color Picker is a fixed instance and can be used to work with colors\r\n\trunNotColorPicker = true;\r\n\trunNotVirtualKeyboard = false;\r\n\trunNotMathJax = true;\r\n\trunNotCodeMirror = false;\r\n\r\n\trtlStyle = \'ltr\';\r\n\tlocation = "";\r\n\tdocumentations = null;\r\n\tlocalizer = null;\r\n\tthemes = null;\r\n\tmath = null;\r\n\tparameters = null;\r\n\tutilities = null;\r\n\tmessager = null;\r\n\tpanels = null;\r\n\tuseEasyLoader = true;\r\n\tbaseLocation = "";\r\n\t\r\n\t/**\r\n\t * Constructor\r\n\t */\r\n\tconstructor(useEasyLaoder = true) {\r\n\t\tvar vme = this;\r\n\t\twindow.vme = this;\r\n\t\tglobalThis.vme = this;\r\n\t\tthis.useEasyLoader = useEasyLaoder;\r\n\t\r\n\t\t// independent of plugin variant\r\n\t\tthis.baseLocation = this.setBaseLocation();\r\n\t\t\r\n\t\t// Probably not needed\r\n\t\tconsole.info(`Url: ${window.location}`);\r\n\t\t\r\n\t\tthis.url = {\r\n\t\t\tparam: function(name) {\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\trunLocal: true,\r\n\t\t\t\t\tcodeType: "Latex",\r\n\t\t\t\t};\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn vme.parameters[name];\t\t\t\t\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\tconsole.warn(`Url Access could not resolve name: ${name}`);\r\n\t\t\t\t\treturn params[name];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tthis.documentations = new Documentations(false, this.baseLocation);\r\n\t\tthis.parameters = (0,_parameters__WEBPACK_IMPORTED_MODULE_4__.ParametersProxy)();\r\n\t\tthis.localizer = new _localization__WEBPACK_IMPORTED_MODULE_5__.Localizer();\r\n\t\tthis.messager = new _helpers__WEBPACK_IMPORTED_MODULE_7__.Messager(this.localizer);\r\n\t\tthis.utilities = new _helpers__WEBPACK_IMPORTED_MODULE_7__.Utilities(this.localizer);\r\n\t\tthis.themes = new _themes__WEBPACK_IMPORTED_MODULE_6__.Themes();\r\n\t\tthis.parser = new _parserExtension__WEBPACK_IMPORTED_MODULE_8__.ParserExtension(true);\r\n\t\tthis.math = new _math__WEBPACK_IMPORTED_MODULE_9__.MathFormulae(false, this.localizer, null, this.parameters, this.parser);\t// code mirror per method injection\r\n\t\tthis.panels = new _panels__WEBPACK_IMPORTED_MODULE_10__.KIHPanels(this.parameters, this.localizer, this.parser);\r\n\r\n\t\tthis.mathTextInput = document.getElementById(\'mathTextInput\'); \r\n\t\tthis.mathVisualOutput = document.getElementById(\'mathVisualOutput\'); \r\n\t\t\r\n\t\tfor (var i = 65; i <= 90; i++) if ($.inArray(i, this.allowedCtrlKeys) == -1) this.notAllowedCtrlKeys.push(i); \r\n\t\tfor (var i = 65; i < 90; i++) this.notAllowedAltKeys.push(i);\r\n\t}\r\n\r\n\tget localType() {\r\n\t\treturn this.parameters.localType;\r\n\t}\r\n\tset localType(value) {\r\n\t\tthis.parameters.localType = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\r\n\tget style() {\r\n\t\treturn this.parameters.style;\r\n\t}\r\n\tset style(value) {\r\n\t\tthis.parameters.style = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\t\r\n\tget encloseAllFormula() {\r\n\t\treturn this.parameters.encloseAllFormula;\r\n\t}\r\n\tset encloseAllFormula(value) {\r\n\t\tthis.parameters.encloseAllFormula = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\t\r\n\tget autoUpdateTime() {\r\n\t\treturn this.parameters.autoUpdateTime;\r\n\t}\r\n\tset autoUpdateTime(value) {\r\n\t\tthis.parameters.autoUpdateTime = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\t\r\n\tget menuupdateType() {\r\n\t\treturn this.parameters.menuupdateType;\r\n\t}\r\n\tset menuupdateType(value) {\r\n\t\tthis.parameters.menuupdateType = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\t\r\n\tget autoupdateType() {\r\n\t\treturn this.parameters.autoupdateType;\r\n\t}\r\n\tset autoupdateType(value) {\r\n\t\tthis.parameters.autoupdateType = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\r\n\t\r\n\tget persistWindowPositions() {\r\n\t\treturn this.parameters.persistWindowPositions;\r\n\t}\r\n\tset persistWindowPositions(value) {\r\n\t\tthis.parameters.persistWindowPositions = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\t\r\n\tget persistEquations() {\r\n\t\treturn this.parameters.persistEquations;\r\n\t}\r\n\tset persistEquations(value) {\r\n\t\tthis.parameters.persistEquations = value;\r\n\t\t// Seems to be unnecessary (setter interceptor in parameters)\r\n\t\t// this.parameters.writeParameters();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @abstract Initialize. Performs the whole initialization.\r\n\t */\r\n\tasync initialise() { \r\n\t\t/* TEST: Dynamically create data-options\r\n\t\t   For a better handling look at TEST dialog. \r\n\t\t*/\r\n\t\tif (this.useEasyLoader) {\r\n\t\t\tvar options = {\r\n\t\t\t\t\'#WaitMsg\': {\r\n\t\t\t\t\tmodal: true,\r\n\t\t\t\t\tmaximizable: false,\r\n\t\t\t\t\tminimizable: false,\r\n\t\t\t\t\tcollapsible: false,\r\n\t\t\t\t\tclosable: false,\r\n\t\t\t\t\tmaximized: true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wEDITOR_PARAMETERS\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:true,\r\n\t\t\t\t\tbuttons:\'#btEDITOR_PARAMETERS\',\r\n\t\t\t\t\tresizable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wLANGUAGE_CHOISE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:true,\r\n\t\t\t\t\tbuttons:\'#btLANGUAGE_CHOISE\',\r\n\t\t\t\t\tresizable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wSTYLE_CHOISE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:true,\r\n\t\t\t\t\tbuttons:\'#btSTYLE_CHOISE\',\r\n\t\t\t\t\tresizable:true\r\n\t\t\t},\r\n\t\t\t\t\'#wMATRIX\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:true,\r\n\t\t\t\t\tbuttons:\'#btMATRIX\',\r\n\t\t\t\t\tresizable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_COMMUTATIVE_DIAGRAM_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_CHEMICAL_FORMULAE_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_BRACKET_SYMBOLS_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_RELATION_SYMBOLS_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_ARROW_SYMBOLS_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_FR_CHAR_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_BBB_CHAR_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_L_U_GREEK_CHAR_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_ALL_CHAR_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_EQUATION_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_CUSTOM_EQUATIONS_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true,\r\n\t\t\t\t\tbuttons:\'#btCUSTOM_EQUATIONS_BUTTONS\'\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_HORIZONTAL_SPACING_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_VERTICAL_SPACING_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wf_SPECIAL_CHARACTER_MORE\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tshadow:false,\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tcollapsible:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wLATEX_CODES_LIST\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tcollapsible:false,\r\n\t\t\t\t\tminimizable:false,\r\n\t\t\t\t\tmaximizable:false,\r\n\t\t\t\t\tclosable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wASCIIMATH_CODES_LIST\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tcollapsible:false,\r\n\t\t\t\t\tminimizable:false,\r\n\t\t\t\t\tmaximizable:false,\r\n\t\t\t\t\tclosable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wUNICODES_LIST\': {\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tcollapsible:false,\r\n\t\t\t\t\tminimizable:false,\r\n\t\t\t\t\tmaximizable:false,\r\n\t\t\t\t\tclosable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wLANGUAGE_LIST\': {\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tcollapsible:false,\r\n\t\t\t\t\tminimizable:false,\r\n\t\t\t\t\tmaximizable:false,\r\n\t\t\t\t\tclosable:true\r\n\t\t\t\t},\r\n\t\t\t\t\'#wINFORMATIONS\': {\r\n\t\t\t\t\tresizable:true,\r\n\t\t\t\t\tclosed:true,\r\n\t\t\t\t\tmodal:false,\r\n\t\t\t\t\tcollapsible:false,\r\n\t\t\t\t\tminimizable:false,\r\n\t\t\t\t\tmaximizable:false,\r\n\t\t\t\t\tclosable:true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar menuOptions = [\r\n\t\t\t\t{ iconCls: \'icon-file\', menu: \'#mFILE\' },\r\n\t\t\t\t{ iconCls: \'icon-insert\', menu: \'#mINSERT\' },\r\n\t\t\t\t{ iconCls: \'icon-plugin\', menu: \'#mTOOLS\' },\r\n\t\t\t\t{ iconCls: \'icon-watch\', menu: \'#mVIEW\' },\r\n\t\t\t\t{ iconCls: \'icon-option\', menu: \'#mOPTIONS\' },\r\n\t\t\t\t{ iconCls: \'icon-info\', menu: \'#mINFORMATIONS\' },\r\n\t\t\t];\r\n\r\n\t\t\t$(Object.keys(options).join(\',\'))\r\n\t\t\t.each(function() {\r\n\t\t\t\tvar id = $(this).attr(\'id\');\r\n\t\t\t\t$(this).dialog(options[id]);\r\n\t\t\t});\r\n\t\t\t$(\'#menu a\')\r\n\t\t\t.each(function(idx) {\r\n\t\t\t\t$(this).menubutton(menuOptions[idx]);\r\n\t\t\t});\r\n\t\t}\r\n\t\t/* TEST END */\r\n\r\n\t\tvar vme = this; \r\n\t\t\r\n\t\tthis.parser.initialise();\t\t\r\n\t\tawait this.parameters.queryParameters();\t\t\t\t\t\t\t// from Plugin\t\t\r\n\r\n\t\t// IN QUESTION\r\n\t\tvme.initialiseCodeMirror(); \r\n\t\tthis.localizer.subscribe(this.onLocaleChanged.bind(this));\r\n\t\tawait this.localizer.initialiseLanguageChoice(this.localType);\t\t// Progress dialog uses localized text\r\n\t\t\r\n\t\t$.messager.progress({\r\n\t\t\ttitle: "VisualMathEditor", \r\n\t\t\ttext: vme.getLocalText("WAIT_FOR_EDITOR_DOWNLOAD"), \r\n\t\t\tmsg: "<center>&copy; <a href=\'mailto:contact@equatheque.com?subject=VisualMathEditor\' target=\'_blank\' class=\'bt\' >David Grima</a> - <a href=\'http://www.equatheque.net\' target=\'_blank\' class=\'bt\' >EquaThEque</a><br/><br/></center>", \r\n\t\t\tinterval: 300 \r\n\t\t}); \r\n\t\t$(\'#form\').hide();\r\n\t\t\r\n\t\tawait vme.initialiseUI(); \r\n\t\tawait vme.updateInfo();\t\t\t\t\t\t\t\t\t\t\t\t// updates a few dialogs\r\n\t\tvme.initialiseParameters(); \r\n\t\tvme.initialiseCodeType(); \r\n\t\tawait vme.initialiseVirtualKeyboard(); \r\n\r\n\t\t// IN QUESTION\r\n\t\tawait this.onLocaleChanged(this.localizer);\t\t\t\t\t\t\t// repeat because too soon after initialiseLanguageChoice\r\n\t\tthis.themes.subscribe(this.onStyleChanged.bind(this));\r\n\t\tawait this.themes.initialiseThemeChoice(this.style, this.rtlStyle); // RTL STYLE defined after locale language\r\n\r\n\t\tvme.endWait(); \r\n\t\tvme.isBuild = true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract At the end of initialization close Progress dialog and WaitMsg\r\n\t * \t\t\t panel.\r\n\t */\r\n\tendWait() { \r\n\t\tthis.initialiseEquation(); \r\n\t\t$.messager.progress(\'close\'); \r\n\t\t$("#WaitMsg").panel(\'close\');\r\n\t\tthis.setFocus(); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Set Focus on Editor.\r\n\t */\r\n\tsetFocus() { \r\n\t\t$("#mathTextInput").focus(); \r\n\t\tif (this.codeMirrorEditor) this.codeMirrorEditor.focus(); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Sets Cursor at editor end.\r\n\t */\r\n\tsetCodeMirrorCursorAtEnd() { \r\n\t\tvar pos = { \r\n\t\t\tline: this.codeMirrorEditor.lastLine(), \r\n\t\t\tch: this.codeMirrorEditor.getValue().length \r\n\t\t}; \r\n\t\tthis.codeMirrorEditor.setCursor(pos); \r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initializes the virtual keyboard by loading a script.\r\n\t */\t\r\n\tasync initialiseVirtualKeyboard() { \r\n\t\t\r\n\t\tif (!this.runNotVirtualKeyboard) {\r\n\t\t\t_keyboard_keyboard__WEBPACK_IMPORTED_MODULE_1__.VKI_init.bind(this)();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialise the Code Mirror Editor.\r\n\t * \r\n\t * This includes:\r\n\t * - instance creation with parameters\r\n\t * - change handler -> auto update of formula\r\n\t * - context menu binding\r\n\t */\r\n\tinitialiseCodeMirror() { \r\n\t\tvar vme = this; \r\n\t\tvme.codeMirrorEditor = _codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_2___default().fromTextArea(document.getElementById("mathTextInput"), { \r\n\t\t\tmode: vme.encloseAllFormula ? "text/html" : "text/x-latex", \r\n\t\t\tautofocus: true, \r\n\t\t\tshowCursorWhenSelecting: true, \r\n\t\t\tstyleActiveLine: true, \r\n\t\t\tlineNumbers: true, \r\n\t\t\tlineWrapping: true, \r\n\t\t\tmatchBrackets: true, \r\n\t\t\tautoCloseBrackets: true, \r\n\t\t\tautoCloseTags: vme.encloseAllFormula ? true : false, \r\n\t\t\ttabMode: "indent", \r\n\t\t\ttabSize: 4, \r\n\t\t\tindentUnit: 4, \r\n\t\t\tindentWithTabs: true, \r\n\t\t\ttheme: "default"\r\n\t\t}); \r\n\t\tvme.codeMirrorEditor.on("change", function() { vme.autoUpdateOutput(); }); \r\n\t\t\r\n\t\t$(".CodeMirror").bind(\'contextmenu\', function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#mINSERT\').menu(\'show\', { left: event.pageX, top: event.pageY }); \r\n\t\t\treturn false; \r\n\t\t}); \r\n\t\t\r\n\t\tthis.math.setEditorInstance(this.codeMirrorEditor);\r\n\t\t\r\n\t\t$(\'#divMathTextInput\').panel({\r\n\t\t\tonResize: function(width, height) {\r\n\t\t\t\tvme.codeMirrorEditor.setSize(width, height);\r\n\t\t\t\tvme.codeMirrorEditor.refresh();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initializes the User Interface.\r\n\t * \r\n\t * This includes:\r\n\t * - assignes menu commands\r\n\t * - prepares the accordion panels with symbol templates\r\n\t * - prepares the **info** dialog\r\n\t * - assigns button handlers\r\n\t * - additional handlers ...\r\n\t */\r\n\tasync initialiseUI() {\r\n\t\t\r\n\t\tvar vme = this;\r\n\t\t$("a.easyui-linkbutton").linkbutton({ plain: true }); \r\n\t\t$(document).bind(\'contextmenu\', function(event) { event.preventDefault(); return false; }); \r\n\t\t\r\n\t\t// The whole menu commands. \r\n\t\t$("#mFILE, #mINSERT, #mTOOLS, #mVIEW, #mOPTIONS, #mINFORMATIONS").menu({\r\n\t\t\tonClick: async function(item) {\r\n\t\t\t\tswitch (item.target.id) {\r\n\t\t\t\t\tcase "mEDITOR_PARAMETERS": await vme.openWindow(\'wEDITOR_PARAMETERS\'); break; \r\n\t\t\t\t\tcase "mSTYLE_CHOISE": await vme.openWindow(\'wSTYLE_CHOISE\'); break; \r\n\t\t\t\t\tcase "mLANGUAGE_CHOISE": await vme.openWindow(\'wLANGUAGE_CHOISE\'); break; \r\n\t\t\t\t\tcase "mMATRIX": await vme.showMatrixWindow(3, 3); break; \r\n\t\t\t\t\tcase "mCOMMUTATIVE_DIAGRAM": await vme.initialiseUImoreDialogs("f_COMMUTATIVE_DIAGRAM"); break; \r\n\t\t\t\t\tcase "mCHEMICAL_FORMULAE": await vme.initialiseUImoreDialogs("f_CHEMICAL_FORMULAE"); break; \r\n\t\t\t\t\tcase "mSAVE_EQUATION": vme.saveEquationFile(); break; \r\n\t\t\t\t\tcase "mOPEN_EQUATION": vme.testOpenFile(); break; \r\n\t\t\t\t\tcase "mLaTeX_TEXT": vme.insert("\\\\LaTeX"); break; \r\n\t\t\t\t\tcase "mMATH_ML": vme.viewMathML(vme.mathVisualOutput.id); break; \r\n\t\t\t\t\tcase "mUNICODES_LIST": await vme.openWindow(\'wUNICODES_LIST\'); await vme.initialiseUniCodesList(); break; \r\n\t\t\t\t\tcase "mLATEX_CODES_LIST": await vme.openWindow(\'wLATEX_CODES_LIST\'); await vme.initialiseLatexMathjaxCodesList(); break; \r\n\t\t\t\t\tcase "mLANG_RESSOURCE_LIST": await vme.openWindow(\'wLANGUAGE_LIST\'); vme.initialiseLangRessourcesList(); break; \r\n\t\t\t\t\tcase "mLATEX_DOCUMENTATION": vme.documentations.showLatexDocumentation(); break;\r\n\t\t\t\t\tcase "mMHCHEM_DOCUMENTATION": vme.documentations.showMhchemDocumentation(); break;\r\n\t\t\t\t\tcase "mAMSCD_DOCUMENTATION": vme.documentations.showAmscdDocumentation(); break;\r\n\t\t\t\t\tcase "mMATH_ML_SPECIFICATIONS": vme.documentations.showMathmlSpecifications(); break;\r\n\t\t\t\t\tcase "mCOPYRIGHT": await vme.openInformationTab(0); break; \r\n\t\t\t\t\tcase "mVERSION": await vme.openInformationTab(1); break; \r\n\t\t\t\t\tcase "mBUGS": await vme.openInformationTab(2); break; \r\n\t\t\t\t\tcase "mEQUATION_SAMPLE": await vme.openInformationTab(3); break; \r\n\t\t\t\t\tcase "f_GREEK_CHAR": await vme.initialiseUImoreDialogs("f_L_U_GREEK_CHAR"); break; \r\n\t\t\t\t\tcase "mCHARS": \r\n\t\t\t\t\tcase "f_ALL_CHAR": await vme.initialiseUImoreDialogs("f_ALL_CHAR"); break; \r\n\t\t\t\t\tcase "f_FR_CHAR": \r\n\t\t\t\t\tcase "f_BBB_CHAR": await vme.initialiseUImoreDialogs(item.target.id); break; \r\n\t\t\t\t\tcase "mEQUATION": await vme.initialiseUImoreDialogs("f_EQUATION"); break; \r\n\t\t\t\t\tcase "mCUSTOM_EQUATIONS": await vme.panels.showDynamicPanel(vme.math); break;\r\n\t\t\t\t\tcase "mHORIZONTAL_SPACING": await vme.initialiseUImoreDialogs("f_HORIZONTAL_SPACING"); break; \r\n\t\t\t\t\tcase "mVERTICAL_SPACING": await vme.initialiseUImoreDialogs("f_VERTICAL_SPACING"); break; \r\n\t\t\t\t\tcase "mSPECIAL_CHARACTER": await vme.initialiseUImoreDialogs("f_SPECIAL_CHARACTER"); break; \r\n\t\t\t\t\tcase "mHTML_MODE": $("#btENCLOSE_TYPE").click(); break; \r\n\t\t\t\t\tcase "mKEYBOARD": if (!vme.runNotVirtualKeyboard) { vme.VKI_show(document.getElementById("tKEYBOARD")); $("#keyboardInputMaster").draggable({ handle: \'#keyboardTitle\' }); } break; \r\n\t\t\t\t\tdefault: $.messager.show({ title: "<span class=\'rtl-title-withicon\'>" + vme.getLocalText("INFORMATION") + "</span>", msg: item.text }); break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tif (!window.opener) { \r\n\t\t\t$("#mQUIT_EDITOR").addClass("menu-item-disabled").click(function(event) { }); \r\n\t\t}\r\n\t\tif (typeof (FileReader) == "undefined") { \r\n\t\t\t$("#mOPEN_EQUATION").addClass("menu-item-disabled").click(function(event) { vme.testOpenFile(); }); \r\n\t\t}\r\n\t\t$("#fOPEN_EQUATION").change(function(event) { vme.openFile(event); }); \r\n\t\t\r\n\t\t// The Symbol palettes\r\n\t\tthis.initialiseUIaccordion("#f_SYMBOLS"); \r\n\t\tthis.initialiseUIaccordion("#f_SYMBOLS2"); \r\n\r\n\t\t// Configures Clicks on close buttons and Key handlers, Context menus and others\r\n\t\t$(\'#btMATRIX_CLOSE\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#wMATRIX\').dialog(\'close\'); \r\n\t\t\tvme.setFocus(); \r\n\t\t}); \r\n\t\t$(\'#btMATRIX_SET\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\tvme.setLatexMatrixInEditor(); \r\n\t\t\tvme.updateOutput(); \r\n\t\t\t$(\'#wMATRIX\').dialog(\'close\'); vme.setFocus(); \r\n\t\t}); \r\n\t\t$(\'#colsMATRIX, #rowsMATRIX\').keyup(function(event) { \r\n\t\t\tvme.updateMatrixWindow(); \r\n\t\t}); \r\n\t\t$(\'#btSTYLE_CHOISE_CLOSE\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#wSTYLE_CHOISE\').dialog(\'close\'); \r\n\t\t\tvme.setFocus(); \r\n\t\t}); \r\n\t\t$(\'#btLANGUAGE_CHOISE_CLOSE\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#wLANGUAGE_CHOISE\').dialog(\'close\'); \r\n\t\t\tvme.setFocus(); \r\n\t\t}); \r\n\t\t$(\'#btEDITOR_PARAMETERS_CLOSE\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#wEDITOR_PARAMETERS\').dialog(\'close\'); \r\n\t\t\tvme.setFocus(); \r\n\t\t}); \r\n\t\t$(\'#btRESET_WINDOW_POSITIONS\').click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\tvme.parameters.resetWindowPositions(); \r\n\t\t}); \r\n\t\t$("input[name=\'codeType\']").change(function() { \r\n\t\t\tvme.codeType = $("input[name=\'codeType\']:checked").val(); \r\n\t\t\tvme.printCodeType(); \r\n\t\t\tvme.updateOutput(); \r\n\t\t});\r\n\t\t$("#mathVisualOutput").bind(\'contextmenu\', function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\t$(\'#mVIEW\').menu(\'show\', { left: event.pageX, top: event.pageY }); \r\n\t\t\treturn false; \r\n\t\t}); \r\n\t\t$("[information]").mouseover(function(event) { \r\n\t\t\t$("#divInformation").html(vme.getLocalText($(this).attr("information"))); \r\n\t\t}); \r\n\t\t$("[information]").mouseout(function(event) { \r\n\t\t\t$("#divInformation").html("&nbsp;"); \r\n\t\t}); \r\n\t\t$(\'#unicodeChoise\').combobox({ \r\n\t\t\tvalueField: \'value\', \r\n\t\t\ttextField: \'text\', \r\n\t\t\tonSelect: async function(record) { \r\n\t\t\t\tvar range = record.value.split(","); \r\n\t\t\t\tawait vme.setUniCodesValues(vme.h2d(range[0]), \r\n\t\t\t\tvme.h2d(range[1])); \r\n\t\t\t}, \r\n\t\t\tonLoadSuccess: async function() { \r\n\t\t\t\t$(this).combobox("select", "0x25A0,0x25FF"); \r\n\t\t\t\tawait vme.setUniCodesValues(0x25A0, 0x25FF); \r\n\t\t\t} \r\n\t\t});\r\n\r\n\t\t$(\'body\').on(\'click\', \'#btCOPYRIGHT\', async function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\tawait vme.openInformationTab(0); \r\n\t\t\tvme.setFocus(); \r\n\t\t});\r\n\r\n\t\t$(\'body\').on(\'click\', \'#btTITLE_EDITION_SYNTAX,#btENCLOSE_TYPE\', async function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\tvme.setFocus(); \r\n\t\t});\r\n\t\t\r\n\t\t// TEST: MAIL\r\n\t\t$(\'body\')\r\n\t\t.on(\'mouseover\', \'a.bt\', function(event) {\r\n\t\t\tvar href = $(this).attr(\'href\');\r\n\t\t\tif (!$(this).hasClass(\'easyui-tooltip\')) {\r\n\t\t\t\t$(this)\r\n\t\t\t\t.addClass(\'easyui-tooltip\')\r\n\t\t\t\t.tooltip({\r\n\t\t\t\t\tposition: \'bottom\',\r\n\t\t\t\t\tcontent: `<span>${href}</span>`\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t/* NOT WORKING\r\n\t\t.on(\'click\', \'a.bt\', function(event) {\r\n\t\t\tvar href = $(this).attr(\'href\');\r\n\t\t\tif (href.startsWith(\'mailto\')) {\r\n\t\t\t\tconsole.info(`Mail request to : ${href}`);\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\twindow.open(href, \'_blank\', \'popup=true\');\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t\t*/\r\n\t\r\n\t\tthis.math.updateLatexMenu();\r\n\t\tthis.htmlToolbarButtons(); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Activates information tabs on the information dialog.\r\n\t * \r\n\t * @param numTab - number (index) of the tab (0..3)\r\n\t */\r\n\tasync openInformationTab(numTab) { \r\n\t\tawait this.openWindow(\'wINFORMATIONS\');\r\n\t\t$(\'#tINFORMATIONS\').tabs(\'select\', numTab); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initializes one of the "MORE" dialogs.\r\n\t * \r\n\t * @param fPanelID - the panel id (this is the panel from which the more dialog is originating)\r\n\t */\r\n\tasync initialiseUImoreDialogs(fPanelID) {\r\n\t\tvar vme = this;\r\n\t\tvar fPanelMoreID = \'w\' + fPanelID + \'_MORE\';\r\n\t\tawait vme.panels.showMoreDialog(fPanelMoreID, vme.initialiseSymbolContent.bind(vme));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Registers events for a window and opens it.\r\n\t * \r\n\t * This whole effort is done to get the window position and size persisted.\r\n\t * \r\n\t * @param id - the HTML id of the window\r\n\t */\r\n\tasync openWindow(id) {\r\n\t\tawait this.panels.showWindow(id);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Adapt UI to code type. (Latex or Ascii).\r\n\t * \r\n\t * TODO: This is obsolete and can be removed in the future.\r\n\t */\r\n\tprintCodeType() { \r\n\t\t$("[name=\'codeType\']").filter("[value=" + this.codeType + "]").attr("checked", "checked"); \r\n\t\t$("#title_Edition_Current_Syntax").text(this.codeType); \r\n\t\t$("#title_Edition_Other_Syntax").text((this.codeType == "AsciiMath") ? "Latex" : "AsciiMath"); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Same as *printCodeType*.\r\n\t */\r\n\tinitialiseCodeType() {\r\n\t\tthis.printCodeType();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initializes the Equation from the parameters.\r\n\t * \r\n\t * This includes copying it to the editor and displaying it in the output field.\r\n\t */\r\n\tinitialiseEquation() {\r\n\t\tvar vme = this;\r\n\t\tvar param = this.parameters.equation;\r\n\t\tif (param && typeof (param) != "undefined") {\r\n\t\t\tthis.codeMirrorEditor.setValue(param); \r\n\t\t\tthis.setCodeMirrorCursorAtEnd(); \r\n\t\t\tthis.updateOutput();\r\n\t\t} \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialises all **configuration** parameters including start time initialisation and change\r\n\t * \t\t\t handlers.\r\n\t */\r\n\tinitialiseParameters() {\r\n\t\t\r\n\t\tvar vme = this;\r\n\t\tfunction onChange(target, value) {\r\n\t\t\tconsole.debug(`Checkbox content of ${$(target).attr(\'id\')} changed to : ${value} `);\r\n\t\t\tif (value) {\r\n\t\t\t\t$(target).attr(\'checked\', \'checked\');\r\n\t\t\t} else {\r\n\t\t\t\t$(target).removeAttr(\'checked\');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction onAdditionalChange(value) {\r\n\t\t\tif (value) {\r\n\t\t\t\t$("#btENCLOSE_TYPE").removeClass("unselect"); \r\n\t\t\t\t$(\'#HTML_TAG\').show(); \r\n\t\t\t\tvme.codeMirrorEditor.setOption("mode", "text/html"); \r\n\t\t\t\tvme.codeMirrorEditor.setOption("autoCloseTags", true); \r\n\t\t\t} else {\r\n\t\t\t\t$("#btENCLOSE_TYPE").addClass("unselect"); \r\n\t\t\t\t$(\'#HTML_TAG\').hide(); \r\n\t\t\t\tvme.codeMirrorEditor.setOption("mode", "text/x-latex"); \r\n\t\t\t\tvme.codeMirrorEditor.setOption("autoCloseTags", false); \r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tonChange(\'#encloseType\', this.encloseAllFormula);\r\n\t\tonAdditionalChange(this.encloseAllFormula);\r\n\t\t$("#autoUpdateTime").val(this.autoUpdateTime);\r\n\t\tonChange(\'#menuupdateType\', this.menuupdateType);\r\n\t\tonChange(\'#autoupdateType\', this.autoupdateType);\r\n\t\tonChange(\'#persistWindowPositions\', this.persistWindowPositions);\r\n\t\tonChange(\'#persistEquations\', this.persistEquations);\r\n\t\t\r\n\t\t$("#encloseType").change(function(event) {\r\n\t\t\tvme.encloseAllFormula = !vme.encloseAllFormula;\r\n\t\t\tonChange(event.target, vme.encloseAllFormula);\r\n\t\t\tonAdditionalChange(vme.encloseAllFormula);\r\n\t\t\tvme.updateOutput(); \r\n\t\t}); \r\n\t\t$("#autoUpdateTime").change(function(event) { \r\n\t\t\tvme.autoUpdateTime = $("#autoUpdateTime").val(); \r\n\t\t});\r\n\t\t$("#menuupdateType").change(function(event) {\r\n\t\t\tvme.menuupdateType = !vme.menuupdateType;\r\n\t\t\tonChange(event.target, vme.menuupdateType);\r\n\t\t}); \r\n\t\t$("#autoupdateType").change(function(event) { \r\n\t\t\tvme.autoupdateType = !vme.autoupdateType;\r\n\t\t\tonChange(event.target, vme.autoupdateType);\r\n\t\t}); \r\n\t\t$("#persistWindowPositions").change(function(event) { \r\n\t\t\tvme.persistWindowPositions = !vme.persistWindowPositions;\r\n\t\t\tonChange(event.target, vme.persistWindowPositions);\r\n\t\t}); \r\n\t\t$("#persistEquations").change(function(event) { \r\n\t\t\tvme.persistEquations = !vme.persistEquations;\r\n\t\t\tonChange(event.target, vme.persistEquations);\r\n\t\t}); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Not defined for Katex. Reserved for future use.\r\n\t */\r\n\tasync initialiseLatexMathjaxCodesList() {\r\n\t\tif (!this.latexMathjaxCodesListLoaded) {\r\n\t\t\tfunction listNames(obj, prefix) {\r\n\t\t\t\tvar html = ""; \r\n\t\t\t\tfor (var i in obj) { \r\n\t\t\t\t\tif (obj[i] != \'Space\') html += (\'<tr><td dir="ltr"><a href="#" class="s" latex="\' + prefix + i + \'">\' + prefix + i + \'</a></td><td></td></tr>\'); \r\n\t\t\t\t}\r\n\t\t\t\treturn html;\r\n\t\t\t}\r\n\t\t\tfunction listNamesValues(obj, prefix) {\r\n\t\t\t\tvar html = ""; \r\n\t\t\t\tvar hexa = 0; \r\n\t\t\t\tvar output = ""; \r\n\t\t\t\tfor (var i in obj) { \r\n\t\t\t\t\tif (typeof obj[i] === \'object\') { \r\n\t\t\t\t\t\thexa = parseInt(obj[i][0], 16); \r\n\t\t\t\t\t\tif (isNaN(hexa)) output = obj[i][0]; else output = "&#x" + obj[i][0] + ";"; \r\n\t\t\t\t\t\thtml += (\'<tr><td dir="ltr"><a href="#" class="s" latex="\' + prefix + i + \'">\' + prefix + i + \'</a><td style="font-size:150%;"><a href="#" class="s" latex="\' + prefix + i + \'">\' + output + \'</a></td></tr>\'); \r\n\t\t\t\t\t} else { \r\n\t\t\t\t\t\thexa = parseInt(obj[i], 16); \r\n\t\t\t\t\t\tif (isNaN(hexa)) output = obj[i]; else output = "&#x" + obj[i] + ";"; \r\n\t\t\t\t\t\thtml += (\'<tr><td dir="ltr"><a href="#" class="s" latex="\' + prefix + i + \'">\' + prefix + i + \'</a><td style="font-size:150%;"><a href="#" class="s" latex="\' + prefix + i + \'">\' + output + \'</a></td></tr>\'); \r\n\t\t\t\t\t} \r\n\t\t\t\t}\r\n\t\t\t\treturn html;\r\n\t\t\t}\r\n\t\t\tif (!Object.keys) {\r\n\t\t\t\tObject.keys = function(obj) {\r\n\t\t\t\t\tvar keys = [], k; \r\n\t\t\t\t\tfor (k in obj) { \r\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(obj, k)) { keys.push(k); } \r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn keys;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tvar special = {}; \r\n\t\t\tvar remap = {}; \r\n\t\t\tvar mathchar0mi = {}; \r\n\t\t\tvar mathchar0mo = {}; \r\n\t\t\tvar mathchar7 = {}; \r\n\t\t\tvar delimiter = {}; \r\n\t\t\tvar macros = {}; \r\n\t\t\tvar environment = {}; \r\n\t\t\tvar length = (Object.keys(special).length + Object.keys(remap).length + Object.keys(mathchar0mi).length + Object.keys(mathchar0mo).length + Object.keys(mathchar7).length + Object.keys(delimiter).length + Object.keys(macros).length + Object.keys(environment).length); var html = ("<table border=\'1\' cellspacing=\'0\' style=\'margin-left:20px;border-spacing:0px;border-collapse:collapse;\'><caption>" + length + " <span locate=\'MATHJAX_LATEX_SYMBOLS\'>" + this.getLocalText("MATHJAX_LATEX_SYMBOLS") + "</span></caption>"); html += ("\\n<tr><th><span locate=\'MATHJAX_LATEX_INPUT\'>" + this.getLocalText("MATHJAX_LATEX_INPUT") + "</span></th><th><span locate=\'OUTPUT\'>" + this.getLocalText("OUTPUT") + "</span></th></tr>"); \r\n\t\t\thtml += listNames(special, ""); \r\n\t\t\thtml += listNamesValues(remap, ""); \r\n\t\t\thtml += listNamesValues(mathchar0mi, "\\\\"); \r\n\t\t\thtml += listNamesValues(mathchar0mo, "\\\\"); \r\n\t\t\thtml += listNamesValues(mathchar7, "\\\\"); \r\n\t\t\thtml += listNamesValues(delimiter, ""); \r\n\t\t\thtml += listNames(macros, "\\\\"); \r\n\t\t\thtml += listNames(environment, ""); \r\n\t\t\thtml += "\\n</table>"; \r\n\t\t\t$("#cLATEX_CODES_LIST").html(html); \r\n\t\t\tawait this.initialiseSymbolContent("cLATEX_CODES_LIST"); \r\n\t\t\tthis.latexMathjaxCodesListLoaded = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialises the Unicode List.\r\n\t */\r\n\tasync initialiseUniCodesList() {\r\n\t\tvar vme = this;\r\n\t\tif (!this.uniCodesListLoaded) {\r\n\t\t\tvar html = "<table><caption>[0x0000,0xFFFF]</caption>"; \r\n\t\t\tfor (var i = 0; i <= 650; i = i + 10) {\r\n\t\t\t\thtml += "\\n<tr>"; \r\n\t\t\t\tfor (var j = i; j < i + 10; j++) { \r\n\t\t\t\t\tif (j > 655) break;\r\n\t\t\t\t\tvar cellDec = (i < 10 ? "00" : (i < 100 ? "0" : "")) + j;\r\n\t\t\t\t\thtml += `<td><a style=\'border:1px solid #f0f0f0;\' class=\'s\' href=\'#\'>${cellDec}</a></td>`; \r\n\t\t\t\t}\r\n\t\t\t\thtml += "</tr>";\r\n\t\t\t}\r\n\t\t\thtml = html + "\\n</table>"; \r\n\t\t\t$("#cUNICODES_LIST").html(html);\r\n\t\t\t$("#cUNICODES_LIST a.s")\r\n\t\t\t\t.click(async function(event) {\r\n\t\t\t\t\tconsole.debug(`click event`);\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar j = parseInt($(this).text());\r\n\t\t\t\t\tawait vme.selectUniCodesValues(((j * 100) + 1), ((j + 1) * 100));\r\n\t\t\t\t\treturn false;\t\r\n\t\t\t\t}); \r\n\t\t\tthis.uniCodesListLoaded = true; \r\n\t\t\t$(\'#unicodeChoise\').combobox("reload", `formulas/unicodeChoiseData.json`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Selects a range of Unicode Characters and inserts it in a table.\r\n\t */\r\n\tasync selectUniCodesValues(i1, i2) { \r\n\t\t$(\'#unicodeChoise\').combobox("select", ""); \r\n\t\tawait this.setUniCodesValues(i1, i2, true); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Inserts a range of Unicode Characters for display in the table.\r\n\t */\r\n\tasync setUniCodesValues(i1, i2, breakFFFF) {\r\n\t\tvar html = ("<table border=\'1\' cellspacing=\'0\' style=\'border-spacing:0px;border-collapse:collapse;\'>"); \r\n\t\thtml += `\r\n\t\t\t<tr>\r\n\t\t\t\t<th><span locate=\'UNICODES_INPUT\'>${this.getLocalText("UNICODES_INPUT")}</span></th>\r\n\t\t\t\t<th>HEXA</th>\r\n\t\t\t\t<th><span locate=\'OUTPUT\'>${this.getLocalText("OUTPUT")}</span></th>\r\n\t\t\t</tr>\r\n\t\t`;\r\n\t\tfor (var i = i1; i <= i2; i++) { \r\n\t\t\tif (breakFFFF & i > 65535) break; \r\n\t\t\thtml += `\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>${i}</td>\r\n\t\t\t\t\t<td style=\'text-align:center;\'>${this.d2h(i)}</td>\r\n\t\t\t\t\t<td style=\'font-size:150%;text-align:center;\'>\r\n\t\t\t\t\t\t<a href=\'#\' class=\'s\' latex=\'\\\\char"${this.d2h(i)} \'>&#${i};</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr> \r\n\t\t\t`;\r\n\t\t}\r\n\t\thtml = html + "\\n</table>"; \r\n\t\t$("#cUNICODES_VALUES").html(html); \r\n\t\t$("#cUNICODES_VALUES").scrollTop(0); \r\n\t\tawait this.initialiseSymbolContent("cUNICODES_VALUES");\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Opens the Matrix window with given rows and columns values.\r\n\t * \r\n\t * @param {int} rows - the number of matrix rows \r\n\t * @param {int} cols - the number of matrix columns\r\n\t */\r\n\tshowMatrixWindow(rows, cols) { \r\n\t\tthis.openWindow(\'wMATRIX\'); \r\n\t\tthis.updateMatrixWindow(rows, cols); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Updates the Matrix window with given rows and columns values.\r\n\t * \r\n\t * @param {int} rows - the number of matrix rows \r\n\t * @param {int} cols - the number of matrix columns\r\n\t */\r\n\tasync updateMatrixWindow(rows, cols) {\r\n\t\tvar vme = this;\r\n\t\tif (typeof (rows != "undefined") && rows != null) document.formMATRIX.rowsMATRIX.value = rows; \r\n\t\tif (typeof (cols != "undefined") && cols != null) document.formMATRIX.colsMATRIX.value = cols; \r\n\t\trows = document.formMATRIX.rowsMATRIX.value; \r\n\t\tcols = document.formMATRIX.colsMATRIX.value; \r\n\t\tvar html = \'<table style="border-spacing:0px; border-collapse:collapse;">\'; \r\n\t\tvar r, c, value; for (r = 1; r <= rows; r++) {\r\n\t\t\thtml += "<tr>"; \r\n\t\t\tfor (c = 1; c <= cols; c++) {\r\n\t\t\t\tvalue = ("a_{" + r + c + "}");\r\n\t\t\t\thtml = html + "<td><input type=\'text\' size=\'5\' name=\'a_" + r + c + "\' value=\'" + value + "\'/></td>";\r\n\t\t\t}\r\n\t\t\thtml += "</tr>";\r\n\t\t}\r\n\t\thtml += "</table>"; \r\n\t\t$("#showMATRIX").html(html); \r\n\t\tawait this.parser.parseAsync(\'#wMATRIX\');\t\t\t\t\t\t\t\t\t\t// after dynamically set the content\r\n\t\t$(\'#wMATRIX\').dialog(\'open\'); \r\n\t\tvar width = 20 + $("#tableMATRIX").width(); \r\n\t\tvar height = 100 + $("#tableMATRIX").height(); \r\n\t\tif (width < 240) width = 240; \r\n\t\tif (height < 160) height = 160; \r\n\t\t$(\'#wMATRIX\').dialog({ title: vme.getLocalText("MATRIX"), width: width, height: height }); \r\n\t\t$(\'#wMATRIX\').dialog(\'open\');\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Transfers the Matrix displayed in the Matrix window to the Editor.\r\n\t */\r\n\tsetLatexMatrixInEditor() {\r\n\t\tvar vme = this; \r\n\t\tvar cols = document.formMATRIX.colsMATRIX.value; \r\n\t\tvar rows = document.formMATRIX.rowsMATRIX.value; \r\n\t\tvar formula = ""; \r\n\t\tvar r, c; \r\n\t\tfor (r = 1; r <= rows; r++) {\r\n\t\t\tfor (c = 1; c <= cols; c++) { \r\n\t\t\t\teval("formula = formula + document.formMATRIX.a_" + r + c + ".value"); \r\n\t\t\t\tif (c < cols) formula += " & "; \r\n\t\t\t}\r\n\t\t\tif (r < rows) formula += " \\\\\\\\ ";\r\n\t\t}\r\n\t\tvar left = document.formMATRIX.leftbracketMATRIX.value; \r\n\t\tvar right = document.formMATRIX.rightbracketMATRIX.value; \r\n\t\tvar matrix = ""; \r\n\t\tif (left != "{:") matrix += "\\\\left "; \r\n\t\tif (left == "{" || left == "}") matrix += "\\\\"; \r\n\t\tif (left == "||") matrix += "\\\\|"; \r\n\t\tif (left == "(:") matrix += "\\\\langle"; \r\n\t\tif (left == ":)") matrix += "\\\\rangle"; \r\n\t\tif (left != "{:" && left != "||" && left != ":)" && left != "(:") matrix += document.formMATRIX.leftbracketMATRIX.value; \r\n\t\tmatrix += " \\\\begin{matrix} "; matrix += formula; \r\n\t\tmatrix += " \\\\end{matrix} "; \r\n\t\tif (right != ":}") matrix += " \\\\right "; \r\n\t\tif (right == "}" || right == "{") matrix += "\\\\";\r\n\t\tif (right == "||") matrix += "\\\\|"; \r\n\t\tif (right == "(:") matrix += "\\\\langle"; \r\n\t\tif (right == ":)") matrix += "\\\\rangle"; \r\n\t\tif (right != ":}" && right != "||" && right != ":)" && right != "(:") matrix += document.formMATRIX.rightbracketMATRIX.value; \r\n\t\tmatrix += " "; \r\n\t\tvme.insert(matrix);\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Wrapper of the Localizer routine.\r\n\t */\t\r\n\tgetLocalText(TEXT_CODE) { \r\n\t\ttry { \r\n\t\t\treturn this.localizer.getLocalText(TEXT_CODE);\r\n\t\t} catch (e) { return ""; } \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract This is the observer for Language changes, it switches the language of the UI.\r\n\t * \r\n\t * It does this by:\r\n\t * - setting document language\r\n\t * - setting the RTL style\r\n\t * - localize all entries of the UI (using *span[locate]*)\r\n\t */\r\n\tasync onLocaleChanged(localizer) {\r\n\t\tthis.localType = this.localizer.currentLocale;\r\n\t\tconsole.log(`Entry into onLocaleChanged, localType is: ${this.localType}`);\r\n\t\tvar vme = this; \r\n\t\t\r\n\t\t$("html").attr("xml:lang", vme.getLocalText("_i18n_HTML_Lang")); \r\n\t\t$("html").attr("lang", vme.getLocalText("_i18n_HTML_Lang")); \r\n\t\t$("html").attr("dir", vme.getLocalText("_i18n_HTML_Dir")); \r\n\t\tvme.setRTLstyle();\r\n\t\t\r\n\t\t$("span[locate]").each(\r\n\t\t\tfunction() { \r\n\t\t\t\tif (typeof ($(this).attr("locate")) != "undefined") { \r\n\t\t\t\t\tvar localText = vme.getLocalText($(this).attr("locate")); \r\n\t\t\t\t\tif (typeof (localText) != "undefined") $(this).html(localText); \r\n\t\t\t\t} \r\n\t\t\t});\r\n\r\n\t\tvme.switchHtmlMode(vme.encloseAllFormula);\r\n\t\t\r\n\t\tthis.printCodeType();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Handlers for the HTML toolbar buttons.\r\n\t * \r\n\t * This is the only place, where the ColorPicker is used. The click events\r\n\t * are assigned to static Html content, no need to re-invoke this in\r\n\t * *onLocaleChanged*.\r\n\t */\r\n\thtmlToolbarButtons() {\r\n\t\tvar vme = this;\r\n\t\t$("#btHTML_STRONG").click(function(event) { event.preventDefault(); vme.tag("<strong>", "</strong>"); }); \r\n\t\t$("#btHTML_EM").click(function(event) { event.preventDefault(); vme.tag("<em>", "</em>"); }); \r\n\t\t$("#btHTML_U").click(function(event) { event.preventDefault(); vme.tag("<u>", "</u>"); }); \r\n\t\t$("#btHTML_S").click(function(event) { event.preventDefault(); vme.tag("<s>", "</s>"); }); \r\n\t\t$("#btHTML_BR").click(function(event) { event.preventDefault(); vme.insert("<br/>"); }); \r\n\t\t$("#btHTML_P").click(function(event) { event.preventDefault(); vme.tag("<p>", "</p>"); }); \r\n\t\t$("#btHTML_H1").click(function(event) { event.preventDefault(); vme.tag("<h1>", "</h1>"); }); \r\n\t\t$("#btHTML_H2").click(function(event) { event.preventDefault(); vme.tag("<h2>", "</h2>"); }); \r\n\t\t$("#btHTML_H3").click(function(event) { event.preventDefault(); vme.tag("<h3>", "</h3>"); }); \r\n\t\t$("#btHTML_Latex").click(function(event) { event.preventDefault(); vme.tag("$", " $"); }); \r\n\t\t$("#btHTML_LatexLine").click(function(event) { event.preventDefault(); vme.tag("$$", " $$"); }); \r\n\t\t$("#btHTML_AsciiMath").click(function(event) { event.preventDefault(); vme.tag("`", " `"); }); \r\n\t\t$("#btHTML_OL").click(function(event) { event.preventDefault(); vme.tag("\\n<ol>\\n\\t<li>", "</li>\\n</ol>\\n"); }); \r\n\t\t$("#btHTML_UL").click(function(event) { event.preventDefault(); vme.tag("\\n<ul>\\n\\t<li>", "</li>\\n</ul>\\n"); }); \r\n\t\t$("#btHTML_A").click(function(event) { event.preventDefault(); vme.tag("<a href=\\"http://www.equatheque.net\\">", "</a>"); }); \r\n\t\t$("#btHTML_HR").click(function(event) { event.preventDefault(); vme.insert("<hr/>"); }); \r\n\t\t$("#btHTML_IMG").click(function(event) { event.preventDefault(); vme.insert("<img src=\\"http://www.equatheque.net/image/EquaThEque.png\\"/>"); }); \r\n\t\t$("#btHTML_CENTER").click(function(event) { event.preventDefault(); vme.tag("<p style=\\"text-align:center\\">", "</p>"); }); \r\n\t\t$("#btHTML_LEFT").click(function(event) { event.preventDefault(); vme.tag("<p style=\\"text-align:left\\">", "</p>"); }); \r\n\t\t$("#btHTML_RIGHT").click(function(event) { event.preventDefault(); vme.tag("<p style=\\"text-align:right\\">", "</p>"); }); \r\n\t\t$("#btHTML_JUSTIFY").click(function(event) { event.preventDefault(); vme.tag("<p style=\\"text-align:justify\\">", "</p>"); }); \r\n\t\t$("#btHTML_INDENT").click(function(event) { event.preventDefault(); vme.tag("<p style=\\"margin-left:40px;text-align:justify\\">", "</p>"); }); \r\n\t\tif (!vme.runNotColorPicker) { \r\n\t\t\t$(\'#btHTML_TEXTCOLOR\').ColorPicker({ \r\n\t\t\t\tcolor: \'#0000ff\', \r\n\t\t\t\tflat: false, \r\n\t\t\t\tonShow: function(colpkr) { $(colpkr).fadeIn(500); return false; }, \r\n\t\t\t\tonHide: function(colpkr) { $(colpkr).fadeOut(500); return false; }, \r\n\t\t\t\tonChange: function(hsb, hex, rgb) { $(\'#btHTML_TEXTCOLOR\').css(\'backgroundColor\', \'#\' + hex); }, \r\n\t\t\t\tonSubmit: function(hsb, hex, rgb, el) { \r\n\t\t\t\t\t$(el).css(\'backgroundColor\', \'#\' + hex); \r\n\t\t\t\t\t$(el).ColorPickerHide(); \r\n\t\t\t\t\tvme.tag("<span style=\\"color:#" + hex + "\\">", "</span>"); \r\n\t\t\t\t} \r\n\t\t\t}); \r\n\t\t\t$(\'#btHTML_FORECOLOR\').ColorPicker({ \r\n\t\t\t\tcolor: \'#0000ff\', \r\n\t\t\t\tflat: false, \r\n\t\t\t\tonShow: function(colpkr) { $(colpkr).fadeIn(500); return false; }, \r\n\t\t\t\tonHide: function(colpkr) { $(colpkr).fadeOut(500); return false; }, \r\n\t\t\t\tonChange: function(hsb, hex, rgb) { $(\'#btHTML_FORECOLOR\').css(\'backgroundColor\', \'#\' + hex); }, \r\n\t\t\t\tonSubmit: function(hsb, hex, rgb, el) { \r\n\t\t\t\t\t$(el).css(\'backgroundColor\', \'#\' + hex); \r\n\t\t\t\t\t$(el).ColorPickerHide(); \r\n\t\t\t\t\tvme.tag("<span style=\\"background-color:#" + hex + "\\">", "</span>"); \r\n\t\t\t\t} \r\n\t\t\t}); \r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Switches the Html mode into a given state.\r\n\t * \r\n\t * @param toEnclose - target state\r\n\t */\r\n\tswitchHtmlMode(toEnclose) {\r\n\t\t// $("#btENCLOSE_TYPE").linkbutton(\'disable\');\r\n\t\tvar vme = this; \r\n\t\tif (toEnclose) { \r\n\t\t\t$("#encloseType").attr("checked", "checked"); \r\n\t\t\t$("#btENCLOSE_TYPE").removeClass("unselect"); \r\n\t\t\t$(\'#HTML_TAG\').show(); \r\n\t\t\tvme.codeMirrorEditor.setOption("mode", "text/html"); \r\n\t\t\tvme.codeMirrorEditor.setOption("autoCloseTags", true); \r\n\t\t} else { \r\n\t\t\t$("#encloseType").removeAttr("checked"); \r\n\t\t\t$("#btENCLOSE_TYPE").addClass("unselect"); \r\n\t\t\t$(\'#HTML_TAG\').hide(); \r\n\t\t\tvme.codeMirrorEditor.setOption("mode", "text/x-latex"); \r\n\t\t\tvme.codeMirrorEditor.setOption("autoCloseTags", false); \r\n\t\t}\r\n\t\t$(\'#innerLayout\').layout();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Wrapper around Localizer routine. Builds resources dialog.\r\n\t */\r\n\tasync initialiseLangRessourcesList() {\r\n\t\tawait this.localizer.buildLocalResources(() => {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Establishs an *autoUpdateType* mode, if active.\r\n\t */\r\n\tautoUpdateOutput() {\r\n\t\tvar vme = this; \r\n\t\tif (typeof (vme.autoUpdateOutputTimeout) != "undefined" && vme.autoUpdateOutputTimeout != null) { \r\n\t\t\tclearTimeout(vme.autoUpdateOutputTimeout); \r\n\t\t\tdelete vme.autoUpdateOutputTimeout; \r\n\t\t}\r\n\t\tif (vme.autoupdateType) vme.autoUpdateOutputTimeout = setTimeout("vme.updateOutput();", vme.autoUpdateTime);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Wrapper of the appropriate Math routine. Updates the math in the \r\n\t * \t\t\t output window.\r\n\t */\r\n\tupdateOutput() {\r\n\t\tthis.math.updateOutput();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Wrapper of the appropriate Math routine. Inserts a piece of \r\n\t * \t\t\t math code into the editor and updates the output.\r\n\t */\t\r\n\tinsert(b) {\r\n\t\tthis.math.insert(b);\r\n\t\tthis.setFocus();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract OBSOLETE. NOT USED.\r\n\t */\r\n\tinsertBeforeEachLine(b) { \r\n\t\tthis.encloseSelection("", "", function(a) { a = a.replace(/\\r/g, ""); \r\n\t\t\treturn b + a.replace(/\\n/g, "\\n" + b) }) \r\n\t\t}\r\n\t\r\n\t/**\r\n\t * @abstract Plays a role in Html mode (obsolete).\r\n\t */\r\n\ttag(b, a) {\r\n\t\tb = b || null; a = a || b; if (!b || !a) { return }\r\n\t\tthis.codeMirrorEditor.replaceSelection(b + this.codeMirrorEditor.getSelection() + a); \r\n\t\tvar pos = this.codeMirrorEditor.getCursor(); \r\n\t\tpos.ch = pos.ch - a.length; this.codeMirrorEditor.setCursor(pos); \r\n\t\tif (this.menuupdateType) this.updateOutput(); \r\n\t\tthis.setFocus();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract OBSOLETE. NOT USED.\r\n\t */\r\n\tencloseSelection(f, j, h) {\r\n\t\tthis.mathTextInput.focus(); \r\n\t\tf = f || ""; \r\n\t\tj = j || ""; \r\n\t\tvar a, d, c, b, i, g; \r\n\t\tif (typeof (document.selection) != "undefined") { \r\n\t\t\tc = document.selection.createRange().text \r\n\t\t} else { \r\n\t\t\tif (typeof (this.mathTextInput.setSelectionRange) != "undefined") { \r\n\t\t\t\ta = this.mathTextInput.selectionStart; \r\n\t\t\t\td = this.mathTextInput.selectionEnd; \r\n\t\t\t\tb = this.mathTextInput.scrollTop; \r\n\t\t\t\tc = this.mathTextInput.value.substring(a, d) \r\n\t\t\t} \r\n\t\t}\r\n\t\tif (c.match(/ $/)) { \r\n\t\t\tc = c.substring(0, c.length - 1); \r\n\t\t\tj = j + " " \r\n\t\t}\r\n\t\tif (typeof (h) == "function") { \r\n\t\t\tg = (c) ? h.call(this, c) : h("") \r\n\t\t} else { \r\n\t\t\tg = (c) ? c : "" \r\n\t\t}\r\n\t\ti = f + g + j; \r\n\t\tif (typeof (document.selection) != "undefined") { \r\n\t\t\tvar e = document.selection.createRange().text = i; \r\n\t\t\tthis.mathTextInput.caretPos -= j.length; \r\n\t\t} else {\r\n\t\t\tif (typeof (this.mathTextInput.setSelectionRange) != "undefined") {\r\n\t\t\t\tthis.mathTextInput.value = this.mathTextInput.value.substring(0, a) + i + this.mathTextInput.value.substring(d); \r\n\t\t\t\tif (c) { \r\n\t\t\t\t\tthis.mathTextInput.setSelectionRange(a + i.length, a + i.length); \r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (j != "") { \r\n\t\t\t\t\t\tthis.mathTextInput.setSelectionRange(a + f.length, a + f.length); \r\n\t\t\t\t\t} else { \r\n\t\t\t\t\t\tthis.mathTextInput.setSelectionRange(a + i.length, a + i.length); \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.mathTextInput.scrollTop = b\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.menuupdateType) this.updateOutput();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Menu command to open a file with formula.\r\n\t * \r\n\t * Checks, if *FileReader* is present and if so, initiates a file open action.\r\n\t */\r\n\ttestOpenFile() { \r\n\t\tif (typeof (FileReader) == "undefined") { \r\n\t\t\t$.messager.alert(\r\n\t\t\t\t"<span class=\'rtl-title-withicon\'>" + this.getLocalText("ERROR") + "</span>", \r\n\t\t\t\t"VisualMathEditor JAVASCRIPT ERROR : \\n\\nFileReader isn\'t supported!", \r\n\t\t\t\t\'error\'); \r\n\t\t} else { \r\n\t\t\tdocument.getElementById("fOPEN_EQUATION").click(); \r\n\t\t} \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The initiated file open action, implemented by clicking onan anchor element.\r\n\t */\r\n\topenFile(event) {\r\n\t\tvar vme = this;\r\n\t\tvar file = event.target.files ? event.target.files[0] : event.target.value; \r\n\t\tvar reader = new FileReader(); \r\n\t\treader.onload = function() {\r\n\t\t\tvme.codeMirrorEditor.setValue(this.result); \r\n\t\t\tvme.setCodeMirrorCursorAtEnd(); \r\n\t\t\tvme.updateOutput();\r\n\t\t}; \r\n\t\treader.readAsText(file, "UTF-8");\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Saves the formula in Editor to a file.\r\n\t */\r\n\tsaveEquationFile() {\r\n\t\tvar vme = this;\r\n\t\tvar content = ""; \r\n\t\tcontent = vme.codeMirrorEditor.getValue();\r\n\t\t\r\n\t\tvar fileHandler = new FileHandler();\r\n\t\tfileHandler.saveFile(content, "application/x-download", "fSAVE_EQUATION"); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The style chosen is set up for the UI.\r\n\t */\r\n\tonStyleChanged(style, rtlStyle, colorType) {\r\n\t\tthis.style = style;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// necessary to persist and delegate\r\n\t\ttry {\r\n\t\t\tvar colorImg = "black", codemirrorCSS = "default", colorpickerCSS = "gray"; \r\n\t\t\t\r\n\t\t\tif (colorType == "black") {\r\n\t\t\t\tcolorImg = "white"\r\n\t\t\t\tcodemirrorCSS = "twilight"; \r\n\t\t\t\tcolorpickerCSS = "black";\r\n\t\t\t}\r\n\t\t\tthis.codeMirrorTheme = codemirrorCSS;\r\n\t\t\tthis.codeMirrorEditor.setOption("theme", codemirrorCSS); \r\n\t\t\tif (!this.runNotColorPicker) { \r\n\t\t\t\t$("#colorpickerCSSblack").prop(\'disabled\', !(colorpickerCSS == "black"));\r\n\t\t\t\t$("#colorpickerCSSgray").prop(\'disabled\', !(colorpickerCSS == "gray"));\r\n\t\t\t}\r\n\t\t\tvar posColor, posExt; \r\n\t\t\t$(".symbol_btn").each(function(index) { \r\n\t\t\t\tif (this.className.indexOf("icon-matrix") > -1) { \r\n\t\t\t\t\tposColor = this.className.lastIndexOf("_"); \r\n\t\t\t\t\tif (posColor) this.className = this.className.substr(0, posColor + 1) + colorImg; \r\n\t\t\t\t} \r\n\t\t\t}); \r\n\t\t\tthis.setRTLstyle();\r\n\t\t}\r\n\t\tcatch(e) {\r\n\t\t\tconsole.error(`onStyleChanged error: ${e}`);\t\t\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Updates the RTL flag after the language resource is updated.\r\n\t * \r\n\t * Evt transfer this functionality to Themes.\r\n\t */\t\r\n\tsetRTLstyle() {\r\n\t\tvar dir = this.getLocalText("_i18n_HTML_Dir");\r\n\t\tthis.rtlStyle = dir;\r\n\t\tthis.themes.setRTLstyle(dir);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Convert text to boolean. Only "true" is truthy.\r\n\t */\r\n\tgetBoolean(text) { return (text == "true"); }\r\n\t\r\n\t/**\r\n\t * @abstract Decimal to hex conversion.\r\n\t */\r\n\td2h(d) { return d.toString(16).toUpperCase(); }\r\n\t\r\n\t/**\r\n\t * @abstract Hex to decimal conversion.\r\n\t */\r\n\th2d(h) { return parseInt(h, 16); }\r\n\t\r\n\t/**\r\n\t * @abstract Html-encodes string for attributes (quotes only).\r\n\t */\r\n\tencodeStringForHTMLAttr(s) { \r\n\t\tif (typeof s == "string") return s.replace("\\"", "&quot;"); else return ""; \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Loads a script. Actually only used by virtual keyboard.\r\n\t */\r\n\tloadScript(url, callback) {\r\n\t\tvar script = document.createElement("script"); \r\n\t\tscript.type = "text/javascript"; \r\n\t\tscript.src = url; \r\n\t\tif (script.readyState) { \r\n\t\t\tscript.onreadystatechange = function() {\r\n\t\t\t\t \r\n\t\t\t\tif (script.readyState == "loaded" || script.readyState == "complete") { \r\n\t\t\t\t\tscript.onreadystatechange = null; \r\n\t\t\t\t\tcallback(); \r\n\t\t\t\t} \r\n\t\t\t}; \r\n\t\t} else { \r\n\t\t\tscript.onload = function() { callback(); }; \r\n\t\t}\r\n\t\tdocument.body.appendChild(script);\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initializes an accordion (several palettes with symbols).\r\n\t */\r\n\tinitialiseUIaccordion(accordionID) {\r\n\t\tvar vme = this; \r\n\t\t$(accordionID).accordion({\r\n\t\t\tonSelect: function(title) {\r\n\r\n\t\t\t\tvar fPanel = $(accordionID).accordion("getSelected"); \r\n\t\t\t\tif (fPanel) { \r\n\t\t\t\t\tvar fPanelID = $(fPanel).attr("id"); \r\n\t\t\t\t\tif (vme.symbolPanelsLoaded.indexOf(fPanelID) == -1) { \r\n\t\t\t\t\t\tvme.symbolPanelsLoaded.push(fPanelID);\r\n\t\t\t\t\t\t$(fPanel).html(`<img src="icons/loading.gif" />`);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar options = $(fPanel).panel(\'options\');\r\n\t\t\t\t\t\toptions.onLoad = async function() { \r\n\t\t\t\t\t\t\tawait vme.initialiseSymbolContent(fPanelID); \r\n\t\t\t\t\t\t\tvme.math.updateHeaders(`#${fPanelID}`);\t\t\t\t// with panel id not working\r\n\t\t\t\t\t\t\tawait vme.themes.activateStyle(vme.style);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$(fPanel).panel(\'refresh\', `formulas/${fPanelID}.html`);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$(`#${fPanelID}`).on(\'click\', \'a.more\', \r\n\t\t\t\t\t\t\tasync function(event) { \r\n\t\t\t\t\t\t\t\tevent.preventDefault(); \r\n\t\t\t\t\t\t\t\tawait vme.initialiseUImoreDialogs(fPanelID); \r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} \r\n\t\t\t\t}\r\n\t\t\t\tvme.setFocus();\r\n\t\t\t}\r\n\t\t}); \r\n\t\tvar p = $(accordionID).accordion(\'getSelected\'); \r\n\t\tif (p) { p.panel(\'collapse\', false); }\r\n\t\tthis.math.updateHeaders();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The routine equips the entries in the given panel with functionality.\r\n\t * \r\n\t * This is:\r\n\t * - tool tip\r\n\t * - info line\r\n\t * - click event\r\n\t */\r\n\tasync initialiseSymbolContent(fPanelID) { \r\n\t\tvar vme = this; \r\n\t\t/**\r\n\t\t * @abstract Given an anchor object, determines and returns the included\r\n\t\t * \t\t\t LATEX code used as info for tool tip and info line.\r\n\t\t */\r\n\t\tfunction getSymbol(a) {\r\n\t\t\tvar info = beginEndInfo(a);\r\n\t\t\tif (info !== null) return info[0] + info[1];\r\n\t\t\tinfo = latex(a);\r\n\t\t\tif (info !== null) return info;\r\n\t\t\treturn vme.getLocalText("NO_LATEX"); \r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * @abstract Returns the begin to end info of an anchor.\r\n\t\t */\r\n\t\tfunction beginEndInfo(a) {\r\n\t\t\tif (typeof ($(a).attr("lbegin")) != "undefined" && typeof ($(a).attr("lend")) != "undefined") \r\n\t\t\t\treturn [$(a).attr("lbegin"), $(a).attr("lend")];\r\n\t\t\treturn null; \r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * @abstract Returns the latex info of an anchor.\r\n\t\t */\r\n\t\tfunction latex(a) {\r\n\t\t\tif (typeof ($(a).attr("latex")) != "undefined")\r\n\t\t\t\treturn $(a).attr("latex");\r\n\t\t};\r\n\t\t\r\n\t\t$(`#${fPanelID} a.s`)\r\n\t\t.each(function() {\r\n\t\t\tvar tt = getSymbol(this);\r\n\t\t\tvme.math.equipWithTooltip($(this), tt, true);\r\n\t\t});\r\n\t\t$(`#${fPanelID} a.s`).on(\'click\', function(event) {\r\n\t\t\tevent.preventDefault(); \r\n\t\t\tvar info = beginEndInfo(this);\r\n\t\t\tif (info !== null) {\r\n\t\t\t\tvme.tag(...info);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tinfo = latex(this);\r\n\t\t\tif (info !== null) {\r\n\t\t\t\tvme.insert(info);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t$.messager.show({ \r\n\t\t\t\ttitle: "<span class=\'rtl-title-withicon\'>" + vme.getLocalText("INFORMATION") + "</span>", \r\n\t\t\t\tmsg: vme.getLocalText("NO_LATEX") \r\n\t\t\t}); \r\n\t\t}); \r\n\t\t\r\n\t\t// this is solely for a single ...more button linking to a dialog\r\n\t\t// containing more formulae.\r\n\t\t$(`#${fPanelID} a.more`)\r\n\t\t.addClass("easyui-tooltip")\r\n\t\t.attr("title", function(index, attr) { return "Loading more formulae"; });\r\n\r\n\t\tawait vme.parser.parseAsync("#" + fPanelID); \r\n\t\tawait this.math.updateTables();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Updates a few dialogs with formulae.\r\n\t * \r\n\t * The candidates here are:\r\n\t * - the panels of the info dialog\r\n\t * - the equation dialog\r\n\t * - the special characters dialog\r\n\t */\r\n\tasync updateInfo() {\r\n\t\tvar vme = this;\r\n\t\t$(\'div[href]\')\r\n\t\t.each(function( idx ) {\r\n\t\t\tvar href = $(this).attr(\'href\');\r\n\t\t\tvar id = $(this).attr(\'id\');\r\n\t\t\tif (href.length <= 1) {\t\t\t\t\t\t\t\t\t\t\t\t\t// info html !\r\n\t\t\t\tconsole.info(`Info dialog with : id : ${id}, href : ${href}`);\r\n\t\t\t\tvar newHref = `information/${id}.html`;\t\t\t\t\t\t\t\t// lazily load html info\r\n\t\t\t\t$(this).attr(\'href\', newHref);\r\n\t\t\t\t$(this).load(newHref);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tawait vme.parser.parseAsync(\'div[href]\', 0, 100);\r\n\t\tconsole.info(`Parse completed for : div[href]`);\r\n\r\n\t\tvar VKI_version = \'1.49\';\r\n\t\tvar easyuiVersion = \'1.11\';\r\n\t\t$("#VMEversion").html(`\r\n\t\t\t\t<table class="inline-table">\r\n\t\t\t\t\t<tr><td><b> ${vme.version} </b></td><td><b>Katex Input Helper / Visual Math Editor</b>, (This software)</td></tr>\r\n\t\t\t\t\t<tr><td> 0.16 </td><td>Katex</td></tr>\r\n\t\t\t\t\t<tr><td> ${(_codemirror_lib_codemirror__WEBPACK_IMPORTED_MODULE_2___default().version)} </td><td>Code Mirror</td></tr>\r\n\t\t\t\t\t<tr><td> ${VKI_version} </td><td>Virtual Keyboard</td></tr>\r\n\t\t\t\t\t<tr><td> ${$.fn.jquery} </td><td>Jquery</td></tr>\r\n\t\t\t\t\t<tr><td> ${easyuiVersion} </td><td>Jquery Easyui</td></tr>\r\n\t\t\t\t\t<tr><td> 23/05/2009 </td><td>Jquery Color Picker</td></tr>\r\n\t\t\t\t<table>`); \r\n\t\t$("#VMEdate").html((new Date()).getFullYear());\r\n\t\t\r\n\t\t// updates exactly 2 dialogs (see selectors)\r\n\t\t// TODO: necessary and additional ones required?\r\n\t\tvme.math.inplaceUpdate(\'#tEQUATION div a.s[latex], #mSPECIAL_CHARACTER div a.s[latex]\', true);\t// where and when to do that\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Sets the base location.\r\n\t * \r\n\t * This will be needed for relative paths of some content like css or html files.\r\n\t * This method is only called once in constructor.\r\n\t */\r\n\tsetBaseLocation() {\r\n\t\tvar location = $("script[src]")\r\n\t\t\t.last()\r\n\t\t\t.attr("src")\r\n\t\t\t.split(\'/\')\r\n\t\t\t.slice(0, this.useEasyLoader ? -4 : -1)\t\t\t\t// modified -2 => -1 for Web app with webpack\r\n\t\t\t.join(\'/\')\r\n\t\t\t.replace(/ /g, \'%20\')\r\n\t\t\t.replace(\'file:///\', \'file://\')\r\n\t\t\t.replace(\'file://\', \'file:///\') + \'/\';\r\n\t\tconsole.info(`Base location is : ${location}`);\r\n\t\twindow.alert(location);\r\n\r\n\t\tif (!location.includes(\'joplin\') && \r\n\t\t\t!location.includes(\'github\')) {\r\n\t\t\t\r\n\t\t\tlocation = $("script[src]")\t\t\t\t\t\t\t// seems not to work\r\n\t\t\t.last()\r\n\t\t\t.attr("src")\r\n\t\t\t.replace(\'bundle.js\', \'\');\r\n\r\n\t\t\tlocation = "http://localhost:9000/";\t\t\t\t// -> use fixed server address\r\n\t\t}\r\n\t\t\r\n\t\t$(\'html > head\').append($(\'<base />\'));\r\n\t\t$(\'html > head > base\').attr(\'href\', location);\r\n\t\t\r\n\t\treturn location;\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { KatexInputHelper };\r\n} catch(e) { }\r\n\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/dialog.js?')},"./src/assets/js/fileHandling.js":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FileHandler: () => (/* binding */ FileHandler)\n/* harmony export */ });\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n/**\r\n * Supports some (asynchronous) file operations.\r\n */\r\nclass FileHandler {\r\n\t\r\n\tconstructor() {\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Selects a file from file open dialog.\r\n\t * \r\n\t * This works in tandem with the callback selectFileCb.\r\n\t * \r\n\t * @param fileInputId - the id of an input field serving for file open clicks.\r\n\t */\r\n\tasync selectFile(fileInputId) {\r\n\t\treturn promisify(this, this.selectFileCb, fileInputId);\r\n\t}\r\n\t\r\n\tselectFileCb(fileInputId, cb) {\r\n\t\t$(`#${fileInputId}`)\r\n\t\t.change(function(event) { \r\n\t\t\tvar file = event.target.files ? event.target.files[0] : event.target.value; \r\n\t\t\tcb(null, file); \r\n\t\t}); \r\n\t\t\r\n\t\tdocument.getElementById(fileInputId).click(); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Reads a file.\r\n\t * \r\n\t * A File object must be given, provided by the FileReader object.\r\n\t * \r\n\t * @param file - the file object\r\n\t */\r\n\tasync readFile(file) {\r\n\t\treturn promisify(this, this.readFileCb, file);\r\n\t}\r\n\t\r\n\treadFileCb(file, cb) {\r\n\t\tvar reader = new FileReader(); \r\n\t\treader.onload = function() {\r\n\t\t\tcb(null, this.result); \r\n\t\t}; \r\n\t\treader.readAsText(file, "UTF-8");\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract A load file transaction.\r\n\t * \r\n\t * Selects a file with the file open dialog and reads and returns the file content.\r\n\t */\r\n\tasync loadFile(fileInputId) {\r\n\t\t\r\n\t\tvar file = await this.selectFile(fileInputId);\r\n\t\tvar text = await this.readFile(file);\r\n\r\n\t\treturn text;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Lets You select a file where the given content is written to.\r\n\t * \r\n\t * The output is written by the system after the file selection is initiated.\r\n\t * \r\n\t * @param content - the content string\r\n\t * @param type - a type string (MIME type)\r\n\t * @param fileAnchorId - the id field of an anchor to be used by the operation  \r\n\t */\t\r\n\tsaveFile(content, type, fileAnchorId) {\r\n\r\n\t\tvar selector = `#${fileAnchorId}`;\r\n\t\tvar name = "equation_vme_latex.txt"; \r\n\t\tvar blob = null;\r\n\t\t\r\n\t\ttry { \r\n\t\t\tblob = new Blob([ content ], { type: type }); \r\n\t\t} catch (e) { } \r\n\t\t\r\n\t\tvar bloburl = null; \r\n\t\tif (blob) { \r\n\t\t\tvar URL = window.URL || window.webkitURL; \r\n\t\t\ttry { \r\n\t\t\t\tbloburl = URL.createObjectURL(blob); \r\n\t\t\t} catch (e) { } \r\n\t\t}\r\n\t\t\r\n\t\t$(selector).attr("href", bloburl); \r\n\t\t$(selector).attr("download", name); \r\n\t\t$(selector).attr("type", type); \r\n\t\tvar comp = document.getElementById(fileAnchorId); \r\n\r\n\t\t// Test: TRIAL 1 was working, most probably we do not need the remaining code.\r\n\t\ttry { \r\n\t\t\tcomp.click();\r\n\t\t\tconsole.info(`File Save : TRIAL 1`);\r\n\t\t\treturn; \r\n\t\t} catch (ex) { }\r\n\r\n\t\ttry { \r\n\t\t\tif (document.createEvent) { \r\n\t\t\t\tvar e = document.createEvent(\'MouseEvents\'); \r\n\t\t\t\te.initEvent(\'click\', true, true); \r\n\t\t\t\tcomp.dispatchEvent(e); \r\n\t\t\t\tconsole.info(`File Save : TRIAL 2`);\r\n\t\t\t\treturn; \r\n\t\t\t} \r\n\t\t} catch (ex) { }\r\n\r\n\t\ttry { \r\n\t\t\tif (document.createEventObject) { \r\n\t\t\t\tvar evObj = document.createEventObject(); \r\n\t\t\t\tcomp.fireEvent("onclick", evObj); \r\n\t\t\t\tconsole.info(`File Save : TRIAL 3`);\r\n\t\t\t\treturn; \r\n\t\t\t} \r\n\t\t} catch (ex) { }\r\n\r\n\t\tif (bloburl) { \r\n\t\t\twindow.location.href = bloburl; \r\n\t\t\tconsole.info(`File Save : OUTCOME 4`);\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\t// window.location = "data:" + type + ";charset=utf-8," + encodeURIComponent(content); \r\n\t\tconsole.info(`File Save : OUTCOME 5`);\r\n\t\treturn; \r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = FileHandler;\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/fileHandling.js?')},"./src/assets/js/helpers.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Messager: () => (/* binding */ Messager),\n/* harmony export */   Utilities: () => (/* binding */ Utilities)\n/* harmony export */ });\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n/**\r\n * @abstract Encapsulates the jquery messager with frequently used options.\r\n */\r\nclass Messager {\r\n\tlocalizer = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor, localizer is injected.\r\n\t */\r\n\tconstructor(localizer) {\r\n\t\tthis.localizer = localizer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Displays an alert warning box.\r\n\t * \r\n\t * Provided messages key is translated, so you get a localized message.\r\n\t */\r\n\terror(msgKey, e) {\r\n\t\tvar error = this.localizer.getLocalText('ERROR');\r\n\t\tvar msg = this.localizer.getLocalText(msgKey);\r\n\t\t$.messager.alert(`<span class='rtl-title-withicon'>${error}</span>`, `${msg} - ${e}`, 'warning'); \t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Shows an Panel with some information or hints.\r\n\t * \r\n\t * Title key and Message key are translated.\r\n\t */\r\n\tshow(titleKey, msgKey, e = null) {\r\n\t\tvar inst = this;\r\n\t\tvar msg = inst.localizer.getLocalText(msgKey);\r\n\t\tif (e != null) {\r\n\t\t\tmsg = `<div>${msg}:</div><div style=\"color: red;\">${e}</div>`;\r\n\t\t}\r\n\t\t$.messager.show({\r\n\t\t\ttitle: `<span class='rtl-title-withicon'>${inst.localizer.getLocalText(titleKey)}</span>`,\r\n\t\t\tmsg: msg\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @abstract A Utilities class.\r\n */\r\nclass Utilities {\r\n\tlocalizer = null;\r\n\t\t\r\n\t/**\r\n\t * @abstract Constructor, localizer is injected.\r\n\t */\r\n\tconstructor(localizer) {\r\n\t\tthis.localizer = localizer;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Gets an option.\r\n\t * \r\n\t * This extracts the option without translating it.\r\n\t * \r\n\t * @param id - the id of the object, can be a window\r\n\t * @param option - the option name\r\n\t * @returns the changed option as html string\r\n\t */\r\n\tgetOption(id, option) {\r\n\t\tvar text = $(`#${id}`).window('options')[option];\r\n\t\treturn text;\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Used to localize an option.\r\n\t * \r\n\t * The option is part of a bigger **easyui** object like dialog, panel, window. Originally it\r\n\t * was meant to change the **title** of an object because that object was newly created in code.\r\n\t * \r\n\t * @param id - the id of the object, can be a window\r\n\t * @param option - the option name\r\n\t * @returns the changed option as html string\r\n\t */\t\r\n\tlocalizeOption(id, option) {\r\n\t\tvar text = $(`#${id}`).window('options')[option];\t\t\t\t\t\t\t\t// do something to preserve the TITLE: this is an option\r\n\t\tvar html = $.parseHTML(text);\t\t\t\t\t\t\t\t\t\t\t\t\t// parse it into html object\r\n\t\tvar key = $(html).attr('locate');\t\t\t\t\t\t\t\t\t\t\t\t// extract the locate attribute\r\n\t\tvar located = this.localizer.getLocalText(key);\t\t\t\t\t\t\t\t\t// use it to get localized text\r\n\t\thtml = $(html).html(located)[0].outerHTML;\t\t\t\t\t\t\t\t\t\t// insert it into orginal html\r\n\t\r\n\t\treturn html;\r\n\t}\t\t\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { Messager, Utilities };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/helpers.js?")},"./src/assets/js/i18n/icons lazy recursive ^\\.\\/.*\\.png$":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var map = {\n\t"./ar.png": [\n\t\t"./src/assets/js/i18n/icons/ar.png",\n\t\t"src_assets_js_i18n_icons_ar_png"\n\t],\n\t"./de.png": [\n\t\t"./src/assets/js/i18n/icons/de.png",\n\t\t"src_assets_js_i18n_icons_de_png"\n\t],\n\t"./es.png": [\n\t\t"./src/assets/js/i18n/icons/es.png",\n\t\t"src_assets_js_i18n_icons_es_png"\n\t],\n\t"./fr.png": [\n\t\t"./src/assets/js/i18n/icons/fr.png",\n\t\t"src_assets_js_i18n_icons_fr_png"\n\t],\n\t"./ru.png": [\n\t\t"./src/assets/js/i18n/icons/ru.png",\n\t\t"src_assets_js_i18n_icons_ru_png"\n\t],\n\t"./us.png": [\n\t\t"./src/assets/js/i18n/icons/us.png",\n\t\t"src_assets_js_i18n_icons_us_png"\n\t],\n\t"./vi.png": [\n\t\t"./src/assets/js/i18n/icons/vi.png",\n\t\t"src_assets_js_i18n_icons_vi_png"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\t\te.code = \'MODULE_NOT_FOUND\';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 1 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = "./src/assets/js/i18n/icons lazy recursive ^\\\\.\\\\/.*\\\\.png$";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/i18n/icons/_lazy_^\\.\\/.*\\.png$_namespace_object?')},"./src/assets/js/jquery-easyui-MathEditorExtend/themes lazy recursive ^\\.\\/.*\\/easyui\\.css$":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var map = {\n\t"./aguas/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui-MathEditorExtend/themes/aguas/easyui.css",\n\t\t"src_assets_js_jquery-easyui-MathEditorExtend_themes_aguas_easyui_css"\n\t],\n\t"./black/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui-MathEditorExtend/themes/black/easyui.css",\n\t\t"src_assets_js_jquery-easyui-MathEditorExtend_themes_black_easyui_css"\n\t],\n\t"./bootstrap/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui-MathEditorExtend/themes/bootstrap/easyui.css",\n\t\t"src_assets_js_jquery-easyui-MathEditorExtend_themes_bootstrap_easyui_css"\n\t],\n\t"./gray/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui-MathEditorExtend/themes/gray/easyui.css",\n\t\t"src_assets_js_jquery-easyui-MathEditorExtend_themes_gray_easyui_css"\n\t],\n\t"./metro/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui-MathEditorExtend/themes/metro/easyui.css",\n\t\t"src_assets_js_jquery-easyui-MathEditorExtend_themes_metro_easyui_css"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\t\te.code = \'MODULE_NOT_FOUND\';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = "./src/assets/js/jquery-easyui-MathEditorExtend/themes lazy recursive ^\\\\.\\\\/.*\\\\/easyui\\\\.css$";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui-MathEditorExtend/themes/_lazy_^\\.\\/.*\\/easyui\\.css$_namespace_object?')},"./src/assets/js/jquery-easyui/datagrid-cellediting.js":()=>{eval("(function($){\n\t$.extend($.fn.datagrid.defaults, {\n\t\tclickToEdit: true,\n\t\tdblclickToEdit: false,\n\t\tnavHandler: {\n\t\t\t'37': function(e){\n\t\t\t\tvar opts = $(this).datagrid('options');\n\t\t\t\treturn navHandler.call(this, e, opts.isRtl?'right':'left');\n\t\t\t},\n\t\t\t'39': function(e){\n\t\t\t\tvar opts = $(this).datagrid('options');\n\t\t\t\treturn navHandler.call(this, e, opts.isRtl?'left':'right');\n\t\t\t},\n\t\t\t'38': function(e){\n\t\t\t\treturn navHandler.call(this, e, 'up');\n\t\t\t},\n\t\t\t'40': function(e){\n\t\t\t\treturn navHandler.call(this, e, 'down');\n\t\t\t},\n\t\t\t'13': function(e){\n\t\t\t\treturn enterHandler.call(this, e);\n\t\t\t},\n\t\t\t'27': function(e){\n\t\t\t\treturn escHandler.call(this, e);\n\t\t\t},\n\t\t\t'8': function(e){\n\t\t\t\treturn clearHandler.call(this, e);\n\t\t\t},\n\t\t\t'46': function(e){\n\t\t\t\treturn clearHandler.call(this, e);\n\t\t\t},\n\t\t\t'keypress': function(e){\n\t\t\t\tif (e.metaKey || e.ctrlKey){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar dg = $(this);\n\t\t\t\tvar param = dg.datagrid('cell');\t// current cell information\n\t\t\t\tif (!param){return;}\n\t\t\t\tvar input = dg.datagrid('input', param);\n\t\t\t\tif (!input){\n\t\t\t\t\tvar tmp = $('<span></span>');\n\t\t\t\t\ttmp.html(String.fromCharCode(e.which));\n\t\t\t\t\tvar c = tmp.text();\n\t\t\t\t\ttmp.remove();\n\t\t\t\t\tif (c){\n\t\t\t\t\t\tdg.datagrid('editCell', {\n\t\t\t\t\t\t\tindex: param.index,\n\t\t\t\t\t\t\tfield: param.field,\n\t\t\t\t\t\t\tvalue: c\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn false;\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonBeforeCellEdit: function(index, field){},\n\t\tonCellEdit: function(index, field, value){\n\t\t\tvar input = $(this).datagrid('input', {index:index, field:field});\n\t\t\tif (input){\n\t\t\t\tif (value != undefined){\n\t\t\t\t\tinput.val(value);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonSelectCell: function(index, field){},\n\t\tonUnselectCell: function(index, field){}\n\t});\n\n\tfunction navHandler(e, dir){\n\t\tvar dg = $(this);\n\t\tvar param = dg.datagrid('cell');\n\t\tvar input = dg.datagrid('input', param);\n\t\tif (!input){\n\t\t\tdg.datagrid('gotoCell', dir);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction enterHandler(e){\n\t\tvar dg = $(this);\n\t\tvar cell = dg.datagrid('cell');\n\t\tif (!cell){return;}\n\t\tvar input = dg.datagrid('input', cell);\n\t\tif (input){\n\t\t\tif (input[0].tagName.toLowerCase() == 'textarea'){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tendCellEdit(this, true);\n\t\t} else {\n\t\t\tdg.datagrid('editCell', cell);\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction escHandler(e){\n\t\tendCellEdit(this, false);\n\t\treturn false;\n\t}\n\n\tfunction clearHandler(e){\n\t\tvar dg = $(this);\n\t\tvar param = dg.datagrid('cell');\n\t\tif (!param){return;}\n\t\tvar input = dg.datagrid('input', param);\n\t\tif (!input){\n\t\t\tdg.datagrid('editCell', {\n\t\t\t\tindex: param.index,\n\t\t\t\tfield: param.field,\n\t\t\t\tvalue: ''\n\t\t\t});\n\t\t\treturn false;\n\t\t}\t\t\n\t}\n\n\tfunction getCurrCell(target){\n\t\tvar cell = $(target).datagrid('getPanel').find('td.datagrid-row-selected');\n\t\tif (cell.length){\n\t\t\treturn {\n\t\t\t\tindex: parseInt(cell.closest('tr.datagrid-row').attr('datagrid-row-index')),\n\t\t\t\tfield: cell.attr('field')\n\t\t\t};\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tfunction unselectCell(target, p){\n\t\tvar opts = $(target).datagrid('options');\n\t\tvar cell = opts.finder.getTr(target, p.index).find('td[field=\"'+p.field+'\"]');\n\t\tcell.removeClass('datagrid-row-selected');\n\t\topts.onUnselectCell.call(target, p.index, p.field);\n\t}\n\n\tfunction unselectAllCells(target){\n\t\tvar panel = $(target).datagrid('getPanel');\n\t\tpanel.find('td.datagrid-row-selected').removeClass('datagrid-row-selected');\n\t}\n\n\tfunction selectCell(target, p){\n\t\tvar opts = $(target).datagrid('options');\n\t\tif (opts.singleSelect){\n\t\t\tunselectAllCells(target);\n\t\t}\n\t\tvar cell = opts.finder.getTr(target, p.index).find('td[field=\"'+p.field+'\"]');\n\t\tcell.addClass('datagrid-row-selected');\n\t\topts.onSelectCell.call(target, p.index, p.field);\n\t}\n\n\tfunction getSelectedCells(target){\n\t\tvar cells = [];\n\t\tvar panel = $(target).datagrid('getPanel');\n\t\tpanel.find('td.datagrid-row-selected').each(function(){\n\t\t\tvar td = $(this);\n\t\t\tcells.push({\n\t\t\t\tindex: parseInt(td.closest('tr.datagrid-row').attr('datagrid-row-index')),\n\t\t\t\tfield: td.attr('field')\n\t\t\t});\n\t\t});\n\t\treturn cells;\n\t}\n\n\tfunction gotoCell(target, p){\n\t\tvar dg = $(target);\n\t\tvar opts = dg.datagrid('options');\n\t\tvar panel = dg.datagrid('getPanel').focus();\n\n\t\tvar cparam = dg.datagrid('cell');\n\t\tif (cparam){\n\t\t\tvar input = dg.datagrid('input', cparam);\n\t\t\tif (input){\n\t\t\t\tinput.focus();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof p == 'object'){\n\t\t\t_go(p);\n\t\t\treturn;\n\t\t}\n\t\tvar cell = panel.find('td.datagrid-row-selected');\n\t\tif (!cell){return;}\n\t\tvar fields = dg.datagrid('getColumnFields',true).concat(dg.datagrid('getColumnFields'));\n\t\tvar field = cell.attr('field');\n\t\tvar tr = cell.closest('tr.datagrid-row');\n\t\tvar rowIndex = parseInt(tr.attr('datagrid-row-index'));\n\t\tvar colIndex = $.inArray(field, fields);\n\n\t\tif (p == 'up' && rowIndex > 0){\n\t\t\trowIndex--;\n\t\t} else if (p == 'down'){\n\t\t\tif (opts.finder.getRow(target, rowIndex+1)){\n\t\t\t\trowIndex++;\n\t\t\t}\n\t\t} else if (p == 'left'){\n\t\t\tvar i = colIndex - 1;\n\t\t\twhile(i >= 0){\n\t\t\t\tvar col = dg.datagrid('getColumnOption', fields[i]);\n\t\t\t\tif (!col.hidden){\n\t\t\t\t\tcolIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti--;\n\t\t\t}\n\t\t} else if (p == 'right'){\n\t\t\tvar i = colIndex + 1;\n\t\t\twhile(i <= fields.length-1){\n\t\t\t\tvar col = dg.datagrid('getColumnOption', fields[i]);\n\t\t\t\tif (!col.hidden){\n\t\t\t\t\tcolIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\n\t\tfield = fields[colIndex];\n\n\t\t_go({index:rowIndex, field:field});\n\n\t\tfunction _go(p){\n\t\t\tdg.datagrid('scrollTo', p.index);\n\t\t\tunselectAllCells(target);\n\t\t\tselectCell(target, p);\n\t\t\tvar td = opts.finder.getTr(target, p.index, 'body', 2).find('td[field=\"'+p.field+'\"]');\n\t\t\tif (td.length){\n\t\t\t\tvar body2 = dg.data('datagrid').dc.body2;\n\t\t\t\tvar left = td.position().left;\n\t\t\t\tif (left < 0){\n\t\t\t\t\tbody2._scrollLeft(body2._scrollLeft() + left*(opts.isRtl?-1:1));\n\t\t\t\t} else if (left+td._outerWidth()>body2.width()){\n\t\t\t\t\tbody2._scrollLeft(body2._scrollLeft() + (left+td._outerWidth()-body2.width())*(opts.isRtl?-1:1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// end the current cell editing\n\tfunction endCellEdit(target, accepted){\n\t\tvar dg = $(target);\n\t\tvar cell = dg.datagrid('cell');\n\t\tif (cell){\n\t\t\tvar input = dg.datagrid('input', cell);\n\t\t\tif (input){\n\t\t\t\tif (accepted){\n\t\t\t\t\tif (dg.datagrid('validateRow', cell.index)){\n\t\t\t\t\t\tdg.datagrid('endEdit', cell.index);\n\t\t\t\t\t\tdg.datagrid('gotoCell', cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdg.datagrid('gotoCell', cell);\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdg.datagrid('cancelEdit', cell.index);\n\t\t\t\t\tdg.datagrid('gotoCell', cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction editCell(target, param){\n\t\tvar dg = $(target);\n\t\tvar opts = dg.datagrid('options');\n\t\tvar input = dg.datagrid('input', param);\n\t\tif (input){\n\t\t\tdg.datagrid('gotoCell', param);\n\t\t\tinput.focus();\n\t\t\treturn;\n\t\t}\n\t\tif (!endCellEdit(target, true)){return;}\n\t\tif (opts.onBeforeCellEdit.call(target, param.index, param.field) == false){\n\t\t\treturn;\n\t\t}\n\n\t\tvar fields = dg.datagrid('getColumnFields',true).concat(dg.datagrid('getColumnFields'));\n\t\t$.map(fields, function(field){\n\t\t\tvar col = dg.datagrid('getColumnOption', field);\n\t\t\tcol.editor1 = col.editor;\n\t\t\tif (field != param.field){\n\t\t\t\tcol.editor = null;\n\t\t\t}\n\t\t});\n\n\t\tvar col = dg.datagrid('getColumnOption', param.field);\n\t\tif (col.editor){\n\t\t\tdg.datagrid('beginEdit', param.index);\n\t\t\tvar input = dg.datagrid('input', param);\n\t\t\tif (input){\n\t\t\t\tdg.datagrid('gotoCell', param);\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tinput.unbind('.cellediting').bind('keydown.cellediting', function(e){\n\t\t\t\t\t\tif (e.keyCode == 13){\n\t\t\t\t\t\t\treturn opts.navHandler['13'].call(target, e);\n\t\t\t\t\t\t\t// return false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tinput.focus();\n\t\t\t\t}, 0);\n\t\t\t\topts.onCellEdit.call(target, param.index, param.field, param.value);\n\t\t\t} else {\n\t\t\t\tdg.datagrid('cancelEdit', param.index);\n\t\t\t\tdg.datagrid('gotoCell', param);\n\t\t\t}\n\t\t} else {\n\t\t\tdg.datagrid('gotoCell', param);\n\t\t}\n\n\t\t$.map(fields, function(field){\n\t\t\tvar col = dg.datagrid('getColumnOption', field);\n\t\t\tcol.editor = col.editor1;\n\t\t});\n\t}\n\n\tfunction enableCellSelecting(target){\n\t\tvar dg = $(target);\n\t\tvar state = dg.data('datagrid');\n\t\tvar panel = dg.datagrid('getPanel');\n\t\tvar opts = state.options;\n\t\tvar dc = state.dc;\n\t\tpanel.attr('tabindex',1).css('outline-style','none').unbind('.cellediting').bind('keydown.cellediting', function(e){\n\t\t\tvar h = opts.navHandler[e.keyCode];\n\t\t\tif (h){\n\t\t\t\treturn h.call(target, e);\n\t\t\t}\n\t\t});\n\t\tdc.body1.add(dc.body2).unbind('.cellediting').bind('click.cellediting', function(e){\n\t\t\tvar tr = $(e.target).closest('.datagrid-row');\n\t\t\tif (tr.length && tr.parent().length){\n\t\t\t\tvar td = $(e.target).closest('td[field]', tr);\n\t\t\t\tif (td.length){\n\t\t\t\t\tvar index = parseInt(tr.attr('datagrid-row-index'));\n\t\t\t\t\tvar field = td.attr('field');\n\t\t\t\t\tvar p = {\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\tfield: field\n\t\t\t\t\t};\n\t\t\t\t\tif (opts.singleSelect){\n\t\t\t\t\t\tselectCell(target, p);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (opts.ctrlSelect){\n\t\t\t\t\t\t\tif (e.ctrlKey){\n\t\t\t\t\t\t\t\tif (td.hasClass('datagrid-row-selected')){\n\t\t\t\t\t\t\t\t\tunselectCell(target, p);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tselectCell(target, p);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tunselectAllCells(target);\n\t\t\t\t\t\t\t\tselectCell(target, p);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (td.hasClass('datagrid-row-selected')){\n\t\t\t\t\t\t\t\tunselectCell(target, p);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tselectCell(target, p);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind('mouseover.cellediting', function(e){\n\t\t\tvar td = $(e.target).closest('td[field]');\n\t\t\tif (td.length){\n\t\t\t\ttd.addClass('datagrid-row-over');\n\t\t\t\ttd.closest('tr.datagrid-row').removeClass('datagrid-row-over');\n\t\t\t}\n\t\t}).bind('mouseout.cellediting', function(e){\n\t\t\tvar td = $(e.target).closest('td[field]');\n\t\t\ttd.removeClass('datagrid-row-over');\n\t\t});\n\n\t\topts.isRtl = dg.datagrid('getPanel').css('direction').toLowerCase()=='rtl';\n\t\topts.OldOnBeforeSelect = opts.onBeforeSelect;\n\t\topts.onBeforeSelect = function(){\n\t\t\treturn false;\n\t\t};\n\t\tdg.datagrid('clearSelections');\n\t}\n\n\tfunction disableCellSelecting(target){\n\t\tvar dg = $(target);\n\t\tvar state = dg.data('datagrid');\n\t\tvar panel = dg.datagrid('getPanel');\n\t\tvar opts = state.options;\n\t\topts.onBeforeSelect = opts.OldOnBeforeSelect || opts.onBeforeSelect;\n\t\tpanel.unbind('.cellediting').find('td.datagrid-row-selected').removeClass('datagrid-row-selected');\n\t\tvar dc = state.dc;\n\t\tdc.body1.add(dc.body2).unbind('.cellediting');\n\t}\n\n\tfunction enableCellEditing(target){\n\t\tvar dg = $(target);\n\t\tvar opts = dg.datagrid('options');\n\t\tvar panel = dg.datagrid('getPanel');\n\t\tpanel.attr('tabindex',1).css('outline-style','none').unbind('.cellediting').bind('keydown.cellediting', function(e){\n\t\t\tvar h = opts.navHandler[e.keyCode];\n\t\t\tif (h){\n\t\t\t\treturn h.call(target, e);\n\t\t\t}\n\t\t}).bind('keypress.cellediting', function(e){\n\t\t\treturn opts.navHandler['keypress'].call(target, e);\n\t\t});\n\t\tpanel.panel('panel').unbind('.cellediting').bind('keydown.cellediting', function(e){\n\t\t\te.stopPropagation();\n\t\t}).bind('keypress.cellediting', function(e){\n\t\t\te.stopPropagation();\n\t\t}).bind('mouseover.cellediting', function(e){\n\t\t\tvar td = $(e.target).closest('td[field]');\n\t\t\tif (td.length){\n\t\t\t\ttd.addClass('datagrid-row-over');\n\t\t\t\ttd.closest('tr.datagrid-row').removeClass('datagrid-row-over');\n\t\t\t}\n\t\t}).bind('mouseout.cellediting', function(e){\n\t\t\tvar td = $(e.target).closest('td[field]');\n\t\t\ttd.removeClass('datagrid-row-over');\n\t\t});\n\n\t\topts.isRtl = dg.datagrid('getPanel').css('direction').toLowerCase()=='rtl';\n\t\topts.oldOnClickCell = opts.onClickCell;\n\t\topts.oldOnDblClickCell = opts.onDblClickCell;\n\t\topts.onClickCell = function(index, field, value){\n\t\t\tif (opts.clickToEdit){\n\t\t\t\t$(this).datagrid('editCell', {index:index,field:field});\n\t\t\t} else {\n\t\t\t\tif (endCellEdit(this, true)){\n\t\t\t\t\t$(this).datagrid('gotoCell', {\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\tfield: field\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\topts.oldOnClickCell.call(this, index, field, value);\n\t\t}\n\t\tif (opts.dblclickToEdit){\n\t\t\topts.onDblClickCell = function(index, field, value){\n\t\t\t\t$(this).datagrid('editCell', {index:index,field:field});\n\t\t\t\topts.oldOnDblClickCell.call(this, index, field, value);\n\t\t\t}\n\t\t}\n\t\topts.OldOnBeforeSelect = opts.onBeforeSelect;\n\t\topts.onBeforeSelect = function(){\n\t\t\treturn false;\n\t\t};\n\t\tdg.datagrid('clearSelections')\n\t}\n\n\tfunction disableCellEditing(target){\n\t\tvar dg = $(target);\n\t\tvar panel = dg.datagrid('getPanel');\n\t\tvar opts = dg.datagrid('options');\n\t\topts.onClickCell = opts.oldOnClickCell || opts.onClickCell;\n\t\topts.onDblClickCell = opts.oldOnDblClickCell || opts.onDblClickCell;\n\t\topts.onBeforeSelect = opts.OldOnBeforeSelect || opts.onBeforeSelect;\n\t\tpanel.unbind('.cellediting').find('td.datagrid-row-selected').removeClass('datagrid-row-selected');\n\t\tpanel.panel('panel').unbind('.cellediting');\n\t}\n\n\n\t$.extend($.fn.datagrid.methods, {\n\t\teditCell: function(jq, param){\n\t\t\treturn jq.each(function(){\n\t\t\t\teditCell(this, param);\n\t\t\t});\n\t\t},\n\t\tisEditing: function(jq, index){\n\t\t\tvar opts = $.data(jq[0], 'datagrid').options;\n\t\t\tvar tr = opts.finder.getTr(jq[0], index);\n\t\t\treturn tr.length && tr.hasClass('datagrid-row-editing');\n\t\t},\n\t\tgotoCell: function(jq, param){\n\t\t\treturn jq.each(function(){\n\t\t\t\tgotoCell(this, param);\n\t\t\t});\n\t\t},\n\t\tenableCellEditing: function(jq){\n\t\t\treturn jq.each(function(){\n\t\t\t\tenableCellEditing(this);\n\t\t\t});\n\t\t},\n\t\tdisableCellEditing: function(jq){\n\t\t\treturn jq.each(function(){\n\t\t\t\tdisableCellEditing(this);\n\t\t\t});\n\t\t},\n\t\tenableCellSelecting: function(jq){\n\t\t\treturn jq.each(function(){\n\t\t\t\tenableCellSelecting(this);\n\t\t\t});\n\t\t},\n\t\tdisableCellSelecting: function(jq){\n\t\t\treturn jq.each(function(){\n\t\t\t\tdisableCellSelecting(this);\n\t\t\t});\n\t\t},\n\t\tinput: function(jq, param){\n\t\t\tif (!param){return null;}\n\t\t\tvar ed = jq.datagrid('getEditor', param);\n\t\t\tif (ed){\n\t\t\t\tvar t = $(ed.target);\n\t\t\t\tif (t.hasClass('textbox-f')){\n\t\t\t\t\tt = t.textbox('textbox');\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t\tcell: function(jq){\t\t// get current cell info {index,field}\n\t\t\treturn getCurrCell(jq[0]);\n\t\t},\n\t\tgetSelectedCells: function(jq){\n\t\t\treturn getSelectedCells(jq[0]);\n\t\t}\n\t});\n\n})(jQuery);\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/datagrid-cellediting.js?")},"./src/assets/js/jquery-easyui/datagrid-dnd.js":()=>{eval("/**\r\n * DataGrid Dnd for jQuery EasyUI\r\n * version: 1.0.1\r\n */\r\n(function($){\r\n\t$.extend($.fn.datagrid.defaults, {\r\n\t\tdropAccept: 'tr.datagrid-row',\r\n\t\tdragSelection: false,\r\n\t\tdragDelay: 100,\r\n\t\tonBeforeDrag: function(row){},\t// return false to deny drag\r\n\t\tonStartDrag: function(row){},\r\n\t\tonStopDrag: function(row){},\r\n\t\tonDragEnter: function(targetRow, sourceRow){},\t// return false to deny drop\r\n\t\tonDragOver: function(targetRow, sourceRow){},\t// return false to deny drop\r\n\t\tonDragLeave: function(targetRow, sourceRow){},\r\n\t\tonBeforeDrop: function(targetRow, sourceRow, point){},\r\n\t\tonDrop: function(targetRow, sourceRow, point){},\t// point:'append','top','bottom'\r\n\t});\r\n\t$.extend($.fn.datagrid.methods, {\r\n\t\t_appendRows: function(jq, row){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar dg = $(this);\r\n\t\t\t\tvar rows = $.isArray(row) ? row : [row];\r\n\t\t\t\t$.map(rows, function(row){\r\n\t\t\t\t\tdg.datagrid('appendRow', row).datagrid('enableDnd', dg.datagrid('getRows').length-1);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t_insertRows: function(jq, param){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar dg = $(this);\r\n\t\t\t\tvar index = param.index;\r\n\t\t\t\tvar row = param.row;\r\n\t\t\t\tvar rows = $.isArray(row) ? row : [row];\r\n\t\t\t\t$.map(rows, function(row, i){\r\n\t\t\t\t\tdg.datagrid('insertRow', {\r\n\t\t\t\t\t\tindex: (index+i),\r\n\t\t\t\t\t\trow: row\r\n\t\t\t\t\t}).datagrid('enableDnd', index+i);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t_getRowIndexs: function(jq, row){\r\n\t\t\tvar dg = jq;\r\n\t\t\tvar rows = $.isArray(row) ? row : [row];\r\n\t\t\tvar indexs = $.map(rows, function(row){\r\n\t\t\t\treturn dg.datagrid('getRowIndex', row);\r\n\t\t\t});\r\n\t\t\treturn $.grep(indexs, function(index){\r\n\t\t\t\tif (index >= 0){return true;}\r\n\t\t\t});\r\n\t\t},\r\n\t\t_deleteRows: function(jq, indexs){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\t// sort desc\r\n\t\t\t\tindexs.sort(function(x,y){\r\n\t\t\t\t\tif (parseInt(x)>parseInt(y)){\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tfor(var i=0; i<indexs.length; i++){\r\n\t\t\t\t\t$(this).datagrid('deleteRow', indexs[i]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t_setSelections: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar rows = $(this).datagrid('getRows');\r\n\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\tif (rows[i]._selected){\r\n\t\t\t\t\t\t$(this).datagrid('selectRow', i);\r\n\t\t\t\t\t\trows[i]._selected = undefined;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tclearInsertingFlag: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar opts = $(this).datagrid('options');\r\n\t\t\t\tif (opts.insertingIndex >= 0){\r\n\t\t\t\t\tvar tr = opts.finder.getTr(this, opts.insertingIndex);\r\n\t\t\t\t\ttr.removeClass('datagrid-row-top datagrid-row-bottom');\r\n\t\t\t\t\topts.insertingIndex = -1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\t\r\n\tvar disabledDroppingRows = [];\r\n\r\n\tfunction enableDroppable(aa){\r\n\t\t$.map(aa, function(row){\r\n\t\t\t$(row).droppable('enable');\r\n\t\t});\r\n\t}\r\n\t\r\n\t$.extend($.fn.datagrid.methods, {\r\n\t\tresetDroppable: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar c = $(this).datagrid('getPanel')[0];\r\n\t\t\t\tvar my = [];\r\n\t\t\t\tvar left = [];\r\n\t\t\t\tfor(var i=0; i<disabledDroppingRows.length; i++){\r\n\t\t\t\t\tvar t = disabledDroppingRows[i];\r\n\t\t\t\t\tvar p = $(t).closest('div.datagrid-wrap');\r\n\t\t\t\t\tif (p.length && p[0] == c){\r\n\t\t\t\t\t\tmy.push(t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tleft.push(t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdisabledDroppingRows = left;\r\n\t\t\t\tenableDroppable(my);\r\n\t\t\t});\r\n\t\t},\r\n\t\tenableDnd: function(jq, index){\r\n\t\t\tif (!$('#datagrid-dnd-style').length){\r\n\t\t\t\t$('<style id=\"datagrid-dnd-style\">' +\r\n\t\t\t\t\t'.datagrid-row-top>td{border-top:1px solid red}' +\r\n\t\t\t\t\t'.datagrid-row-bottom>td{border-bottom:1px solid red}' +\r\n\t\t\t\t\t'</style>'\r\n\t\t\t\t).appendTo('head');\r\n\t\t\t}\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar target = this;\r\n\t\t\t\tvar state = $.data(this, 'datagrid');\r\n\t\t\t\tvar dg = $(this);\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\t\r\n\t\t\t\tvar draggableOptions = {\r\n\t\t\t\t\tdisabled: false,\r\n\t\t\t\t\trevert: true,\r\n\t\t\t\t\tcursor: 'pointer',\r\n\t\t\t\t\tproxy: function(source) {\r\n\t\t\t\t\t\tvar p = $('<div style=\"z-index:9999999999999\"></div>').appendTo('body');\r\n\t\t\t\t\t\tvar draggingRow = getDraggingRow(source);\r\n\t\t\t\t\t\tvar rows = $.isArray(draggingRow) ? draggingRow : [draggingRow];\r\n\t\t\t\t\t\t$.map(rows, function(row,i){\r\n\t\t\t\t\t\t\tvar index = dg.datagrid('getRowIndex', row);\r\n\t\t\t\t\t\t\tvar tr1 = opts.finder.getTr(target, index, 'body', 1);\r\n\t\t\t\t\t\t\tvar tr2 = opts.finder.getTr(target, index, 'body', 2);\r\n\t\t\t\t\t\t\ttr2.clone().removeAttr('id').removeClass('droppable').appendTo(p);\r\n\t\t\t\t\t\t\ttr1.clone().removeAttr('id').removeClass('droppable').find('td').insertBefore(p.find('tr:eq('+i+') td:first'));\r\n\t\t\t\t\t\t\t$('<td><span class=\"tree-dnd-icon tree-dnd-no\" style=\"position:static\">&nbsp;</span></td>').insertBefore(p.find('tr:eq('+i+') td:first'));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tp.find('td').css('vertical-align','middle');\r\n\t\t\t\t\t\tp.hide();\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdeltaX: 15,\r\n\t\t\t\t\tdeltaY: 15,\r\n\t\t\t\t\tdelay: opts.dragDelay,\r\n\t\t\t\t\tonBeforeDrag:function(e){\r\n\t\t\t\t\t\tvar draggingRow = getDraggingRow(this);\r\n\t\t\t\t\t\tif (opts.onBeforeDrag.call(target, draggingRow) == false){return false;}\r\n\t\t\t\t\t\tif ($(e.target).parent().hasClass('datagrid-cell-check')){return false;}\r\n\t\t\t\t\t\tif (e.which != 1){return false;}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonStartDrag: function() {\r\n\t\t\t\t\t\t$(this).draggable('proxy').css({\r\n\t\t\t\t\t\t\tleft: -10000,\r\n\t\t\t\t\t\t\ttop: -10000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar draggingRow = getDraggingRow(this);\r\n\t\t\t\t\t\tsetValid(draggingRow, false);\r\n\t\t\t\t\t\tstate.draggingRow = draggingRow;\r\n\t\t\t\t\t\topts.onStartDrag.call(target, draggingRow);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonDrag: function(e) {\r\n\t\t\t\t\t\tvar x1=e.pageX,y1=e.pageY,x2=e.data.startX,y2=e.data.startY;\r\n\t\t\t\t\t\tvar d = Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));\r\n\t\t\t\t\t\tif (d>3){\t// when drag a little distance, show the proxy object\r\n\t\t\t\t\t\t\t$(this).draggable('proxy').show();\r\n\t\t\t\t\t\t\tvar tr = opts.finder.getTr(target, parseInt($(this).attr('datagrid-row-index')), 'body');\r\n\t\t\t\t\t\t\t$.extend(e.data, {\r\n\t\t\t\t\t\t\t\tstartX: tr.offset().left,\r\n\t\t\t\t\t\t\t\tstartY: tr.offset().top,\r\n\t\t\t\t\t\t\t\toffsetWidth: 0,\r\n\t\t\t\t\t\t\t\toffsetHeight: 0\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.pageY = e.pageY;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonEndDrag: function(e){\r\n\t\t\t\t\t\tvar dd = $(this).data('draggable').droppables.filter(function(){\r\n\t\t\t\t\t\t\tvar dropObj = $(this);\r\n\t\t\t\t\t\t\tif (dropObj.droppable('options').disabled){return false;}\r\n\t\t\t\t\t\t\tif (dropObj.hasClass('datagrid-row') && !dropObj.hasClass('datagrid-row-over')){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar p2 = dropObj.offset();\r\n\t\t\t\t\t\t\tif (e.pageX > p2.left && e.pageX < p2.left + dropObj.outerWidth()\r\n\t\t\t\t\t\t\t\t\t&& e.pageY > p2.top && e.pageY < p2.top + dropObj.outerHeight()){\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar trs = dd.filter(function(){\r\n\t\t\t\t\t\t\treturn $(this).hasClass('datagrid-row');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (trs.length){\r\n\t\t\t\t\t\t\tdd = trs;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$(this).data('draggable').droppables = dd;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonStopDrag:function(){\r\n\t\t\t\t\t\tenableDroppable(disabledDroppingRows);\r\n\t\t\t\t\t\tdisabledDroppingRows = [];\r\n\t\t\t\t\t\tsetValid(state.draggingRow, true);\r\n\t\t\t\t\t\topts.onStopDrag.call(target, state.draggingRow);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tvar droppableOptions = {\r\n\t\t\t\t\tdisabled: false,\r\n\t\t\t\t\taccept: opts.dropAccept,\r\n\t\t\t\t\tonDragEnter: function(e, source){\r\n\t\t\t\t\t\tif ($(this).droppable('options').disabled){return;}\r\n\t\t\t\t\t\tvar dTarget = getDataGridTarget(this);\r\n\t\t\t\t\t\tvar dOpts = $(dTarget).datagrid('options');\r\n\t\t\t\t\t\tvar tr = dOpts.finder.getTr(dTarget, null, 'highlight');\r\n\t\t\t\t\t\tvar sRow = getDraggingRow(source);\r\n\t\t\t\t\t\tvar dRow = getRow(this);\r\n\t\t\t\t\t\tif (tr.length && dRow){\r\n\t\t\t\t\t\t\tcb();\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfunction cb(){\r\n\t\t\t\t\t\t\tif (opts.onDragEnter.call(target, dRow, sRow) == false){\r\n\t\t\t\t\t\t\t\t$(dTarget).datagrid('clearInsertingFlag');\r\n\t\t\t\t\t\t\t\ttr.droppable('disable');\r\n\t\t\t\t\t\t\t\ttr.each(function(){\r\n\t\t\t\t\t\t\t\t\tdisabledDroppingRows.push(this);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonDragOver: function(e, source) {\r\n\t\t\t\t\t\tif ($(this).droppable('options').disabled){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ($.inArray(this, disabledDroppingRows) >= 0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar dTarget = getDataGridTarget(this);\r\n\t\t\t\t\t\tvar dOpts = $(dTarget).datagrid('options');\r\n\t\t\t\t\t\tvar tr = dOpts.finder.getTr(dTarget, null, 'highlight');\r\n\t\t\t\t\t\tif (tr.length){\r\n\t\t\t\t\t\t\tif (!isValid(tr)){\r\n\t\t\t\t\t\t\t\tsetProxyFlag(source, false);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetProxyFlag(source, true);\r\n\r\n\t\t\t\t\t\tvar sRow = getDraggingRow(source);\r\n\t\t\t\t\t\tvar dRow = getRow(this);\r\n\t\t\t\t\t\tif (tr.length){\r\n\t\t\t\t\t\t\tvar pageY = source.pageY;\r\n\t\t\t\t\t\t\tvar top = tr.offset().top;\r\n\t\t\t\t\t\t\tvar bottom = tr.offset().top + tr.outerHeight();\r\n\t\t\t\t\t\t\t$(dTarget).datagrid('clearInsertingFlag');\r\n\t\t\t\t\t\t\tdOpts.insertingIndex = tr.attr('datagrid-row-index');\r\n\t\t\t\t\t\t\tif (pageY > top + (bottom - top) / 2) {\r\n\t\t\t\t\t\t\t\ttr.addClass('datagrid-row-bottom');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttr.addClass('datagrid-row-top');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (dRow){\r\n\t\t\t\t\t\t\t\tcb();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfunction cb(){\r\n\t\t\t\t\t\t\tif (opts.onDragOver.call(target, dRow, sRow) == false){\r\n\t\t\t\t\t\t\t\tsetProxyFlag(source, false);\r\n\t\t\t\t\t\t\t\t$(dTarget).datagrid('clearInsertingFlag');\r\n\t\t\t\t\t\t\t\ttr.droppable('disable');\r\n\t\t\t\t\t\t\t\ttr.each(function(){\r\n\t\t\t\t\t\t\t\t\tdisabledDroppingRows.push(this);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonDragLeave: function(e, source) {\r\n\t\t\t\t\t\tif ($(this).droppable('options').disabled){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetProxyFlag(source, false);\r\n\t\t\t\t\t\tvar dTarget = getDataGridTarget(this);\r\n\t\t\t\t\t\t$(dTarget).datagrid('clearInsertingFlag');\r\n\t\t\t\t\t\tvar sRow = getDraggingRow(source);\r\n\t\t\t\t\t\tvar dRow = getRow(this);\r\n\t\t\t\t\t\tif (dRow){\r\n\t\t\t\t\t\t\topts.onDragLeave.call(target, dRow, sRow);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonDrop: function(e, source) {\r\n\t\t\t\t\t\tif ($(this).droppable('options').disabled){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar sTarget = getDataGridTarget(source);\r\n\t\t\t\t\t\tvar dTarget = getDataGridTarget(this);\r\n\t\t\t\t\t\tvar dOpts = $(dTarget).datagrid('options');\r\n\t\t\t\t\t\tvar tr = dOpts.finder.getTr(dTarget, null, 'highlight');\r\n\r\n\t\t\t\t\t\tvar point = null;\r\n\t\t\t\t\t\tvar sRow = getDraggingRow(source);\r\n\t\t\t\t\t\tvar dRow = null;\r\n\t\t\t\t\t\tif (tr.length){\r\n\t\t\t\t\t\t\tif (!isValid(tr)){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpoint = tr.hasClass('datagrid-row-top') ? 'top' : 'bottom';\r\n\t\t\t\t\t\t\tdRow = getRow(tr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$(dTarget).datagrid('clearInsertingFlag');\r\n\t\t\t\t\t\tif (opts.onBeforeDrop.call(target, dRow, sRow, point) == false){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tinsert.call(this);\r\n\t\t\t\t\t\topts.onDrop.call(target, dRow, sRow, point);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfunction insert(){\r\n\t\t\t\t\t\t\tvar destIndex = parseInt(tr.attr('datagrid-row-index'));\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (!point){\r\n\t\t\t\t\t\t\t\tvar indexs = $(sTarget).datagrid('_getRowIndexs', sRow);\r\n\t\t\t\t\t\t\t\t$(dTarget).datagrid('_appendRows', sRow);\r\n\t\t\t\t\t\t\t\t$(sTarget).datagrid('_deleteRows', indexs);\r\n\t\t\t\t\t\t\t\t$(dTarget).datagrid('_setSelections');\r\n\t\t\t\t\t\t\t} else if (dTarget != sTarget){\r\n\t\t\t\t\t\t\t\tvar index = point == 'top' ? destIndex : (destIndex+1);\r\n\t\t\t\t\t\t\t\tif (index >= 0){\r\n\t\t\t\t\t\t\t\t\tvar indexs = $(sTarget).datagrid('_getRowIndexs', sRow);\r\n\t\t\t\t\t\t\t\t\t$(dTarget).datagrid('_insertRows', {\r\n\t\t\t\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\t\t\t\trow: sRow\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t$(sTarget).datagrid('_deleteRows', indexs);\r\n\t\t\t\t\t\t\t\t\t$(dTarget).datagrid('_setSelections');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar dg = $(dTarget);\r\n\t\t\t\t\t\t\t\tvar index = point == 'top' ? destIndex : (destIndex+1);\r\n\t\t\t\t\t\t\t\tif (index >= 0){\r\n\t\t\t\t\t\t\t\t\tvar indexs = dg.datagrid('_getRowIndexs', sRow);\r\n\t\t\t\t\t\t\t\t\tvar destIndex = parseInt(tr.attr('datagrid-row-index'));\r\n\t\t\t\t\t\t\t\t\tvar index = point == 'top' ? destIndex : (destIndex+1);\r\n\t\t\t\t\t\t\t\t\tif (index >= 0){\r\n\t\t\t\t\t\t\t\t\t\tdg.datagrid('_insertRows', {\r\n\t\t\t\t\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\t\t\t\t\trow: sRow\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tfor(var i=0; i<indexs.length; i++){\r\n\t\t\t\t\t\t\t\t\t\t\tif (indexs[i] > index){\r\n\t\t\t\t\t\t\t\t\t\t\t\tindexs[i] += indexs.length;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tdg.datagrid('_deleteRows', indexs);\r\n\t\t\t\t\t\t\t\t\t\tdg.datagrid('_setSelections');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (index != undefined){\r\n\t\t\t\t\tvar trs = opts.finder.getTr(this, index);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar trs = opts.finder.getTr(this, 0, 'allbody');\r\n\t\t\t\t}\r\n\t\t\t\ttrs.draggable(draggableOptions);\r\n\t\t\t\ttrs.droppable(droppableOptions);\r\n\t\t\t\tsetDroppable(target);\r\n\t\t\t\t\r\n\t\t\t\tfunction setProxyFlag(source, allowed){\r\n\t\t\t\t\tvar icon = $(source).draggable('proxy').find('span.tree-dnd-icon');\r\n\t\t\t\t\ticon.removeClass('tree-dnd-yes tree-dnd-no').addClass(allowed ? 'tree-dnd-yes' : 'tree-dnd-no');\r\n\t\t\t\t}\r\n\t\t\t\tfunction getRow(tr){\r\n\t\t\t\t\tif (!$(tr).hasClass('datagrid-row')){return null}\r\n\t\t\t\t\t// var target = $(tr).closest('div.datagrid-view').children('table')[0];\r\n\t\t\t\t\tvar target = $(tr).closest('div.datagrid-view').children('table,.datagrid-f')[0];\r\n\t\t\t\t\tvar opts = $(target).datagrid('options');\r\n\t\t\t\t\treturn opts.finder.getRow(target, $(tr));\r\n\t\t\t\t}\r\n\t\t\t\tfunction getDraggingRow(tr){\r\n\t\t\t\t\tif (!$(tr).hasClass('datagrid-row')){return null}\r\n\t\t\t\t\tvar target = getDataGridTarget(tr);\r\n\t\t\t\t\tvar opts = $(target).datagrid('options');\r\n\t\t\t\t\tvar rows = $(target).datagrid('getRows');\r\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\t\trows[i]._selected = undefined;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (opts.dragSelection){\r\n\t\t\t\t\t\tif ($(tr).hasClass('datagrid-row-selected')){\r\n\t\t\t\t\t\t\tvar rows = $(target).datagrid('getSelections');\r\n\t\t\t\t\t\t\t$.map(rows, function(row){\r\n\t\t\t\t\t\t\t\trow._selected = true;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn rows;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar row = opts.finder.getRow(target, $(tr));\r\n\t\t\t\t\trow._selected = $(tr).hasClass('datagrid-row-selected');\r\n\t\t\t\t\treturn row;\r\n\t\t\t\t}\r\n\t\t\t\tfunction setDroppable(target){\r\n\t\t\t\t\tgetDroppableBody(target).droppable(droppableOptions).droppable('enable');\r\n\t\t\t\t}\r\n\t\t\t\tfunction getDataGridTarget(el){\r\n\t\t\t\t\t// return $(el).closest('div.datagrid-view').children('table')[0];\r\n\t\t\t\t\treturn $(el).closest('div.datagrid-view').children('table,.datagrid-f')[0];\r\n\t\t\t\t}\r\n\t\t\t\tfunction getDroppableBody(target){\r\n\t\t\t\t\tvar dc = $(target).data('datagrid').dc;\r\n\t\t\t\t\treturn dc.view;\r\n\t\t\t\t}\r\n\t\t\t\tfunction isValid(tr){\r\n\t\t\t\t\tvar opts = $(tr).droppable('options');\r\n\t\t\t\t\tif (opts.disabled || opts.accept == 'no-accept'){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfunction setValid(rows, valid){\r\n\t\t\t\t\tvar accept = valid ? opts.dropAccept : 'no-accept';\r\n\t\t\t\t\t$.map($.isArray(rows)?rows:[rows], function(row){\r\n\t\t\t\t\t\tvar index = $(target).datagrid('getRowIndex', row);\r\n\t\t\t\t\t\topts.finder.getTr(target, index).droppable({accept:accept});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdisableDnd: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar target = this;\r\n\t\t\t\tvar state = $.data(this, 'datagrid');\r\n\t\t\t\tvar dg = $(this);\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tvar trs = opts.finder.getTr(this, 0, 'allbody');\r\n\t\t\t\ttrs.draggable('disable');\r\n\t\t\t\ttrs.droppable('disable');\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t});\r\n})(jQuery);\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/datagrid-dnd.js?")},"./src/assets/js/jquery-easyui/datagrid-filter.js":()=>{eval("/**\r\n * DataGrid Filter for jQuery EasyUI\r\n * version: 1.0.7\r\n */\r\n\r\n(function($){\r\n\tfunction getPluginName(target){\r\n\t\tif ($(target).data('treegrid')){\r\n\t\t\treturn 'treegrid';\r\n\t\t} else {\r\n\t\t\treturn 'datagrid';\r\n\t\t}\r\n\t}\r\n\r\n\tvar autoSizeColumn1 = $.fn.datagrid.methods.autoSizeColumn;\r\n\tvar loadDataMethod1 = $.fn.datagrid.methods.loadData;\r\n\tvar appendMethod1 = $.fn.datagrid.methods.appendRow;\r\n\tvar insertMethod1 = $.fn.datagrid.methods.insertRow;\r\n\tvar deleteMethod1 = $.fn.datagrid.methods.deleteRow;\r\n\t$.extend($.fn.datagrid.methods, {\r\n\t\tautoSizeColumn: function(jq, field){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar fc = $(this).datagrid('getPanel').find('.datagrid-header .datagrid-filter-c');\r\n\t\t\t\t// fc.hide();\r\n\t\t\t\tfc.css({\r\n\t\t\t\t\twidth:'1px',\r\n\t\t\t\t\theight:0\r\n\t\t\t\t});\r\n\t\t\t\tautoSizeColumn1.call($.fn.datagrid.methods, $(this), field);\r\n\t\t\t\t// fc.show();\r\n\t\t\t\tfc.css({\r\n\t\t\t\t\twidth:'',\r\n\t\t\t\t\theight:''\r\n\t\t\t\t});\r\n\t\t\t\tresizeFilter(this, field);\r\n\t\t\t});\r\n\t\t},\r\n\t\tloadData: function(jq, data){\r\n\t\t\tjq.each(function(){\r\n\t\t\t\t$.data(this, 'datagrid').filterSource = null;\r\n\t\t\t});\r\n\t\t\treturn loadDataMethod1.call($.fn.datagrid.methods, jq, data);\r\n\t\t},\r\n\t\tappendRow: function(jq, row){\r\n\t\t\tvar result = appendMethod1.call($.fn.datagrid.methods, jq, row);\r\n\t\t\tjq.each(function(){\r\n\t\t\t\tvar state = $(this).data('datagrid');\r\n\t\t\t\tif (state.filterSource){\r\n\t\t\t\t\tstate.filterSource.total++;\r\n\t\t\t\t\tif (state.filterSource.rows != state.data.rows){\r\n\t\t\t\t\t\tstate.filterSource.rows.push(row);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tinsertRow: function(jq, param){\r\n\t\t\tvar result = insertMethod1.call($.fn.datagrid.methods, jq, param);\r\n\t\t\tjq.each(function(){\r\n\t\t\t\tvar state = $(this).data('datagrid');\r\n\t\t\t\tif (state.filterSource){\r\n\t\t\t\t\tstate.filterSource.total++;\r\n\t\t\t\t\tif (state.filterSource.rows != state.data.rows){\r\n\t\t\t\t\t\tvar index = param.index || 0;\r\n\t\t\t\t\t\tif (index > state.filterSource.rows.length){\r\n\t\t\t\t\t\t\tindex = state.filterSource.rows.length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstate.filterSource.rows.splice(index, 0, param.row);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tdeleteRow: function(jq, index){\r\n\t\t\tjq.each(function(){\r\n\t\t\t\tvar state = $(this).data('datagrid');\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tif (state.filterSource && opts.idField){\r\n\t\t\t\t\tif (state.filterSource.rows == state.data.rows){\r\n\t\t\t\t\t\tstate.filterSource.total--;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfor(var i=0; i<state.filterSource.rows.length; i++){\r\n\t\t\t\t\t\t\tvar row = state.filterSource.rows[i];\r\n\t\t\t\t\t\t\tif (row[opts.idField] == state.data.rows[index][opts.idField]){\r\n\t\t\t\t\t\t\t\tstate.filterSource.rows.splice(i,1);\r\n\t\t\t\t\t\t\t\tstate.filterSource.total--;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn deleteMethod1.call($.fn.datagrid.methods, jq, index);\t\t\r\n\t\t}\r\n\t});\r\n\r\n\tvar loadDataMethod2 = $.fn.treegrid.methods.loadData;\r\n\tvar appendMethod2 = $.fn.treegrid.methods.append;\r\n\tvar insertMethod2 = $.fn.treegrid.methods.insert;\r\n\tvar removeMethod2 = $.fn.treegrid.methods.remove;\r\n\t$.extend($.fn.treegrid.methods, {\r\n\t\tloadData: function(jq, data){\r\n\t\t\tjq.each(function(){\r\n\t\t\t\t$.data(this, 'treegrid').filterSource = null;\r\n\t\t\t});\r\n\t\t\treturn loadDataMethod2.call($.fn.treegrid.methods, jq, data);\r\n\t\t},\r\n\t\tappend: function(jq, param){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar state = $(this).data('treegrid');\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tif (opts.oldLoadFilter){\r\n\t\t\t\t\tvar rows = translateTreeData(this, param.data, param.parent);\r\n\t\t\t\t\tstate.filterSource.total += rows.length;\r\n\t\t\t\t\tstate.filterSource.rows = state.filterSource.rows.concat(rows);\r\n\t\t\t\t\t$(this).treegrid('loadData', state.filterSource)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tappendMethod2($(this), param);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tinsert: function(jq, param){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar state = $(this).data('treegrid');\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tif (opts.oldLoadFilter){\r\n\t\t\t\t\tvar ref = param.before || param.after;\r\n\t\t\t\t\tvar index = getNodeIndex(param.before || param.after);\r\n\t\t\t\t\tvar pid = index>=0 ? state.filterSource.rows[index]._parentId : null;\r\n\t\t\t\t\tvar rows = translateTreeData(this, [param.data], pid);\r\n\t\t\t\t\tvar newRows = state.filterSource.rows.splice(0, index>=0 ? (param.before ? index : index+1) : (state.filterSource.rows.length));\r\n\t\t\t\t\tnewRows = newRows.concat(rows);\r\n\t\t\t\t\tnewRows = newRows.concat(state.filterSource.rows);\r\n\t\t\t\t\tstate.filterSource.total += rows.length;\r\n\t\t\t\t\tstate.filterSource.rows = newRows;\r\n\t\t\t\t\t$(this).treegrid('loadData', state.filterSource);\r\n\r\n\t\t\t\t\tfunction getNodeIndex(id){\r\n\t\t\t\t\t\tvar rows = state.filterSource.rows;\r\n\t\t\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\t\t\tif (rows[i][opts.idField] == id){\r\n\t\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tinsertMethod2($(this), param);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tremove: function(jq, id){\r\n\t\t\tjq.each(function(){\r\n\t\t\t\tvar state = $(this).data('treegrid');\r\n\t\t\t\tif (state.filterSource){\r\n\t\t\t\t\tvar opts = state.options;\r\n\t\t\t\t\tvar rows = state.filterSource.rows;\r\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\t\tif (rows[i][opts.idField] == id){\r\n\t\t\t\t\t\t\trows.splice(i, 1);\r\n\t\t\t\t\t\t\tstate.filterSource.total--;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn removeMethod2(jq, id);\r\n\t\t}\r\n\t});\r\n\r\n\tvar extendedOptions = {\r\n\t\tfilterMenuIconCls: 'icon-ok',\r\n\t\tfilterBtnIconCls: 'icon-filter',\r\n\t\tfilterBtnPosition: 'right',\r\n\t\tfilterPosition: 'bottom',\r\n\t\tremoteFilter: false,\r\n\t\tclientPaging: true,\r\n\t\tshowFilterBar: true,\r\n\t\tfilterDelay: 400,\r\n\t\tfilterRules: [],\r\n\t\t// specify whether the filtered records need to match ALL or ANY of the applied filters\r\n\t\tfilterMatchingType: 'all',\t// possible values: 'all','any'\r\n\t\tfilterIncludingChild: false,\r\n\t\t// filterCache: {},\r\n\t\tfilterMatcher: function(data){\r\n\t\t\tvar name = getPluginName(this);\r\n\t\t\tvar dg = $(this);\r\n\t\t\tvar state = $.data(this, name);\r\n\t\t\tvar opts = state.options;\r\n\t\t\tif (opts.filterRules.length){\r\n\t\t\t\tvar rows = [];\r\n\t\t\t\tif (name == 'treegrid'){\r\n\t\t\t\t\tvar rr = {};\r\n\t\t\t\t\t$.map(data.rows, function(row){\r\n\t\t\t\t\t\tif (isMatch(row, row[opts.idField])){\r\n\t\t\t\t\t\t\trr[row[opts.idField]] = row;\r\n\t\t\t\t\t\t\tvar prow = getRow(data.rows, row._parentId);\r\n\t\t\t\t\t\t\twhile(prow){\r\n\t\t\t\t\t\t\t\trr[prow[opts.idField]] = prow;\r\n\t\t\t\t\t\t\t\tprow = getRow(data.rows, prow._parentId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (opts.filterIncludingChild){\r\n\t\t\t\t\t\t\t\tvar cc = getAllChildRows(data.rows, row[opts.idField]);\r\n\t\t\t\t\t\t\t\t$.map(cc, function(row){\r\n\t\t\t\t\t\t\t\t\trr[row[opts.idField]] = row;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tfor(var id in rr){\r\n\t\t\t\t\t\trows.push(rr[id]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor(var i=0; i<data.rows.length; i++){\r\n\t\t\t\t\t\tvar row = data.rows[i];\r\n\t\t\t\t\t\tif (isMatch(row, i)){\r\n\t\t\t\t\t\t\trows.push(row);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// data = {\r\n\t\t\t\t// \ttotal: data.total - (data.rows.length - rows.length),\r\n\t\t\t\t// \trows: rows\r\n\t\t\t\t// };\r\n\t\t\t\tdata.total = data.total - (data.rows.length - rows.length);\r\n\t\t\t\tdata.rows = rows;\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t\t\r\n\t\t\tfunction isMatch(row, index){\r\n\t\t\t\tif (opts.val == $.fn.combogrid.defaults.val){\r\n\t\t\t\t\topts.val = extendedOptions.val;\r\n\t\t\t\t}\r\n\t\t\t\tvar rules = opts.filterRules;\r\n\t\t\t\tif (!rules.length){return true;}\r\n\t\t\t\tfor(var i=0; i<rules.length; i++){\r\n\t\t\t\t\tvar rule = rules[i];\r\n\r\n\t\t\t\t\t// var source = row[rule.field];\r\n\t\t\t\t\t// var col = dg.datagrid('getColumnOption', rule.field);\r\n\t\t\t\t\t// if (col && col.formatter){\r\n\t\t\t\t\t// \tsource = col.formatter(row[rule.field], row, index);\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar col = dg.datagrid('getColumnOption', rule.field);\r\n\t\t\t\t\tvar formattedValue = (col && col.formatter) ? col.formatter(row[rule.field], row, index) : undefined;\r\n\t\t\t\t\tvar source = opts.val.call(dg[0], row, rule.field, formattedValue);\r\n\r\n\t\t\t\t\tif (source == undefined){\r\n\t\t\t\t\t\tsource = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar op = opts.operators[rule.op];\r\n\t\t\t\t\tvar matched = op.isMatch(source, rule.value);\r\n\t\t\t\t\tif (opts.filterMatchingType == 'any'){\r\n\t\t\t\t\t\tif (matched){return true;}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (!matched){return false;}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn opts.filterMatchingType == 'all';\r\n\t\t\t}\r\n\t\t\tfunction getRow(rows, id){\r\n\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\tvar row = rows[i];\r\n\t\t\t\t\tif (row[opts.idField] == id){\r\n\t\t\t\t\t\treturn row;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tfunction getAllChildRows(rows, id){\r\n\t\t\t\tvar cc = getChildRows(rows, id);\r\n\t\t\t\tvar stack = $.extend(true, [], cc);\r\n\t\t\t\twhile(stack.length){\r\n\t\t\t\t\tvar row = stack.shift();\r\n\t\t\t\t\tvar c2 = getChildRows(rows, row[opts.idField]);\r\n\t\t\t\t\tcc = cc.concat(c2);\r\n\t\t\t\t\tstack = stack.concat(c2);\r\n\t\t\t\t}\r\n\t\t\t\treturn cc;\r\n\t\t\t}\r\n\t\t\tfunction getChildRows(rows, id){\r\n\t\t\t\tvar cc = [];\r\n\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\tvar row = rows[i];\r\n\t\t\t\t\tif (row._parentId == id){\r\n\t\t\t\t\t\tcc.push(row);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn cc;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaultFilterType: 'text',\r\n\t\tdefaultFilterOperator: 'contains',\r\n\t\tdefaultFilterTrigger: 'keydown',\r\n\t\tdefaultFilterOptions: {\r\n\t\t\tonInit: function(target){\r\n\t\t\t\tvar name = getPluginName(target);\r\n\t\t\t\tvar opts = $(target)[name]('options');\r\n\t\t\t\tvar filterOpts = this.filterOptions;\r\n\t\t\t\tvar field = $(this).attr('name');\r\n\t\t\t\tvar input = $(this);\r\n\t\t\t\tif (input.data('textbox')){\r\n\t\t\t\t\tinput = input.textbox('textbox');\r\n\t\t\t\t}\r\n\t\t\t\tvar trigger = filterOpts.trigger || opts.defaultFilterTrigger;\r\n\t\t\t\tinput.off('.filter').on(trigger+'.filter', function(e){\r\n\t\t\t\t\tvar t = $(this);\r\n\t\t\t\t\tif (this.timer){\r\n\t\t\t\t\t\tclearTimeout(this.timer);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (e.keyCode == 13){\r\n\t\t\t\t\t\t_doFilter();\r\n\t\t\t\t\t} else if (opts.filterDelay){\r\n\t\t\t\t\t\tthis.timer = setTimeout(function(){\r\n\t\t\t\t\t\t\t_doFilter();\r\n\t\t\t\t\t\t}, opts.filterDelay);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tfunction _doFilter(){\r\n\t\t\t\t\tvar rule = $(target)[name]('getFilterRule', field);\r\n\t\t\t\t\tvar value = input.val();\r\n\t\t\t\t\tif (filterOpts.options.prompt && filterOpts.options.prompt==value){\r\n\t\t\t\t\t\tvalue = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (value != ''){\r\n\t\t\t\t\t\tif ((rule && rule.value!=value) || !rule){\r\n\t\t\t\t\t\t\tvar op = rule ? rule.op : (filterOpts ? filterOpts.defaultFilterOperator||opts.defaultFilterOperator : opts.defaultFilterOperator);\r\n\t\t\t\t\t\t\t$(target)[name]('addFilterRule', {\r\n\t\t\t\t\t\t\t\tfield: field,\r\n\t\t\t\t\t\t\t\t// op: opts.defaultFilterOperator,\r\n\t\t\t\t\t\t\t\top: op,\r\n\t\t\t\t\t\t\t\tvalue: value\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$(target)[name]('doFilter');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (rule){\r\n\t\t\t\t\t\t\t$(target)[name]('removeFilterRule', field);\r\n\t\t\t\t\t\t\t$(target)[name]('doFilter');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tfilterStringify: function(data){\r\n\t\t\treturn JSON.stringify(data);\r\n\t\t},\r\n\t\t// the function to retrieve the field value of a row to match the filter rule\r\n\t\tval: function(row, field, formattedValue){\r\n\t\t\treturn formattedValue || row[field];\r\n\t\t},\r\n\t\tonClickMenu: function(item,button){}\r\n\t};\r\n\t$.extend($.fn.datagrid.defaults, extendedOptions);\r\n\t$.extend($.fn.treegrid.defaults, extendedOptions);\r\n\t\r\n\t// filter types\r\n\t$.fn.datagrid.defaults.filters = $.extend({}, $.fn.datagrid.defaults.editors, {\r\n\t\tlabel: {\r\n\t\t\tinit: function(container, options){\r\n\t\t\t\treturn $('<span></span>').appendTo(container);\r\n\t\t\t},\r\n\t\t\tgetValue: function(target){\r\n\t\t\t\treturn $(target).html();\r\n\t\t\t},\r\n\t\t\tsetValue: function(target, value){\r\n\t\t\t\t$(target).html(value);\r\n\t\t\t},\r\n\t\t\tresize: function(target, width){\r\n\t\t\t\t$(target)._outerWidth(width)._outerHeight(22);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t$.fn.treegrid.defaults.filters = $.fn.datagrid.defaults.filters;\r\n\t\r\n\t// filter operators\r\n\t$.fn.datagrid.defaults.operators = {\r\n\t\tnofilter: {\r\n\t\t\ttext: 'No Filter'\r\n\t\t},\r\n\t\tcontains: {\r\n\t\t\ttext: 'Contains',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\tsource = String(source);\r\n\t\t\t\tvalue = String(value);\r\n\t\t\t\treturn source.toLowerCase().indexOf(value.toLowerCase()) >= 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tequal: {\r\n\t\t\ttext: 'Equal',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source == value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tnotequal: {\r\n\t\t\ttext: 'Not Equal',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source != value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tbeginwith: {\r\n\t\t\ttext: 'Begin With',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\tsource = String(source);\r\n\t\t\t\tvalue = String(value);\r\n\t\t\t\treturn source.toLowerCase().indexOf(value.toLowerCase()) == 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tendwith: {\r\n\t\t\ttext: 'End With',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\tsource = String(source);\r\n\t\t\t\tvalue = String(value);\r\n\t\t\t\treturn source.toLowerCase().indexOf(value.toLowerCase(), source.length - value.length) !== -1;\r\n\t\t\t}\r\n\t\t},\r\n\t\tless: {\r\n\t\t\ttext: 'Less',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source < value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tlessorequal: {\r\n\t\t\ttext: 'Less Or Equal',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source <= value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgreater: {\r\n\t\t\ttext: 'Greater',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source > value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgreaterorequal: {\r\n\t\t\ttext: 'Greater Or Equal',\r\n\t\t\tisMatch: function(source, value){\r\n\t\t\t\treturn source >= value;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t$.fn.treegrid.defaults.operators = $.fn.datagrid.defaults.operators;\r\n\t\r\n\tfunction resizeFilter(target, field){\r\n\t\tvar toFixColumnSize = false;\r\n\t\tvar dg = $(target);\r\n\t\tvar header = dg.datagrid('getPanel').find('div.datagrid-header');\r\n\t\tvar tr = header.find('.datagrid-header-row:not(.datagrid-filter-row)');\r\n\t\tvar ff = field ? header.find('.datagrid-filter[name=\"'+field+'\"]') : header.find('.datagrid-filter');\r\n\t\tff.each(function(){\r\n\t\t\tvar name = $(this).attr('name');\r\n\t\t\tvar col = dg.datagrid('getColumnOption', name);\r\n\t\t\tvar cc = $(this).closest('div.datagrid-filter-c');\r\n\t\t\tvar btn = cc.find('a.datagrid-filter-btn');\r\n\t\t\tvar cell = tr.find('td[field=\"'+name+'\"] .datagrid-cell');\r\n\t\t\tvar cellWidth = cell._outerWidth();\r\n\t\t\tif (cellWidth != _getContentWidth(cc)){\r\n\t\t\t\tthis.filter.resize(this, cellWidth - btn._outerWidth());\r\n\t\t\t}\r\n\t\t\tif (cc.width() > col.boxWidth+col.deltaWidth-1){\r\n\t\t\t\tcol.boxWidth = cc.width() - col.deltaWidth + 1;\r\n\t\t\t\tcol.width = col.boxWidth + col.deltaWidth;\r\n\t\t\t\ttoFixColumnSize = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (toFixColumnSize){\r\n\t\t\t$(target).datagrid('fixColumnSize');\t\t\t\r\n\t\t}\r\n\r\n\t\tfunction _getContentWidth(cc){\r\n\t\t\tvar w = 0;\r\n\t\t\t$(cc).children(':visible').each(function(){\r\n\t\t\t\tw += $(this)._outerWidth();\r\n\t\t\t});\r\n\t\t\treturn w;\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction getFilterComponent(target, field){\r\n\t\tvar header = $(target).datagrid('getPanel').find('div.datagrid-header');\r\n\t\treturn header.find('tr.datagrid-filter-row td[field=\"'+field+'\"] .datagrid-filter');\r\n\t}\r\n\t\r\n\t/**\r\n\t * get filter rule index, return -1 if not found.\r\n\t */\r\n\tfunction getRuleIndex(target, field){\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar rules = $(target)[name]('options').filterRules;\r\n\t\tfor(var i=0; i<rules.length; i++){\r\n\t\t\tif (rules[i].field == field){\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tfunction getFilterRule(target, field){\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar rules = $(target)[name]('options').filterRules;\r\n\t\tvar index = getRuleIndex(target, field);\r\n\t\tif (index >= 0){\r\n\t\t\treturn rules[index];\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction addFilterRule(target, param){\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar opts = $(target)[name]('options');\r\n\t\tvar rules = opts.filterRules;\r\n\r\n\t\tif (param.op == 'nofilter'){\r\n\t\t\tremoveFilterRule(target, param.field);\r\n\t\t} else {\r\n\t\t\tvar index = getRuleIndex(target, param.field);\r\n\t\t\tif (index >= 0){\r\n\t\t\t\t$.extend(rules[index], param);\r\n\t\t\t} else {\r\n\t\t\t\trules.push(param);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar input = getFilterComponent(target, param.field);\r\n\t\tif (input.length){\r\n\t\t\tif (param.op != 'nofilter'){\r\n\t\t\t\tvar value = input.val();\r\n\t\t\t\tif (input.data('textbox')){\r\n\t\t\t\t\tvalue = input.textbox('getText');\r\n\t\t\t\t}\r\n\t\t\t\tif (value != param.value){\r\n\t\t\t\t\tinput[0].filter.setValue(input, param.value);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar menu = input[0].menu;\r\n\t\t\tif (menu){\r\n\t\t\t\tmenu.find('.'+opts.filterMenuIconCls).removeClass(opts.filterMenuIconCls);\r\n\t\t\t\tvar item = menu.menu('findItem', opts.operators[param.op]['text']);\r\n\t\t\t\tmenu.menu('setIcon', {\r\n\t\t\t\t\ttarget: item.target,\r\n\t\t\t\t\ticonCls: opts.filterMenuIconCls\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction removeFilterRule(target, field){\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar dg = $(target);\r\n\t\tvar opts = dg[name]('options');\r\n\t\tif (field){\r\n\t\t\tvar index = getRuleIndex(target, field);\r\n\t\t\tif (index >= 0){\r\n\t\t\t\topts.filterRules.splice(index, 1);\r\n\t\t\t}\r\n\t\t\t_clear([field]);\r\n\t\t} else {\r\n\t\t\topts.filterRules = [];\r\n\t\t\tvar fields = dg.datagrid('getColumnFields',true).concat(dg.datagrid('getColumnFields'));\r\n\t\t\t_clear(fields);\r\n\t\t}\r\n\t\t\r\n\t\tfunction _clear(fields){\r\n\t\t\tfor(var i=0; i<fields.length; i++){\r\n\t\t\t\tvar input = getFilterComponent(target, fields[i]);\r\n\t\t\t\tif (input.length){\r\n\t\t\t\t\tinput[0].filter.setValue(input, '');\r\n\t\t\t\t\tvar menu = input[0].menu;\r\n\t\t\t\t\tif (menu){\r\n\t\t\t\t\t\tmenu.find('.'+opts.filterMenuIconCls).removeClass(opts.filterMenuIconCls);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction doFilter(target){\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar state = $.data(target, name);\r\n\t\tvar opts = state.options;\r\n\t\tif (opts.remoteFilter){\r\n\t\t\t$(target)[name]('load');\r\n\t\t} else {\r\n\t\t\tif (opts.view.type == 'scrollview' && state.data.firstRows && state.data.firstRows.length){\r\n\t\t\t\tstate.data.rows = state.data.firstRows;\r\n\t\t\t}\r\n\t\t\t$(target)[name]('getPager').pagination('refresh', {pageNumber:1});\r\n\t\t\t$(target)[name]('options').pageNumber = 1;\r\n\t\t\t$(target)[name]('loadData', state.filterSource || state.data);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction translateTreeData(target, children, pid){\r\n\t\tvar opts = $(target).treegrid('options');\r\n\t\tif (!children || !children.length){return []}\r\n\t\tvar rows = [];\r\n\t\t$.map(children, function(item){\r\n\t\t\titem._parentId = pid;\r\n\t\t\trows.push(item);\r\n\t\t\trows = rows.concat(translateTreeData(target, item.children, item[opts.idField]));\r\n\t\t});\r\n\t\t$.map(rows, function(row){\r\n\t\t\t// row.children = undefined;\r\n\t\t\tdelete row.children;\r\n\t\t});\r\n\t\treturn rows;\r\n\t}\r\n\r\n\tfunction myLoadFilter(data, parentId){\r\n\t\tvar target = this;\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar state = $.data(target, name);\r\n\t\tvar opts = state.options;\r\n\r\n\t\tif (name == 'datagrid' && $.isArray(data)){\r\n\t\t\tdata = {\r\n\t\t\t\ttotal: data.length,\r\n\t\t\t\trows: data\r\n\t\t\t};\r\n\t\t} else if (name == 'treegrid' && $.isArray(data)){\r\n\t\t\tvar rows = translateTreeData(target, data, parentId);\r\n\t\t\tdata = {\r\n\t\t\t\ttotal: rows.length,\r\n\t\t\t\trows: rows\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!opts.remoteFilter || opts.clientPaging){\r\n\t\t\tif (!state.filterSource){\r\n\t\t\t\tstate.filterSource = data;\r\n\t\t\t} else {\r\n\t\t\t\tif (!opts.isSorting) {\r\n\t\t\t\t\tif (name == 'datagrid'){\r\n\t\t\t\t\t\tstate.filterSource = data;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstate.filterSource.total += data.length;\r\n\t\t\t\t\t\tstate.filterSource.rows = state.filterSource.rows.concat(data.rows);\r\n\t\t\t\t\t\tif (parentId){\r\n\t\t\t\t\t\t\treturn opts.filterMatcher.call(target, data);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\topts.isSorting = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!opts.remoteSort && opts.sortName){\r\n\t\t\t\tvar names = opts.sortName.split(',');\r\n\t\t\t\tvar orders = opts.sortOrder.split(',');\r\n\t\t\t\tvar dg = $(target);\r\n\t\t\t\tstate.filterSource.rows.sort(function(r1,r2){\r\n\t\t\t\t\tvar r = 0;\r\n\t\t\t\t\tfor(var i=0; i<names.length; i++){\r\n\t\t\t\t\t\tvar sn = names[i];\r\n\t\t\t\t\t\tvar so = orders[i];\r\n\t\t\t\t\t\tvar col = dg.datagrid('getColumnOption', sn);\r\n\t\t\t\t\t\tvar sortFunc = col.sorter || function(a,b){\r\n\t\t\t\t\t\t\treturn a==b ? 0 : (a>b?1:-1);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tr = sortFunc(r1[sn], r2[sn]) * (so=='asc'?1:-1);\r\n\t\t\t\t\t\tif (r != 0){\r\n\t\t\t\t\t\t\treturn r;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn r;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// data = opts.filterMatcher.call(target, {\r\n\t\t\t// \ttotal: state.filterSource.total,\r\n\t\t\t// \trows: state.filterSource.rows,\r\n\t\t\t// \tfooter: state.filterSource.footer||[]\r\n\t\t\t// });\r\n\t\t\tdata = opts.filterMatcher.call(target, $.extend({},state.filterSource,{\r\n\t\t\t\ttotal: state.filterSource.total,\r\n\t\t\t\trows: state.filterSource.rows,\r\n\t\t\t\tfooter: state.filterSource.footer||[]\r\n\t\t\t}));\r\n\t\t\tdata.filterRows = data.rows;\r\n\t\t}\r\n\t\tif (opts.pagination && opts.clientPaging){\r\n\t\t\tvar dg = $(target);\r\n\t\t\tvar pager = dg[name]('getPager');\r\n\t\t\tpager.pagination({\r\n\t\t\t\tonSelectPage:function(pageNum, pageSize){\r\n\t\t\t\t\topts.pageNumber = pageNum;\r\n\t\t\t\t\topts.pageSize = pageSize;\r\n\t\t\t\t\tpager.pagination('refresh',{\r\n\t\t\t\t\t\tpageNumber:pageNum,\r\n\t\t\t\t\t\tpageSize:pageSize\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// dg[name]('loadData', state.filterSource);\r\n\t\t\t\t\tif (opts.clientPaging){\r\n\t\t\t\t\t\tdg[name]('loadData', state.filterSource);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdg[name]('reload');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonBeforeRefresh:function(){\r\n\t\t\t\t\tdg[name]('reload');\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (name == 'datagrid'){\r\n\t\t\t\tvar pd = getPageData(data.rows);\r\n\t\t\t\topts.pageNumber = pd.pageNumber;\r\n\t\t\t\tdata.rows = pd.rows;\r\n\t\t\t} else {\r\n\t\t\t\tvar topRows = [];\r\n\t\t\t\tvar childRows = [];\r\n\t\t\t\t$.map(data.rows, function(row){\r\n\t\t\t\t\trow._parentId ? childRows.push(row) : topRows.push(row);\r\n\t\t\t\t});\r\n\t\t\t\tdata.total = topRows.length;\r\n\t\t\t\tvar pd = getPageData(topRows);\r\n\t\t\t\topts.pageNumber = pd.pageNumber;\r\n\t\t\t\tdata.rows = pd.rows.concat(childRows);\r\n\t\t\t}\r\n\t\t}\r\n\t\t$.map(data.rows, function(row){\r\n\t\t\t// row.children = undefined;\r\n\t\t\tdelete row.children;\r\n\t\t});\r\n\t\treturn data;\r\n\r\n\t\tfunction getPageData(dataRows){\r\n\t\t\tvar rows = [];\r\n\t\t\tvar page = opts.pageNumber;\r\n\t\t\twhile(page > 0){\r\n\t\t\t\tvar start = (page-1)*parseInt(opts.pageSize);\r\n\t\t\t\tvar end = start + parseInt(opts.pageSize);\r\n\t\t\t\trows = dataRows.slice(start, end);\r\n\t\t\t\tif (rows.length){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tpage--;\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tpageNumber: page>0?page:1,\r\n\t\t\t\trows: rows\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction init(target, filters){\r\n\t\tfilters = filters || [];\r\n\t\tvar name = getPluginName(target);\r\n\t\tvar state = $.data(target, name);\r\n\t\tvar opts = state.options;\r\n\t\tif (!opts.filterRules.length){\r\n\t\t\topts.filterRules = [];\r\n\t\t}\r\n\t\topts.filterCache = opts.filterCache || {};\r\n\t\tvar dgOpts = $.data(target, 'datagrid').options;\r\n\t\t\r\n\t\tvar onResize = dgOpts.onResize;\r\n\t\tdgOpts.onResize = function(width,height){\r\n\t\t\tresizeFilter(target);\r\n\t\t\tonResize.call(this, width, height);\r\n\t\t}\r\n\t\tvar onBeforeSortColumn = dgOpts.onBeforeSortColumn;\r\n\t\tdgOpts.onBeforeSortColumn = function(sort, order){\r\n\t\t\tvar result = onBeforeSortColumn.call(this, sort, order);\r\n\t\t\tif (result != false){\r\n\t\t\t\topts.isSorting = true;\t\t\t\t\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\tvar onResizeColumn = opts.onResizeColumn;\r\n\t\topts.onResizeColumn = function(field,width){\r\n\t\t\tvar fc = $(this).datagrid('getPanel').find('.datagrid-header .datagrid-filter-c');\r\n\t\t\tvar focusOne = fc.find('.datagrid-filter:focus');\r\n\t\t\t// fc.hide();\r\n\t\t\tfc.css({\r\n\t\t\t\twidth:'1px',\r\n\t\t\t\theight:0\r\n\t\t\t});\r\n\t\t\t$(target).datagrid('fitColumns');\r\n\t\t\tif (opts.fitColumns){\r\n\t\t\t\tresizeFilter(target);\r\n\t\t\t} else {\r\n\t\t\t\tresizeFilter(target, field);\r\n\t\t\t}\r\n\t\t\t// fc.show();\r\n\t\t\tfc.css({\r\n\t\t\t\twidth:'',\r\n\t\t\t\theight:''\r\n\t\t\t});\r\n\t\t\tfocusOne.blur().focus();\r\n\t\t\tonResizeColumn.call(target, field, width);\r\n\t\t};\r\n\t\tvar onBeforeLoad = opts.onBeforeLoad;\r\n\t\topts.onBeforeLoad = function(param1, param2){\r\n\t\t\tif (param1){\r\n\t\t\t\tparam1.filterRules = opts.filterStringify(opts.filterRules);\r\n\t\t\t}\r\n\t\t\tif (param2){\r\n\t\t\t\tparam2.filterRules = opts.filterStringify(opts.filterRules);\r\n\t\t\t}\r\n\t\t\tvar result = onBeforeLoad.call(this, param1, param2);\r\n\t\t\tif (result != false && opts.url){\r\n\t\t\t\tif (name == 'datagrid'){\r\n\t\t\t\t\tstate.filterSource = null;\r\n\t\t\t\t} else if (name == 'treegrid' && state.filterSource){\r\n\t\t\t\t\tif (param1){\r\n\t\t\t\t\t\tvar id = param1[opts.idField];\t// the id of the expanding row\r\n\t\t\t\t\t\tvar rows = state.filterSource.rows || [];\r\n\t\t\t\t\t\tfor(var i=0; i<rows.length; i++){\r\n\t\t\t\t\t\t\tif (id == rows[i]._parentId){\t// the expanding row has children\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstate.filterSource = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\t\tif ((opts.view.type == 'detailview' || opts.view.type == 'scrollview') && opts.frozenColumns && opts.frozenColumns.length) {\r\n\t\t\tvar onBeforeRender = opts.view.onBeforeRender;\r\n\t\t\topts.view.onBeforeRender = function(target){\r\n\t\t\t\tonBeforeRender.call(opts.view, target)\r\n\t\t\t\tif (!opts.detailviewFilterInited){\r\n\t\t\t\t\topts.detailviewFilterInited = true;\r\n\t\t\t\t\tvar fields = $(target).datagrid('getColumnFields', true);\r\n\t\t\t\t\tif (opts.rownumbers){\r\n\t\t\t\t\t\tfields.unshift('_');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar tr = $(target).data('datagrid').dc.header1.find('.datagrid-filter-row');\r\n\t\t\t\t\tif (tr.length < fields.length){\r\n\t\t\t\t\t\tvar index = $.inArray('_expander', fields);\r\n\t\t\t\t\t\tif (index >= 0){\r\n\t\t\t\t\t\t\tvar td = tr.children().eq(index);\r\n\t\t\t\t\t\t\tif (td.length){\r\n\t\t\t\t\t\t\t\t$('<td class=\"_expander\"></td>').insertBefore(td);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$('<td class=\"_expander\"></td>').appendTo(tr);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// opts.loadFilter = myLoadFilter;\r\n\t\topts.loadFilter = function(data, parentId){\r\n\t\t\tvar d = opts.oldLoadFilter.call(this, data, parentId);\r\n\t\t\treturn myLoadFilter.call(this, d, parentId);\r\n\t\t};\r\n\t\tstate.dc.view2.children('.datagrid-header').off('.filter').on('focusin.filter', function(e){\r\n\t\t\tvar header = $(this);\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tstate.dc.body2._scrollLeft(header._scrollLeft());\r\n\t\t\t},0);\r\n\t\t}).on('keydown.filter', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).on('keypress.filter', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tstate.dc.view1.children('.datagrid-header').off('.filter').on('keydown.filter', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).on('keypress.filter', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\r\n\t\tinitCss();\r\n\t\tcreateFilter(true);\r\n\t\tcreateFilter();\r\n\t\tif (opts.fitColumns){\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tresizeFilter(target);\r\n\t\t\t}, 0);\r\n\t\t}\r\n\r\n\t\t$.map(opts.filterRules, function(rule){\r\n\t\t\taddFilterRule(target, rule);\r\n\t\t});\r\n\t\t\r\n\t\tfunction initCss(){\r\n\t\t\tif (!$('#datagrid-filter-style').length){\r\n\t\t\t\t$('head').append(\r\n\t\t\t\t\t'<style id=\"datagrid-filter-style\">' +\r\n\t\t\t\t\t'a.datagrid-filter-btn{display:inline-block;width:22px;height:100%;margin:0;vertical-align:middle;cursor:pointer;opacity:0.6;filter:alpha(opacity=60);}' +\r\n\t\t\t\t\t'a:hover.datagrid-filter-btn{opacity:1;filter:alpha(opacity=100);}' +\r\n\t\t\t\t\t'.datagrid-filter-row .textbox,.datagrid-filter-row .textbox .textbox-text{-moz-border-radius:0;-webkit-border-radius:0;border-radius:0;}' +\r\n\t\t\t\t\t'.datagrid-filter-row input{margin:0;-moz-border-radius:0;-webkit-border-radius:0;border-radius:0;}' +\r\n\t\t\t\t\t'.datagrid-filter-c{overflow:hidden}' +\r\n\t\t\t\t\t'.datagrid-filter-cache{position:absolute;width:10px;height:10px;left:-99999px;}' +\r\n\t\t\t\t\t'</style>'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * create filter component\r\n\t\t */\r\n\t\tfunction createFilter(frozen){\r\n\t\t\tvar dc = state.dc;\r\n\t\t\tvar fields = $(target).datagrid('getColumnFields', frozen);\r\n\t\t\tif (frozen && opts.rownumbers){\r\n\t\t\t\tfields.unshift('_');\r\n\t\t\t}\r\n\t\t\tvar table = (frozen?dc.header1:dc.header2).find('table.datagrid-htable');\r\n\t\t\t\r\n\t\t\t// clear the old filter component\r\n\t\t\ttable.find('.datagrid-filter').each(function(){\r\n\t\t\t\tif (this.filter.destroy){\r\n\t\t\t\t\tthis.filter.destroy(this);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.menu){\r\n\t\t\t\t\t$(this.menu).menu('destroy');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\ttable.find('tr.datagrid-filter-row').remove();\r\n\t\t\t\r\n\t\t\tvar tr = $('<tr class=\"datagrid-header-row datagrid-filter-row\"></tr>');\r\n\t\t\tif (opts.filterPosition == 'bottom'){\r\n\t\t\t\ttr.appendTo(table.find('tbody'));\r\n\t\t\t} else {\r\n\t\t\t\ttr.prependTo(table.find('tbody'));\r\n\t\t\t}\r\n\t\t\tif (!opts.showFilterBar){\r\n\t\t\t\ttr.hide();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(var i=0; i<fields.length; i++){\r\n\t\t\t\tvar field = fields[i];\r\n\t\t\t\tvar col = $(target).datagrid('getColumnOption', field);\r\n\t\t\t\tvar td = $('<td></td>').attr('field', field).appendTo(tr);\r\n\t\t\t\tif (col && col.hidden){\r\n\t\t\t\t\ttd.hide();\r\n\t\t\t\t}\r\n\t\t\t\tif (field == '_'){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (col && (col.checkbox || col.expander)){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar fopts = getFilter(field);\r\n\t\t\t\tif (fopts){\r\n\t\t\t\t\t$(target)[name]('destroyFilter', field);\t// destroy the old filter component\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfopts = $.extend({}, {\r\n\t\t\t\t\t\tfield: field,\r\n\t\t\t\t\t\ttype: opts.defaultFilterType,\r\n\t\t\t\t\t\toptions: opts.defaultFilterOptions\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar div = opts.filterCache[field];\r\n\t\t\t\tif (!div){\r\n\t\t\t\t\tdiv = $('<div class=\"datagrid-filter-c\"></div>').appendTo(td);\r\n\t\t\t\t\tvar filter = opts.filters[fopts.type];\r\n\t\t\t\t\tvar input = filter.init(div, $.extend({height:opts.editorHeight},fopts.options||{}));\r\n\t\t\t\t\tinput.addClass('datagrid-filter').attr('name', field);\r\n\t\t\t\t\tinput[0].filter = filter;\r\n\t\t\t\t\tinput[0].filterOptions = fopts;\r\n\t\t\t\t\tinput[0].menu = createFilterButton(div, fopts.op);\r\n\t\t\t\t\tif (fopts.op && fopts.op.length){\r\n\t\t\t\t\t\tif (fopts.options && fopts.options.onInit){\r\n\t\t\t\t\t\t\tfopts.options.onInit.call(input[0], target);\r\n\t\t\t\t\t\t} else if (fopts.defaultFilterOperator){\r\n\t\t\t\t\t\t\topts.defaultFilterOptions.onInit.call(input[0], target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\topts.defaultFilterOptions.onInit.call(input[0], target);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// if (fopts.options){\r\n\t\t\t\t\t// \tif (fopts.options.onInit){\r\n\t\t\t\t\t// \t\tfopts.options.onInit.call(input[0], target);\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// } else {\r\n\t\t\t\t\t// \topts.defaultFilterOptions.onInit.call(input[0], target);\r\n\t\t\t\t\t// }\r\n\t\t\t\t\topts.filterCache[field] = div;\r\n\t\t\t\t\tresizeFilter(target, field);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdiv.appendTo(td);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction createFilterButton(container, operators){\r\n\t\t\tif (!operators){return null;}\r\n\t\t\t\r\n\t\t\tvar btn = $('<a class=\"datagrid-filter-btn\">&nbsp;</a>').addClass(opts.filterBtnIconCls);\r\n\t\t\tbtn.css('height',opts.editorHeight);\r\n\t\t\tif (opts.filterBtnPosition == 'right'){\r\n\t\t\t\tbtn.appendTo(container);\r\n\t\t\t} else {\r\n\t\t\t\tbtn.prependTo(container);\r\n\t\t\t}\r\n\r\n\t\t\tvar menu = $('<div></div>').appendTo('body');\r\n\t\t\t$.map(['nofilter'].concat(operators), function(item){\r\n\t\t\t\tvar op = opts.operators[item];\r\n\t\t\t\tif (op){\r\n\t\t\t\t\t$('<div></div>').attr('name', item).html(op.text).appendTo(menu);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tmenu.menu({\r\n\t\t\t\talignTo:btn,\r\n\t\t\t\tonClick:function(item){\r\n\t\t\t\t\tvar btn = $(this).menu('options').alignTo;\r\n\t\t\t\t\tvar td = btn.closest('td[field]');\r\n\t\t\t\t\tvar field = td.attr('field');\r\n\t\t\t\t\tvar input = td.find('.datagrid-filter');\r\n\t\t\t\t\tvar value = input[0].filter.getValue(input);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (opts.onClickMenu.call(target, item, btn, field) == false){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\taddFilterRule(target, {\r\n\t\t\t\t\t\tfield: field,\r\n\t\t\t\t\t\top: item.name,\r\n\t\t\t\t\t\tvalue: value\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tdoFilter(target);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tbtn[0].menu = menu;\r\n\t\t\tbtn.on('click', {menu:menu}, function(e){\r\n\t\t\t\t$(this.menu).menu('show');\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\treturn menu;\r\n\t\t}\r\n\t\t\r\n\t\tfunction getFilter(field){\r\n\t\t\tfor(var i=0; i<filters.length; i++){\r\n\t\t\t\tvar filter = filters[i];\r\n\t\t\t\tif (filter.field == field){\r\n\t\t\t\t\treturn filter;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t$.extend($.fn.datagrid.methods, {\r\n\t\tisFilterEnabled: function(jq){\r\n\t\t\tvar name = getPluginName(jq[0]);\r\n\t\t\tvar opts = $.data(jq[0], name).options;\r\n\t\t\tif (opts.oldLoadFilter){\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tenableFilter: function(jq, filters){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar name = getPluginName(this);\r\n\t\t\t\tvar opts = $.data(this, name).options;\r\n\t\t\t\tif (opts.oldLoadFilter){\r\n\t\t\t\t\tif (filters){\r\n\t\t\t\t\t\t$(this)[name]('disableFilter');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\topts.oldLoadFilter = opts.loadFilter;\r\n\t\t\t\tinit(this, filters);\r\n\t\t\t\t$(this)[name]('resize');\r\n\t\t\t\tif (opts.filterRules.length){\r\n\t\t\t\t\tif (opts.remoteFilter){\r\n\t\t\t\t\t\tdoFilter(this);\r\n\t\t\t\t\t} else if (opts.data){\r\n\t\t\t\t\t\tdoFilter(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdisableFilter: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar name = getPluginName(this);\r\n\t\t\t\tvar state = $.data(this, name);\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tif (!opts.oldLoadFilter){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar dc = $(this).data('datagrid').dc;\r\n\t\t\t\tvar div = dc.view.children('.datagrid-filter-cache');\r\n\t\t\t\tif (!div.length){\r\n\t\t\t\t\tdiv = $('<div class=\"datagrid-filter-cache\"></div>').appendTo(dc.view);\r\n\t\t\t\t}\r\n\t\t\t\tfor(var field in opts.filterCache){\r\n\t\t\t\t\t$(opts.filterCache[field]).appendTo(div);\r\n\t\t\t\t}\r\n\t\t\t\tvar data = state.data;\r\n\t\t\t\tif (state.filterSource){\r\n\t\t\t\t\tdata = state.filterSource;\r\n\t\t\t\t\t$.map(data.rows, function(row){\r\n\t\t\t\t\t\t// row.children = undefined;\r\n\t\t\t\t\t\tdelete row.children;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tdc.header1.add(dc.header2).find('tr.datagrid-filter-row').remove();\r\n\t\t\t\topts.loadFilter = opts.oldLoadFilter || undefined;\r\n\t\t\t\topts.oldLoadFilter = null;\r\n\t\t\t\t$(this)[name]('resize');\r\n\t\t\t\t$(this)[name]('loadData', data);\r\n\r\n\t\t\t\t// $(this)[name]({\r\n\t\t\t\t// \tdata: data,\r\n\t\t\t\t// \tloadFilter: (opts.oldLoadFilter||undefined),\r\n\t\t\t\t// \toldLoadFilter: null\r\n\t\t\t\t// });\r\n\t\t\t});\r\n\t\t},\r\n\t\tdestroyFilter: function(jq, field){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tvar name = getPluginName(this);\r\n\t\t\t\tvar state = $.data(this, name);\r\n\t\t\t\tvar opts = state.options;\r\n\t\t\t\tif (field){\r\n\t\t\t\t\t_destroy(field);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor(var f in opts.filterCache){\r\n\t\t\t\t\t\t_destroy(f);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(this).datagrid('getPanel').find('.datagrid-header .datagrid-filter-row').remove();\r\n\t\t\t\t\t$(this).data('datagrid').dc.view.children('.datagrid-filter-cache').remove();\r\n\t\t\t\t\topts.filterCache = {};\r\n\t\t\t\t\t$(this)[name]('resize');\r\n\t\t\t\t\t$(this)[name]('disableFilter');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction _destroy(field){\r\n\t\t\t\t\tvar c = $(opts.filterCache[field]);\r\n\t\t\t\t\tvar input = c.find('.datagrid-filter');\r\n\t\t\t\t\tif (input.length){\r\n\t\t\t\t\t\tvar filter = input[0].filter;\r\n\t\t\t\t\t\tif (filter.destroy){\r\n\t\t\t\t\t\t\tfilter.destroy(input[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc.find('.datagrid-filter-btn').each(function(){\r\n\t\t\t\t\t\t$(this.menu).menu('destroy');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tc.remove();\r\n\t\t\t\t\topts.filterCache[field] = undefined;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetFilterRule: function(jq, field){\r\n\t\t\treturn getFilterRule(jq[0], field);\r\n\t\t},\r\n\t\taddFilterRule: function(jq, param){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\taddFilterRule(this, param);\r\n\t\t\t});\r\n\t\t},\r\n\t\tremoveFilterRule: function(jq, field){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tremoveFilterRule(this, field);\r\n\t\t\t});\r\n\t\t},\r\n\t\tdoFilter: function(jq){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tdoFilter(this);\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetFilterComponent: function(jq, field){\r\n\t\t\treturn getFilterComponent(jq[0], field);\r\n\t\t},\r\n\t\tresizeFilter: function(jq, field){\r\n\t\t\treturn jq.each(function(){\r\n\t\t\t\tresizeFilter(this, field);\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/datagrid-filter.js?")},"./src/assets/js/jquery-easyui/jquery.easyui.min.js":()=>{eval('/**\n * EasyUI for jQuery 1.11.0\n * \n * Copyright (c) 2009-2024 www.jeasyui.com. All rights reserved.\n *\n * Licensed under the freeware license: http://www.jeasyui.com/license_freeware.php\n * To use it on other terms please contact us: info@jeasyui.com\n *\n */\n (function($){\n$.easyui={indexOfArray:function(a,o,id){\nfor(var i=0,_1=a.length;i<_1;i++){\nif(id==undefined){\nif(a[i]==o){\nreturn i;\n}\n}else{\nif(a[i][o]==id){\nreturn i;\n}\n}\n}\nreturn -1;\n},removeArrayItem:function(a,o,id){\nif(typeof o=="string"){\nfor(var i=0,_2=a.length;i<_2;i++){\nif(a[i][o]==id){\na.splice(i,1);\nreturn;\n}\n}\n}else{\nvar _3=this.indexOfArray(a,o);\nif(_3!=-1){\na.splice(_3,1);\n}\n}\n},addArrayItem:function(a,o,r){\nvar _4=this.indexOfArray(a,o,r?r[o]:undefined);\nif(_4==-1){\na.push(r?r:o);\n}else{\na[_4]=r?r:o;\n}\n},getArrayItem:function(a,o,id){\nvar _5=this.indexOfArray(a,o,id);\nreturn _5==-1?null:a[_5];\n},forEach:function(_6,_7,_8){\nvar _9=[];\nfor(var i=0;i<_6.length;i++){\n_9.push(_6[i]);\n}\nwhile(_9.length){\nvar _a=_9.shift();\nif(_8(_a)==false){\nreturn;\n}\nif(_7&&_a.children){\nfor(var i=_a.children.length-1;i>=0;i--){\n_9.unshift(_a.children[i]);\n}\n}\n}\n}};\n$.parser={auto:true,emptyFn:function(){\n},onComplete:function(_b){\n},plugins:["draggable","droppable","resizable","pagination","tooltip","linkbutton","menu","sidemenu","menubutton","splitbutton","switchbutton","progressbar","radiobutton","checkbox","radiogroup","checkgroup","tree","textbox","passwordbox","maskedbox","filebox","combo","combobox","combotree","combogrid","combotreegrid","tagbox","numberbox","validatebox","searchbox","spinner","numberspinner","timespinner","datetimespinner","calendar","datebox","datetimebox","timepicker","slider","layout","panel","datagrid","propertygrid","treegrid","datalist","tabs","accordion","window","dialog","drawer","swiper","timeline","form"],parse:function(_c){\nvar aa=[];\nfor(var i=0;i<$.parser.plugins.length;i++){\nvar _d=$.parser.plugins[i];\nvar r=$(".easyui-"+_d,_c);\nif(r.length){\nif(r[_d]){\nr.each(function(){\n$(this)[_d]($.data(this,"options")||{});\n});\n}else{\naa.push({name:_d,jq:r});\n}\n}\n}\nif(aa.length&&window.easyloader){\nvar _e=[];\nfor(var i=0;i<aa.length;i++){\n_e.push(aa[i].name);\n}\neasyloader.load(_e,function(){\nfor(var i=0;i<aa.length;i++){\nvar _f=aa[i].name;\nvar jq=aa[i].jq;\njq.each(function(){\n$(this)[_f]($.data(this,"options")||{});\n});\n}\n$.parser.onComplete.call($.parser,_c);\n});\n}else{\n$.parser.onComplete.call($.parser,_c);\n}\n},parseValue:function(_10,_11,_12,_13){\n_13=_13||0;\nvar v=$.trim(String(_11||""));\nvar _14=v.substr(v.length-1,1);\nif(_14=="%"){\nv=parseFloat(v.substr(0,v.length-1));\nif(_10.toLowerCase().indexOf("width")>=0){\n_13+=_12[0].offsetWidth-_12[0].clientWidth;\nv=Math.floor((_12.width()-_13)*v/100);\n}else{\n_13+=_12[0].offsetHeight-_12[0].clientHeight;\nv=Math.floor((_12.height()-_13)*v/100);\n}\n}else{\nv=parseInt(v)||undefined;\n}\nreturn v;\n},parseOptions:function(_15,_16){\nvar t=$(_15);\nvar _17={};\nvar s=$.trim(t.attr("data-options"));\nif(s){\nif(s.substring(0,1)!="{"){\ns="{"+s+"}";\n}\n_17=(new Function("return "+s))();\n}\n$.map(["width","height","left","top","minWidth","maxWidth","minHeight","maxHeight"],function(p){\nvar pv=$.trim(_15.style[p]||"");\nif(pv){\nif(pv.indexOf("%")==-1){\npv=parseInt(pv);\nif(isNaN(pv)){\npv=undefined;\n}\n}\n_17[p]=pv;\n}\n});\nif(_16){\nvar _18={};\nfor(var i=0;i<_16.length;i++){\nvar pp=_16[i];\nif(typeof pp=="string"){\n_18[pp]=t.attr(pp);\n}else{\nfor(var _19 in pp){\nvar _1a=pp[_19];\nif(_1a=="boolean"){\n_18[_19]=t.attr(_19)?(t.attr(_19)=="true"):undefined;\n}else{\nif(_1a=="number"){\n_18[_19]=t.attr(_19)=="0"?0:parseFloat(t.attr(_19))||undefined;\n}\n}\n}\n}\n}\n$.extend(_17,_18);\n}\nreturn _17;\n},parseVars:function(){\nvar d=$("<div style=\\"position:absolute;top:-1000px;width:100px;height:100px;padding:5px\\"></div>").appendTo("body");\n$._boxModel=d.outerWidth()!=100;\nd.remove();\nd=$("<div style=\\"position:fixed\\"></div>").appendTo("body");\n$._positionFixed=(d.css("position")=="fixed");\nd.remove();\n}};\n$(function(){\n$.parser.parseVars();\nif(!window.easyloader&&$.parser.auto){\n$.parser.parse();\n}\n});\n$.fn._outerWidth=function(_1b){\nif(_1b==undefined){\nif(this[0]==window){\nreturn this.width()||document.body.clientWidth;\n}\nreturn this.outerWidth()||0;\n}\nreturn this._size("width",_1b);\n};\n$.fn._outerHeight=function(_1c){\nif(_1c==undefined){\nif(this[0]==window){\nreturn this.height()||document.body.clientHeight;\n}\nreturn this.outerHeight()||0;\n}\nreturn this._size("height",_1c);\n};\n$.fn._scrollLeft=function(_1d){\nif(_1d==undefined){\nreturn this.scrollLeft();\n}else{\nreturn this.each(function(){\n$(this).scrollLeft(_1d);\n});\n}\n};\n$.fn._propAttr=$.fn.prop||$.fn.attr;\n$.fn._bind=$.fn.on;\n$.fn._unbind=$.fn.off;\n$.fn._size=function(_1e,_1f){\nif(typeof _1e=="string"){\nif(_1e=="clear"){\nreturn this.each(function(){\n$(this).css({width:"",minWidth:"",maxWidth:"",height:"",minHeight:"",maxHeight:""});\n});\n}else{\nif(_1e=="fit"){\nreturn this.each(function(){\n_20(this,this.tagName=="BODY"?$("body"):$(this).parent(),true);\n});\n}else{\nif(_1e=="unfit"){\nreturn this.each(function(){\n_20(this,$(this).parent(),false);\n});\n}else{\nif(_1f==undefined){\nreturn _21(this[0],_1e);\n}else{\nreturn this.each(function(){\n_21(this,_1e,_1f);\n});\n}\n}\n}\n}\n}else{\nreturn this.each(function(){\n_1f=_1f||$(this).parent();\n$.extend(_1e,_20(this,_1f,_1e.fit)||{});\nvar r1=_22(this,"width",_1f,_1e);\nvar r2=_22(this,"height",_1f,_1e);\nif(r1||r2){\n$(this).addClass("easyui-fluid");\n}else{\n$(this).removeClass("easyui-fluid");\n}\n});\n}\nfunction _20(_23,_24,fit){\nif(!_24.length){\nreturn false;\n}\nvar t=$(_23)[0];\nvar p=_24[0];\nvar _25=p.fcount||0;\nif(fit){\nif(!t.fitted){\nt.fitted=true;\np.fcount=_25+1;\n$(p).addClass("panel-noscroll");\nif(p.tagName=="BODY"){\n$("html").addClass("panel-fit");\n}\n}\nreturn {width:($(p).width()||1),height:($(p).height()||1)};\n}else{\nif(t.fitted){\nt.fitted=false;\np.fcount=_25-1;\nif(p.fcount==0){\n$(p).removeClass("panel-noscroll");\nif(p.tagName=="BODY"){\n$("html").removeClass("panel-fit");\n}\n}\n}\nreturn false;\n}\n};\nfunction _22(_26,_27,_28,_29){\nvar t=$(_26);\nvar p=_27;\nvar p1=p.substr(0,1).toUpperCase()+p.substr(1);\nvar min=$.parser.parseValue("min"+p1,_29["min"+p1],_28);\nvar max=$.parser.parseValue("max"+p1,_29["max"+p1],_28);\nvar val=$.parser.parseValue(p,_29[p],_28);\nvar _2a=(String(_29[p]||"").indexOf("%")>=0?true:false);\nif(!isNaN(val)){\nvar v=Math.min(Math.max(val,min||0),max||99999);\nif(!_2a){\n_29[p]=v;\n}\nt._size("min"+p1,"");\nt._size("max"+p1,"");\nt._size(p,v);\n}else{\nt._size(p,"");\nt._size("min"+p1,min);\nt._size("max"+p1,max);\n}\nreturn _2a||_29.fit;\n};\nfunction _21(_2b,_2c,_2d){\nvar t=$(_2b);\nif(_2d==undefined){\n_2d=parseInt(_2b.style[_2c]);\nif(isNaN(_2d)){\nreturn undefined;\n}\nif($._boxModel){\n_2d+=_2e();\n}\nreturn _2d;\n}else{\nif(_2d===""){\nt.css(_2c,"");\n}else{\nif($._boxModel){\n_2d-=_2e();\nif(_2d<0){\n_2d=0;\n}\n}\nt.css(_2c,_2d+"px");\n}\n}\nfunction _2e(){\nif(_2c.toLowerCase().indexOf("width")>=0){\nreturn t.outerWidth()-t.width();\n}else{\nreturn t.outerHeight()-t.height();\n}\n};\n};\n};\n})(jQuery);\n(function($){\nvar _2f=null;\nvar _30=null;\nvar _31=false;\nfunction _32(e){\nif(e.touches.length!=1){\nreturn;\n}\nif(!_31){\n_31=true;\ndblClickTimer=setTimeout(function(){\n_31=false;\n},500);\n}else{\nclearTimeout(dblClickTimer);\n_31=false;\n_33(e,"dblclick");\n}\n_2f=setTimeout(function(){\n_33(e,"contextmenu",3);\n},1000);\n_33(e,"mousedown");\nif($.fn.draggable.isDragging||$.fn.resizable.isResizing){\ne.preventDefault();\n}\n};\nfunction _34(e){\nif(e.touches.length!=1){\nreturn;\n}\nif(_2f){\nclearTimeout(_2f);\n}\n_33(e,"mousemove");\nif($.fn.draggable.isDragging||$.fn.resizable.isResizing){\ne.preventDefault();\n}\n};\nfunction _35(e){\nif(_2f){\nclearTimeout(_2f);\n}\n_33(e,"mouseup");\nif($.fn.draggable.isDragging||$.fn.resizable.isResizing){\ne.preventDefault();\n}\n};\nfunction _33(e,_36,_37){\nvar _38=new $.Event(_36);\n_38.pageX=e.changedTouches[0].pageX;\n_38.pageY=e.changedTouches[0].pageY;\n_38.which=_37||1;\n$(e.target).trigger(_38);\n};\nif(document.addEventListener){\ndocument.addEventListener("touchstart",_32,true);\ndocument.addEventListener("touchmove",_34,true);\ndocument.addEventListener("touchend",_35,true);\n}\n})(jQuery);\n(function($){\nfunction _39(e){\nvar _3a=$.data(e.data.target,"draggable");\nvar _3b=_3a.options;\nvar _3c=_3a.proxy;\nvar _3d=e.data;\nvar _3e=_3d.startLeft+e.pageX-_3d.startX;\nvar top=_3d.startTop+e.pageY-_3d.startY;\nif(_3c){\nif(_3c.parent()[0]==document.body){\nif(_3b.deltaX!=null&&_3b.deltaX!=undefined){\n_3e=e.pageX+_3b.deltaX;\n}else{\n_3e=e.pageX-e.data.offsetWidth;\n}\nif(_3b.deltaY!=null&&_3b.deltaY!=undefined){\ntop=e.pageY+_3b.deltaY;\n}else{\ntop=e.pageY-e.data.offsetHeight;\n}\n}else{\nif(_3b.deltaX!=null&&_3b.deltaX!=undefined){\n_3e+=e.data.offsetWidth+_3b.deltaX;\n}\nif(_3b.deltaY!=null&&_3b.deltaY!=undefined){\ntop+=e.data.offsetHeight+_3b.deltaY;\n}\n}\n}\nif(e.data.parent!=document.body){\n_3e+=$(e.data.parent).scrollLeft();\ntop+=$(e.data.parent).scrollTop();\n}\nif(_3b.axis=="h"){\n_3d.left=_3e;\n}else{\nif(_3b.axis=="v"){\n_3d.top=top;\n}else{\n_3d.left=_3e;\n_3d.top=top;\n}\n}\n};\nfunction _3f(e){\nvar _40=$.data(e.data.target,"draggable");\nvar _41=_40.options;\nvar _42=_40.proxy;\nif(!_42){\n_42=$(e.data.target);\n}\n_42.css({left:e.data.left,top:e.data.top});\n$("body").css("cursor",_41.cursor);\n};\nfunction _43(e){\nif(!$.fn.draggable.isDragging){\nreturn false;\n}\nvar _44=$.data(e.data.target,"draggable");\nvar _45=_44.options;\nvar _46=$(".droppable:visible").filter(function(){\nreturn e.data.target!=this;\n}).filter(function(){\nvar _47=$.data(this,"droppable").options.accept;\nif(_47){\nreturn $(_47).filter(function(){\nreturn this==e.data.target;\n}).length>0;\n}else{\nreturn true;\n}\n});\n_44.droppables=_46;\nvar _48=_44.proxy;\nif(!_48){\nif(_45.proxy){\nif(_45.proxy=="clone"){\n_48=$(e.data.target).clone().insertAfter(e.data.target);\n}else{\n_48=_45.proxy.call(e.data.target,e.data.target);\n}\n_44.proxy=_48;\n}else{\n_48=$(e.data.target);\n}\n}\n_48.css("position","absolute");\n_39(e);\n_3f(e);\n_45.onStartDrag.call(e.data.target,e);\nreturn false;\n};\nfunction _49(e){\nif(!$.fn.draggable.isDragging){\nreturn false;\n}\nvar _4a=$.data(e.data.target,"draggable");\n_39(e);\nif(_4a.options.onDrag.call(e.data.target,e)!=false){\n_3f(e);\n}\nvar _4b=e.data.target;\n_4a.droppables.each(function(){\nvar _4c=$(this);\nif(_4c.droppable("options").disabled){\nreturn;\n}\nvar p2=_4c.offset();\nif(e.pageX>p2.left&&e.pageX<p2.left+_4c.outerWidth()&&e.pageY>p2.top&&e.pageY<p2.top+_4c.outerHeight()){\nif(!this.entered){\n$(this).trigger("_dragenter",[_4b]);\nthis.entered=true;\n}\n$(this).trigger("_dragover",[_4b]);\n}else{\nif(this.entered){\n$(this).trigger("_dragleave",[_4b]);\nthis.entered=false;\n}\n}\n});\nreturn false;\n};\nfunction _4d(e){\nif(!$.fn.draggable.isDragging){\n_4e();\nreturn false;\n}\n_49(e);\nvar _4f=$.data(e.data.target,"draggable");\nvar _50=_4f.proxy;\nvar _51=_4f.options;\n_51.onEndDrag.call(e.data.target,e);\nif(_51.revert){\nif(_52()==true){\n$(e.data.target).css({position:e.data.startPosition,left:e.data.startLeft,top:e.data.startTop});\n}else{\nif(_50){\nvar _53,top;\nif(_50.parent()[0]==document.body){\n_53=e.data.startX-e.data.offsetWidth;\ntop=e.data.startY-e.data.offsetHeight;\n}else{\n_53=e.data.startLeft;\ntop=e.data.startTop;\n}\n_50.animate({left:_53,top:top},function(){\n_54();\n});\n}else{\n$(e.data.target).animate({left:e.data.startLeft,top:e.data.startTop},function(){\n$(e.data.target).css("position",e.data.startPosition);\n});\n}\n}\n}else{\n$(e.data.target).css({position:"absolute",left:e.data.left,top:e.data.top});\n_52();\n}\n_51.onStopDrag.call(e.data.target,e);\n_4e();\nfunction _54(){\nif(_50){\n_50.remove();\n}\n_4f.proxy=null;\n};\nfunction _52(){\nvar _55=false;\n_4f.droppables.each(function(){\nvar _56=$(this);\nif(_56.droppable("options").disabled){\nreturn;\n}\nvar p2=_56.offset();\nif(e.pageX>p2.left&&e.pageX<p2.left+_56.outerWidth()&&e.pageY>p2.top&&e.pageY<p2.top+_56.outerHeight()){\nif(_51.revert){\n$(e.data.target).css({position:e.data.startPosition,left:e.data.startLeft,top:e.data.startTop});\n}\n$(this).triggerHandler("_drop",[e.data.target]);\n_54();\n_55=true;\nthis.entered=false;\nreturn false;\n}\n});\nif(!_55&&!_51.revert){\n_54();\n}\nreturn _55;\n};\nreturn false;\n};\nfunction _4e(){\nif($.fn.draggable.timer){\nclearTimeout($.fn.draggable.timer);\n$.fn.draggable.timer=undefined;\n}\n$(document)._unbind(".draggable");\n$.fn.draggable.isDragging=false;\nsetTimeout(function(){\n$("body").css("cursor","");\n},100);\n};\n$.fn.draggable=function(_57,_58){\nif(typeof _57=="string"){\nreturn $.fn.draggable.methods[_57](this,_58);\n}\nreturn this.each(function(){\nvar _59;\nvar _5a=$.data(this,"draggable");\nif(_5a){\n_5a.handle._unbind(".draggable");\n_59=$.extend(_5a.options,_57);\n}else{\n_59=$.extend({},$.fn.draggable.defaults,$.fn.draggable.parseOptions(this),_57||{});\n}\nvar _5b=_59.handle?(typeof _59.handle=="string"?$(_59.handle,this):_59.handle):$(this);\n$.data(this,"draggable",{options:_59,handle:_5b});\nif(_59.disabled){\n$(this).css("cursor","");\nreturn;\n}\n_5b._unbind(".draggable")._bind("mousemove.draggable",{target:this},function(e){\nif($.fn.draggable.isDragging){\nreturn;\n}\nvar _5c=$.data(e.data.target,"draggable").options;\nif(_5d(e)){\n$(this).css("cursor",_5c.cursor);\n}else{\n$(this).css("cursor","");\n}\n})._bind("mouseleave.draggable",{target:this},function(e){\n$(this).css("cursor","");\n})._bind("mousedown.draggable",{target:this},function(e){\nif(_5d(e)==false){\nreturn;\n}\n$(this).css("cursor","");\nvar _5e=$(e.data.target).position();\nvar _5f=$(e.data.target).offset();\nvar _60={startPosition:$(e.data.target).css("position"),startLeft:_5e.left,startTop:_5e.top,left:_5e.left,top:_5e.top,startX:e.pageX,startY:e.pageY,width:$(e.data.target).outerWidth(),height:$(e.data.target).outerHeight(),offsetWidth:(e.pageX-_5f.left),offsetHeight:(e.pageY-_5f.top),target:e.data.target,parent:$(e.data.target).parent()[0]};\n$.extend(e.data,_60);\nvar _61=$.data(e.data.target,"draggable").options;\nif(_61.onBeforeDrag.call(e.data.target,e)==false){\nreturn;\n}\n$(document)._bind("mousedown.draggable",e.data,_43);\n$(document)._bind("mousemove.draggable",e.data,_49);\n$(document)._bind("mouseup.draggable",e.data,_4d);\n$.fn.draggable.timer=setTimeout(function(){\n$.fn.draggable.isDragging=true;\n_43(e);\n},_61.delay);\nreturn false;\n});\nfunction _5d(e){\nvar _62=$.data(e.data.target,"draggable");\nvar _63=_62.handle;\nvar _64=$(_63).offset();\nvar _65=$(_63).outerWidth();\nvar _66=$(_63).outerHeight();\nvar t=e.pageY-_64.top;\nvar r=_64.left+_65-e.pageX;\nvar b=_64.top+_66-e.pageY;\nvar l=e.pageX-_64.left;\nreturn Math.min(t,r,b,l)>_62.options.edge;\n};\n});\n};\n$.fn.draggable.methods={options:function(jq){\nreturn $.data(jq[0],"draggable").options;\n},proxy:function(jq){\nreturn $.data(jq[0],"draggable").proxy;\n},enable:function(jq){\nreturn jq.each(function(){\n$(this).draggable({disabled:false});\n});\n},disable:function(jq){\nreturn jq.each(function(){\n$(this).draggable({disabled:true});\n});\n}};\n$.fn.draggable.parseOptions=function(_67){\nvar t=$(_67);\nreturn $.extend({},$.parser.parseOptions(_67,["cursor","handle","axis",{"revert":"boolean","deltaX":"number","deltaY":"number","edge":"number","delay":"number"}]),{disabled:(t.attr("disabled")?true:undefined)});\n};\n$.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,delay:100,onBeforeDrag:function(e){\n},onStartDrag:function(e){\n},onDrag:function(e){\n},onEndDrag:function(e){\n},onStopDrag:function(e){\n}};\n$.fn.draggable.isDragging=false;\n})(jQuery);\n(function($){\nfunction _68(_69){\n$(_69).addClass("droppable");\n$(_69)._bind("_dragenter",function(e,_6a){\n$.data(_69,"droppable").options.onDragEnter.apply(_69,[e,_6a]);\n});\n$(_69)._bind("_dragleave",function(e,_6b){\n$.data(_69,"droppable").options.onDragLeave.apply(_69,[e,_6b]);\n});\n$(_69)._bind("_dragover",function(e,_6c){\n$.data(_69,"droppable").options.onDragOver.apply(_69,[e,_6c]);\n});\n$(_69)._bind("_drop",function(e,_6d){\n$.data(_69,"droppable").options.onDrop.apply(_69,[e,_6d]);\n});\n};\n$.fn.droppable=function(_6e,_6f){\nif(typeof _6e=="string"){\nreturn $.fn.droppable.methods[_6e](this,_6f);\n}\n_6e=_6e||{};\nreturn this.each(function(){\nvar _70=$.data(this,"droppable");\nif(_70){\n$.extend(_70.options,_6e);\n}else{\n_68(this);\n$.data(this,"droppable",{options:$.extend({},$.fn.droppable.defaults,$.fn.droppable.parseOptions(this),_6e)});\n}\n});\n};\n$.fn.droppable.methods={options:function(jq){\nreturn $.data(jq[0],"droppable").options;\n},enable:function(jq){\nreturn jq.each(function(){\n$(this).droppable({disabled:false});\n});\n},disable:function(jq){\nreturn jq.each(function(){\n$(this).droppable({disabled:true});\n});\n}};\n$.fn.droppable.parseOptions=function(_71){\nvar t=$(_71);\nreturn $.extend({},$.parser.parseOptions(_71,["accept"]),{disabled:(t.attr("disabled")?true:undefined)});\n};\n$.fn.droppable.defaults={accept:null,disabled:false,onDragEnter:function(e,_72){\n},onDragOver:function(e,_73){\n},onDragLeave:function(e,_74){\n},onDrop:function(e,_75){\n}};\n})(jQuery);\n(function($){\nfunction _76(e){\nvar _77=e.data;\nvar _78=$.data(_77.target,"resizable").options;\nif(_77.dir.indexOf("e")!=-1){\nvar _79=_77.startWidth+e.pageX-_77.startX;\n_79=Math.min(Math.max(_79,_78.minWidth),_78.maxWidth);\n_77.width=_79;\n}\nif(_77.dir.indexOf("s")!=-1){\nvar _7a=_77.startHeight+e.pageY-_77.startY;\n_7a=Math.min(Math.max(_7a,_78.minHeight),_78.maxHeight);\n_77.height=_7a;\n}\nif(_77.dir.indexOf("w")!=-1){\nvar _79=_77.startWidth-e.pageX+_77.startX;\n_79=Math.min(Math.max(_79,_78.minWidth),_78.maxWidth);\n_77.width=_79;\n_77.left=_77.startLeft+_77.startWidth-_77.width;\n}\nif(_77.dir.indexOf("n")!=-1){\nvar _7a=_77.startHeight-e.pageY+_77.startY;\n_7a=Math.min(Math.max(_7a,_78.minHeight),_78.maxHeight);\n_77.height=_7a;\n_77.top=_77.startTop+_77.startHeight-_77.height;\n}\n};\nfunction _7b(e){\nvar _7c=e.data;\nvar t=$(_7c.target);\nt.css({left:_7c.left,top:_7c.top});\nif(t.outerWidth()!=_7c.width){\nt._outerWidth(_7c.width);\n}\nif(t.outerHeight()!=_7c.height){\nt._outerHeight(_7c.height);\n}\n};\nfunction _7d(e){\n$.fn.resizable.isResizing=true;\n$.data(e.data.target,"resizable").options.onStartResize.call(e.data.target,e);\nreturn false;\n};\nfunction _7e(e){\n_76(e);\nif($.data(e.data.target,"resizable").options.onResize.call(e.data.target,e)!=false){\n_7b(e);\n}\nreturn false;\n};\nfunction _7f(e){\n$.fn.resizable.isResizing=false;\n_76(e,true);\n_7b(e);\n$.data(e.data.target,"resizable").options.onStopResize.call(e.data.target,e);\n$(document)._unbind(".resizable");\n$("body").css("cursor","");\nreturn false;\n};\nfunction _80(e){\nvar _81=$(e.data.target).resizable("options");\nvar tt=$(e.data.target);\nvar dir="";\nvar _82=tt.offset();\nvar _83=tt.outerWidth();\nvar _84=tt.outerHeight();\nvar _85=_81.edge;\nif(e.pageY>_82.top&&e.pageY<_82.top+_85){\ndir+="n";\n}else{\nif(e.pageY<_82.top+_84&&e.pageY>_82.top+_84-_85){\ndir+="s";\n}\n}\nif(e.pageX>_82.left&&e.pageX<_82.left+_85){\ndir+="w";\n}else{\nif(e.pageX<_82.left+_83&&e.pageX>_82.left+_83-_85){\ndir+="e";\n}\n}\nvar _86=_81.handles.split(",");\n_86=$.map(_86,function(h){\nreturn $.trim(h).toLowerCase();\n});\nif($.inArray("all",_86)>=0||$.inArray(dir,_86)>=0){\nreturn dir;\n}\nfor(var i=0;i<dir.length;i++){\nvar _87=$.inArray(dir.substr(i,1),_86);\nif(_87>=0){\nreturn _86[_87];\n}\n}\nreturn "";\n};\n$.fn.resizable=function(_88,_89){\nif(typeof _88=="string"){\nreturn $.fn.resizable.methods[_88](this,_89);\n}\nreturn this.each(function(){\nvar _8a=null;\nvar _8b=$.data(this,"resizable");\nif(_8b){\n$(this)._unbind(".resizable");\n_8a=$.extend(_8b.options,_88||{});\n}else{\n_8a=$.extend({},$.fn.resizable.defaults,$.fn.resizable.parseOptions(this),_88||{});\n$.data(this,"resizable",{options:_8a});\n}\nif(_8a.disabled==true){\nreturn;\n}\n$(this)._bind("mousemove.resizable",{target:this},function(e){\nif($.fn.resizable.isResizing){\nreturn;\n}\nvar dir=_80(e);\n$(e.data.target).css("cursor",dir?dir+"-resize":"");\n})._bind("mouseleave.resizable",{target:this},function(e){\n$(e.data.target).css("cursor","");\n})._bind("mousedown.resizable",{target:this},function(e){\nvar dir=_80(e);\nif(dir==""){\nreturn;\n}\nfunction _8c(css){\nvar val=parseInt($(e.data.target).css(css));\nif(isNaN(val)){\nreturn 0;\n}else{\nreturn val;\n}\n};\nvar _8d={target:e.data.target,dir:dir,startLeft:_8c("left"),startTop:_8c("top"),left:_8c("left"),top:_8c("top"),startX:e.pageX,startY:e.pageY,startWidth:$(e.data.target).outerWidth(),startHeight:$(e.data.target).outerHeight(),width:$(e.data.target).outerWidth(),height:$(e.data.target).outerHeight(),deltaWidth:$(e.data.target).outerWidth()-$(e.data.target).width(),deltaHeight:$(e.data.target).outerHeight()-$(e.data.target).height()};\n$(document)._bind("mousedown.resizable",_8d,_7d);\n$(document)._bind("mousemove.resizable",_8d,_7e);\n$(document)._bind("mouseup.resizable",_8d,_7f);\n$("body").css("cursor",dir+"-resize");\n});\n});\n};\n$.fn.resizable.methods={options:function(jq){\nreturn $.data(jq[0],"resizable").options;\n},enable:function(jq){\nreturn jq.each(function(){\n$(this).resizable({disabled:false});\n});\n},disable:function(jq){\nreturn jq.each(function(){\n$(this).resizable({disabled:true});\n});\n}};\n$.fn.resizable.parseOptions=function(_8e){\nvar t=$(_8e);\nreturn $.extend({},$.parser.parseOptions(_8e,["handles",{minWidth:"number",minHeight:"number",maxWidth:"number",maxHeight:"number",edge:"number"}]),{disabled:(t.attr("disabled")?true:undefined)});\n};\n$.fn.resizable.defaults={disabled:false,handles:"n, e, s, w, ne, se, sw, nw, all",minWidth:10,minHeight:10,maxWidth:10000,maxHeight:10000,edge:5,onStartResize:function(e){\n},onResize:function(e){\n},onStopResize:function(e){\n}};\n$.fn.resizable.isResizing=false;\n})(jQuery);\n(function($){\nfunction _8f(_90,_91){\nvar _92=$.data(_90,"linkbutton").options;\nif(_91){\n$.extend(_92,_91);\n}\nif(_92.width||_92.height||_92.fit){\nvar btn=$(_90);\nvar _93=btn.parent();\nvar _94=btn.is(":visible");\nif(!_94){\nvar _95=$("<div style=\\"display:none\\"></div>").insertBefore(_90);\nvar _96={position:btn.css("position"),display:btn.css("display"),left:btn.css("left")};\nbtn.appendTo("body");\nbtn.css({position:"absolute",display:"inline-block",left:-20000});\n}\nbtn._size(_92,_93);\nvar _97=btn.find(".l-btn-left");\n_97.css("margin-top",0);\n_97.css("margin-top",parseInt((btn.height()-_97.height())/2)+"px");\nif(!_94){\nbtn.insertAfter(_95);\nbtn.css(_96);\n_95.remove();\n}\n}\n};\nfunction _98(_99){\nvar _9a=$.data(_99,"linkbutton").options;\nvar t=$(_99).empty();\nt.addClass("l-btn").removeClass("l-btn-plain l-btn-selected l-btn-plain-selected l-btn-outline");\nt.removeClass("l-btn-small l-btn-medium l-btn-large").addClass("l-btn-"+_9a.size);\nif(_9a.plain){\nt.addClass("l-btn-plain");\n}\nif(_9a.outline){\nt.addClass("l-btn-outline");\n}\nif(_9a.selected){\nt.addClass(_9a.plain?"l-btn-selected l-btn-plain-selected":"l-btn-selected");\n}\nt.attr("group",_9a.group||"");\nt.attr("id",_9a.id||"");\nvar _9b=$("<span class=\\"l-btn-left\\"></span>").appendTo(t);\nif(_9a.text){\n$("<span class=\\"l-btn-text\\"></span>").html(_9a.text).appendTo(_9b);\n}else{\n$("<span class=\\"l-btn-text l-btn-empty\\">&nbsp;</span>").appendTo(_9b);\n}\nif(_9a.iconCls){\n$("<span class=\\"l-btn-icon\\">&nbsp;</span>").addClass(_9a.iconCls).appendTo(_9b);\n_9b.addClass("l-btn-icon-"+_9a.iconAlign);\n}\nt._unbind(".linkbutton")._bind("focus.linkbutton",function(){\nif(!_9a.disabled){\n$(this).addClass("l-btn-focus");\n}\n})._bind("blur.linkbutton",function(){\n$(this).removeClass("l-btn-focus");\n})._bind("click.linkbutton",function(){\nif(!_9a.disabled){\nif(_9a.toggle){\nif(_9a.selected){\n$(this).linkbutton("unselect");\n}else{\n$(this).linkbutton("select");\n}\n}\n_9a.onClick.call(this);\n}\n});\n_9c(_99,_9a.selected);\n_9d(_99,_9a.disabled);\n};\nfunction _9c(_9e,_9f){\nvar _a0=$.data(_9e,"linkbutton").options;\nif(_9f){\nif(_a0.group){\n$("a.l-btn[group=\\""+_a0.group+"\\"]").each(function(){\nvar o=$(this).linkbutton("options");\nif(o.toggle){\n$(this).removeClass("l-btn-selected l-btn-plain-selected");\no.selected=false;\n}\n});\n}\n$(_9e).addClass(_a0.plain?"l-btn-selected l-btn-plain-selected":"l-btn-selected");\n_a0.selected=true;\n}else{\nif(!_a0.group){\n$(_9e).removeClass("l-btn-selected l-btn-plain-selected");\n_a0.selected=false;\n}\n}\n};\nfunction _9d(_a1,_a2){\nvar _a3=$.data(_a1,"linkbutton");\nvar _a4=_a3.options;\n$(_a1).removeClass("l-btn-disabled l-btn-plain-disabled");\nif(_a2){\n_a4.disabled=true;\nvar _a5=$(_a1).attr("href");\nif(_a5){\n_a3.href=_a5;\n$(_a1).attr("href","javascript:;");\n}\nif(_a1.onclick){\n_a3.onclick=_a1.onclick;\n_a1.onclick=null;\n}\n_a4.plain?$(_a1).addClass("l-btn-disabled l-btn-plain-disabled"):$(_a1).addClass("l-btn-disabled");\n}else{\n_a4.disabled=false;\nif(_a3.href){\n$(_a1).attr("href",_a3.href);\n}\nif(_a3.onclick){\n_a1.onclick=_a3.onclick;\n}\n}\n$(_a1)._propAttr("disabled",_a2);\n};\n$.fn.linkbutton=function(_a6,_a7){\nif(typeof _a6=="string"){\nreturn $.fn.linkbutton.methods[_a6](this,_a7);\n}\n_a6=_a6||{};\nreturn this.each(function(){\nvar _a8=$.data(this,"linkbutton");\nif(_a8){\n$.extend(_a8.options,_a6);\n}else{\n$.data(this,"linkbutton",{options:$.extend({},$.fn.linkbutton.defaults,$.fn.linkbutton.parseOptions(this),_a6)});\n$(this)._propAttr("disabled",false);\n$(this)._bind("_resize",function(e,_a9){\nif($(this).hasClass("easyui-fluid")||_a9){\n_8f(this);\n}\nreturn false;\n});\n}\n_98(this);\n_8f(this);\n});\n};\n$.fn.linkbutton.methods={options:function(jq){\nreturn $.data(jq[0],"linkbutton").options;\n},resize:function(jq,_aa){\nreturn jq.each(function(){\n_8f(this,_aa);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_9d(this,false);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_9d(this,true);\n});\n},select:function(jq){\nreturn jq.each(function(){\n_9c(this,true);\n});\n},unselect:function(jq){\nreturn jq.each(function(){\n_9c(this,false);\n});\n}};\n$.fn.linkbutton.parseOptions=function(_ab){\nvar t=$(_ab);\nreturn $.extend({},$.parser.parseOptions(_ab,["id","iconCls","iconAlign","group","size","text",{plain:"boolean",toggle:"boolean",selected:"boolean",outline:"boolean"}]),{disabled:(t.attr("disabled")?true:undefined),text:($.trim(t.html())||undefined),iconCls:(t.attr("icon")||t.attr("iconCls"))});\n};\n$.fn.linkbutton.defaults={id:null,disabled:false,toggle:false,selected:false,outline:false,group:null,plain:false,text:"",iconCls:null,iconAlign:"left",size:"small",onClick:function(){\n}};\n})(jQuery);\n(function($){\nfunction _ac(_ad){\nvar _ae=$.data(_ad,"pagination");\nvar _af=_ae.options;\nvar bb=_ae.bb={};\nif(_af.buttons&&!$.isArray(_af.buttons)){\n$(_af.buttons).insertAfter(_ad);\n}\nvar _b0=$(_ad).addClass("pagination").html("<table cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tr></tr></table>");\nvar tr=_b0.find("tr");\nvar aa=$.extend([],_af.layout);\nif(!_af.showPageList){\n_b1(aa,"list");\n}\nif(!_af.showPageInfo){\n_b1(aa,"info");\n}\nif(!_af.showRefresh){\n_b1(aa,"refresh");\n}\nif(aa[0]=="sep"){\naa.shift();\n}\nif(aa[aa.length-1]=="sep"){\naa.pop();\n}\nfor(var _b2=0;_b2<aa.length;_b2++){\nvar _b3=aa[_b2];\nif(_b3=="list"){\nvar ps=$("<select class=\\"pagination-page-list\\"></select>");\nps._bind("change",function(){\n_af.pageSize=parseInt($(this).val());\n_af.onChangePageSize.call(_ad,_af.pageSize);\n_b9(_ad,_af.pageNumber);\n});\nfor(var i=0;i<_af.pageList.length;i++){\n$("<option></option>").text(_af.pageList[i]).appendTo(ps);\n}\n$("<td></td>").append(ps).appendTo(tr);\n}else{\nif(_b3=="sep"){\n$("<td><div class=\\"pagination-btn-separator\\"></div></td>").appendTo(tr);\n}else{\nif(_b3=="first"){\nbb.first=_b4("first");\n}else{\nif(_b3=="prev"){\nbb.prev=_b4("prev");\n}else{\nif(_b3=="next"){\nbb.next=_b4("next");\n}else{\nif(_b3=="last"){\nbb.last=_b4("last");\n}else{\nif(_b3=="manual"){\n$("<span style=\\"padding-left:6px;\\"></span>").html(_af.beforePageText).appendTo(tr).wrap("<td></td>");\nbb.num=$("<input class=\\"pagination-num\\" type=\\"text\\" value=\\"1\\" size=\\"2\\">").appendTo(tr).wrap("<td></td>");\nbb.num._unbind(".pagination")._bind("keydown.pagination",function(e){\nif(e.keyCode==13){\nvar _b5=parseInt($(this).val())||1;\n_b9(_ad,_b5);\nreturn false;\n}\n});\nbb.after=$("<span style=\\"padding-right:6px;\\"></span>").appendTo(tr).wrap("<td></td>");\n}else{\nif(_b3=="refresh"){\nbb.refresh=_b4("refresh");\n}else{\nif(_b3=="links"){\n$("<td class=\\"pagination-links\\"></td>").appendTo(tr);\n}else{\nif(_b3=="info"){\nif(_b2==aa.length-1){\n$("<div class=\\"pagination-info\\"></div>").appendTo(_b0);\n}else{\n$("<td><div class=\\"pagination-info\\"></div></td>").appendTo(tr);\n}\n}\n}\n}\n}\n}\n}\n}\n}\n}\n}\n}\nif(_af.buttons){\n$("<td><div class=\\"pagination-btn-separator\\"></div></td>").appendTo(tr);\nif($.isArray(_af.buttons)){\nfor(var i=0;i<_af.buttons.length;i++){\nvar btn=_af.buttons[i];\nif(btn=="-"){\n$("<td><div class=\\"pagination-btn-separator\\"></div></td>").appendTo(tr);\n}else{\nvar td=$("<td></td>").appendTo(tr);\nvar a=$("<a href=\\"javascript:;\\"></a>").appendTo(td);\na[0].onclick=eval(btn.handler||function(){\n});\na.linkbutton($.extend({},btn,{plain:true}));\n}\n}\n}else{\nvar td=$("<td></td>").appendTo(tr);\n$(_af.buttons).appendTo(td).show();\n}\n}\n$("<div style=\\"clear:both;\\"></div>").appendTo(_b0);\nfunction _b4(_b6){\nvar btn=_af.nav[_b6];\nvar a=$("<a href=\\"javascript:;\\"></a>").appendTo(tr);\na.wrap("<td></td>");\na.linkbutton({iconCls:btn.iconCls,plain:true})._unbind(".pagination")._bind("click.pagination",function(){\nbtn.handler.call(_ad);\n});\nreturn a;\n};\nfunction _b1(aa,_b7){\nvar _b8=$.inArray(_b7,aa);\nif(_b8>=0){\naa.splice(_b8,1);\n}\nreturn aa;\n};\n};\nfunction _b9(_ba,_bb){\nvar _bc=$.data(_ba,"pagination").options;\nif(_bc.onBeforeSelectPage.call(_ba,_bb,_bc.pageSize)==false){\n_bd(_ba);\nreturn;\n}\n_bd(_ba,{pageNumber:_bb});\n_bc.onSelectPage.call(_ba,_bc.pageNumber,_bc.pageSize);\n};\nfunction _bd(_be,_bf){\nvar _c0=$.data(_be,"pagination");\nvar _c1=_c0.options;\nvar bb=_c0.bb;\n$.extend(_c1,_bf||{});\nvar ps=$(_be).find("select.pagination-page-list");\nif(ps.length){\nps.val(_c1.pageSize+"");\n_c1.pageSize=parseInt(ps.val());\n}\nvar _c2=Math.ceil(_c1.total/_c1.pageSize)||1;\nif(_c1.pageNumber<1){\n_c1.pageNumber=1;\n}\nif(_c1.pageNumber>_c2){\n_c1.pageNumber=_c2;\n}\nif(_c1.total==0){\n_c1.pageNumber=0;\n_c2=0;\n}\nif(bb.num){\nbb.num.val(_c1.pageNumber);\n}\nif(bb.after){\nbb.after.html(_c1.afterPageText.replace(/{pages}/,_c2));\n}\nvar td=$(_be).find("td.pagination-links");\nif(td.length){\ntd.empty();\nvar _c3=_c1.pageNumber-Math.floor(_c1.links/2);\nif(_c3<1){\n_c3=1;\n}\nvar _c4=_c3+_c1.links-1;\nif(_c4>_c2){\n_c4=_c2;\n}\n_c3=_c4-_c1.links+1;\nif(_c3<1){\n_c3=1;\n}\nfor(var i=_c3;i<=_c4;i++){\nvar a=$("<a class=\\"pagination-link\\" href=\\"javascript:;\\"></a>").appendTo(td);\na.linkbutton({plain:true,text:i});\nif(i==_c1.pageNumber){\na.linkbutton("select");\n}else{\na._unbind(".pagination")._bind("click.pagination",{pageNumber:i},function(e){\n_b9(_be,e.data.pageNumber);\n});\n}\n}\n}\nvar _c5=_c1.displayMsg;\n_c5=_c5.replace(/{from}/,_c1.total==0?0:_c1.pageSize*(_c1.pageNumber-1)+1);\n_c5=_c5.replace(/{to}/,Math.min(_c1.pageSize*(_c1.pageNumber),_c1.total));\n_c5=_c5.replace(/{total}/,_c1.total);\n$(_be).find("div.pagination-info").html(_c5);\nif(bb.first){\nbb.first.linkbutton({disabled:((!_c1.total)||_c1.pageNumber==1)});\n}\nif(bb.prev){\nbb.prev.linkbutton({disabled:((!_c1.total)||_c1.pageNumber==1)});\n}\nif(bb.next){\nbb.next.linkbutton({disabled:(_c1.pageNumber==_c2)});\n}\nif(bb.last){\nbb.last.linkbutton({disabled:(_c1.pageNumber==_c2)});\n}\n_c6(_be,_c1.loading);\n};\nfunction _c6(_c7,_c8){\nvar _c9=$.data(_c7,"pagination");\nvar _ca=_c9.options;\n_ca.loading=_c8;\nif(_ca.showRefresh&&_c9.bb.refresh){\n_c9.bb.refresh.linkbutton({iconCls:(_ca.loading?"pagination-loading":"pagination-load")});\n}\n};\n$.fn.pagination=function(_cb,_cc){\nif(typeof _cb=="string"){\nreturn $.fn.pagination.methods[_cb](this,_cc);\n}\n_cb=_cb||{};\nreturn this.each(function(){\nvar _cd;\nvar _ce=$.data(this,"pagination");\nif(_ce){\n_cd=$.extend(_ce.options,_cb);\n}else{\n_cd=$.extend({},$.fn.pagination.defaults,$.fn.pagination.parseOptions(this),_cb);\n$.data(this,"pagination",{options:_cd});\n}\n_ac(this);\n_bd(this);\n});\n};\n$.fn.pagination.methods={options:function(jq){\nreturn $.data(jq[0],"pagination").options;\n},loading:function(jq){\nreturn jq.each(function(){\n_c6(this,true);\n});\n},loaded:function(jq){\nreturn jq.each(function(){\n_c6(this,false);\n});\n},refresh:function(jq,_cf){\nreturn jq.each(function(){\n_bd(this,_cf);\n});\n},select:function(jq,_d0){\nreturn jq.each(function(){\n_b9(this,_d0);\n});\n}};\n$.fn.pagination.parseOptions=function(_d1){\nvar t=$(_d1);\nreturn $.extend({},$.parser.parseOptions(_d1,[{total:"number",pageSize:"number",pageNumber:"number",links:"number"},{loading:"boolean",showPageList:"boolean",showPageInfo:"boolean",showRefresh:"boolean"}]),{pageList:(t.attr("pageList")?eval(t.attr("pageList")):undefined)});\n};\n$.fn.pagination.defaults={total:1,pageSize:10,pageNumber:1,pageList:[10,20,30,50],loading:false,buttons:null,showPageList:true,showPageInfo:true,showRefresh:true,links:10,layout:["list","sep","first","prev","sep","manual","sep","next","last","sep","refresh","info"],onBeforeSelectPage:function(_d2,_d3){\n},onSelectPage:function(_d4,_d5){\n},onBeforeRefresh:function(_d6,_d7){\n},onRefresh:function(_d8,_d9){\n},onChangePageSize:function(_da){\n},beforePageText:"Page",afterPageText:"of {pages}",displayMsg:"Displaying {from} to {to} of {total} items",nav:{first:{iconCls:"pagination-first",handler:function(){\nvar _db=$(this).pagination("options");\nif(_db.pageNumber>1){\n$(this).pagination("select",1);\n}\n}},prev:{iconCls:"pagination-prev",handler:function(){\nvar _dc=$(this).pagination("options");\nif(_dc.pageNumber>1){\n$(this).pagination("select",_dc.pageNumber-1);\n}\n}},next:{iconCls:"pagination-next",handler:function(){\nvar _dd=$(this).pagination("options");\nvar _de=Math.ceil(_dd.total/_dd.pageSize);\nif(_dd.pageNumber<_de){\n$(this).pagination("select",_dd.pageNumber+1);\n}\n}},last:{iconCls:"pagination-last",handler:function(){\nvar _df=$(this).pagination("options");\nvar _e0=Math.ceil(_df.total/_df.pageSize);\nif(_df.pageNumber<_e0){\n$(this).pagination("select",_e0);\n}\n}},refresh:{iconCls:"pagination-refresh",handler:function(){\nvar _e1=$(this).pagination("options");\nif(_e1.onBeforeRefresh.call(this,_e1.pageNumber,_e1.pageSize)!=false){\n$(this).pagination("select",_e1.pageNumber);\n_e1.onRefresh.call(this,_e1.pageNumber,_e1.pageSize);\n}\n}}}};\n})(jQuery);\n(function($){\nfunction _e2(_e3){\nvar _e4=$(_e3);\n_e4.addClass("tree");\nreturn _e4;\n};\nfunction _e5(_e6){\nvar _e7=$.data(_e6,"tree").options;\n$(_e6)._unbind()._bind("mouseover",function(e){\nvar tt=$(e.target);\nvar _e8=tt.closest("div.tree-node");\nif(!_e8.length){\nreturn;\n}\n_e8.addClass("tree-node-hover");\nif(tt.hasClass("tree-hit")){\nif(tt.hasClass("tree-expanded")){\ntt.addClass("tree-expanded-hover");\n}else{\ntt.addClass("tree-collapsed-hover");\n}\n}\ne.stopPropagation();\n})._bind("mouseout",function(e){\nvar tt=$(e.target);\nvar _e9=tt.closest("div.tree-node");\nif(!_e9.length){\nreturn;\n}\n_e9.removeClass("tree-node-hover");\nif(tt.hasClass("tree-hit")){\nif(tt.hasClass("tree-expanded")){\ntt.removeClass("tree-expanded-hover");\n}else{\ntt.removeClass("tree-collapsed-hover");\n}\n}\ne.stopPropagation();\n})._bind("click",function(e){\nvar tt=$(e.target);\nvar _ea=tt.closest("div.tree-node");\nif(!_ea.length){\nreturn;\n}\nif(tt.hasClass("tree-hit")){\n_148(_e6,_ea[0]);\nreturn false;\n}else{\nif(tt.hasClass("tree-checkbox")){\n_10f(_e6,_ea[0]);\nreturn false;\n}else{\n_18d(_e6,_ea[0]);\n_e7.onClick.call(_e6,_ed(_e6,_ea[0]));\n}\n}\ne.stopPropagation();\n})._bind("dblclick",function(e){\nvar _eb=$(e.target).closest("div.tree-node");\nif(!_eb.length){\nreturn;\n}\n_18d(_e6,_eb[0]);\n_e7.onDblClick.call(_e6,_ed(_e6,_eb[0]));\ne.stopPropagation();\n})._bind("contextmenu",function(e){\nvar _ec=$(e.target).closest("div.tree-node");\nif(!_ec.length){\nreturn;\n}\n_e7.onContextMenu.call(_e6,e,_ed(_e6,_ec[0]));\ne.stopPropagation();\n});\n};\nfunction _ee(_ef){\nvar _f0=$.data(_ef,"tree").options;\n_f0.dnd=false;\nvar _f1=$(_ef).find("div.tree-node");\n_f1.draggable("disable");\n_f1.css("cursor","pointer");\n};\nfunction _f2(_f3){\nvar _f4=$.data(_f3,"tree");\nvar _f5=_f4.options;\nvar _f6=_f4.tree;\n_f4.disabledNodes=[];\n_f5.dnd=true;\n_f6.find("div.tree-node").draggable({disabled:false,revert:true,cursor:"pointer",proxy:function(_f7){\nvar p=$("<div class=\\"tree-node-proxy\\"></div>").appendTo("body");\np.html("<span class=\\"tree-dnd-icon tree-dnd-no\\">&nbsp;</span>"+$(_f7).find(".tree-title").html());\np.hide();\nreturn p;\n},deltaX:15,deltaY:15,onBeforeDrag:function(e){\nif(_f5.onBeforeDrag.call(_f3,_ed(_f3,this))==false){\nreturn false;\n}\nif($(e.target).hasClass("tree-hit")||$(e.target).hasClass("tree-checkbox")){\nreturn false;\n}\nif(e.which!=1){\nreturn false;\n}\nvar _f8=$(this).find("span.tree-indent");\nif(_f8.length){\ne.data.offsetWidth-=_f8.length*_f8.width();\n}\n},onStartDrag:function(e){\n$(this).next("ul").find("div.tree-node").each(function(){\n$(this).droppable("disable");\n_f4.disabledNodes.push(this);\n});\n$(this).draggable("proxy").css({left:-10000,top:-10000});\n_f5.onStartDrag.call(_f3,_ed(_f3,this));\nvar _f9=_ed(_f3,this);\nif(_f9.id==undefined){\n_f9.id="easyui_tree_node_id_temp";\n_12f(_f3,_f9);\n}\n_f4.draggingNodeId=_f9.id;\n},onDrag:function(e){\nvar x1=e.pageX,y1=e.pageY,x2=e.data.startX,y2=e.data.startY;\nvar d=Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));\nif(d>3){\n$(this).draggable("proxy").show();\n}\nthis.pageY=e.pageY;\n},onStopDrag:function(){\nfor(var i=0;i<_f4.disabledNodes.length;i++){\n$(_f4.disabledNodes[i]).droppable("enable");\n}\n_f4.disabledNodes=[];\nvar _fa=_185(_f3,_f4.draggingNodeId);\nif(_fa&&_fa.id=="easyui_tree_node_id_temp"){\n_fa.id="";\n_12f(_f3,_fa);\n}\n_f5.onStopDrag.call(_f3,_fa);\n}}).droppable({accept:"div.tree-node",onDragEnter:function(e,_fb){\nif(_f5.onDragEnter.call(_f3,this,_fc(_fb))==false){\n_fd(_fb,false);\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\n$(this).droppable("disable");\n_f4.disabledNodes.push(this);\n}\n},onDragOver:function(e,_fe){\nif($(this).droppable("options").disabled){\nreturn;\n}\nvar _ff=_fe.pageY;\nvar top=$(this).offset().top;\nvar _100=top+$(this).outerHeight();\n_fd(_fe,true);\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\nif(_ff>top+(_100-top)/2){\nif(_100-_ff<5){\n$(this).addClass("tree-node-bottom");\n}else{\n$(this).addClass("tree-node-append");\n}\n}else{\nif(_ff-top<5){\n$(this).addClass("tree-node-top");\n}else{\n$(this).addClass("tree-node-append");\n}\n}\nif(_f5.onDragOver.call(_f3,this,_fc(_fe))==false){\n_fd(_fe,false);\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\n$(this).droppable("disable");\n_f4.disabledNodes.push(this);\n}\n},onDragLeave:function(e,_101){\n_fd(_101,false);\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\n_f5.onDragLeave.call(_f3,this,_fc(_101));\n},onDrop:function(e,_102){\nvar dest=this;\nvar _103,_104;\nif($(this).hasClass("tree-node-append")){\n_103=_105;\n_104="append";\n}else{\n_103=_106;\n_104=$(this).hasClass("tree-node-top")?"top":"bottom";\n}\nif(_f5.onBeforeDrop.call(_f3,dest,_fc(_102),_104)==false){\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\nreturn;\n}\n_103(_102,dest,_104);\n$(this).removeClass("tree-node-append tree-node-top tree-node-bottom");\n}});\nfunction _fc(_107,pop){\nreturn $(_107).closest("ul.tree").tree(pop?"pop":"getData",_107);\n};\nfunction _fd(_108,_109){\nvar icon=$(_108).draggable("proxy").find("span.tree-dnd-icon");\nicon.removeClass("tree-dnd-yes tree-dnd-no").addClass(_109?"tree-dnd-yes":"tree-dnd-no");\n};\nfunction _105(_10a,dest){\nif(_ed(_f3,dest).state=="closed"){\n_140(_f3,dest,function(){\n_10b();\n});\n}else{\n_10b();\n}\nfunction _10b(){\nvar node=_fc(_10a,true);\n$(_f3).tree("append",{parent:dest,data:[node]});\n_f5.onDrop.call(_f3,dest,node,"append");\n};\n};\nfunction _106(_10c,dest,_10d){\nvar _10e={};\nif(_10d=="top"){\n_10e.before=dest;\n}else{\n_10e.after=dest;\n}\nvar node=_fc(_10c,true);\n_10e.data=node;\n$(_f3).tree("insert",_10e);\n_f5.onDrop.call(_f3,dest,node,_10d);\n};\n};\nfunction _10f(_110,_111,_112,_113){\nvar _114=$.data(_110,"tree");\nvar opts=_114.options;\nif(!opts.checkbox){\nreturn;\n}\nvar _115=_ed(_110,_111);\nif(!_115.checkState){\nreturn;\n}\nvar ck=$(_111).find(".tree-checkbox");\nif(_112==undefined){\nif(ck.hasClass("tree-checkbox1")){\n_112=false;\n}else{\nif(ck.hasClass("tree-checkbox0")){\n_112=true;\n}else{\nif(_115._checked==undefined){\n_115._checked=$(_111).find(".tree-checkbox").hasClass("tree-checkbox1");\n}\n_112=!_115._checked;\n}\n}\n}\n_115._checked=_112;\nif(_112){\nif(ck.hasClass("tree-checkbox1")){\nreturn;\n}\n}else{\nif(ck.hasClass("tree-checkbox0")){\nreturn;\n}\n}\nif(!_113){\nif(opts.onBeforeCheck.call(_110,_115,_112)==false){\nreturn;\n}\n}\nif(opts.cascadeCheck){\n_116(_110,_115,_112);\n_117(_110,_115);\n}else{\n_118(_110,_115,_112?"1":"0");\n}\nif(!_113){\nopts.onCheck.call(_110,_115,_112);\n}\n};\nfunction _116(_119,_11a,_11b){\nvar opts=$.data(_119,"tree").options;\nvar flag=_11b?1:0;\n_118(_119,_11a,flag);\nif(opts.deepCheck){\n$.easyui.forEach(_11a.children||[],true,function(n){\n_118(_119,n,flag);\n});\n}else{\nvar _11c=[];\nif(_11a.children&&_11a.children.length){\n_11c.push(_11a);\n}\n$.easyui.forEach(_11a.children||[],true,function(n){\nif(!n.hidden){\n_118(_119,n,flag);\nif(n.children&&n.children.length){\n_11c.push(n);\n}\n}\n});\nfor(var i=_11c.length-1;i>=0;i--){\nvar node=_11c[i];\n_118(_119,node,_11d(node));\n}\n}\n};\nfunction _118(_11e,_11f,flag){\nvar opts=$.data(_11e,"tree").options;\nif(!_11f.checkState||flag==undefined){\nreturn;\n}\nif(_11f.hidden&&!opts.deepCheck){\nreturn;\n}\nvar ck=$("#"+_11f.domId).find(".tree-checkbox");\n_11f.checkState=["unchecked","checked","indeterminate"][flag];\n_11f.checked=(_11f.checkState=="checked");\nck.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2");\nck.addClass("tree-checkbox"+flag);\n};\nfunction _117(_120,_121){\nvar pd=_122(_120,$("#"+_121.domId)[0]);\nif(pd){\n_118(_120,pd,_11d(pd));\n_117(_120,pd);\n}\n};\nfunction _11d(row){\nvar c0=0;\nvar c1=0;\nvar len=0;\n$.easyui.forEach(row.children||[],false,function(r){\nif(r.checkState){\nlen++;\nif(r.checkState=="checked"){\nc1++;\n}else{\nif(r.checkState=="unchecked"){\nc0++;\n}\n}\n}\n});\nif(len==0){\nreturn undefined;\n}\nvar flag=0;\nif(c0==len){\nflag=0;\n}else{\nif(c1==len){\nflag=1;\n}else{\nflag=2;\n}\n}\nreturn flag;\n};\nfunction _123(_124,_125){\nvar opts=$.data(_124,"tree").options;\nif(!opts.checkbox){\nreturn;\n}\nvar node=$(_125);\nvar ck=node.find(".tree-checkbox");\nvar _126=_ed(_124,_125);\nif(opts.view.hasCheckbox(_124,_126)){\nif(!ck.length){\n_126.checkState=_126.checkState||"unchecked";\n$("<span class=\\"tree-checkbox\\"></span>").insertBefore(node.find(".tree-title"));\n}\nif(_126.checkState=="checked"){\n_10f(_124,_125,true,true);\n}else{\nif(_126.checkState=="unchecked"){\n_10f(_124,_125,false,true);\n}else{\nvar flag=_11d(_126);\nif(flag===0){\n_10f(_124,_125,false,true);\n}else{\nif(flag===1){\n_10f(_124,_125,true,true);\n}\n}\n}\n}\n}else{\nck.remove();\n_126.checkState=undefined;\n_126.checked=undefined;\n_117(_124,_126);\n}\n};\nfunction _127(_128,ul,data,_129,_12a){\nvar _12b=$.data(_128,"tree");\nvar opts=_12b.options;\nvar _12c=$(ul).prevAll("div.tree-node:first");\ndata=opts.loadFilter.call(_128,data,_12c[0]);\nvar _12d=_12e(_128,"domId",_12c.attr("id"));\nif(!_129){\n_12d?_12d.children=data:_12b.data=data;\n$(ul).empty();\n}else{\nif(_12d){\n_12d.children?_12d.children=_12d.children.concat(data):_12d.children=data;\n}else{\n_12b.data=_12b.data.concat(data);\n}\n}\nopts.view.render.call(opts.view,_128,ul,data);\nif(opts.dnd){\n_f2(_128);\n}\nif(_12d){\n_12f(_128,_12d);\n}\nfor(var i=0;i<_12b.tmpIds.length;i++){\n_10f(_128,$("#"+_12b.tmpIds[i])[0],true,true);\n}\n_12b.tmpIds=[];\nsetTimeout(function(){\n_130(_128,_128);\n},0);\nif(!_12a){\nopts.onLoadSuccess.call(_128,_12d,data);\n}\n};\nfunction _130(_131,ul,_132){\nvar opts=$.data(_131,"tree").options;\nif(opts.lines){\n$(_131).addClass("tree-lines");\n}else{\n$(_131).removeClass("tree-lines");\nreturn;\n}\nif(!_132){\n_132=true;\n$(_131).find("span.tree-indent").removeClass("tree-line tree-join tree-joinbottom");\n$(_131).find("div.tree-node").removeClass("tree-node-last tree-root-first tree-root-one");\nvar _133=$(_131).tree("getRoots");\nif(_133.length>1){\n$(_133[0].target).addClass("tree-root-first");\n}else{\nif(_133.length==1){\n$(_133[0].target).addClass("tree-root-one");\n}\n}\n}\n$(ul).children("li").each(function(){\nvar node=$(this).children("div.tree-node");\nvar ul=node.next("ul");\nif(ul.length){\nif($(this).next().length){\n_134(node);\n}\n_130(_131,ul,_132);\n}else{\n_135(node);\n}\n});\nvar _136=$(ul).children("li:last").children("div.tree-node").addClass("tree-node-last");\n_136.children("span.tree-join").removeClass("tree-join").addClass("tree-joinbottom");\nfunction _135(node,_137){\nvar icon=node.find("span.tree-icon");\nicon.prev("span.tree-indent").addClass("tree-join");\n};\nfunction _134(node){\nvar _138=node.find("span.tree-indent, span.tree-hit").length;\nnode.next().find("div.tree-node").each(function(){\n$(this).children("span:eq("+(_138-1)+")").addClass("tree-line");\n});\n};\n};\nfunction _139(_13a,ul,_13b,_13c){\nvar opts=$.data(_13a,"tree").options;\n_13b=$.extend({},opts.queryParams,_13b||{});\nvar _13d=null;\nif(_13a!=ul){\nvar node=$(ul).prev();\n_13d=_ed(_13a,node[0]);\n}\nif(opts.onBeforeLoad.call(_13a,_13d,_13b)==false){\nreturn;\n}\nvar _13e=$(ul).prev().children("span.tree-folder");\n_13e.addClass("tree-loading");\nvar _13f=opts.loader.call(_13a,_13b,function(data){\n_13e.removeClass("tree-loading");\n_127(_13a,ul,data);\nif(_13c){\n_13c();\n}\n},function(){\n_13e.removeClass("tree-loading");\nopts.onLoadError.apply(_13a,arguments);\nif(_13c){\n_13c();\n}\n});\nif(_13f==false){\n_13e.removeClass("tree-loading");\n}\n};\nfunction _140(_141,_142,_143){\nvar opts=$.data(_141,"tree").options;\nvar hit=$(_142).children("span.tree-hit");\nif(hit.length==0){\nreturn;\n}\nif(hit.hasClass("tree-expanded")){\nreturn;\n}\nvar node=_ed(_141,_142);\nif(opts.onBeforeExpand.call(_141,node)==false){\nreturn;\n}\nhit.removeClass("tree-collapsed tree-collapsed-hover").addClass("tree-expanded");\nhit.next().addClass("tree-folder-open");\nvar ul=$(_142).next();\nif(ul.length){\nif(opts.animate){\nul.slideDown("normal",function(){\nnode.state="open";\nopts.onExpand.call(_141,node);\nif(_143){\n_143();\n}\n});\n}else{\nul.css("display","block");\nnode.state="open";\nopts.onExpand.call(_141,node);\nif(_143){\n_143();\n}\n}\n}else{\nvar _144=$("<ul style=\\"display:none\\"></ul>").insertAfter(_142);\n_139(_141,_144[0],{id:node.id},function(){\nif(_144.is(":empty")){\n_144.remove();\n}\nif(opts.animate){\n_144.slideDown("normal",function(){\nnode.state="open";\nopts.onExpand.call(_141,node);\nif(_143){\n_143();\n}\n});\n}else{\n_144.css("display","block");\nnode.state="open";\nopts.onExpand.call(_141,node);\nif(_143){\n_143();\n}\n}\n});\n}\n};\nfunction _145(_146,_147){\nvar opts=$.data(_146,"tree").options;\nvar hit=$(_147).children("span.tree-hit");\nif(hit.length==0){\nreturn;\n}\nif(hit.hasClass("tree-collapsed")){\nreturn;\n}\nvar node=_ed(_146,_147);\nif(opts.onBeforeCollapse.call(_146,node)==false){\nreturn;\n}\nhit.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed");\nhit.next().removeClass("tree-folder-open");\nvar ul=$(_147).next();\nif(opts.animate){\nul.slideUp("normal",function(){\nnode.state="closed";\nopts.onCollapse.call(_146,node);\n});\n}else{\nul.css("display","none");\nnode.state="closed";\nopts.onCollapse.call(_146,node);\n}\n};\nfunction _148(_149,_14a){\nvar hit=$(_14a).children("span.tree-hit");\nif(hit.length==0){\nreturn;\n}\nif(hit.hasClass("tree-expanded")){\n_145(_149,_14a);\n}else{\n_140(_149,_14a);\n}\n};\nfunction _14b(_14c,_14d){\nvar _14e=_14f(_14c,_14d);\nif(_14d){\n_14e.unshift(_ed(_14c,_14d));\n}\nfor(var i=0;i<_14e.length;i++){\n_140(_14c,_14e[i].target);\n}\n};\nfunction _150(_151,_152){\nvar _153=[];\nvar p=_122(_151,_152);\nwhile(p){\n_153.unshift(p);\np=_122(_151,p.target);\n}\nfor(var i=0;i<_153.length;i++){\n_140(_151,_153[i].target);\n}\n};\nfunction _154(_155,_156){\nvar c=$(_155).parent();\nwhile(c[0].tagName!="BODY"&&c.css("overflow-y")!="auto"){\nc=c.parent();\n}\nvar n=$(_156);\nvar ntop=n.offset().top;\nif(c[0].tagName!="BODY"){\nvar ctop=c.offset().top;\nif(ntop<ctop){\nc.scrollTop(c.scrollTop()+ntop-ctop);\n}else{\nif(ntop+n.outerHeight()>ctop+c.outerHeight()-18){\nc.scrollTop(c.scrollTop()+ntop+n.outerHeight()-ctop-c.outerHeight()+18);\n}\n}\n}else{\nc.scrollTop(ntop);\n}\n};\nfunction _157(_158,_159){\nvar _15a=_14f(_158,_159);\nif(_159){\n_15a.unshift(_ed(_158,_159));\n}\nfor(var i=0;i<_15a.length;i++){\n_145(_158,_15a[i].target);\n}\n};\nfunction _15b(_15c,_15d){\nvar node=$(_15d.parent);\nvar data=_15d.data;\nif(!data){\nreturn;\n}\ndata=$.isArray(data)?data:[data];\nif(!data.length){\nreturn;\n}\nvar ul;\nif(node.length==0){\nul=$(_15c);\n}else{\nif(_15e(_15c,node[0])){\nvar _15f=node.find("span.tree-icon");\n_15f.removeClass("tree-file").addClass("tree-folder tree-folder-open");\nvar hit=$("<span class=\\"tree-hit tree-expanded\\"></span>").insertBefore(_15f);\nif(hit.prev().length){\nhit.prev().remove();\n}\n}\nul=node.next();\nif(!ul.length){\nul=$("<ul></ul>").insertAfter(node);\n}\n}\n_127(_15c,ul[0],data,true,true);\n};\nfunction _160(_161,_162){\nvar ref=_162.before||_162.after;\nvar _163=_122(_161,ref);\nvar data=_162.data;\nif(!data){\nreturn;\n}\ndata=$.isArray(data)?data:[data];\nif(!data.length){\nreturn;\n}\n_15b(_161,{parent:(_163?_163.target:null),data:data});\nvar _164=_163?_163.children:$(_161).tree("getRoots");\nfor(var i=0;i<_164.length;i++){\nif(_164[i].domId==$(ref).attr("id")){\nfor(var j=data.length-1;j>=0;j--){\n_164.splice((_162.before?i:(i+1)),0,data[j]);\n}\n_164.splice(_164.length-data.length,data.length);\nbreak;\n}\n}\nvar li=$();\nfor(var i=0;i<data.length;i++){\nli=li.add($("#"+data[i].domId).parent());\n}\nif(_162.before){\nli.insertBefore($(ref).parent());\n}else{\nli.insertAfter($(ref).parent());\n}\n};\nfunction _165(_166,_167){\nvar _168=del(_167);\n$(_167).parent().remove();\nif(_168){\nif(!_168.children||!_168.children.length){\nvar node=$(_168.target);\nnode.find(".tree-icon").removeClass("tree-folder").addClass("tree-file");\nnode.find(".tree-hit").remove();\n$("<span class=\\"tree-indent\\"></span>").prependTo(node);\nnode.next().remove();\n}\n_12f(_166,_168);\n}\n_130(_166,_166);\nfunction del(_169){\nvar id=$(_169).attr("id");\nvar _16a=_122(_166,_169);\nvar cc=_16a?_16a.children:$.data(_166,"tree").data;\nfor(var i=0;i<cc.length;i++){\nif(cc[i].domId==id){\ncc.splice(i,1);\nbreak;\n}\n}\nreturn _16a;\n};\n};\nfunction _12f(_16b,_16c){\nvar opts=$.data(_16b,"tree").options;\nvar node=$(_16c.target);\nvar data=_ed(_16b,_16c.target);\nif(data.iconCls){\nnode.find(".tree-icon").removeClass(data.iconCls);\n}\n$.extend(data,_16c);\nnode.find(".tree-title").html(opts.formatter.call(_16b,data));\nif(data.iconCls){\nnode.find(".tree-icon").addClass(data.iconCls);\n}\n_123(_16b,_16c.target);\n};\nfunction _16d(_16e,_16f){\nif(_16f){\nvar p=_122(_16e,_16f);\nwhile(p){\n_16f=p.target;\np=_122(_16e,_16f);\n}\nreturn _ed(_16e,_16f);\n}else{\nvar _170=_171(_16e);\nreturn _170.length?_170[0]:null;\n}\n};\nfunction _171(_172){\nvar _173=$.data(_172,"tree").data;\nfor(var i=0;i<_173.length;i++){\n_174(_173[i]);\n}\nreturn _173;\n};\nfunction _14f(_175,_176){\nvar _177=[];\nvar n=_ed(_175,_176);\nvar data=n?(n.children||[]):$.data(_175,"tree").data;\n$.easyui.forEach(data,true,function(node){\n_177.push(_174(node));\n});\nreturn _177;\n};\nfunction _122(_178,_179){\nvar p=$(_179).closest("ul").prevAll("div.tree-node:first");\nreturn _ed(_178,p[0]);\n};\nfunction _17a(_17b,_17c){\n_17c=_17c||"checked";\nif(!$.isArray(_17c)){\n_17c=[_17c];\n}\nvar _17d=[];\n$.easyui.forEach($.data(_17b,"tree").data,true,function(n){\nif(n.checkState&&$.easyui.indexOfArray(_17c,n.checkState)!=-1){\n_17d.push(_174(n));\n}\n});\nreturn _17d;\n};\nfunction _17e(_17f){\nvar node=$(_17f).find("div.tree-node-selected");\nreturn node.length?_ed(_17f,node[0]):null;\n};\nfunction _180(_181,_182){\nvar data=_ed(_181,_182);\nif(data&&data.children){\n$.easyui.forEach(data.children,true,function(node){\n_174(node);\n});\n}\nreturn data;\n};\nfunction _ed(_183,_184){\nreturn _12e(_183,"domId",$(_184).attr("id"));\n};\nfunction _185(_186,_187){\nif($.isFunction(_187)){\nvar fn=_187;\n}else{\nvar _187=typeof _187=="object"?_187:{id:_187};\nvar fn=function(node){\nfor(var p in _187){\nif(node[p]!=_187[p]){\nreturn false;\n}\n}\nreturn true;\n};\n}\nvar _188=null;\nvar data=$.data(_186,"tree").data;\n$.easyui.forEach(data,true,function(node){\nif(fn.call(_186,node)==true){\n_188=_174(node);\nreturn false;\n}\n});\nreturn _188;\n};\nfunction _12e(_189,_18a,_18b){\nvar _18c={};\n_18c[_18a]=_18b;\nreturn _185(_189,_18c);\n};\nfunction _174(node){\nnode.target=$("#"+node.domId)[0];\nreturn node;\n};\nfunction _18d(_18e,_18f){\nvar opts=$.data(_18e,"tree").options;\nvar node=_ed(_18e,_18f);\nif(opts.onBeforeSelect.call(_18e,node)==false){\nreturn;\n}\n$(_18e).find("div.tree-node-selected").removeClass("tree-node-selected");\n$(_18f).addClass("tree-node-selected");\nopts.onSelect.call(_18e,node);\n};\nfunction _15e(_190,_191){\nreturn $(_191).children("span.tree-hit").length==0;\n};\nfunction _192(_193,_194){\nvar opts=$.data(_193,"tree").options;\nvar node=_ed(_193,_194);\nif(opts.onBeforeEdit.call(_193,node)==false){\nreturn;\n}\n$(_194).css("position","relative");\nvar nt=$(_194).find(".tree-title");\nvar _195=nt.outerWidth();\nnt.empty();\nvar _196=$("<input class=\\"tree-editor\\">").appendTo(nt);\n_196.val(node.text).focus();\n_196.width(_195+20);\n_196._outerHeight(opts.editorHeight);\n_196._bind("click",function(e){\nreturn false;\n})._bind("mousedown",function(e){\ne.stopPropagation();\n})._bind("mousemove",function(e){\ne.stopPropagation();\n})._bind("keydown",function(e){\nif(e.keyCode==13){\n_197(_193,_194);\nreturn false;\n}else{\nif(e.keyCode==27){\n_19b(_193,_194);\nreturn false;\n}\n}\n})._bind("blur",function(e){\ne.stopPropagation();\n_197(_193,_194);\n});\n};\nfunction _197(_198,_199){\nvar opts=$.data(_198,"tree").options;\n$(_199).css("position","");\nvar _19a=$(_199).find("input.tree-editor");\nvar val=_19a.val();\n_19a.remove();\nvar node=_ed(_198,_199);\nnode.text=val;\n_12f(_198,node);\nopts.onAfterEdit.call(_198,node);\n};\nfunction _19b(_19c,_19d){\nvar opts=$.data(_19c,"tree").options;\n$(_19d).css("position","");\n$(_19d).find("input.tree-editor").remove();\nvar node=_ed(_19c,_19d);\n_12f(_19c,node);\nopts.onCancelEdit.call(_19c,node);\n};\nfunction _19e(_19f,q){\nvar _1a0=$.data(_19f,"tree");\nvar opts=_1a0.options;\nvar ids={};\n$.easyui.forEach(_1a0.data,true,function(node){\nif(opts.filter.call(_19f,q,node)){\n$("#"+node.domId).removeClass("tree-node-hidden");\nids[node.domId]=1;\nnode.hidden=false;\n}else{\n$("#"+node.domId).addClass("tree-node-hidden");\nnode.hidden=true;\n}\n});\nfor(var id in ids){\n_1a1(id);\n}\nfunction _1a1(_1a2){\nvar p=$(_19f).tree("getParent",$("#"+_1a2)[0]);\nwhile(p){\n$(p.target).removeClass("tree-node-hidden");\np.hidden=false;\np=$(_19f).tree("getParent",p.target);\n}\n};\n};\n$.fn.tree=function(_1a3,_1a4){\nif(typeof _1a3=="string"){\nreturn $.fn.tree.methods[_1a3](this,_1a4);\n}\nvar _1a3=_1a3||{};\nreturn this.each(function(){\nvar _1a5=$.data(this,"tree");\nvar opts;\nif(_1a5){\nopts=$.extend(_1a5.options,_1a3);\n_1a5.options=opts;\n}else{\nopts=$.extend({},$.fn.tree.defaults,$.fn.tree.parseOptions(this),_1a3);\n$.data(this,"tree",{options:opts,tree:_e2(this),data:[],tmpIds:[]});\nvar data=$.fn.tree.parseData(this);\nif(data.length){\n_127(this,this,data);\n}\n}\n_e5(this);\nif(opts.data){\n_127(this,this,$.extend(true,[],opts.data));\n}\n_139(this,this);\n});\n};\n$.fn.tree.methods={options:function(jq){\nreturn $.data(jq[0],"tree").options;\n},loadData:function(jq,data){\nreturn jq.each(function(){\n_127(this,this,data);\n});\n},getNode:function(jq,_1a6){\nreturn _ed(jq[0],_1a6);\n},getData:function(jq,_1a7){\nreturn _180(jq[0],_1a7);\n},reload:function(jq,_1a8){\nreturn jq.each(function(){\nif(_1a8){\nvar node=$(_1a8);\nvar hit=node.children("span.tree-hit");\nhit.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed");\nnode.next().remove();\n_140(this,_1a8);\n}else{\n$(this).empty();\n_139(this,this);\n}\n});\n},getRoot:function(jq,_1a9){\nreturn _16d(jq[0],_1a9);\n},getRoots:function(jq){\nreturn _171(jq[0]);\n},getParent:function(jq,_1aa){\nreturn _122(jq[0],_1aa);\n},getChildren:function(jq,_1ab){\nreturn _14f(jq[0],_1ab);\n},getChecked:function(jq,_1ac){\nreturn _17a(jq[0],_1ac);\n},getSelected:function(jq){\nreturn _17e(jq[0]);\n},isLeaf:function(jq,_1ad){\nreturn _15e(jq[0],_1ad);\n},find:function(jq,id){\nreturn _185(jq[0],id);\n},findBy:function(jq,_1ae){\nreturn _12e(jq[0],_1ae.field,_1ae.value);\n},select:function(jq,_1af){\nreturn jq.each(function(){\n_18d(this,_1af);\n});\n},check:function(jq,_1b0){\nreturn jq.each(function(){\n_10f(this,_1b0,true);\n});\n},uncheck:function(jq,_1b1){\nreturn jq.each(function(){\n_10f(this,_1b1,false);\n});\n},collapse:function(jq,_1b2){\nreturn jq.each(function(){\n_145(this,_1b2);\n});\n},expand:function(jq,_1b3){\nreturn jq.each(function(){\n_140(this,_1b3);\n});\n},collapseAll:function(jq,_1b4){\nreturn jq.each(function(){\n_157(this,_1b4);\n});\n},expandAll:function(jq,_1b5){\nreturn jq.each(function(){\n_14b(this,_1b5);\n});\n},expandTo:function(jq,_1b6){\nreturn jq.each(function(){\n_150(this,_1b6);\n});\n},scrollTo:function(jq,_1b7){\nreturn jq.each(function(){\n_154(this,_1b7);\n});\n},toggle:function(jq,_1b8){\nreturn jq.each(function(){\n_148(this,_1b8);\n});\n},append:function(jq,_1b9){\nreturn jq.each(function(){\n_15b(this,_1b9);\n});\n},insert:function(jq,_1ba){\nreturn jq.each(function(){\n_160(this,_1ba);\n});\n},remove:function(jq,_1bb){\nreturn jq.each(function(){\n_165(this,_1bb);\n});\n},pop:function(jq,_1bc){\nvar node=jq.tree("getData",_1bc);\njq.tree("remove",_1bc);\nreturn node;\n},update:function(jq,_1bd){\nreturn jq.each(function(){\n_12f(this,$.extend({},_1bd,{checkState:_1bd.checked?"checked":(_1bd.checked===false?"unchecked":undefined)}));\n});\n},enableDnd:function(jq){\nreturn jq.each(function(){\n_f2(this);\n});\n},disableDnd:function(jq){\nreturn jq.each(function(){\n_ee(this);\n});\n},beginEdit:function(jq,_1be){\nreturn jq.each(function(){\n_192(this,_1be);\n});\n},endEdit:function(jq,_1bf){\nreturn jq.each(function(){\n_197(this,_1bf);\n});\n},cancelEdit:function(jq,_1c0){\nreturn jq.each(function(){\n_19b(this,_1c0);\n});\n},doFilter:function(jq,q){\nreturn jq.each(function(){\n_19e(this,q);\n});\n}};\n$.fn.tree.parseOptions=function(_1c1){\nvar t=$(_1c1);\nreturn $.extend({},$.parser.parseOptions(_1c1,["url","method",{checkbox:"boolean",cascadeCheck:"boolean",onlyLeafCheck:"boolean"},{animate:"boolean",lines:"boolean",dnd:"boolean"}]));\n};\n$.fn.tree.parseData=function(_1c2){\nvar data=[];\n_1c3(data,$(_1c2));\nreturn data;\nfunction _1c3(aa,tree){\ntree.children("li").each(function(){\nvar node=$(this);\nvar item=$.extend({},$.parser.parseOptions(this,["id","iconCls","state"]),{checked:(node.attr("checked")?true:undefined)});\nitem.text=node.children("span").html();\nif(!item.text){\nitem.text=node.html();\n}\nvar _1c4=node.children("ul");\nif(_1c4.length){\nitem.children=[];\n_1c3(item.children,_1c4);\n}\naa.push(item);\n});\n};\n};\nvar _1c5=1;\nvar _1c6={render:function(_1c7,ul,data){\nvar _1c8=$.data(_1c7,"tree");\nvar opts=_1c8.options;\nvar _1c9=$(ul).prev(".tree-node");\nvar _1ca=_1c9.length?$(_1c7).tree("getNode",_1c9[0]):null;\nvar _1cb=_1c9.find("span.tree-indent, span.tree-hit").length;\nvar _1cc=$(_1c7).attr("id")||"";\nvar cc=_1cd.call(this,_1cb,data);\n$(ul).append(cc.join(""));\nfunction _1cd(_1ce,_1cf){\nvar cc=[];\nfor(var i=0;i<_1cf.length;i++){\nvar item=_1cf[i];\nif(item.state!="open"&&item.state!="closed"){\nitem.state="open";\n}\nitem.domId=_1cc+"_easyui_tree_"+_1c5++;\ncc.push("<li>");\ncc.push("<div id=\\""+item.domId+"\\" class=\\"tree-node"+(item.nodeCls?" "+item.nodeCls:"")+"\\">");\nfor(var j=0;j<_1ce;j++){\ncc.push("<span class=\\"tree-indent\\"></span>");\n}\nif(item.state=="closed"){\ncc.push("<span class=\\"tree-hit tree-collapsed\\"></span>");\ncc.push("<span class=\\"tree-icon tree-folder "+(item.iconCls?item.iconCls:"")+"\\"></span>");\n}else{\nif(item.children&&item.children.length){\ncc.push("<span class=\\"tree-hit tree-expanded\\"></span>");\ncc.push("<span class=\\"tree-icon tree-folder tree-folder-open "+(item.iconCls?item.iconCls:"")+"\\"></span>");\n}else{\ncc.push("<span class=\\"tree-indent\\"></span>");\ncc.push("<span class=\\"tree-icon tree-file "+(item.iconCls?item.iconCls:"")+"\\"></span>");\n}\n}\nif(this.hasCheckbox(_1c7,item)){\nvar flag=0;\nif(_1ca&&_1ca.checkState=="checked"&&opts.cascadeCheck){\nflag=1;\nitem.checked=true;\n}else{\nif(item.checked){\n$.easyui.addArrayItem(_1c8.tmpIds,item.domId);\n}\n}\nitem.checkState=flag?"checked":"unchecked";\ncc.push("<span class=\\"tree-checkbox tree-checkbox"+flag+"\\"></span>");\n}else{\nitem.checkState=undefined;\nitem.checked=undefined;\n}\ncc.push("<span class=\\"tree-title\\">"+opts.formatter.call(_1c7,item)+"</span>");\ncc.push("</div>");\nif(item.children&&item.children.length){\nvar tmp=_1cd.call(this,_1ce+1,item.children);\ncc.push("<ul style=\\"display:"+(item.state=="closed"?"none":"block")+"\\">");\ncc=cc.concat(tmp);\ncc.push("</ul>");\n}\ncc.push("</li>");\n}\nreturn cc;\n};\n},hasCheckbox:function(_1d0,item){\nvar _1d1=$.data(_1d0,"tree");\nvar opts=_1d1.options;\nif(opts.checkbox){\nif($.isFunction(opts.checkbox)){\nif(opts.checkbox.call(_1d0,item)){\nreturn true;\n}else{\nreturn false;\n}\n}else{\nif(opts.onlyLeafCheck){\nif(item.state=="open"&&!(item.children&&item.children.length)){\nreturn true;\n}\n}else{\nreturn true;\n}\n}\n}\nreturn false;\n}};\n$.fn.tree.defaults={url:null,method:"post",animate:false,checkbox:false,cascadeCheck:true,onlyLeafCheck:false,lines:false,dnd:false,editorHeight:26,data:null,queryParams:{},formatter:function(node){\nreturn node.text;\n},filter:function(q,node){\nvar qq=[];\n$.map($.isArray(q)?q:[q],function(q){\nq=$.trim(q);\nif(q){\nqq.push(q);\n}\n});\nfor(var i=0;i<qq.length;i++){\nvar _1d2=node.text.toLowerCase().indexOf(qq[i].toLowerCase());\nif(_1d2>=0){\nreturn true;\n}\n}\nreturn !qq.length;\n},loader:function(_1d3,_1d4,_1d5){\nvar opts=$(this).tree("options");\nif(!opts.url){\nreturn false;\n}\n$.ajax({type:opts.method,url:opts.url,data:_1d3,dataType:"json",success:function(data){\n_1d4(data);\n},error:function(){\n_1d5.apply(this,arguments);\n}});\n},loadFilter:function(data,_1d6){\nreturn data;\n},view:_1c6,onBeforeLoad:function(node,_1d7){\n},onLoadSuccess:function(node,data){\n},onLoadError:function(){\n},onClick:function(node){\n},onDblClick:function(node){\n},onBeforeExpand:function(node){\n},onExpand:function(node){\n},onBeforeCollapse:function(node){\n},onCollapse:function(node){\n},onBeforeCheck:function(node,_1d8){\n},onCheck:function(node,_1d9){\n},onBeforeSelect:function(node){\n},onSelect:function(node){\n},onContextMenu:function(e,node){\n},onBeforeDrag:function(node){\n},onStartDrag:function(node){\n},onStopDrag:function(node){\n},onDragEnter:function(_1da,_1db){\n},onDragOver:function(_1dc,_1dd){\n},onDragLeave:function(_1de,_1df){\n},onBeforeDrop:function(_1e0,_1e1,_1e2){\n},onDrop:function(_1e3,_1e4,_1e5){\n},onBeforeEdit:function(node){\n},onAfterEdit:function(node){\n},onCancelEdit:function(node){\n}};\n})(jQuery);\n(function($){\nfunction init(_1e6){\n$(_1e6).addClass("progressbar");\n$(_1e6).html("<div class=\\"progressbar-text\\"></div><div class=\\"progressbar-value\\"><div class=\\"progressbar-text\\"></div></div>");\n$(_1e6)._bind("_resize",function(e,_1e7){\nif($(this).hasClass("easyui-fluid")||_1e7){\n_1e8(_1e6);\n}\nreturn false;\n});\nreturn $(_1e6);\n};\nfunction _1e8(_1e9,_1ea){\nvar opts=$.data(_1e9,"progressbar").options;\nvar bar=$.data(_1e9,"progressbar").bar;\nif(_1ea){\nopts.width=_1ea;\n}\nbar._size(opts);\nbar.find("div.progressbar-text").css("width",bar.width());\nbar.find("div.progressbar-text,div.progressbar-value").css({height:bar.height()+"px",lineHeight:bar.height()+"px"});\n};\n$.fn.progressbar=function(_1eb,_1ec){\nif(typeof _1eb=="string"){\nvar _1ed=$.fn.progressbar.methods[_1eb];\nif(_1ed){\nreturn _1ed(this,_1ec);\n}\n}\n_1eb=_1eb||{};\nreturn this.each(function(){\nvar _1ee=$.data(this,"progressbar");\nif(_1ee){\n$.extend(_1ee.options,_1eb);\n}else{\n_1ee=$.data(this,"progressbar",{options:$.extend({},$.fn.progressbar.defaults,$.fn.progressbar.parseOptions(this),_1eb),bar:init(this)});\n}\n$(this).progressbar("setValue",_1ee.options.value);\n_1e8(this);\n});\n};\n$.fn.progressbar.methods={options:function(jq){\nreturn $.data(jq[0],"progressbar").options;\n},resize:function(jq,_1ef){\nreturn jq.each(function(){\n_1e8(this,_1ef);\n});\n},getValue:function(jq){\nreturn $.data(jq[0],"progressbar").options.value;\n},setValue:function(jq,_1f0){\nif(_1f0<0){\n_1f0=0;\n}\nif(_1f0>100){\n_1f0=100;\n}\nreturn jq.each(function(){\nvar opts=$.data(this,"progressbar").options;\nvar text=opts.text.replace(/{value}/,_1f0);\nvar _1f1=opts.value;\nopts.value=_1f0;\n$(this).find("div.progressbar-value").width(_1f0+"%");\n$(this).find("div.progressbar-text").html(text);\nif(_1f1!=_1f0){\nopts.onChange.call(this,_1f0,_1f1);\n}\n});\n}};\n$.fn.progressbar.parseOptions=function(_1f2){\nreturn $.extend({},$.parser.parseOptions(_1f2,["width","height","text",{value:"number"}]));\n};\n$.fn.progressbar.defaults={width:"auto",height:22,value:0,text:"{value}%",onChange:function(_1f3,_1f4){\n}};\n})(jQuery);\n(function($){\nfunction init(_1f5){\n$(_1f5).addClass("tooltip-f");\n};\nfunction _1f6(_1f7){\nvar opts=$.data(_1f7,"tooltip").options;\n$(_1f7)._unbind(".tooltip")._bind(opts.showEvent+".tooltip",function(e){\n$(_1f7).tooltip("show",e);\n})._bind(opts.hideEvent+".tooltip",function(e){\n$(_1f7).tooltip("hide",e);\n})._bind("mousemove.tooltip",function(e){\nif(opts.trackMouse){\nopts.trackMouseX=e.pageX;\nopts.trackMouseY=e.pageY;\n$(_1f7).tooltip("reposition");\n}\n});\n};\nfunction _1f8(_1f9){\nvar _1fa=$.data(_1f9,"tooltip");\nif(_1fa.showTimer){\nclearTimeout(_1fa.showTimer);\n_1fa.showTimer=null;\n}\nif(_1fa.hideTimer){\nclearTimeout(_1fa.hideTimer);\n_1fa.hideTimer=null;\n}\n};\nfunction _1fb(_1fc){\nvar _1fd=$.data(_1fc,"tooltip");\nif(!_1fd||!_1fd.tip){\nreturn;\n}\nvar opts=_1fd.options;\nvar tip=_1fd.tip;\nvar pos={left:-100000,top:-100000};\nif($(_1fc).is(":visible")){\npos=_1fe(opts.position);\nif(opts.position=="top"&&pos.top<0){\npos=_1fe("bottom");\n}else{\nif((opts.position=="bottom")&&(pos.top+tip._outerHeight()>$(window)._outerHeight()+$(document).scrollTop())){\npos=_1fe("top");\n}\n}\nif(pos.left<0){\nif(opts.position=="left"){\npos=_1fe("right");\n}else{\n$(_1fc).tooltip("arrow").css("left",tip._outerWidth()/2+pos.left);\npos.left=0;\n}\n}else{\nif(pos.left+tip._outerWidth()>$(window)._outerWidth()+$(document)._scrollLeft()){\nif(opts.position=="right"){\npos=_1fe("left");\n}else{\nvar left=pos.left;\npos.left=$(window)._outerWidth()+$(document)._scrollLeft()-tip._outerWidth();\n$(_1fc).tooltip("arrow").css("left",tip._outerWidth()/2-(pos.left-left));\n}\n}\n}\n}\ntip.css({left:pos.left,top:pos.top,zIndex:(opts.zIndex!=undefined?opts.zIndex:($.fn.window?$.fn.window.defaults.zIndex++:""))});\nopts.onPosition.call(_1fc,pos.left,pos.top);\nfunction _1fe(_1ff){\nopts.position=_1ff||"bottom";\ntip.removeClass("tooltip-top tooltip-bottom tooltip-left tooltip-right").addClass("tooltip-"+opts.position);\nvar left,top;\nvar _200=$.isFunction(opts.deltaX)?opts.deltaX.call(_1fc,opts.position):opts.deltaX;\nvar _201=$.isFunction(opts.deltaY)?opts.deltaY.call(_1fc,opts.position):opts.deltaY;\nif(opts.trackMouse){\nt=$();\nleft=opts.trackMouseX+_200;\ntop=opts.trackMouseY+_201;\n}else{\nvar t=$(_1fc);\nleft=t.offset().left+_200;\ntop=t.offset().top+_201;\n}\nswitch(opts.position){\ncase "right":\nleft+=t._outerWidth()+12+(opts.trackMouse?12:0);\nif(opts.valign=="middle"){\ntop-=(tip._outerHeight()-t._outerHeight())/2;\n}\nbreak;\ncase "left":\nleft-=tip._outerWidth()+12+(opts.trackMouse?12:0);\nif(opts.valign=="middle"){\ntop-=(tip._outerHeight()-t._outerHeight())/2;\n}\nbreak;\ncase "top":\nleft-=(tip._outerWidth()-t._outerWidth())/2;\ntop-=tip._outerHeight()+12+(opts.trackMouse?12:0);\nbreak;\ncase "bottom":\nleft-=(tip._outerWidth()-t._outerWidth())/2;\ntop+=t._outerHeight()+12+(opts.trackMouse?12:0);\nbreak;\n}\nreturn {left:left,top:top};\n};\n};\nfunction _202(_203,e){\nvar _204=$.data(_203,"tooltip");\nvar opts=_204.options;\nvar tip=_204.tip;\nif(!tip){\ntip=$("<div tabindex=\\"-1\\" class=\\"tooltip\\">"+"<div class=\\"tooltip-content\\"></div>"+"<div class=\\"tooltip-arrow-outer\\"></div>"+"<div class=\\"tooltip-arrow\\"></div>"+"</div>").appendTo("body");\n_204.tip=tip;\n_205(_203);\n}\n_1f8(_203);\n_204.showTimer=setTimeout(function(){\n$(_203).tooltip("reposition");\ntip.show();\nopts.onShow.call(_203,e);\nvar _206=tip.children(".tooltip-arrow-outer");\nvar _207=tip.children(".tooltip-arrow");\nvar bc="border-"+opts.position+"-color";\n_206.add(_207).css({borderTopColor:"",borderBottomColor:"",borderLeftColor:"",borderRightColor:""});\n_206.css(bc,tip.css(bc));\n_207.css(bc,tip.css("backgroundColor"));\n},opts.showDelay);\n};\nfunction _208(_209,e){\nvar _20a=$.data(_209,"tooltip");\nif(_20a&&_20a.tip){\n_1f8(_209);\n_20a.hideTimer=setTimeout(function(){\n_20a.tip.hide();\n_20a.options.onHide.call(_209,e);\n},_20a.options.hideDelay);\n}\n};\nfunction _205(_20b,_20c){\nvar _20d=$.data(_20b,"tooltip");\nvar opts=_20d.options;\nif(_20c){\nopts.content=_20c;\n}\nif(!_20d.tip){\nreturn;\n}\nvar cc=typeof opts.content=="function"?opts.content.call(_20b):opts.content;\n_20d.tip.children(".tooltip-content").html(cc);\nopts.onUpdate.call(_20b,cc);\n};\nfunction _20e(_20f){\nvar _210=$.data(_20f,"tooltip");\nif(_210){\n_1f8(_20f);\nvar opts=_210.options;\nif(_210.tip){\n_210.tip.remove();\n}\nif(opts._title){\n$(_20f).attr("title",opts._title);\n}\n$.removeData(_20f,"tooltip");\n$(_20f)._unbind(".tooltip").removeClass("tooltip-f");\nopts.onDestroy.call(_20f);\n}\n};\n$.fn.tooltip=function(_211,_212){\nif(typeof _211=="string"){\nreturn $.fn.tooltip.methods[_211](this,_212);\n}\n_211=_211||{};\nreturn this.each(function(){\nvar _213=$.data(this,"tooltip");\nif(_213){\n$.extend(_213.options,_211);\n}else{\n$.data(this,"tooltip",{options:$.extend({},$.fn.tooltip.defaults,$.fn.tooltip.parseOptions(this),_211)});\ninit(this);\n}\n_1f6(this);\n_205(this);\n});\n};\n$.fn.tooltip.methods={options:function(jq){\nreturn $.data(jq[0],"tooltip").options;\n},tip:function(jq){\nreturn $.data(jq[0],"tooltip").tip;\n},arrow:function(jq){\nreturn jq.tooltip("tip").children(".tooltip-arrow-outer,.tooltip-arrow");\n},show:function(jq,e){\nreturn jq.each(function(){\n_202(this,e);\n});\n},hide:function(jq,e){\nreturn jq.each(function(){\n_208(this,e);\n});\n},update:function(jq,_214){\nreturn jq.each(function(){\n_205(this,_214);\n});\n},reposition:function(jq){\nreturn jq.each(function(){\n_1fb(this);\n});\n},destroy:function(jq){\nreturn jq.each(function(){\n_20e(this);\n});\n}};\n$.fn.tooltip.parseOptions=function(_215){\nvar t=$(_215);\nvar opts=$.extend({},$.parser.parseOptions(_215,["position","showEvent","hideEvent","content",{trackMouse:"boolean",deltaX:"number",deltaY:"number",showDelay:"number",hideDelay:"number"}]),{_title:t.attr("title")});\nt.attr("title","");\nif(!opts.content){\nopts.content=opts._title;\n}\nreturn opts;\n};\n$.fn.tooltip.defaults={position:"bottom",valign:"middle",content:null,trackMouse:false,deltaX:0,deltaY:0,showEvent:"mouseenter",hideEvent:"mouseleave",showDelay:200,hideDelay:100,onShow:function(e){\n},onHide:function(e){\n},onUpdate:function(_216){\n},onPosition:function(left,top){\n},onDestroy:function(){\n}};\n})(jQuery);\n(function($){\n$.fn._remove=function(){\nreturn this.each(function(){\n$(this).remove();\ntry{\nthis.outerHTML="";\n}\ncatch(err){\n}\n});\n};\nfunction _217(node){\nnode._remove();\n};\nfunction _218(_219,_21a){\nvar _21b=$.data(_219,"panel");\nvar opts=_21b.options;\nvar _21c=_21b.panel;\nvar _21d=_21c.children(".panel-header");\nvar _21e=_21c.children(".panel-body");\nvar _21f=_21c.children(".panel-footer");\nvar _220=(opts.halign=="left"||opts.halign=="right");\nif(_21a){\n$.extend(opts,{width:_21a.width,height:_21a.height,minWidth:_21a.minWidth,maxWidth:_21a.maxWidth,minHeight:_21a.minHeight,maxHeight:_21a.maxHeight,left:_21a.left,top:_21a.top});\nopts.hasResized=false;\n}\nvar _221=_21c.outerWidth();\nvar _222=_21c.outerHeight();\n_21c._size(opts);\nvar _223=_21c.outerWidth();\nvar _224=_21c.outerHeight();\nif(opts.hasResized&&(_221==_223&&_222==_224)){\nreturn;\n}\nopts.hasResized=true;\nif(!_220){\n_21d._outerWidth(_21c.width());\n}\n_21e._outerWidth(_21c.width());\nif(!isNaN(parseInt(opts.height))){\nif(_220){\nif(opts.header){\nvar _225=$(opts.header)._outerWidth();\n}else{\n_21d.css("width","");\nvar _225=_21d._outerWidth();\n}\nvar _226=_21d.find(".panel-title");\n_225+=Math.min(_226._outerWidth(),_226._outerHeight());\nvar _227=_21c.height();\n_21d._outerWidth(_225)._outerHeight(_227);\n_226._outerWidth(_21d.height());\n_21e._outerWidth(_21c.width()-_225-_21f._outerWidth())._outerHeight(_227);\n_21f._outerHeight(_227);\n_21e.css({left:"",right:""});\nif(_21d.length){\n_21e.css(opts.halign,(_21d.position()[opts.halign]+_225)+"px");\n}\nopts.panelCssWidth=_21c.css("width");\nif(opts.collapsed){\n_21c._outerWidth(_225+_21f._outerWidth());\n}\n}else{\n_21e._outerHeight(_21c.height()-_21d._outerHeight()-_21f._outerHeight());\n}\n}else{\n_21e.css("height","");\nvar min=$.parser.parseValue("minHeight",opts.minHeight,_21c.parent());\nvar max=$.parser.parseValue("maxHeight",opts.maxHeight,_21c.parent());\nvar _228=_21d._outerHeight()+_21f._outerHeight()+_21c._outerHeight()-_21c.height();\n_21e._size("minHeight",min?(min-_228):"");\n_21e._size("maxHeight",max?(max-_228):"");\n}\n_21c.css({height:(_220?undefined:""),minHeight:"",maxHeight:"",left:opts.left,top:opts.top});\nopts.onResize.apply(_219,[opts.width,opts.height]);\n$(_219).panel("doLayout");\n};\nfunction _229(_22a,_22b){\nvar _22c=$.data(_22a,"panel");\nvar opts=_22c.options;\nvar _22d=_22c.panel;\nif(_22b){\nif(_22b.left!=null){\nopts.left=_22b.left;\n}\nif(_22b.top!=null){\nopts.top=_22b.top;\n}\n}\n_22d.css({left:opts.left,top:opts.top});\n_22d.find(".tooltip-f").each(function(){\n$(this).tooltip("reposition");\n});\nopts.onMove.apply(_22a,[opts.left,opts.top]);\n};\nfunction _22e(_22f){\n$(_22f).addClass("panel-body")._size("clear");\nvar _230=$("<div class=\\"panel\\"></div>").insertBefore(_22f);\n_230[0].appendChild(_22f);\n_230._bind("_resize",function(e,_231){\nif($(this).hasClass("easyui-fluid")||_231){\n_218(_22f,{});\n}\nreturn false;\n});\nreturn _230;\n};\nfunction _232(_233){\nvar _234=$.data(_233,"panel");\nvar opts=_234.options;\nvar _235=_234.panel;\n_235.css(opts.style);\n_235.addClass(opts.cls);\n_235.removeClass("panel-hleft panel-hright").addClass("panel-h"+opts.halign);\n_236();\n_237();\nvar _238=$(_233).panel("header");\nvar body=$(_233).panel("body");\nvar _239=$(_233).siblings(".panel-footer");\nif(opts.border){\n_238.removeClass("panel-header-noborder");\nbody.removeClass("panel-body-noborder");\n_239.removeClass("panel-footer-noborder");\n}else{\n_238.addClass("panel-header-noborder");\nbody.addClass("panel-body-noborder");\n_239.addClass("panel-footer-noborder");\n}\n_238.addClass(opts.headerCls);\nbody.addClass(opts.bodyCls);\n$(_233).attr("id",opts.id||"");\nif(opts.content){\n$(_233).panel("clear");\n$(_233).html(opts.content);\n$.parser.parse($(_233));\n}\nfunction _236(){\nif(opts.noheader||(!opts.title&&!opts.header)){\n_217(_235.children(".panel-header"));\n_235.children(".panel-body").addClass("panel-body-noheader");\n}else{\nif(opts.header){\n$(opts.header).addClass("panel-header").prependTo(_235);\n}else{\nvar _23a=_235.children(".panel-header");\nif(!_23a.length){\n_23a=$("<div class=\\"panel-header\\"></div>").prependTo(_235);\n}\nif(!$.isArray(opts.tools)){\n_23a.find("div.panel-tool .panel-tool-a").appendTo(opts.tools);\n}\n_23a.empty();\nvar _23b=$("<div class=\\"panel-title\\"></div>").html(opts.title).appendTo(_23a);\nif(opts.iconCls){\n_23b.addClass("panel-with-icon");\n$("<div class=\\"panel-icon\\"></div>").addClass(opts.iconCls).appendTo(_23a);\n}\nif(opts.halign=="left"||opts.halign=="right"){\n_23b.addClass("panel-title-"+opts.titleDirection);\n}\nvar tool=$("<div class=\\"panel-tool\\"></div>").appendTo(_23a);\ntool._bind("click",function(e){\ne.stopPropagation();\n});\nif(opts.tools){\nif($.isArray(opts.tools)){\n$.map(opts.tools,function(t){\n_23c(tool,t.iconCls,eval(t.handler));\n});\n}else{\n$(opts.tools).children().each(function(){\n$(this).addClass($(this).attr("iconCls")).addClass("panel-tool-a").appendTo(tool);\n});\n}\n}\nif(opts.collapsible){\n_23c(tool,"panel-tool-collapse",function(){\nif(opts.collapsed==true){\n_25d(_233,true);\n}else{\n_24e(_233,true);\n}\n});\n}\nif(opts.minimizable){\n_23c(tool,"panel-tool-min",function(){\n_263(_233);\n});\n}\nif(opts.maximizable){\n_23c(tool,"panel-tool-max",function(){\nif(opts.maximized==true){\n_266(_233);\n}else{\n_24d(_233);\n}\n});\n}\nif(opts.closable){\n_23c(tool,"panel-tool-close",function(){\n_24f(_233);\n});\n}\n}\n_235.children("div.panel-body").removeClass("panel-body-noheader");\n}\n};\nfunction _23c(c,icon,_23d){\nvar a=$("<a href=\\"javascript:;\\"></a>").addClass(icon).appendTo(c);\na._bind("click",_23d);\n};\nfunction _237(){\nif(opts.footer){\n$(opts.footer).addClass("panel-footer").appendTo(_235);\n$(_233).addClass("panel-body-nobottom");\n}else{\n_235.children(".panel-footer").remove();\n$(_233).removeClass("panel-body-nobottom");\n}\n};\n};\nfunction _23e(_23f,_240){\nvar _241=$.data(_23f,"panel");\nvar opts=_241.options;\nif(_242){\nopts.queryParams=_240;\n}\nif(!opts.href){\nreturn;\n}\nif(!_241.isLoaded||!opts.cache){\nvar _242=$.extend({},opts.queryParams);\nif(opts.onBeforeLoad.call(_23f,_242)==false){\nreturn;\n}\n_241.isLoaded=false;\nif(opts.loadingMessage){\n$(_23f).panel("clear");\n$(_23f).html($("<div class=\\"panel-loading\\"></div>").html(opts.loadingMessage));\n}\nopts.loader.call(_23f,_242,function(data){\nvar _243=opts.extractor.call(_23f,data);\n$(_23f).panel("clear");\n$(_23f).html(_243);\n$.parser.parse($(_23f));\nopts.onLoad.apply(_23f,arguments);\n_241.isLoaded=true;\n},function(){\nopts.onLoadError.apply(_23f,arguments);\n});\n}\n};\nfunction _244(_245){\nvar t=$(_245);\nt.find(".combo-f").each(function(){\n$(this).combo("destroy");\n});\nt.find(".m-btn").each(function(){\n$(this).menubutton("destroy");\n});\nt.find(".s-btn").each(function(){\n$(this).splitbutton("destroy");\n});\nt.find(".tooltip-f").each(function(){\n$(this).tooltip("destroy");\n});\nt.children("div").each(function(){\n$(this)._size("unfit");\n});\nt.empty();\n};\nfunction _246(_247){\n$(_247).panel("doLayout",true);\n};\nfunction _248(_249,_24a){\nvar _24b=$.data(_249,"panel");\nvar opts=_24b.options;\nvar _24c=_24b.panel;\nif(_24a!=true){\nif(opts.onBeforeOpen.call(_249)==false){\nreturn;\n}\n}\n_24c.stop(true,true);\nif($.isFunction(opts.openAnimation)){\nopts.openAnimation.call(_249,cb);\n}else{\nswitch(opts.openAnimation){\ncase "slide":\n_24c.slideDown(opts.openDuration,cb);\nbreak;\ncase "fade":\n_24c.fadeIn(opts.openDuration,cb);\nbreak;\ncase "show":\n_24c.show(opts.openDuration,cb);\nbreak;\ndefault:\n_24c.show();\ncb();\n}\n}\nfunction cb(){\nopts.closed=false;\nopts.minimized=false;\nvar tool=_24c.children(".panel-header").find("a.panel-tool-restore");\nif(tool.length){\nopts.maximized=true;\n}\nopts.onOpen.call(_249);\nif(opts.maximized==true){\nopts.maximized=false;\n_24d(_249);\n}\nif(opts.collapsed==true){\nopts.collapsed=false;\n_24e(_249);\n}\nif(!opts.collapsed){\nif(opts.href&&(!_24b.isLoaded||!opts.cache)){\n_23e(_249);\n_246(_249);\nopts.doneLayout=true;\n}\n}\nif(!opts.doneLayout){\nopts.doneLayout=true;\n_246(_249);\n}\n};\n};\nfunction _24f(_250,_251){\nvar _252=$.data(_250,"panel");\nvar opts=_252.options;\nvar _253=_252.panel;\nif(_251!=true){\nif(opts.onBeforeClose.call(_250)==false){\nreturn;\n}\n}\n_253.find(".tooltip-f").each(function(){\n$(this).tooltip("hide");\n});\n_253.stop(true,true);\n_253._size("unfit");\nif($.isFunction(opts.closeAnimation)){\nopts.closeAnimation.call(_250,cb);\n}else{\nswitch(opts.closeAnimation){\ncase "slide":\n_253.slideUp(opts.closeDuration,cb);\nbreak;\ncase "fade":\n_253.fadeOut(opts.closeDuration,cb);\nbreak;\ncase "hide":\n_253.hide(opts.closeDuration,cb);\nbreak;\ndefault:\n_253.hide();\ncb();\n}\n}\nfunction cb(){\nopts.closed=true;\nopts.onClose.call(_250);\n};\n};\nfunction _254(_255,_256){\nvar _257=$.data(_255,"panel");\nvar opts=_257.options;\nvar _258=_257.panel;\nif(_256!=true){\nif(opts.onBeforeDestroy.call(_255)==false){\nreturn;\n}\n}\n$(_255).panel("clear").panel("clear","footer");\n_217(_258);\nopts.onDestroy.call(_255);\n};\nfunction _24e(_259,_25a){\nvar opts=$.data(_259,"panel").options;\nvar _25b=$.data(_259,"panel").panel;\nvar body=_25b.children(".panel-body");\nvar _25c=_25b.children(".panel-header");\nvar tool=_25c.find("a.panel-tool-collapse");\nif(opts.collapsed==true){\nreturn;\n}\nbody.stop(true,true);\nif(opts.onBeforeCollapse.call(_259)==false){\nreturn;\n}\ntool.addClass("panel-tool-expand");\nif(_25a==true){\nif(opts.halign=="left"||opts.halign=="right"){\n_25b.animate({width:_25c._outerWidth()+_25b.children(".panel-footer")._outerWidth()},function(){\ncb();\n});\n}else{\nbody.slideUp("normal",function(){\ncb();\n});\n}\n}else{\nif(opts.halign=="left"||opts.halign=="right"){\n_25b._outerWidth(_25c._outerWidth()+_25b.children(".panel-footer")._outerWidth());\n}\ncb();\n}\nfunction cb(){\nbody.hide();\nopts.collapsed=true;\nopts.onCollapse.call(_259);\n};\n};\nfunction _25d(_25e,_25f){\nvar opts=$.data(_25e,"panel").options;\nvar _260=$.data(_25e,"panel").panel;\nvar body=_260.children(".panel-body");\nvar tool=_260.children(".panel-header").find("a.panel-tool-collapse");\nif(opts.collapsed==false){\nreturn;\n}\nbody.stop(true,true);\nif(opts.onBeforeExpand.call(_25e)==false){\nreturn;\n}\ntool.removeClass("panel-tool-expand");\nif(_25f==true){\nif(opts.halign=="left"||opts.halign=="right"){\nbody.show();\n_260.animate({width:opts.panelCssWidth},function(){\ncb();\n});\n}else{\nbody.slideDown("normal",function(){\ncb();\n});\n}\n}else{\nif(opts.halign=="left"||opts.halign=="right"){\n_260.css("width",opts.panelCssWidth);\n}\ncb();\n}\nfunction cb(){\nbody.show();\nopts.collapsed=false;\nopts.onExpand.call(_25e);\n_23e(_25e);\n_246(_25e);\n};\n};\nfunction _24d(_261){\nvar opts=$.data(_261,"panel").options;\nvar _262=$.data(_261,"panel").panel;\nvar tool=_262.children(".panel-header").find("a.panel-tool-max");\nif(opts.maximized==true){\nreturn;\n}\ntool.addClass("panel-tool-restore");\nif(!$.data(_261,"panel").original){\n$.data(_261,"panel").original={width:opts.width,height:opts.height,left:opts.left,top:opts.top,fit:opts.fit};\n}\nopts.left=0;\nopts.top=0;\nopts.fit=true;\n_218(_261);\nopts.minimized=false;\nopts.maximized=true;\nopts.onMaximize.call(_261);\n};\nfunction _263(_264){\nvar opts=$.data(_264,"panel").options;\nvar _265=$.data(_264,"panel").panel;\n_265._size("unfit");\n_265.hide();\nopts.minimized=true;\nopts.maximized=false;\nopts.onMinimize.call(_264);\n};\nfunction _266(_267){\nvar opts=$.data(_267,"panel").options;\nvar _268=$.data(_267,"panel").panel;\nvar tool=_268.children(".panel-header").find("a.panel-tool-max");\nif(opts.maximized==false){\nreturn;\n}\n_268.show();\ntool.removeClass("panel-tool-restore");\n$.extend(opts,$.data(_267,"panel").original);\n_218(_267);\nopts.minimized=false;\nopts.maximized=false;\n$.data(_267,"panel").original=null;\nopts.onRestore.call(_267);\n};\nfunction _269(_26a,_26b){\n$.data(_26a,"panel").options.title=_26b;\n$(_26a).panel("header").find("div.panel-title").html(_26b);\n};\nvar _26c=null;\n$(window)._unbind(".panel")._bind("resize.panel",function(){\nif(_26c){\nclearTimeout(_26c);\n}\n_26c=setTimeout(function(){\nvar _26d=$("body.layout");\nif(_26d.length){\n_26d.layout("resize");\n$("body").children(".easyui-fluid:visible").each(function(){\n$(this).triggerHandler("_resize");\n});\n}else{\n$("body").panel("doLayout");\n}\n_26c=null;\n},100);\n});\n$.fn.panel=function(_26e,_26f){\nif(typeof _26e=="string"){\nreturn $.fn.panel.methods[_26e](this,_26f);\n}\n_26e=_26e||{};\nreturn this.each(function(){\nvar _270=$.data(this,"panel");\nvar opts;\nif(_270){\nopts=$.extend(_270.options,_26e);\n_270.isLoaded=false;\n}else{\nopts=$.extend({},$.fn.panel.defaults,$.fn.panel.parseOptions(this),_26e);\n$(this).attr("title","");\n_270=$.data(this,"panel",{options:opts,panel:_22e(this),isLoaded:false});\n}\n_232(this);\n$(this).show();\nif(opts.doSize==true){\n_270.panel.css("display","block");\n_218(this);\n}\nif(opts.closed==true||opts.minimized==true){\n_270.panel.hide();\n}else{\n_248(this);\n}\n});\n};\n$.fn.panel.methods={options:function(jq){\nreturn $.data(jq[0],"panel").options;\n},panel:function(jq){\nreturn $.data(jq[0],"panel").panel;\n},header:function(jq){\nreturn $.data(jq[0],"panel").panel.children(".panel-header");\n},footer:function(jq){\nreturn jq.panel("panel").children(".panel-footer");\n},body:function(jq){\nreturn $.data(jq[0],"panel").panel.children(".panel-body");\n},setTitle:function(jq,_271){\nreturn jq.each(function(){\n_269(this,_271);\n});\n},open:function(jq,_272){\nreturn jq.each(function(){\n_248(this,_272);\n});\n},close:function(jq,_273){\nreturn jq.each(function(){\n_24f(this,_273);\n});\n},destroy:function(jq,_274){\nreturn jq.each(function(){\n_254(this,_274);\n});\n},clear:function(jq,type){\nreturn jq.each(function(){\n_244(type=="footer"?$(this).panel("footer"):this);\n});\n},refresh:function(jq,href){\nreturn jq.each(function(){\nvar _275=$.data(this,"panel");\n_275.isLoaded=false;\nif(href){\nif(typeof href=="string"){\n_275.options.href=href;\n}else{\n_275.options.queryParams=href;\n}\n}\n_23e(this);\n});\n},resize:function(jq,_276){\nreturn jq.each(function(){\n_218(this,_276||{});\n});\n},doLayout:function(jq,all){\nreturn jq.each(function(){\n_277(this,"body");\n_277($(this).siblings(".panel-footer")[0],"footer");\nfunction _277(_278,type){\nif(!_278){\nreturn;\n}\nvar _279=_278==$("body")[0];\nvar s=$(_278).find("div.panel:visible,div.accordion:visible,div.tabs-container:visible,div.layout:visible,.easyui-fluid:visible").filter(function(_27a,el){\nvar p=$(el).parents(".panel-"+type+":first");\nreturn _279?p.length==0:p[0]==_278;\n});\ns.each(function(){\n$(this).triggerHandler("_resize",[all||false]);\n});\n};\n});\n},move:function(jq,_27b){\nreturn jq.each(function(){\n_229(this,_27b);\n});\n},maximize:function(jq){\nreturn jq.each(function(){\n_24d(this);\n});\n},minimize:function(jq){\nreturn jq.each(function(){\n_263(this);\n});\n},restore:function(jq){\nreturn jq.each(function(){\n_266(this);\n});\n},collapse:function(jq,_27c){\nreturn jq.each(function(){\n_24e(this,_27c);\n});\n},expand:function(jq,_27d){\nreturn jq.each(function(){\n_25d(this,_27d);\n});\n}};\n$.fn.panel.parseOptions=function(_27e){\nvar t=$(_27e);\nvar hh=t.children(".panel-header,header");\nvar ff=t.children(".panel-footer,footer");\nreturn $.extend({},$.parser.parseOptions(_27e,["id","width","height","left","top","title","iconCls","cls","headerCls","bodyCls","tools","href","method","header","footer","halign","titleDirection",{cache:"boolean",fit:"boolean",border:"boolean",noheader:"boolean"},{collapsible:"boolean",minimizable:"boolean",maximizable:"boolean"},{closable:"boolean",collapsed:"boolean",minimized:"boolean",maximized:"boolean",closed:"boolean"},"openAnimation","closeAnimation",{openDuration:"number",closeDuration:"number"},]),{loadingMessage:(t.attr("loadingMessage")!=undefined?t.attr("loadingMessage"):undefined),header:(hh.length?hh.removeClass("panel-header"):undefined),footer:(ff.length?ff.removeClass("panel-footer"):undefined)});\n};\n$.fn.panel.defaults={id:null,title:null,iconCls:null,width:"auto",height:"auto",left:null,top:null,cls:null,headerCls:null,bodyCls:null,style:{},href:null,cache:true,fit:false,border:true,doSize:true,noheader:false,content:null,halign:"top",titleDirection:"down",collapsible:false,minimizable:false,maximizable:false,closable:false,collapsed:false,minimized:false,maximized:false,closed:false,openAnimation:false,openDuration:400,closeAnimation:false,closeDuration:400,tools:null,footer:null,header:null,queryParams:{},method:"get",href:null,loadingMessage:"Loading...",loader:function(_27f,_280,_281){\nvar opts=$(this).panel("options");\nif(!opts.href){\nreturn false;\n}\n$.ajax({type:opts.method,url:opts.href,cache:false,data:_27f,dataType:"html",success:function(data){\n_280(data);\n},error:function(){\n_281.apply(this,arguments);\n}});\n},extractor:function(data){\nvar _282=/<body[^>]*>((.|[\\n\\r])*)<\\/body>/im;\nvar _283=_282.exec(data);\nif(_283){\nreturn _283[1];\n}else{\nreturn data;\n}\n},onBeforeLoad:function(_284){\n},onLoad:function(){\n},onLoadError:function(){\n},onBeforeOpen:function(){\n},onOpen:function(){\n},onBeforeClose:function(){\n},onClose:function(){\n},onBeforeDestroy:function(){\n},onDestroy:function(){\n},onResize:function(_285,_286){\n},onMove:function(left,top){\n},onMaximize:function(){\n},onRestore:function(){\n},onMinimize:function(){\n},onBeforeCollapse:function(){\n},onBeforeExpand:function(){\n},onCollapse:function(){\n},onExpand:function(){\n}};\n})(jQuery);\n(function($){\nfunction _287(_288,_289){\nvar _28a=$.data(_288,"window");\nif(_289){\nif(_289.left!=null){\n_28a.options.left=_289.left;\n}\nif(_289.top!=null){\n_28a.options.top=_289.top;\n}\n}\n$(_288).panel("move",_28a.options);\nif(_28a.shadow){\n_28a.shadow.css({left:_28a.options.left,top:_28a.options.top});\n}\n};\nfunction _28b(_28c,_28d){\nvar opts=$.data(_28c,"window").options;\nvar pp=$(_28c).window("panel");\nvar _28e=pp._outerWidth();\nif(opts.inline){\nvar _28f=pp.parent();\nopts.left=Math.ceil((_28f.width()-_28e)/2+_28f.scrollLeft());\n}else{\nvar _290=opts.fixed?0:$(document).scrollLeft();\nopts.left=Math.ceil(($(window)._outerWidth()-_28e)/2+_290);\n}\nif(_28d){\n_287(_28c);\n}\n};\nfunction _291(_292,_293){\nvar opts=$.data(_292,"window").options;\nvar pp=$(_292).window("panel");\nvar _294=pp._outerHeight();\nif(opts.inline){\nvar _295=pp.parent();\nopts.top=Math.ceil((_295.height()-_294)/2+_295.scrollTop());\n}else{\nvar _296=opts.fixed?0:$(document).scrollTop();\nopts.top=Math.ceil(($(window)._outerHeight()-_294)/2+_296);\n}\nif(_293){\n_287(_292);\n}\n};\nfunction _297(_298){\nvar _299=$.data(_298,"window");\nvar opts=_299.options;\nvar win=$(_298).panel($.extend({},_299.options,{border:false,hasResized:false,doSize:true,closed:true,cls:"window "+(!opts.border?"window-thinborder window-noborder ":(opts.border=="thin"?"window-thinborder ":""))+(opts.cls||""),headerCls:"window-header "+(opts.headerCls||""),bodyCls:"window-body "+(opts.noheader?"window-body-noheader ":" ")+(opts.bodyCls||""),onBeforeDestroy:function(){\nif(opts.onBeforeDestroy.call(_298)==false){\nreturn false;\n}\nif(_299.shadow){\n_299.shadow.remove();\n}\nif(_299.mask){\n_299.mask.remove();\n}\n},onClose:function(){\nif(_299.shadow){\n_299.shadow.hide();\n}\nif(_299.mask){\n_299.mask.hide();\n}\nopts.onClose.call(_298);\n},onOpen:function(){\nif(_299.mask){\n_299.mask.css($.extend({display:"block",zIndex:$.fn.window.defaults.zIndex++},$.fn.window.getMaskSize(_298)));\n}\nif(_299.shadow){\n_299.shadow.css({display:"block",position:(opts.fixed?"fixed":"absolute"),zIndex:$.fn.window.defaults.zIndex++,left:opts.left,top:opts.top,width:_299.window._outerWidth(),height:_299.window._outerHeight()});\n}\n_299.window.css({position:(opts.fixed?"fixed":"absolute"),zIndex:$.fn.window.defaults.zIndex++});\nopts.onOpen.call(_298);\n},onResize:function(_29a,_29b){\nvar _29c=$(this).panel("options");\n$.extend(opts,{width:_29c.width,height:_29c.height,left:_29c.left,top:_29c.top});\nif(_299.shadow){\n_299.shadow.css({left:opts.left,top:opts.top,width:_299.window._outerWidth(),height:_299.window._outerHeight()});\n}\nopts.onResize.call(_298,_29a,_29b);\n},onMinimize:function(){\nif(_299.shadow){\n_299.shadow.hide();\n}\nif(_299.mask){\n_299.mask.hide();\n}\n_299.options.onMinimize.call(_298);\n},onBeforeCollapse:function(){\nif(opts.onBeforeCollapse.call(_298)==false){\nreturn false;\n}\nif(_299.shadow){\n_299.shadow.hide();\n}\n},onExpand:function(){\nif(_299.shadow){\n_299.shadow.show();\n}\nopts.onExpand.call(_298);\n}}));\n_299.window=win.panel("panel");\nif(_299.mask){\n_299.mask.remove();\n}\nif(opts.modal){\n_299.mask=$("<div class=\\"window-mask\\" style=\\"display:none\\"></div>").insertAfter(_299.window);\n}\nif(_299.shadow){\n_299.shadow.remove();\n}\nif(opts.shadow){\n_299.shadow=$("<div class=\\"window-shadow\\" style=\\"display:none\\"></div>").insertAfter(_299.window);\n}\nvar _29d=opts.closed;\nif(opts.left==null){\n_28b(_298);\n}\nif(opts.top==null){\n_291(_298);\n}\n_287(_298);\nif(!_29d){\nwin.window("open");\n}\n};\nfunction _29e(left,top,_29f,_2a0){\nvar _2a1=this;\nvar _2a2=$.data(_2a1,"window");\nvar opts=_2a2.options;\nif(!opts.constrain){\nreturn {};\n}\nif($.isFunction(opts.constrain)){\nreturn opts.constrain.call(_2a1,left,top,_29f,_2a0);\n}\nvar win=$(_2a1).window("window");\nvar _2a3=opts.inline?win.parent():$(window);\nvar _2a4=opts.fixed?0:_2a3.scrollTop();\nif(left<0){\nleft=0;\n}\nif(top<_2a4){\ntop=_2a4;\n}\nif(left+_29f>_2a3.width()){\nif(_29f==win.outerWidth()){\nleft=_2a3.width()-_29f;\n}else{\n_29f=_2a3.width()-left;\n}\n}\nif(top-_2a4+_2a0>_2a3.height()){\nif(_2a0==win.outerHeight()){\ntop=_2a3.height()-_2a0+_2a4;\n}else{\n_2a0=_2a3.height()-top+_2a4;\n}\n}\nreturn {left:left,top:top,width:_29f,height:_2a0};\n};\nfunction _2a5(_2a6){\nvar _2a7=$.data(_2a6,"window");\nvar opts=_2a7.options;\n_2a7.window.draggable({handle:">.panel-header>.panel-title",disabled:_2a7.options.draggable==false,onBeforeDrag:function(e){\nif(_2a7.mask){\n_2a7.mask.css("z-index",$.fn.window.defaults.zIndex++);\n}\nif(_2a7.shadow){\n_2a7.shadow.css("z-index",$.fn.window.defaults.zIndex++);\n}\n_2a7.window.css("z-index",$.fn.window.defaults.zIndex++);\n},onStartDrag:function(e){\n_2a8(e);\n},onDrag:function(e){\n_2a9(e);\nreturn false;\n},onStopDrag:function(e){\n_2aa(e,"move");\n}});\n_2a7.window.resizable({disabled:_2a7.options.resizable==false,onStartResize:function(e){\n_2a8(e);\n},onResize:function(e){\n_2a9(e);\nreturn false;\n},onStopResize:function(e){\n_2aa(e,"resize");\n}});\nfunction _2a8(e){\n_2a7.window.css("position",opts.fixed?"fixed":"absolute");\nif(_2a7.shadow){\n_2a7.shadow.css("position",opts.fixed?"fixed":"absolute");\n}\nif(_2a7.pmask){\n_2a7.pmask.remove();\n}\n_2a7.pmask=$("<div class=\\"window-proxy-mask\\"></div>").insertAfter(_2a7.window);\n_2a7.pmask.css({display:"none",position:(opts.fixed?"fixed":"absolute"),zIndex:$.fn.window.defaults.zIndex++,left:e.data.left,top:e.data.top,width:_2a7.window._outerWidth(),height:_2a7.window._outerHeight()});\nif(_2a7.proxy){\n_2a7.proxy.remove();\n}\n_2a7.proxy=$("<div class=\\"window-proxy\\"></div>").insertAfter(_2a7.window);\n_2a7.proxy.css({display:"none",position:(opts.fixed?"fixed":"absolute"),zIndex:$.fn.window.defaults.zIndex++,left:e.data.left,top:e.data.top});\n_2a7.proxy._outerWidth(e.data.width)._outerHeight(e.data.height);\n_2a7.proxy.hide();\nsetTimeout(function(){\nif(_2a7.pmask){\n_2a7.pmask.show();\n}\nif(_2a7.proxy){\n_2a7.proxy.show();\n}\n},500);\n};\nfunction _2a9(e){\n$.extend(e.data,_29e.call(_2a6,e.data.left,e.data.top,e.data.width,e.data.height));\n_2a7.pmask.show();\n_2a7.proxy.css({display:"block",left:e.data.left,top:e.data.top});\n_2a7.proxy._outerWidth(e.data.width);\n_2a7.proxy._outerHeight(e.data.height);\n};\nfunction _2aa(e,_2ab){\n_2a7.window.css("position",opts.fixed?"fixed":"absolute");\nif(_2a7.shadow){\n_2a7.shadow.css("position",opts.fixed?"fixed":"absolute");\n}\n$.extend(e.data,_29e.call(_2a6,e.data.left,e.data.top,e.data.width+0.1,e.data.height+0.1));\n$(_2a6).window(_2ab,e.data);\n_2a7.pmask.remove();\n_2a7.pmask=null;\n_2a7.proxy.remove();\n_2a7.proxy=null;\n};\n};\n$(function(){\nif(!$._positionFixed){\n$(window).resize(function(){\n$("body>.window-mask:visible").css({width:"",height:""});\nsetTimeout(function(){\n$("body>.window-mask:visible").css($.fn.window.getMaskSize());\n},50);\n});\n}\n});\n$.fn.window=function(_2ac,_2ad){\nif(typeof _2ac=="string"){\nvar _2ae=$.fn.window.methods[_2ac];\nif(_2ae){\nreturn _2ae(this,_2ad);\n}else{\nreturn this.panel(_2ac,_2ad);\n}\n}\n_2ac=_2ac||{};\nreturn this.each(function(){\nvar _2af=$.data(this,"window");\nif(_2af){\n$.extend(_2af.options,_2ac);\n}else{\n_2af=$.data(this,"window",{options:$.extend({},$.fn.window.defaults,$.fn.window.parseOptions(this),_2ac)});\nif(!_2af.options.inline){\ndocument.body.appendChild(this);\n}\n}\n_297(this);\n_2a5(this);\n});\n};\n$.fn.window.methods={options:function(jq){\nvar _2b0=jq.panel("options");\nvar _2b1=$.data(jq[0],"window").options;\nreturn $.extend(_2b1,{closed:_2b0.closed,collapsed:_2b0.collapsed,minimized:_2b0.minimized,maximized:_2b0.maximized});\n},window:function(jq){\nreturn $.data(jq[0],"window").window;\n},move:function(jq,_2b2){\nreturn jq.each(function(){\n_287(this,_2b2);\n});\n},hcenter:function(jq){\nreturn jq.each(function(){\n_28b(this,true);\n});\n},vcenter:function(jq){\nreturn jq.each(function(){\n_291(this,true);\n});\n},center:function(jq){\nreturn jq.each(function(){\n_28b(this);\n_291(this);\n_287(this);\n});\n}};\n$.fn.window.getMaskSize=function(_2b3){\nvar _2b4=$(_2b3).data("window");\nif(_2b4&&_2b4.options.inline){\nreturn {};\n}else{\nif($._positionFixed){\nreturn {position:"fixed"};\n}else{\nreturn {width:$(document).width(),height:$(document).height()};\n}\n}\n};\n$.fn.window.parseOptions=function(_2b5){\nreturn $.extend({},$.fn.panel.parseOptions(_2b5),$.parser.parseOptions(_2b5,[{draggable:"boolean",resizable:"boolean",shadow:"boolean",modal:"boolean",inline:"boolean"}]));\n};\n$.fn.window.defaults=$.extend({},$.fn.panel.defaults,{zIndex:9000,draggable:true,resizable:true,shadow:true,modal:false,border:true,inline:false,title:"New Window",collapsible:true,minimizable:true,maximizable:true,closable:true,closed:false,fixed:false,constrain:false});\n})(jQuery);\n(function($){\nfunction _2b6(_2b7){\nvar opts=$.data(_2b7,"dialog").options;\nopts.inited=false;\n$(_2b7).window($.extend({},opts,{onResize:function(w,h){\nif(opts.inited){\n_2bc(this);\nopts.onResize.call(this,w,h);\n}\n}}));\nvar win=$(_2b7).window("window");\nif(opts.toolbar){\nif($.isArray(opts.toolbar)){\n$(_2b7).siblings("div.dialog-toolbar").remove();\nvar _2b8=$("<div class=\\"dialog-toolbar\\"><table cellspacing=\\"0\\" cellpadding=\\"0\\"><tr></tr></table></div>").appendTo(win);\nvar tr=_2b8.find("tr");\nfor(var i=0;i<opts.toolbar.length;i++){\nvar btn=opts.toolbar[i];\nif(btn=="-"){\n$("<td><div class=\\"dialog-tool-separator\\"></div></td>").appendTo(tr);\n}else{\nvar td=$("<td></td>").appendTo(tr);\nvar tool=$("<a href=\\"javascript:;\\"></a>").appendTo(td);\ntool[0].onclick=eval(btn.handler||function(){\n});\ntool.linkbutton($.extend({},btn,{plain:true}));\n}\n}\n}else{\n$(opts.toolbar).addClass("dialog-toolbar").appendTo(win);\n$(opts.toolbar).show();\n}\n}else{\n$(_2b7).siblings("div.dialog-toolbar").remove();\n}\nif(opts.buttons){\nif($.isArray(opts.buttons)){\n$(_2b7).siblings("div.dialog-button").remove();\nvar _2b9=$("<div class=\\"dialog-button\\"></div>").appendTo(win);\nfor(var i=0;i<opts.buttons.length;i++){\nvar p=opts.buttons[i];\nvar _2ba=$("<a href=\\"javascript:;\\"></a>").appendTo(_2b9);\nif(p.handler){\n_2ba[0].onclick=p.handler;\n}\n_2ba.linkbutton(p);\n}\n}else{\n$(opts.buttons).addClass("dialog-button").appendTo(win);\n$(opts.buttons).show();\n}\n}else{\n$(_2b7).siblings("div.dialog-button").remove();\n}\nopts.inited=true;\nvar _2bb=opts.closed;\nwin.show();\n$(_2b7).window("resize",{});\nif(_2bb){\nwin.hide();\n}\n};\nfunction _2bc(_2bd,_2be){\nvar t=$(_2bd);\nvar opts=t.dialog("options");\nvar _2bf=opts.noheader;\nvar tb=t.siblings(".dialog-toolbar");\nvar bb=t.siblings(".dialog-button");\ntb.insertBefore(_2bd).css({borderTopWidth:(_2bf?1:0),top:(_2bf?tb.length:0)});\nbb.insertAfter(_2bd);\ntb.add(bb)._outerWidth(t._outerWidth()).find(".easyui-fluid:visible").each(function(){\n$(this).triggerHandler("_resize");\n});\nvar _2c0=tb._outerHeight()+bb._outerHeight();\nif(!isNaN(parseInt(opts.height))){\nt._outerHeight(t._outerHeight()-_2c0);\n}else{\nvar _2c1=t._size("min-height");\nif(_2c1){\nt._size("min-height",_2c1-_2c0);\n}\nvar _2c2=t._size("max-height");\nif(_2c2){\nt._size("max-height",_2c2-_2c0);\n}\n}\nvar _2c3=$.data(_2bd,"window").shadow;\nif(_2c3){\nvar cc=t.panel("panel");\n_2c3.css({width:cc._outerWidth(),height:cc._outerHeight()});\n}\n};\n$.fn.dialog=function(_2c4,_2c5){\nif(typeof _2c4=="string"){\nvar _2c6=$.fn.dialog.methods[_2c4];\nif(_2c6){\nreturn _2c6(this,_2c5);\n}else{\nreturn this.window(_2c4,_2c5);\n}\n}\n_2c4=_2c4||{};\nreturn this.each(function(){\nvar _2c7=$.data(this,"dialog");\nif(_2c7){\n$.extend(_2c7.options,_2c4);\n}else{\n$.data(this,"dialog",{options:$.extend({},$.fn.dialog.defaults,$.fn.dialog.parseOptions(this),_2c4)});\n}\n_2b6(this);\n});\n};\n$.fn.dialog.methods={options:function(jq){\nvar _2c8=$.data(jq[0],"dialog").options;\nvar _2c9=jq.panel("options");\n$.extend(_2c8,{width:_2c9.width,height:_2c9.height,left:_2c9.left,top:_2c9.top,closed:_2c9.closed,collapsed:_2c9.collapsed,minimized:_2c9.minimized,maximized:_2c9.maximized});\nreturn _2c8;\n},dialog:function(jq){\nreturn jq.window("window");\n}};\n$.fn.dialog.parseOptions=function(_2ca){\nvar t=$(_2ca);\nreturn $.extend({},$.fn.window.parseOptions(_2ca),$.parser.parseOptions(_2ca,["toolbar","buttons"]),{toolbar:(t.children(".dialog-toolbar").length?t.children(".dialog-toolbar").removeClass("dialog-toolbar"):undefined),buttons:(t.children(".dialog-button").length?t.children(".dialog-button").removeClass("dialog-button"):undefined)});\n};\n$.fn.dialog.defaults=$.extend({},$.fn.window.defaults,{title:"New Dialog",collapsible:false,minimizable:false,maximizable:false,resizable:false,toolbar:null,buttons:null});\n})(jQuery);\n(function($){\nfunction _2cb(){\n$(document)._unbind(".messager")._bind("keydown.messager",function(e){\nif(e.keyCode==27){\n$("body").children("div.messager-window").children("div.messager-body").each(function(){\n$(this).dialog("close");\n});\n}else{\nif(e.keyCode==9){\nvar win=$("body").children("div.messager-window");\nif(!win.length){\nreturn;\n}\nvar _2cc=win.find(".messager-input,.messager-button .l-btn");\nfor(var i=0;i<_2cc.length;i++){\nif($(_2cc[i]).is(":focus")){\n$(_2cc[i>=_2cc.length-1?0:i+1]).focus();\nreturn false;\n}\n}\n}else{\nif(e.keyCode==13){\nvar _2cd=$(e.target).closest("input.messager-input");\nif(_2cd.length){\nvar dlg=_2cd.closest(".messager-body");\n_2ce(dlg,_2cd.val());\n}\n}\n}\n}\n});\n};\nfunction _2cf(){\n$(document)._unbind(".messager");\n};\nfunction _2d0(_2d1){\nvar opts=$.extend({},$.messager.defaults,{modal:false,shadow:false,draggable:false,resizable:false,closed:true,style:{left:"",top:"",right:0,zIndex:$.fn.window.defaults.zIndex++,bottom:-document.body.scrollTop-document.documentElement.scrollTop},title:"",width:300,height:150,minHeight:0,showType:"slide",showSpeed:600,content:_2d1.msg,timeout:4000},_2d1);\nvar dlg=$("<div class=\\"messager-body\\"></div>").appendTo("body");\ndlg.dialog($.extend({},opts,{noheader:(opts.title?false:true),openAnimation:(opts.showType),closeAnimation:(opts.showType=="show"?"hide":opts.showType),openDuration:opts.showSpeed,closeDuration:opts.showSpeed,onOpen:function(){\ndlg.dialog("dialog").hover(function(){\nif(opts.timer){\nclearTimeout(opts.timer);\n}\n},function(){\n_2d2();\n});\n_2d2();\nfunction _2d2(){\nif(opts.timeout>0){\nopts.timer=setTimeout(function(){\nif(dlg.length&&dlg.data("dialog")){\ndlg.dialog("close");\n}\n},opts.timeout);\n}\n};\nif(_2d1.onOpen){\n_2d1.onOpen.call(this);\n}else{\nopts.onOpen.call(this);\n}\n},onClose:function(){\nif(opts.timer){\nclearTimeout(opts.timer);\n}\nif(_2d1.onClose){\n_2d1.onClose.call(this);\n}else{\nopts.onClose.call(this);\n}\ndlg.dialog("destroy");\n}}));\ndlg.dialog("dialog").css(opts.style);\ndlg.dialog("open");\nreturn dlg;\n};\nfunction _2d3(_2d4){\n_2cb();\nvar dlg=$("<div class=\\"messager-body\\"></div>").appendTo("body");\ndlg.dialog($.extend({},_2d4,{noheader:(_2d4.title?false:true),onClose:function(){\n_2cf();\nif(_2d4.onClose){\n_2d4.onClose.call(this);\n}\ndlg.dialog("destroy");\n_2d5();\n}}));\nvar win=dlg.dialog("dialog").addClass("messager-window");\nwin.find(".dialog-button").addClass("messager-button").find("a:first").focus();\nreturn dlg;\n};\nfunction _2ce(dlg,_2d6){\nvar opts=dlg.dialog("options");\ndlg.dialog("close");\nopts.fn(_2d6);\n};\nfunction _2d5(){\nvar top=20+document.body.scrollTop+document.documentElement.scrollTop;\n$("body>.messager-tip").each(function(){\n$(this).animate({top:top},200);\ntop+=$(this)._outerHeight()+10;\n});\n};\n$.messager={show:function(_2d7){\nreturn _2d0(_2d7);\n},tip:function(msg){\nvar opts=typeof msg=="object"?msg:{msg:msg};\nif(opts.timeout==null){\nopts.timeout=2000;\n}\nvar top=0;\nvar _2d8=$("body>.messager-tip").last();\nif(_2d8.length){\ntop=parseInt(_2d8.css("top"))+_2d8._outerHeight();\n}\nvar cls=opts.icon?"messager-icon messager-"+opts.icon:"";\nopts=$.extend({},$.messager.defaults,{content:"<div class=\\""+cls+"\\"></div>"+"<div style=\\"white-space:nowrap\\">"+opts.msg+"</div>"+"<div style=\\"clear:both;\\"></div>",border:false,noheader:true,modal:false,title:null,width:"auto",height:"auto",minHeight:null,shadow:false,top:top,cls:"messager-tip",bodyCls:"f-row f-vcenter f-full"},opts);\nvar dlg=_2d3(opts);\nif(opts.timeout){\nsetTimeout(function(){\nif($(dlg).closest("body").length){\n$(dlg).dialog("close");\n}\n},opts.timeout);\n}\nsetTimeout(function(){\n_2d5();\n},0);\nreturn dlg;\n},alert:function(_2d9,msg,icon,fn){\nvar opts=typeof _2d9=="object"?_2d9:{title:_2d9,msg:msg,icon:icon,fn:fn};\nvar cls=opts.icon?"messager-icon messager-"+opts.icon:"";\nopts=$.extend({},$.messager.defaults,{content:"<div class=\\""+cls+"\\"></div>"+"<div>"+opts.msg+"</div>"+"<div style=\\"clear:both;\\"></div>"},opts);\nif(!opts.buttons){\nopts.buttons=[{text:opts.ok,onClick:function(){\n_2ce(dlg);\n}}];\n}\nvar dlg=_2d3(opts);\nreturn dlg;\n},confirm:function(_2da,msg,fn){\nvar opts=typeof _2da=="object"?_2da:{title:_2da,msg:msg,fn:fn};\nopts=$.extend({},$.messager.defaults,{content:"<div class=\\"messager-icon messager-question\\"></div>"+"<div>"+opts.msg+"</div>"+"<div style=\\"clear:both;\\"></div>"},opts);\nif(!opts.buttons){\nopts.buttons=[{text:opts.ok,onClick:function(){\n_2ce(dlg,true);\n}},{text:opts.cancel,onClick:function(){\n_2ce(dlg,false);\n}}];\n}\nvar dlg=_2d3(opts);\nreturn dlg;\n},prompt:function(_2db,msg,fn){\nvar opts=typeof _2db=="object"?_2db:{title:_2db,msg:msg,fn:fn};\nopts=$.extend({},$.messager.defaults,{content:"<div class=\\"messager-icon messager-question\\"></div>"+"<div>"+opts.msg+"</div>"+"<br>"+"<div style=\\"clear:both;\\"></div>"+"<div><input class=\\"messager-input\\" type=\\"text\\"></div>"},opts);\nif(!opts.buttons){\nopts.buttons=[{text:opts.ok,onClick:function(){\n_2ce(dlg,dlg.find(".messager-input").val());\n}},{text:opts.cancel,onClick:function(){\n_2ce(dlg);\n}}];\n}\nvar dlg=_2d3(opts);\ndlg.find(".messager-input").focus();\nreturn dlg;\n},progress:function(_2dc){\nvar _2dd={bar:function(){\nreturn $("body>div.messager-window").find("div.messager-p-bar");\n},close:function(){\nvar dlg=$("body>div.messager-window>div.messager-body:has(div.messager-progress)");\nif(dlg.length){\ndlg.dialog("close");\n}\n}};\nif(typeof _2dc=="string"){\nvar _2de=_2dd[_2dc];\nreturn _2de();\n}\n_2dc=_2dc||{};\nvar opts=$.extend({},{title:"",minHeight:0,content:undefined,msg:"",text:undefined,interval:300},_2dc);\nvar dlg=_2d3($.extend({},$.messager.defaults,{content:"<div class=\\"messager-progress\\"><div class=\\"messager-p-msg\\">"+opts.msg+"</div><div class=\\"messager-p-bar\\"></div></div>",closable:false,doSize:false},opts,{onClose:function(){\nif(this.timer){\nclearInterval(this.timer);\n}\nif(_2dc.onClose){\n_2dc.onClose.call(this);\n}else{\n$.messager.defaults.onClose.call(this);\n}\n}}));\nvar bar=dlg.find("div.messager-p-bar");\nbar.progressbar({text:opts.text});\ndlg.dialog("resize");\nif(opts.interval){\ndlg[0].timer=setInterval(function(){\nvar v=bar.progressbar("getValue");\nv+=10;\nif(v>100){\nv=0;\n}\nbar.progressbar("setValue",v);\n},opts.interval);\n}\nreturn dlg;\n}};\n$.messager.defaults=$.extend({},$.fn.dialog.defaults,{ok:"Ok",cancel:"Cancel",width:300,height:"auto",minHeight:150,modal:true,collapsible:false,minimizable:false,maximizable:false,resizable:false,fn:function(){\n}});\n})(jQuery);\n(function($){\nfunction _2df(_2e0){\nvar opts=$.data(_2e0,"drawer").options;\n$(_2e0).dialog($.extend({},opts,{cls:"drawer f-column window-shadow layout-panel layout-collapsed layout-panel-"+opts.region,bodyCls:"f-full",collapsed:false,top:0,left:"auto",right:"auto",onResize:function(w,h){\nif(opts.collapsed){\nvar _2e1=$(_2e0).dialog("dialog").width();\n$(_2e0).dialog("dialog").css({display:"",left:opts.region=="east"?"auto":-_2e1,right:opts.region=="east"?-_2e1:"auto"});\n}\nopts.onResize.call(this,w,h);\n}}));\n$(_2e0).dialog("header").find(".panel-tool-collapse").addClass("layout-button-"+(opts.region=="east"?"right":"left"))._unbind()._bind("click",function(){\n_2e3(_2e0);\n});\nvar _2e2=$(_2e0).dialog("dialog").width();\n$(_2e0).dialog("dialog").css({display:"",left:opts.region=="east"?"auto":-_2e2,right:opts.region=="east"?-_2e2:"auto"});\nvar mask=$(_2e0).data("window").mask;\n$(mask).addClass("drawer-mask").hide()._unbind()._bind("click",function(){\n_2e3(_2e0);\n});\n};\nfunction _2e4(_2e5){\nvar opts=$.data(_2e5,"drawer").options;\nif(opts.onBeforeExpand.call(_2e5)==false){\nreturn;\n}\nvar _2e6=$(_2e5).dialog("dialog").width();\nvar mask=$(_2e5).data("window").mask;\n$(mask).show();\n$(_2e5).show().css({display:""}).dialog("dialog").animate({left:opts.region=="east"?"auto":0,right:opts.region=="east"?0:"auto"},function(){\n$(this).removeClass("layout-collapsed");\nopts.collapsed=false;\nopts.onExpand.call(_2e5);\n});\n};\nfunction _2e3(_2e7){\nvar opts=$.data(_2e7,"drawer").options;\nif(opts.onBeforeCollapse.call(_2e7)==false){\nreturn;\n}\nvar _2e8=$(_2e7).dialog("dialog").width();\n$(_2e7).show().css({display:""}).dialog("dialog").animate({left:opts.region=="east"?"auto":-_2e8,right:opts.region=="east"?-_2e8:"auto"},function(){\n$(this).addClass("layout-collapsed");\nvar mask=$(_2e7).data("window").mask;\n$(mask).hide();\nopts.collapsed=true;\nopts.onCollapse.call(this);\n});\n};\n$.fn.drawer=function(_2e9,_2ea){\nif(typeof _2e9=="string"){\nvar _2eb=$.fn.drawer.methods[_2e9];\nif(_2eb){\nreturn _2eb(this,_2ea);\n}else{\nreturn this.dialog(_2e9,_2ea);\n}\n}\n_2e9=_2e9||{};\nthis.each(function(){\nvar _2ec=$.data(this,"drawer");\nif(_2ec){\n$.extend(_2ec.options,_2e9);\n}else{\nvar opts=$.extend({},$.fn.drawer.defaults,$.fn.drawer.parseOptions(this),_2e9);\n$.data(this,"drawer",{options:opts});\n}\n_2df(this);\n});\n};\n$.fn.drawer.methods={options:function(jq){\nvar opts=$.data(jq[0],"drawer").options;\nreturn $.extend(jq.dialog("options"),{region:opts.region,collapsed:opts.collapsed});\n},expand:function(jq){\nreturn jq.each(function(){\n_2e4(this);\n});\n},collapse:function(jq){\nreturn jq.each(function(){\n_2e3(this);\n});\n}};\n$.fn.drawer.parseOptions=function(_2ed){\nreturn $.extend({},$.fn.dialog.parseOptions(_2ed),$.parser.parseOptions(_2ed,["region"]));\n};\n$.fn.drawer.defaults=$.extend({},$.fn.dialog.defaults,{border:false,region:"east",title:null,shadow:false,fixed:true,collapsed:true,closable:false,modal:true,draggable:false});\n})(jQuery);\n(function($){\nfunction init(_2ee){\nvar _2ef=$.data(_2ee,"swiper");\nvar opts=_2ef.options;\n$(_2ee).addClass("swiper").wrapInner("<div class=\\"swiper-inner\\"></div>");\nvar _2f0=$(_2ee).find(".swiper-inner");\nvar dots=$("<div class=\\"swiper-dots\\"></div>").appendTo(_2ee);\n_2f0.off("transitionend.swiper").on("transitionend.swiper",function(){\n_2f9(_2ee);\n});\ndots.off("click.swiper").on("click.swiper",".swiper-dot",function(){\nvar _2f1=$(this).index(".swiper-dot");\nopts.selected=_2f1;\n_2f0.children("div").each(function(_2f2){\n$(this).css("transform","translate("+(_2f2*100)+"%,0px) translateZ(0px)");\n});\n_2f0.css({transform:"translate("+(-_2f1*100)+"%,0px) translateZ(0px)"});\nopts.onChange.call(_2ee,opts.selected);\n});\n$(_2ee)._bind("_resize",function(e,_2f3){\nif($(this).hasClass("easyui-fluid")||_2f3){\n_2f4(_2ee);\n}\nreturn false;\n});\n};\nfunction _2f5(_2f6){\nvar _2f7=$.data(_2f6,"swiper");\nvar opts=_2f7.options;\nvar _2f8=$(_2f6).children(".swiper-inner").children("div").length;\nvar dots=$(_2f6).children(".swiper-dots");\ndots.empty();\nif(opts.indicator){\nfor(var i=0;i<_2f8;i++){\n$("<div class=\\"swiper-dot\\"></div>").appendTo(dots);\n}\n}\n_2f9(_2f6);\nif(opts.autoplay){\n_2f7.timer=setInterval(function(){\nnav(_2f6,1);\n},opts.interval);\n}else{\nclearInterval(_2f7.timer);\n}\n};\nfunction _2f4(_2fa,_2fb){\nvar opts=$.data(_2fa,"swiper").options;\nvar t=$(_2fa);\nif(_2fb){\n$.extend(opts,{width:_2fb.width,height:_2fb.height});\n}\nt._size(opts,t.parent());\n};\nfunction _2f9(_2fc){\nvar opts=$(_2fc).swiper("options");\nvar _2fd=$(_2fc).find(".swiper-inner").children("div").length;\nvar _2fe=$(_2fc).find(".swiper-inner");\n_2fe.css({transform:"translate("+(-opts.selected*100)+"%,0px) translateZ(0px)",transitionDuration:"0s"});\n_2fe.children("div").each(function(_2ff){\nvar val=_2ff*100+"%";\nvar tcss="translate("+val+",0px) translateZ(0px)";\nif(opts.selected==0&&_2ff==_2fd-1){\ntcss="translate(-100%,0px) translateZ(0px)";\n}else{\nif(opts.selected==_2fd-1&&_2ff==0){\ntcss="translate("+(_2fd*100)+"%,0px) translateZ(0px)";\n}\n}\n$(this).css({position:"absolute",width:"100%",height:"100%",transform:tcss,willChange:"transform"});\n});\n_2fe.css({transitionDuration:opts.duration/1000+"s"});\nvar dots=$(_2fc).find(".swiper-dots");\ndots.find(".swiper-dot").removeClass("swiper-dot-active");\ndots.find(".swiper-dot:nth-child("+(opts.selected+1)+")").addClass("swiper-dot-active");\n};\nfunction nav(_300,step){\nvar opts=$(_300).swiper("options");\nvar _301=$(_300).find(".swiper-inner").children("div").length;\nvar curr=opts.selected+step;\nvar val=-curr*100+"%";\nif(curr<0){\ncurr=_301-1;\n}else{\nif(curr>=_301){\ncurr=0;\n}\n}\nopts.selected=curr;\nvar _302=$(_300).find(".swiper-inner");\n_302.css({transform:"translate("+val+",0px) translateZ(0px)"});\nopts.onChange.call(_300,opts.selected);\n};\n$.fn.swiper=function(_303,_304){\nif(typeof _303=="string"){\nreturn $.fn.swiper.methods[_303](this,_304);\n}\n_303=_303||{};\nreturn this.each(function(){\nvar _305=$.data(this,"swiper");\nif(_305){\n$.extend(_305.options,_303);\n}else{\n_305=$.data(this,"swiper",{options:$.extend({},$.fn.swiper.defaults,$.fn.swiper.parseOptions(this),_303)});\ninit(this);\n}\n_2f5(this);\n_2f4(this);\n});\n};\n$.fn.swiper.methods={options:function(jq){\nreturn $.data(jq[0],"swiper").options;\n},resize:function(jq,_306){\nreturn jq.each(function(){\n_2f4(this,_306);\n});\n},navNext:function(jq){\nreturn jq.each(function(){\nnav(this,1);\n});\n},navPrev:function(jq){\nreturn jq.each(function(){\nnav(this,-1);\n});\n}};\n$.fn.swiper.parseOptions=function(_307){\nvar t=$(_307);\nreturn $.extend({},$.parser.parseOptions(_307,[{selected:"number",duration:"number",interval:"number"},{autoplay:"boolean",indicator:"boolean"}]));\n};\n$.fn.swiper.defaults={width:"auto",height:200,selected:0,duration:400,interval:2000,autoplay:false,indicator:true,onChange:function(_308){\n}};\n})(jQuery);\n(function($){\nfunction init(_309){\nvar opts=$.data(_309,"timeline").options;\n$(_309).addClass("timeline-container");\n$(_309).off(".timeline").on("click.timeline",".timeline-item",function(){\nvar _30a=$(this).index(".timeline-item");\nopts.onClick.call(_309,opts.data[_30a]);\n});\n$(_309)._bind("_resize",function(e,_30b){\nif($(this).hasClass("easyui-fluid")||_30b){\n_30c(_309);\n}\nreturn false;\n});\n};\nfunction _30c(_30d,_30e){\nvar opts=$.data(_30d,"timeline").options;\nvar t=$(_30d);\nif(_30e){\n$.extend(opts,{width:_30e.width,height:_30e.height});\n}\nt._size(opts,t.parent());\n};\nfunction _30f(_310,data){\nvar opts=$(_310).timeline("options");\nopts.data=data;\n$(_310).empty();\nvar ul=$("<ul class=\\"timeline\\"></ul").appendTo(_310);\nfor(var i=0;i<opts.data.length;i++){\nvar row=opts.data[i];\nvar li=$("<li class=\\"timeline-item\\"></li>").appendTo(ul);\nvar line=$("<div class=\\"timeline-item-line\\"></div>").appendTo(li);\nvar dot=$("<div class=\\"timeline-item-dot\\"></div>").appendTo(li);\nvar _311=opts.dotFormatter.call(_310,row);\nif(_311){\ndot.addClass("timeline-item-dot-custom").html(_311);\n}\nvar _312=opts.dotStyler.call(_310,row);\nif(_312){\ndot.css(_312);\n}\nvar _313=$("<div class=\\"timeline-item-content\\"></div>").appendTo(li);\nvar _314=opts.formatter.call(_310,row);\n_313.html(_314);\n}\n};\n$.fn.timeline=function(_315,_316){\nif(typeof _315=="string"){\nreturn $.fn.timeline.methods[_315](this,_316);\n}\n_315=_315||{};\nreturn this.each(function(){\nvar _317=$.data(this,"timeline");\nif(_317){\n$.extend(_317.options,_315);\n}else{\n_317=$.data(this,"timeline",{options:$.extend({},$.fn.timeline.defaults,$.fn.timeline.parseOptions(this),_315)});\ninit(this);\n}\n_30c(this);\n_30f(this,_317.options.data);\n});\n};\n$.fn.timeline.methods={options:function(jq){\nreturn $.data(jq[0],"timeline").options;\n},loadData:function(jq,data){\nreturn jq.each(function(){\n_30f(this,data);\n});\n}};\n$.fn.timeline.parseOptions=function(_318){\nvar t=$(_318);\nreturn $.extend({},$.parser.parseOptions(_318,[]));\n};\n$.fn.timeline.defaults={width:"auto",height:"auto",data:[],dotStyler:function(row){\nreturn "";\n},dotFormatter:function(row){\nreturn null;\n},formatter:function(row){\nreturn row["content"];\n},onClick:function(row){\n}};\n})(jQuery);\n(function($){\nfunction _319(_31a,_31b){\nvar _31c=$.data(_31a,"accordion");\nvar opts=_31c.options;\nvar _31d=_31c.panels;\nvar cc=$(_31a);\nvar _31e=(opts.halign=="left"||opts.halign=="right");\ncc.children(".panel-last").removeClass("panel-last");\ncc.children(".panel:last").addClass("panel-last");\nif(_31b){\n$.extend(opts,{width:_31b.width,height:_31b.height});\n}\ncc._size(opts);\nvar _31f=0;\nvar _320="auto";\nvar _321=cc.find(">.panel>.accordion-header");\nif(_321.length){\nif(_31e){\n$(_321[0]).next().panel("resize",{width:cc.width(),height:cc.height()});\n_31f=$(_321[0])._outerWidth();\n}else{\n_31f=$(_321[0]).css("height","")._outerHeight();\n}\n}\nif(!isNaN(parseInt(opts.height))){\nif(_31e){\n_320=cc.width()-_31f*_321.length;\n}else{\n_320=cc.height()-_31f*_321.length;\n}\n}\n_322(true,_320-_322(false));\nfunction _322(_323,_324){\nvar _325=0;\nfor(var i=0;i<_31d.length;i++){\nvar p=_31d[i];\nif(_31e){\nvar h=p.panel("header")._outerWidth(_31f);\n}else{\nvar h=p.panel("header")._outerHeight(_31f);\n}\nif(p.panel("options").collapsible==_323){\nvar _326=isNaN(_324)?undefined:(_324+_31f*h.length);\nif(_31e){\np.panel("resize",{height:cc.height(),width:(_323?_326:undefined)});\n_325+=p.panel("panel")._outerWidth()-_31f*h.length;\n}else{\np.panel("resize",{width:cc.width(),height:(_323?_326:undefined)});\n_325+=p.panel("panel").outerHeight()-_31f*h.length;\n}\n}\n}\nreturn _325;\n};\n};\nfunction _327(_328,_329,_32a,all){\nvar _32b=$.data(_328,"accordion").panels;\nvar pp=[];\nfor(var i=0;i<_32b.length;i++){\nvar p=_32b[i];\nif(_329){\nif(p.panel("options")[_329]==_32a){\npp.push(p);\n}\n}else{\nif(p[0]==$(_32a)[0]){\nreturn i;\n}\n}\n}\nif(_329){\nreturn all?pp:(pp.length?pp[0]:null);\n}else{\nreturn -1;\n}\n};\nfunction _32c(_32d){\nreturn _327(_32d,"collapsed",false,true);\n};\nfunction _32e(_32f){\nvar pp=_32c(_32f);\nreturn pp.length?pp[0]:null;\n};\nfunction _330(_331,_332){\nreturn _327(_331,null,_332);\n};\nfunction _333(_334,_335){\nvar _336=$.data(_334,"accordion").panels;\nif(typeof _335=="number"){\nif(_335<0||_335>=_336.length){\nreturn null;\n}else{\nreturn _336[_335];\n}\n}\nreturn _327(_334,"title",_335);\n};\nfunction _337(_338){\nvar opts=$.data(_338,"accordion").options;\nvar cc=$(_338);\nif(opts.border){\ncc.removeClass("accordion-noborder");\n}else{\ncc.addClass("accordion-noborder");\n}\n};\nfunction init(_339){\nvar _33a=$.data(_339,"accordion");\nvar cc=$(_339);\ncc.addClass("accordion");\n_33a.panels=[];\ncc.children("div").each(function(){\nvar opts=$.extend({},$.parser.parseOptions(this),{selected:($(this).attr("selected")?true:undefined)});\nvar pp=$(this);\n_33a.panels.push(pp);\n_33c(_339,pp,opts);\n});\ncc._bind("_resize",function(e,_33b){\nif($(this).hasClass("easyui-fluid")||_33b){\n_319(_339);\n}\nreturn false;\n});\n};\nfunction _33c(_33d,pp,_33e){\nvar opts=$.data(_33d,"accordion").options;\npp.panel($.extend({},{collapsible:true,minimizable:false,maximizable:false,closable:false,doSize:false,collapsed:true,headerCls:"accordion-header",bodyCls:"accordion-body",halign:opts.halign},_33e,{onBeforeExpand:function(){\nif(_33e.onBeforeExpand){\nif(_33e.onBeforeExpand.call(this)==false){\nreturn false;\n}\n}\nif(!opts.multiple){\nvar all=$.grep(_32c(_33d),function(p){\nreturn p.panel("options").collapsible;\n});\nfor(var i=0;i<all.length;i++){\n_346(_33d,_330(_33d,all[i]));\n}\n}\nvar _33f=$(this).panel("header");\n_33f.addClass("accordion-header-selected");\n_33f.find(".accordion-collapse").removeClass("accordion-expand");\n},onExpand:function(){\n$(_33d).find(">.panel-last>.accordion-header").removeClass("accordion-header-border");\nif(_33e.onExpand){\n_33e.onExpand.call(this);\n}\nopts.onSelect.call(_33d,$(this).panel("options").title,_330(_33d,this));\n},onBeforeCollapse:function(){\nif(_33e.onBeforeCollapse){\nif(_33e.onBeforeCollapse.call(this)==false){\nreturn false;\n}\n}\n$(_33d).find(">.panel-last>.accordion-header").addClass("accordion-header-border");\nvar _340=$(this).panel("header");\n_340.removeClass("accordion-header-selected");\n_340.find(".accordion-collapse").addClass("accordion-expand");\n},onCollapse:function(){\nif(isNaN(parseInt(opts.height))){\n$(_33d).find(">.panel-last>.accordion-header").removeClass("accordion-header-border");\n}\nif(_33e.onCollapse){\n_33e.onCollapse.call(this);\n}\nopts.onUnselect.call(_33d,$(this).panel("options").title,_330(_33d,this));\n}}));\nvar _341=pp.panel("header");\nvar tool=_341.children("div.panel-tool");\ntool.children("a.panel-tool-collapse").hide();\nvar t=$("<a href=\\"javascript:;\\"></a>").addClass("accordion-collapse accordion-expand").appendTo(tool);\nt._bind("click",function(){\n_342(pp);\nreturn false;\n});\npp.panel("options").collapsible?t.show():t.hide();\nif(opts.halign=="left"||opts.halign=="right"){\nt.hide();\n}\n_341._bind("click",function(){\n_342(pp);\nreturn false;\n});\nfunction _342(p){\nvar _343=p.panel("options");\nif(_343.collapsible){\nvar _344=_330(_33d,p);\nif(_343.collapsed){\n_345(_33d,_344);\n}else{\n_346(_33d,_344);\n}\n}\n};\n};\nfunction _345(_347,_348){\nvar p=_333(_347,_348);\nif(!p){\nreturn;\n}\n_349(_347);\nvar opts=$.data(_347,"accordion").options;\np.panel("expand",opts.animate);\n};\nfunction _346(_34a,_34b){\nvar p=_333(_34a,_34b);\nif(!p){\nreturn;\n}\n_349(_34a);\nvar opts=$.data(_34a,"accordion").options;\np.panel("collapse",opts.animate);\n};\nfunction _34c(_34d){\nvar opts=$.data(_34d,"accordion").options;\n$(_34d).find(">.panel-last>.accordion-header").addClass("accordion-header-border");\nvar p=_327(_34d,"selected",true);\nif(p){\n_34e(_330(_34d,p));\n}else{\n_34e(opts.selected);\n}\nfunction _34e(_34f){\nvar _350=opts.animate;\nopts.animate=false;\n_345(_34d,_34f);\nopts.animate=_350;\n};\n};\nfunction _349(_351){\nvar _352=$.data(_351,"accordion").panels;\nfor(var i=0;i<_352.length;i++){\n_352[i].stop(true,true);\n}\n};\nfunction add(_353,_354){\nvar _355=$.data(_353,"accordion");\nvar opts=_355.options;\nvar _356=_355.panels;\nif(_354.selected==undefined){\n_354.selected=true;\n}\n_349(_353);\nvar pp=$("<div></div>").appendTo(_353);\n_356.push(pp);\n_33c(_353,pp,_354);\n_319(_353);\nopts.onAdd.call(_353,_354.title,_356.length-1);\nif(_354.selected){\n_345(_353,_356.length-1);\n}\n};\nfunction _357(_358,_359){\nvar _35a=$.data(_358,"accordion");\nvar opts=_35a.options;\nvar _35b=_35a.panels;\n_349(_358);\nvar _35c=_333(_358,_359);\nvar _35d=_35c.panel("options").title;\nvar _35e=_330(_358,_35c);\nif(!_35c){\nreturn;\n}\nif(opts.onBeforeRemove.call(_358,_35d,_35e)==false){\nreturn;\n}\n_35b.splice(_35e,1);\n_35c.panel("destroy");\nif(_35b.length){\n_319(_358);\nvar curr=_32e(_358);\nif(!curr){\n_345(_358,0);\n}\n}\nopts.onRemove.call(_358,_35d,_35e);\n};\n$.fn.accordion=function(_35f,_360){\nif(typeof _35f=="string"){\nreturn $.fn.accordion.methods[_35f](this,_360);\n}\n_35f=_35f||{};\nreturn this.each(function(){\nvar _361=$.data(this,"accordion");\nif(_361){\n$.extend(_361.options,_35f);\n}else{\n$.data(this,"accordion",{options:$.extend({},$.fn.accordion.defaults,$.fn.accordion.parseOptions(this),_35f),accordion:$(this).addClass("accordion"),panels:[]});\ninit(this);\n}\n_337(this);\n_319(this);\n_34c(this);\n});\n};\n$.fn.accordion.methods={options:function(jq){\nreturn $.data(jq[0],"accordion").options;\n},panels:function(jq){\nreturn $.data(jq[0],"accordion").panels;\n},resize:function(jq,_362){\nreturn jq.each(function(){\n_319(this,_362);\n});\n},getSelections:function(jq){\nreturn _32c(jq[0]);\n},getSelected:function(jq){\nreturn _32e(jq[0]);\n},getPanel:function(jq,_363){\nreturn _333(jq[0],_363);\n},getPanelIndex:function(jq,_364){\nreturn _330(jq[0],_364);\n},select:function(jq,_365){\nreturn jq.each(function(){\n_345(this,_365);\n});\n},unselect:function(jq,_366){\nreturn jq.each(function(){\n_346(this,_366);\n});\n},add:function(jq,_367){\nreturn jq.each(function(){\nadd(this,_367);\n});\n},remove:function(jq,_368){\nreturn jq.each(function(){\n_357(this,_368);\n});\n}};\n$.fn.accordion.parseOptions=function(_369){\nvar t=$(_369);\nreturn $.extend({},$.parser.parseOptions(_369,["width","height","halign",{fit:"boolean",border:"boolean",animate:"boolean",multiple:"boolean",selected:"number"}]));\n};\n$.fn.accordion.defaults={width:"auto",height:"auto",fit:false,border:true,animate:true,multiple:false,selected:0,halign:"top",onSelect:function(_36a,_36b){\n},onUnselect:function(_36c,_36d){\n},onAdd:function(_36e,_36f){\n},onBeforeRemove:function(_370,_371){\n},onRemove:function(_372,_373){\n}};\n})(jQuery);\n(function($){\nfunction _374(c){\nvar w=0;\n$(c).children().each(function(){\nw+=$(this).outerWidth(true);\n});\nreturn w;\n};\nfunction _375(_376){\nvar opts=$.data(_376,"tabs").options;\nif(!opts.showHeader){\nreturn;\n}\nvar _377=$(_376).children("div.tabs-header");\nvar tool=_377.children("div.tabs-tool:not(.tabs-tool-hidden)");\nvar _378=_377.children("div.tabs-scroller-left");\nvar _379=_377.children("div.tabs-scroller-right");\nvar wrap=_377.children("div.tabs-wrap");\nif(opts.tabPosition=="left"||opts.tabPosition=="right"){\nif(!tool.length){\nreturn;\n}\ntool._outerWidth(_377.width());\nvar _37a={left:opts.tabPosition=="left"?"auto":0,right:opts.tabPosition=="left"?0:"auto",top:opts.toolPosition=="top"?0:"auto",bottom:opts.toolPosition=="top"?"auto":0};\nvar _37b={marginTop:opts.toolPosition=="top"?tool.outerHeight():0};\ntool.css(_37a);\nwrap.css(_37b);\nreturn;\n}\nvar _37c=_377.outerHeight();\nif(opts.plain){\n_37c-=_37c-_377.height();\n}\ntool._outerHeight(_37c);\nvar _37d=_374(_377.find("ul.tabs"));\nvar _37e=_377.width()-tool._outerWidth();\nif(_37d>_37e){\n_378.add(_379).show()._outerHeight(_37c);\nif(opts.toolPosition=="left"){\ntool.css({left:_378.outerWidth(),right:""});\nwrap.css({marginLeft:_378.outerWidth()+tool._outerWidth(),marginRight:_379._outerWidth(),width:_37e-_378.outerWidth()-_379.outerWidth()});\n}else{\ntool.css({left:"",right:_379.outerWidth()});\nwrap.css({marginLeft:_378.outerWidth(),marginRight:_379.outerWidth()+tool._outerWidth(),width:_37e-_378.outerWidth()-_379.outerWidth()});\n}\n}else{\n_378.add(_379).hide();\nif(opts.toolPosition=="left"){\ntool.css({left:0,right:""});\nwrap.css({marginLeft:tool._outerWidth(),marginRight:0,width:_37e});\n}else{\ntool.css({left:"",right:0});\nwrap.css({marginLeft:0,marginRight:tool._outerWidth(),width:_37e});\n}\n}\n};\nfunction _37f(_380){\nvar opts=$.data(_380,"tabs").options;\nvar _381=$(_380).children("div.tabs-header");\nif(opts.tools){\nif(typeof opts.tools=="string"){\n$(opts.tools).addClass("tabs-tool").appendTo(_381);\n$(opts.tools).show();\n}else{\n_381.children("div.tabs-tool").remove();\nvar _382=$("<div class=\\"tabs-tool\\"><table cellspacing=\\"0\\" cellpadding=\\"0\\" style=\\"height:100%\\"><tr></tr></table></div>").appendTo(_381);\nvar tr=_382.find("tr");\nfor(var i=0;i<opts.tools.length;i++){\nvar td=$("<td></td>").appendTo(tr);\nvar tool=$("<a href=\\"javascript:;\\"></a>").appendTo(td);\ntool[0].onclick=eval(opts.tools[i].handler||function(){\n});\ntool.linkbutton($.extend({},opts.tools[i],{plain:true}));\n}\n}\n}else{\n_381.children("div.tabs-tool").remove();\n}\n};\nfunction _383(_384,_385){\nvar _386=$.data(_384,"tabs");\nvar opts=_386.options;\nvar cc=$(_384);\nif(!opts.doSize){\nreturn;\n}\nif(_385){\n$.extend(opts,{width:_385.width,height:_385.height});\n}\ncc._size(opts);\nvar _387=cc.children("div.tabs-header");\nvar _388=cc.children("div.tabs-panels");\nvar wrap=_387.find("div.tabs-wrap");\nvar ul=wrap.find(".tabs");\nul.children("li").removeClass("tabs-first tabs-last");\nul.children("li:first").addClass("tabs-first");\nul.children("li:last").addClass("tabs-last");\nif(opts.tabPosition=="left"||opts.tabPosition=="right"){\n_387._outerWidth(opts.showHeader?opts.headerWidth:0);\n_388._outerWidth(cc.width()-_387.outerWidth());\n_387.add(_388)._size("height",isNaN(parseInt(opts.height))?"":cc.height());\nwrap._outerWidth(_387.width());\nul._outerWidth(wrap.width()).css("height","");\n}else{\n_387.children("div.tabs-scroller-left,div.tabs-scroller-right,div.tabs-tool:not(.tabs-tool-hidden)").css("display",opts.showHeader?"block":"none");\n_387._outerWidth(cc.width()).css("height","");\nif(opts.showHeader){\n_387.css("background-color","");\nwrap.css("height","");\n}else{\n_387.css("background-color","transparent");\n_387._outerHeight(0);\nwrap._outerHeight(0);\n}\nul._outerHeight(opts.tabHeight).css("width","");\nul._outerHeight(ul.outerHeight()-ul.height()-1+opts.tabHeight).css("width","");\n_388._size("height",isNaN(parseInt(opts.height))?"":(cc.height()-_387.outerHeight()));\n_388._size("width",cc.width());\n}\nif(_386.tabs.length){\nvar d1=ul.outerWidth(true)-ul.width();\nvar li=ul.children("li:first");\nvar d2=li.outerWidth(true)-li.width();\nvar _389=_387.width()-_387.children(".tabs-tool:not(.tabs-tool-hidden)")._outerWidth();\nvar _38a=Math.floor((_389-d1-d2*_386.tabs.length)/_386.tabs.length);\n$.map(_386.tabs,function(p){\n_38b(p,(opts.justified&&$.inArray(opts.tabPosition,["top","bottom"])>=0)?_38a:undefined);\n});\nif(opts.justified&&$.inArray(opts.tabPosition,["top","bottom"])>=0){\nvar _38c=_389-d1-_374(ul);\n_38b(_386.tabs[_386.tabs.length-1],_38a+_38c);\n}\n}\n_375(_384);\nfunction _38b(p,_38d){\nvar _38e=p.panel("options");\nvar p_t=_38e.tab.find(".tabs-inner");\nvar _38d=_38d?_38d:(parseInt(_38e.tabWidth||opts.tabWidth||undefined));\nif(_38d){\np_t._outerWidth(_38d);\n}else{\np_t.css("width","");\n}\np_t._outerHeight(opts.tabHeight);\np_t.css("lineHeight",p_t.height()+"px");\np_t.find(".easyui-fluid:visible").triggerHandler("_resize");\n};\n};\nfunction _38f(_390){\nvar opts=$.data(_390,"tabs").options;\nvar tab=_391(_390);\nif(tab){\nvar _392=$(_390).children("div.tabs-panels");\nvar _393=opts.width=="auto"?"auto":_392.width();\nvar _394=opts.height=="auto"?"auto":_392.height();\ntab.panel("resize",{width:_393,height:_394});\n}\n};\nfunction _395(_396){\nvar tabs=$.data(_396,"tabs").tabs;\nvar cc=$(_396).addClass("tabs-container");\nvar _397=$("<div class=\\"tabs-panels\\"></div>").insertBefore(cc);\ncc.children("div").each(function(){\n_397[0].appendChild(this);\n});\ncc[0].appendChild(_397[0]);\n$("<div class=\\"tabs-header\\">"+"<div class=\\"tabs-scroller-left\\"></div>"+"<div class=\\"tabs-scroller-right\\"></div>"+"<div class=\\"tabs-wrap\\">"+"<ul class=\\"tabs\\"></ul>"+"</div>"+"</div>").prependTo(_396);\ncc.children("div.tabs-panels").children("div").each(function(i){\nvar opts=$.extend({},$.parser.parseOptions(this),{disabled:($(this).attr("disabled")?true:undefined),selected:($(this).attr("selected")?true:undefined)});\n_3a4(_396,opts,$(this));\n});\ncc.children("div.tabs-header").find(".tabs-scroller-left, .tabs-scroller-right")._bind("mouseenter",function(){\n$(this).addClass("tabs-scroller-over");\n})._bind("mouseleave",function(){\n$(this).removeClass("tabs-scroller-over");\n});\ncc._bind("_resize",function(e,_398){\nif($(this).hasClass("easyui-fluid")||_398){\n_383(_396);\n_38f(_396);\n}\nreturn false;\n});\n};\nfunction _399(_39a){\nvar _39b=$.data(_39a,"tabs");\nvar opts=_39b.options;\n$(_39a).children("div.tabs-header")._unbind()._bind("click",function(e){\nif($(e.target).hasClass("tabs-scroller-left")){\n$(_39a).tabs("scrollBy",-opts.scrollIncrement);\n}else{\nif($(e.target).hasClass("tabs-scroller-right")){\n$(_39a).tabs("scrollBy",opts.scrollIncrement);\n}else{\nvar li=$(e.target).closest("li");\nif(li.hasClass("tabs-disabled")){\nreturn false;\n}\nvar a=$(e.target).closest(".tabs-close");\nif(a.length){\n_3be(_39a,_39c(li));\n}else{\nif(li.length){\nvar _39d=_39c(li);\nvar _39e=_39b.tabs[_39d].panel("options");\nif(_39e.collapsible){\n_39e.closed?_3b5(_39a,_39d):_3d5(_39a,_39d);\n}else{\n_3b5(_39a,_39d);\n}\n}\n}\nreturn false;\n}\n}\n})._bind("contextmenu",function(e){\nvar li=$(e.target).closest("li");\nif(li.hasClass("tabs-disabled")){\nreturn;\n}\nif(li.length){\nopts.onContextMenu.call(_39a,e,li.find("span.tabs-title").html(),_39c(li));\n}\n});\nfunction _39c(li){\nvar _39f=0;\nli.parent().children("li").each(function(i){\nif(li[0]==this){\n_39f=i;\nreturn false;\n}\n});\nreturn _39f;\n};\n};\nfunction _3a0(_3a1){\nvar opts=$.data(_3a1,"tabs").options;\nvar _3a2=$(_3a1).children("div.tabs-header");\nvar _3a3=$(_3a1).children("div.tabs-panels");\n_3a2.removeClass("tabs-header-top tabs-header-bottom tabs-header-left tabs-header-right");\n_3a3.removeClass("tabs-panels-top tabs-panels-bottom tabs-panels-left tabs-panels-right");\nif(opts.tabPosition=="top"){\n_3a2.insertBefore(_3a3);\n}else{\nif(opts.tabPosition=="bottom"){\n_3a2.insertAfter(_3a3);\n_3a2.addClass("tabs-header-bottom");\n_3a3.addClass("tabs-panels-top");\n}else{\nif(opts.tabPosition=="left"){\n_3a2.addClass("tabs-header-left");\n_3a3.addClass("tabs-panels-right");\n}else{\nif(opts.tabPosition=="right"){\n_3a2.addClass("tabs-header-right");\n_3a3.addClass("tabs-panels-left");\n}\n}\n}\n}\nif(opts.plain==true){\n_3a2.addClass("tabs-header-plain");\n}else{\n_3a2.removeClass("tabs-header-plain");\n}\n_3a2.removeClass("tabs-header-narrow").addClass(opts.narrow?"tabs-header-narrow":"");\nvar tabs=_3a2.find(".tabs");\ntabs.removeClass("tabs-pill").addClass(opts.pill?"tabs-pill":"");\ntabs.removeClass("tabs-narrow").addClass(opts.narrow?"tabs-narrow":"");\ntabs.removeClass("tabs-justified").addClass(opts.justified?"tabs-justified":"");\nif(opts.border==true){\n_3a2.removeClass("tabs-header-noborder");\n_3a3.removeClass("tabs-panels-noborder");\n}else{\n_3a2.addClass("tabs-header-noborder");\n_3a3.addClass("tabs-panels-noborder");\n}\nopts.doSize=true;\n};\nfunction _3a4(_3a5,_3a6,pp){\n_3a6=_3a6||{};\nvar _3a7=$.data(_3a5,"tabs");\nvar tabs=_3a7.tabs;\nif(_3a6.index==undefined||_3a6.index>tabs.length){\n_3a6.index=tabs.length;\n}\nif(_3a6.index<0){\n_3a6.index=0;\n}\nvar ul=$(_3a5).children("div.tabs-header").find("ul.tabs");\nvar _3a8=$(_3a5).children("div.tabs-panels");\nvar tab=$("<li>"+"<span class=\\"tabs-inner\\">"+"<span class=\\"tabs-title\\"></span>"+"<span class=\\"tabs-icon\\"></span>"+"</span>"+"</li>");\nif(!pp){\npp=$("<div></div>");\n}\nif(_3a6.index>=tabs.length){\ntab.appendTo(ul);\npp.appendTo(_3a8);\ntabs.push(pp);\n}else{\ntab.insertBefore(ul.children("li:eq("+_3a6.index+")"));\npp.insertBefore(_3a8.children("div.panel:eq("+_3a6.index+")"));\ntabs.splice(_3a6.index,0,pp);\n}\npp.panel($.extend({},_3a6,{tab:tab,border:false,noheader:true,closed:true,doSize:false,iconCls:(_3a6.icon?_3a6.icon:undefined),onLoad:function(){\nif(_3a6.onLoad){\n_3a6.onLoad.apply(this,arguments);\n}\n_3a7.options.onLoad.call(_3a5,$(this));\n},onBeforeOpen:function(){\nif(_3a6.onBeforeOpen){\nif(_3a6.onBeforeOpen.call(this)==false){\nreturn false;\n}\n}\nvar p=$(_3a5).tabs("getSelected");\nif(p){\nif(p[0]!=this){\n$(_3a5).tabs("unselect",_3b0(_3a5,p));\np=$(_3a5).tabs("getSelected");\nif(p){\nreturn false;\n}\n}else{\n_38f(_3a5);\nreturn false;\n}\n}\nvar _3a9=$(this).panel("options");\n_3a9.tab.addClass("tabs-selected");\nvar wrap=$(_3a5).find(">div.tabs-header>div.tabs-wrap");\nvar left=_3a9.tab.position().left;\nvar _3aa=left+_3a9.tab.outerWidth();\nif(left<0||_3aa>wrap.width()){\nvar _3ab=left-(wrap.width()-_3a9.tab.width())/2;\n$(_3a5).tabs("scrollBy",_3ab);\n}else{\n$(_3a5).tabs("scrollBy",0);\n}\nvar _3ac=$(this).panel("panel");\n_3ac.css("display","block");\n_38f(_3a5);\n_3ac.css("display","none");\n},onOpen:function(){\nif(_3a6.onOpen){\n_3a6.onOpen.call(this);\n}\nvar _3ad=$(this).panel("options");\nvar _3ae=_3b0(_3a5,this);\n_3a7.selectHis.push(_3ae);\n_3a7.options.onSelect.call(_3a5,_3ad.title,_3ae);\n},onBeforeClose:function(){\nif(_3a6.onBeforeClose){\nif(_3a6.onBeforeClose.call(this)==false){\nreturn false;\n}\n}\n$(this).panel("options").tab.removeClass("tabs-selected");\n},onClose:function(){\nif(_3a6.onClose){\n_3a6.onClose.call(this);\n}\nvar _3af=$(this).panel("options");\n_3a7.options.onUnselect.call(_3a5,_3af.title,_3b0(_3a5,this));\n}}));\n$(_3a5).tabs("update",{tab:pp,options:pp.panel("options"),type:"header"});\n};\nfunction _3b1(_3b2,_3b3){\nvar _3b4=$.data(_3b2,"tabs");\nvar opts=_3b4.options;\nif(_3b3.selected==undefined){\n_3b3.selected=true;\n}\n_3a4(_3b2,_3b3);\nopts.onAdd.call(_3b2,_3b3.title,_3b3.index);\nif(_3b3.selected){\n_3b5(_3b2,_3b3.index);\n}\n};\nfunction _3b6(_3b7,_3b8){\n_3b8.type=_3b8.type||"all";\nvar _3b9=$.data(_3b7,"tabs").selectHis;\nvar pp=_3b8.tab;\nvar opts=pp.panel("options");\nvar _3ba=opts.title;\n$.extend(opts,_3b8.options,{iconCls:(_3b8.options.icon?_3b8.options.icon:undefined)});\nif(_3b8.type=="all"||_3b8.type=="body"){\npp.panel();\n}\nif(_3b8.type=="all"||_3b8.type=="header"){\nvar tab=opts.tab;\nif(opts.header){\ntab.find(".tabs-inner").html($(opts.header));\n}else{\nvar _3bb=tab.find("span.tabs-title");\nvar _3bc=tab.find("span.tabs-icon");\n_3bb.html(opts.title);\n_3bc.attr("class","tabs-icon");\ntab.find(".tabs-close").remove();\nif(opts.closable){\n_3bb.addClass("tabs-closable");\n$("<span class=\\"tabs-close\\"></span>").appendTo(tab);\n}else{\n_3bb.removeClass("tabs-closable");\n}\nif(opts.iconCls){\n_3bb.addClass("tabs-with-icon");\n_3bc.addClass(opts.iconCls);\n}else{\n_3bb.removeClass("tabs-with-icon");\n}\nif(opts.tools){\nvar _3bd=tab.find("span.tabs-p-tool");\nif(!_3bd.length){\nvar _3bd=$("<span class=\\"tabs-p-tool\\"></span>").insertAfter(tab.find(".tabs-inner"));\n}\nif($.isArray(opts.tools)){\n_3bd.empty();\nfor(var i=0;i<opts.tools.length;i++){\nvar t=$("<a href=\\"javascript:;\\"></a>").appendTo(_3bd);\nt.addClass(opts.tools[i].iconCls);\nif(opts.tools[i].handler){\nt._bind("click",{handler:opts.tools[i].handler},function(e){\nif($(this).parents("li").hasClass("tabs-disabled")){\nreturn;\n}\ne.data.handler.call(this);\n});\n}\n}\n}else{\n$(opts.tools).children().appendTo(_3bd);\n}\nvar pr=_3bd.children().length*12;\nif(opts.closable){\npr+=8;\n_3bd.css("right","");\n}else{\npr-=3;\n_3bd.css("right","5px");\n}\n_3bb.css("padding-right",pr+"px");\n}else{\ntab.find("span.tabs-p-tool").remove();\n_3bb.css("padding-right","");\n}\n}\n}\nif(opts.disabled){\nopts.tab.addClass("tabs-disabled");\n}else{\nopts.tab.removeClass("tabs-disabled");\n}\n_383(_3b7);\n$.data(_3b7,"tabs").options.onUpdate.call(_3b7,opts.title,_3b0(_3b7,pp));\n};\nfunction _3be(_3bf,_3c0){\nvar _3c1=$.data(_3bf,"tabs");\nvar opts=_3c1.options;\nvar tabs=_3c1.tabs;\nvar _3c2=_3c1.selectHis;\nif(!_3c3(_3bf,_3c0)){\nreturn;\n}\nvar tab=_3c4(_3bf,_3c0);\nvar _3c5=tab.panel("options").title;\nvar _3c6=_3b0(_3bf,tab);\nif(opts.onBeforeClose.call(_3bf,_3c5,_3c6)==false){\nreturn;\n}\nvar tab=_3c4(_3bf,_3c0,true);\ntab.panel("options").tab.remove();\ntab.panel("destroy");\nopts.onClose.call(_3bf,_3c5,_3c6);\n_383(_3bf);\nvar his=[];\nfor(var i=0;i<_3c2.length;i++){\nvar _3c7=_3c2[i];\nif(_3c7!=_3c6){\nhis.push(_3c7>_3c6?_3c7-1:_3c7);\n}\n}\n_3c1.selectHis=his;\nvar _3c8=$(_3bf).tabs("getSelected");\nif(!_3c8&&his.length){\n_3c6=_3c1.selectHis.pop();\n$(_3bf).tabs("select",_3c6);\n}\n};\nfunction _3c4(_3c9,_3ca,_3cb){\nvar tabs=$.data(_3c9,"tabs").tabs;\nvar tab=null;\nif(typeof _3ca=="number"){\nif(_3ca>=0&&_3ca<tabs.length){\ntab=tabs[_3ca];\nif(_3cb){\ntabs.splice(_3ca,1);\n}\n}\n}else{\nvar tmp=$("<span></span>");\nfor(var i=0;i<tabs.length;i++){\nvar p=tabs[i];\ntmp.html(p.panel("options").title);\nvar _3cc=tmp.text();\ntmp.html(_3ca);\n_3ca=tmp.text();\nif(_3cc==_3ca){\ntab=p;\nif(_3cb){\ntabs.splice(i,1);\n}\nbreak;\n}\n}\ntmp.remove();\n}\nreturn tab;\n};\nfunction _3b0(_3cd,tab){\nvar tabs=$.data(_3cd,"tabs").tabs;\nfor(var i=0;i<tabs.length;i++){\nif(tabs[i][0]==$(tab)[0]){\nreturn i;\n}\n}\nreturn -1;\n};\nfunction _391(_3ce){\nvar tabs=$.data(_3ce,"tabs").tabs;\nfor(var i=0;i<tabs.length;i++){\nvar tab=tabs[i];\nif(tab.panel("options").tab.hasClass("tabs-selected")){\nreturn tab;\n}\n}\nreturn null;\n};\nfunction _3cf(_3d0){\nvar _3d1=$.data(_3d0,"tabs");\nvar tabs=_3d1.tabs;\nfor(var i=0;i<tabs.length;i++){\nvar opts=tabs[i].panel("options");\nif(opts.selected&&!opts.disabled){\n_3b5(_3d0,i);\nreturn;\n}\n}\n_3b5(_3d0,_3d1.options.selected);\n};\nfunction _3b5(_3d2,_3d3){\nvar p=_3c4(_3d2,_3d3);\nif(p&&!p.is(":visible")){\n_3d4(_3d2);\nif(!p.panel("options").disabled){\np.panel("open");\n}\n}\n};\nfunction _3d5(_3d6,_3d7){\nvar p=_3c4(_3d6,_3d7);\nif(p&&p.is(":visible")){\n_3d4(_3d6);\np.panel("close");\n}\n};\nfunction _3d4(_3d8){\n$(_3d8).children("div.tabs-panels").each(function(){\n$(this).stop(true,true);\n});\n};\nfunction _3c3(_3d9,_3da){\nreturn _3c4(_3d9,_3da)!=null;\n};\nfunction _3db(_3dc,_3dd){\nvar opts=$.data(_3dc,"tabs").options;\nopts.showHeader=_3dd;\n$(_3dc).tabs("resize");\n};\nfunction _3de(_3df,_3e0){\nvar tool=$(_3df).find(">.tabs-header>.tabs-tool");\nif(_3e0){\ntool.removeClass("tabs-tool-hidden").show();\n}else{\ntool.addClass("tabs-tool-hidden").hide();\n}\n$(_3df).tabs("resize").tabs("scrollBy",0);\n};\n$.fn.tabs=function(_3e1,_3e2){\nif(typeof _3e1=="string"){\nreturn $.fn.tabs.methods[_3e1](this,_3e2);\n}\n_3e1=_3e1||{};\nreturn this.each(function(){\nvar _3e3=$.data(this,"tabs");\nif(_3e3){\n$.extend(_3e3.options,_3e1);\n}else{\n$.data(this,"tabs",{options:$.extend({},$.fn.tabs.defaults,$.fn.tabs.parseOptions(this),_3e1),tabs:[],selectHis:[]});\n_395(this);\n}\n_37f(this);\n_3a0(this);\n_383(this);\n_399(this);\n_3cf(this);\n});\n};\n$.fn.tabs.methods={options:function(jq){\nvar cc=jq[0];\nvar opts=$.data(cc,"tabs").options;\nvar s=_391(cc);\nopts.selected=s?_3b0(cc,s):-1;\nreturn opts;\n},tabs:function(jq){\nreturn $.data(jq[0],"tabs").tabs;\n},resize:function(jq,_3e4){\nreturn jq.each(function(){\n_383(this,_3e4);\n_38f(this);\n});\n},add:function(jq,_3e5){\nreturn jq.each(function(){\n_3b1(this,_3e5);\n});\n},close:function(jq,_3e6){\nreturn jq.each(function(){\n_3be(this,_3e6);\n});\n},getTab:function(jq,_3e7){\nreturn _3c4(jq[0],_3e7);\n},getTabIndex:function(jq,tab){\nreturn _3b0(jq[0],tab);\n},getSelected:function(jq){\nreturn _391(jq[0]);\n},select:function(jq,_3e8){\nreturn jq.each(function(){\n_3b5(this,_3e8);\n});\n},unselect:function(jq,_3e9){\nreturn jq.each(function(){\n_3d5(this,_3e9);\n});\n},exists:function(jq,_3ea){\nreturn _3c3(jq[0],_3ea);\n},update:function(jq,_3eb){\nreturn jq.each(function(){\n_3b6(this,_3eb);\n});\n},enableTab:function(jq,_3ec){\nreturn jq.each(function(){\nvar opts=$(this).tabs("getTab",_3ec).panel("options");\nopts.tab.removeClass("tabs-disabled");\nopts.disabled=false;\n});\n},disableTab:function(jq,_3ed){\nreturn jq.each(function(){\nvar opts=$(this).tabs("getTab",_3ed).panel("options");\nopts.tab.addClass("tabs-disabled");\nopts.disabled=true;\n});\n},showHeader:function(jq){\nreturn jq.each(function(){\n_3db(this,true);\n});\n},hideHeader:function(jq){\nreturn jq.each(function(){\n_3db(this,false);\n});\n},showTool:function(jq){\nreturn jq.each(function(){\n_3de(this,true);\n});\n},hideTool:function(jq){\nreturn jq.each(function(){\n_3de(this,false);\n});\n},scrollBy:function(jq,_3ee){\nreturn jq.each(function(){\nvar opts=$(this).tabs("options");\nvar wrap=$(this).find(">div.tabs-header>div.tabs-wrap");\nvar pos=Math.min(wrap._scrollLeft()+_3ee,_3ef());\nwrap.animate({scrollLeft:pos},opts.scrollDuration);\nfunction _3ef(){\nvar w=0;\nvar ul=wrap.children("ul");\nul.children("li").each(function(){\nw+=$(this).outerWidth(true);\n});\nreturn w-wrap.width()+(ul.outerWidth()-ul.width());\n};\n});\n}};\n$.fn.tabs.parseOptions=function(_3f0){\nreturn $.extend({},$.parser.parseOptions(_3f0,["tools","toolPosition","tabPosition",{fit:"boolean",border:"boolean",plain:"boolean"},{headerWidth:"number",tabWidth:"number",tabHeight:"number",selected:"number"},{showHeader:"boolean",justified:"boolean",narrow:"boolean",pill:"boolean"}]));\n};\n$.fn.tabs.defaults={width:"auto",height:"auto",headerWidth:150,tabWidth:"auto",tabHeight:32,selected:0,showHeader:true,plain:false,fit:false,border:true,justified:false,narrow:false,pill:false,tools:null,toolPosition:"right",tabPosition:"top",scrollIncrement:100,scrollDuration:400,onLoad:function(_3f1){\n},onSelect:function(_3f2,_3f3){\n},onUnselect:function(_3f4,_3f5){\n},onBeforeClose:function(_3f6,_3f7){\n},onClose:function(_3f8,_3f9){\n},onAdd:function(_3fa,_3fb){\n},onUpdate:function(_3fc,_3fd){\n},onContextMenu:function(e,_3fe,_3ff){\n}};\n})(jQuery);\n(function($){\nvar _400=false;\nfunction _401(_402,_403){\nvar _404=$.data(_402,"layout");\nvar opts=_404.options;\nvar _405=_404.panels;\nvar cc=$(_402);\nif(_403){\n$.extend(opts,{width:_403.width,height:_403.height});\n}\nif(_402.tagName.toLowerCase()=="body"){\ncc._size("fit");\n}else{\ncc._size(opts);\n}\nvar cpos={top:0,left:0,width:cc.width(),height:cc.height()};\n_406(_407(_405.expandNorth)?_405.expandNorth:_405.north,"n");\n_406(_407(_405.expandSouth)?_405.expandSouth:_405.south,"s");\n_408(_407(_405.expandEast)?_405.expandEast:_405.east,"e");\n_408(_407(_405.expandWest)?_405.expandWest:_405.west,"w");\n_405.center.panel("resize",cpos);\nfunction _406(pp,type){\nif(!pp.length||!_407(pp)){\nreturn;\n}\nvar opts=pp.panel("options");\npp.panel("resize",{width:cc.width(),height:opts.height});\nvar _409=pp.panel("panel").outerHeight();\npp.panel("move",{left:0,top:(type=="n"?0:cc.height()-_409)});\ncpos.height-=_409;\nif(type=="n"){\ncpos.top+=_409;\nif(!opts.split&&opts.border){\ncpos.top--;\n}\n}\nif(!opts.split&&opts.border){\ncpos.height++;\n}\n};\nfunction _408(pp,type){\nif(!pp.length||!_407(pp)){\nreturn;\n}\nvar opts=pp.panel("options");\npp.panel("resize",{width:opts.width,height:cpos.height});\nvar _40a=pp.panel("panel").outerWidth();\npp.panel("move",{left:(type=="e"?cc.width()-_40a:0),top:cpos.top});\ncpos.width-=_40a;\nif(type=="w"){\ncpos.left+=_40a;\nif(!opts.split&&opts.border){\ncpos.left--;\n}\n}\nif(!opts.split&&opts.border){\ncpos.width++;\n}\n};\n};\nfunction init(_40b){\nvar cc=$(_40b);\ncc.addClass("layout");\nfunction _40c(el){\nvar _40d=$.fn.layout.parsePanelOptions(el);\nif("north,south,east,west,center".indexOf(_40d.region)>=0){\n_410(_40b,_40d,el);\n}\n};\nvar opts=cc.layout("options");\nvar _40e=opts.onAdd;\nopts.onAdd=function(){\n};\ncc.find(">div,>form>div").each(function(){\n_40c(this);\n});\nopts.onAdd=_40e;\ncc.append("<div class=\\"layout-split-proxy-h\\"></div><div class=\\"layout-split-proxy-v\\"></div>");\ncc._bind("_resize",function(e,_40f){\nif($(this).hasClass("easyui-fluid")||_40f){\n_401(_40b);\n}\nreturn false;\n});\n};\nfunction _410(_411,_412,el){\n_412.region=_412.region||"center";\nvar _413=$.data(_411,"layout").panels;\nvar cc=$(_411);\nvar dir=_412.region;\nif(_413[dir].length){\nreturn;\n}\nvar pp=$(el);\nif(!pp.length){\npp=$("<div></div>").appendTo(cc);\n}\nvar _414=$.extend({},$.fn.layout.paneldefaults,{width:(pp.length?parseInt(pp[0].style.width)||pp.outerWidth():"auto"),height:(pp.length?parseInt(pp[0].style.height)||pp.outerHeight():"auto"),doSize:false,collapsible:true,onOpen:function(){\nvar tool=$(this).panel("header").children("div.panel-tool");\ntool.children("a.panel-tool-collapse").hide();\nvar _415={north:"up",south:"down",east:"right",west:"left"};\nif(!_415[dir]){\nreturn;\n}\nvar _416="layout-button-"+_415[dir];\nvar t=tool.children("a."+_416);\nif(!t.length){\nt=$("<a href=\\"javascript:;\\"></a>").addClass(_416).appendTo(tool);\nt._bind("click",{dir:dir},function(e){\n_42d(_411,e.data.dir);\nreturn false;\n});\n}\n$(this).panel("options").collapsible?t.show():t.hide();\n}},_412,{cls:((_412.cls||"")+" layout-panel layout-panel-"+dir),bodyCls:((_412.bodyCls||"")+" layout-body")});\npp.panel(_414);\n_413[dir]=pp;\nvar _417={north:"s",south:"n",east:"w",west:"e"};\nvar _418=pp.panel("panel");\nif(pp.panel("options").split){\n_418.addClass("layout-split-"+dir);\n}\n_418.resizable($.extend({},{handles:(_417[dir]||""),disabled:(!pp.panel("options").split),onStartResize:function(e){\n_400=true;\nif(dir=="north"||dir=="south"){\nvar _419=$(">div.layout-split-proxy-v",_411);\n}else{\nvar _419=$(">div.layout-split-proxy-h",_411);\n}\nvar top=0,left=0,_41a=0,_41b=0;\nvar pos={display:"block"};\nif(dir=="north"){\npos.top=parseInt(_418.css("top"))+_418.outerHeight()-_419.height();\npos.left=parseInt(_418.css("left"));\npos.width=_418.outerWidth();\npos.height=_419.height();\n}else{\nif(dir=="south"){\npos.top=parseInt(_418.css("top"));\npos.left=parseInt(_418.css("left"));\npos.width=_418.outerWidth();\npos.height=_419.height();\n}else{\nif(dir=="east"){\npos.top=parseInt(_418.css("top"))||0;\npos.left=parseInt(_418.css("left"))||0;\npos.width=_419.width();\npos.height=_418.outerHeight();\n}else{\nif(dir=="west"){\npos.top=parseInt(_418.css("top"))||0;\npos.left=_418.outerWidth()-_419.width();\npos.width=_419.width();\npos.height=_418.outerHeight();\n}\n}\n}\n}\n_419.css(pos);\n$("<div class=\\"layout-mask\\"></div>").css({left:0,top:0,width:cc.width(),height:cc.height()}).appendTo(cc);\n},onResize:function(e){\nif(dir=="north"||dir=="south"){\nvar _41c=_41d(this);\n$(this).resizable("options").maxHeight=_41c;\nvar _41e=$(">div.layout-split-proxy-v",_411);\nvar top=dir=="north"?e.data.height-_41e.height():$(_411).height()-e.data.height;\n_41e.css("top",top);\n}else{\nvar _41f=_41d(this);\n$(this).resizable("options").maxWidth=_41f;\nvar _41e=$(">div.layout-split-proxy-h",_411);\nvar left=dir=="west"?e.data.width-_41e.width():$(_411).width()-e.data.width;\n_41e.css("left",left);\n}\nreturn false;\n},onStopResize:function(e){\ncc.children("div.layout-split-proxy-v,div.layout-split-proxy-h").hide();\npp.panel("resize",e.data);\n_401(_411);\n_400=false;\ncc.find(">div.layout-mask").remove();\n}},_412));\ncc.layout("options").onAdd.call(_411,dir);\nfunction _41d(p){\nvar _420="expand"+dir.substring(0,1).toUpperCase()+dir.substring(1);\nvar _421=_413["center"];\nvar _422=(dir=="north"||dir=="south")?"minHeight":"minWidth";\nvar _423=(dir=="north"||dir=="south")?"maxHeight":"maxWidth";\nvar _424=(dir=="north"||dir=="south")?"_outerHeight":"_outerWidth";\nvar _425=$.parser.parseValue(_423,_413[dir].panel("options")[_423],$(_411));\nvar _426=$.parser.parseValue(_422,_421.panel("options")[_422],$(_411));\nvar _427=_421.panel("panel")[_424]()-_426;\nif(_407(_413[_420])){\n_427+=_413[_420][_424]()-1;\n}else{\n_427+=$(p)[_424]();\n}\nif(_427>_425){\n_427=_425;\n}\nreturn _427;\n};\n};\nfunction _428(_429,_42a){\nvar _42b=$.data(_429,"layout").panels;\nif(_42b[_42a].length){\n_42b[_42a].panel("destroy");\n_42b[_42a]=$();\nvar _42c="expand"+_42a.substring(0,1).toUpperCase()+_42a.substring(1);\nif(_42b[_42c]){\n_42b[_42c].panel("destroy");\n_42b[_42c]=undefined;\n}\n$(_429).layout("options").onRemove.call(_429,_42a);\n}\n};\nfunction _42d(_42e,_42f,_430){\nif(_430==undefined){\n_430="normal";\n}\nvar _431=$.data(_42e,"layout");\nvar _432=_431.panels;\nvar p=_432[_42f];\nvar _433=p.panel("options");\nif(_433.onBeforeCollapse.call(p)==false){\nreturn;\n}\nvar _434="expand"+_42f.substring(0,1).toUpperCase()+_42f.substring(1);\nif(!_432[_434]){\n_432[_434]=_435(_42f);\nvar ep=_432[_434].panel("panel");\nif(!_433.expandMode){\nep.css("cursor","default");\n}else{\nep._bind("click",function(){\nif(_433.expandMode=="dock"){\n_442(_42e,_42f);\n}else{\np.panel("expand",false).panel("open");\nvar _436=_437();\np.panel("resize",_436.collapse);\np.panel("panel")._unbind(".layout")._bind("mouseleave.layout",{region:_42f},function(e){\nvar that=this;\n_431.collapseTimer=setTimeout(function(){\n$(that).stop(true,true);\nif(_400==true){\nreturn;\n}\nif($("body>div.combo-p>div.combo-panel:visible").length){\nreturn;\n}\n_42d(_42e,e.data.region);\n},_431.options.collapseDelay);\n});\np.panel("panel").animate(_436.expand,function(){\n$(_42e).layout("options").onExpand.call(_42e,_42f);\n});\n}\nreturn false;\n});\n}\n}\nvar _438=_437();\nif(!_407(_432[_434])){\n_432.center.panel("resize",_438.resizeC);\n}\np.panel("panel").animate(_438.collapse,_430,function(){\np.panel("collapse",false).panel("close");\n_432[_434].panel("open").panel("resize",_438.expandP);\n$(this)._unbind(".layout");\n$(_42e).layout("options").onCollapse.call(_42e,_42f);\n});\nfunction _435(dir){\nvar _439={"east":"left","west":"right","north":"down","south":"up"};\nvar isns=(_433.region=="north"||_433.region=="south");\nvar icon="layout-button-"+_439[dir];\nvar p=$("<div></div>").appendTo(_42e);\np.panel($.extend({},$.fn.layout.paneldefaults,{cls:("layout-expand layout-expand-"+dir),title:"&nbsp;",titleDirection:_433.titleDirection,iconCls:(_433.hideCollapsedContent?null:_433.iconCls),closed:true,minWidth:0,minHeight:0,doSize:false,region:_433.region,collapsedSize:_433.collapsedSize,noheader:(!isns&&_433.hideExpandTool),tools:((isns&&_433.hideExpandTool)?null:[{iconCls:icon,handler:function(){\n_442(_42e,_42f);\nreturn false;\n}}]),onResize:function(){\nvar _43a=$(this).children(".layout-expand-title");\nif(_43a.length){\nvar icon=$(this).children(".panel-icon");\nvar _43b=icon.length>0?(icon._outerHeight()+2):0;\n_43a._outerWidth($(this).height()-_43b);\nvar left=($(this).width()-Math.min(_43a._outerWidth(),_43a._outerHeight()))/2;\nvar top=Math.max(_43a._outerWidth(),_43a._outerHeight());\nif(_43a.hasClass("layout-expand-title-down")){\nleft+=Math.min(_43a._outerWidth(),_43a._outerHeight());\ntop=0;\n}\ntop+=_43b;\n_43a.css({left:(left+"px"),top:(top+"px")});\n}\n}}));\nif(!_433.hideCollapsedContent){\nvar _43c=typeof _433.collapsedContent=="function"?_433.collapsedContent.call(p[0],_433.title):_433.collapsedContent;\nisns?p.panel("setTitle",_43c):p.html(_43c);\n}\np.panel("panel").hover(function(){\n$(this).addClass("layout-expand-over");\n},function(){\n$(this).removeClass("layout-expand-over");\n});\nreturn p;\n};\nfunction _437(){\nvar cc=$(_42e);\nvar _43d=_432.center.panel("options");\nvar _43e=_433.collapsedSize;\nif(_42f=="east"){\nvar _43f=p.panel("panel")._outerWidth();\nvar _440=_43d.width+_43f-_43e;\nif(_433.split||!_433.border){\n_440++;\n}\nreturn {resizeC:{width:_440},expand:{left:cc.width()-_43f},expandP:{top:_43d.top,left:cc.width()-_43e,width:_43e,height:_43d.height},collapse:{left:cc.width(),top:_43d.top,height:_43d.height}};\n}else{\nif(_42f=="west"){\nvar _43f=p.panel("panel")._outerWidth();\nvar _440=_43d.width+_43f-_43e;\nif(_433.split||!_433.border){\n_440++;\n}\nreturn {resizeC:{width:_440,left:_43e-1},expand:{left:0},expandP:{left:0,top:_43d.top,width:_43e,height:_43d.height},collapse:{left:-_43f,top:_43d.top,height:_43d.height}};\n}else{\nif(_42f=="north"){\nvar _441=p.panel("panel")._outerHeight();\nvar hh=_43d.height;\nif(!_407(_432.expandNorth)){\nhh+=_441-_43e+((_433.split||!_433.border)?1:0);\n}\n_432.east.add(_432.west).add(_432.expandEast).add(_432.expandWest).panel("resize",{top:_43e-1,height:hh});\nreturn {resizeC:{top:_43e-1,height:hh},expand:{top:0},expandP:{top:0,left:0,width:cc.width(),height:_43e},collapse:{top:-_441,width:cc.width()}};\n}else{\nif(_42f=="south"){\nvar _441=p.panel("panel")._outerHeight();\nvar hh=_43d.height;\nif(!_407(_432.expandSouth)){\nhh+=_441-_43e+((_433.split||!_433.border)?1:0);\n}\n_432.east.add(_432.west).add(_432.expandEast).add(_432.expandWest).panel("resize",{height:hh});\nreturn {resizeC:{height:hh},expand:{top:cc.height()-_441},expandP:{top:cc.height()-_43e,left:0,width:cc.width(),height:_43e},collapse:{top:cc.height(),width:cc.width()}};\n}\n}\n}\n}\n};\n};\nfunction _442(_443,_444){\nvar _445=$.data(_443,"layout").panels;\nvar p=_445[_444];\nvar _446=p.panel("options");\nif(_446.onBeforeExpand.call(p)==false){\nreturn;\n}\nvar _447="expand"+_444.substring(0,1).toUpperCase()+_444.substring(1);\nif(_445[_447]){\n_445[_447].panel("close");\np.panel("panel").stop(true,true);\np.panel("expand",false).panel("open");\nvar _448=_449();\np.panel("resize",_448.collapse);\np.panel("panel").animate(_448.expand,function(){\n_401(_443);\n$(_443).layout("options").onExpand.call(_443,_444);\n});\n}\nfunction _449(){\nvar cc=$(_443);\nvar _44a=_445.center.panel("options");\nif(_444=="east"&&_445.expandEast){\nreturn {collapse:{left:cc.width(),top:_44a.top,height:_44a.height},expand:{left:cc.width()-p.panel("panel")._outerWidth()}};\n}else{\nif(_444=="west"&&_445.expandWest){\nreturn {collapse:{left:-p.panel("panel")._outerWidth(),top:_44a.top,height:_44a.height},expand:{left:0}};\n}else{\nif(_444=="north"&&_445.expandNorth){\nreturn {collapse:{top:-p.panel("panel")._outerHeight(),width:cc.width()},expand:{top:0}};\n}else{\nif(_444=="south"&&_445.expandSouth){\nreturn {collapse:{top:cc.height(),width:cc.width()},expand:{top:cc.height()-p.panel("panel")._outerHeight()}};\n}\n}\n}\n}\n};\n};\nfunction _407(pp){\nif(!pp){\nreturn false;\n}\nif(pp.length){\nreturn pp.panel("panel").is(":visible");\n}else{\nreturn false;\n}\n};\nfunction _44b(_44c){\nvar _44d=$.data(_44c,"layout");\nvar opts=_44d.options;\nvar _44e=_44d.panels;\nvar _44f=opts.onCollapse;\nopts.onCollapse=function(){\n};\n_450("east");\n_450("west");\n_450("north");\n_450("south");\nopts.onCollapse=_44f;\nfunction _450(_451){\nvar p=_44e[_451];\nif(p.length&&p.panel("options").collapsed){\n_42d(_44c,_451,0);\n}\n};\n};\nfunction _452(_453,_454,_455){\nvar p=$(_453).layout("panel",_454);\np.panel("options").split=_455;\nvar cls="layout-split-"+_454;\nvar _456=p.panel("panel").removeClass(cls);\nif(_455){\n_456.addClass(cls);\n}\n_456.resizable({disabled:(!_455)});\n_401(_453);\n};\n$.fn.layout=function(_457,_458){\nif(typeof _457=="string"){\nreturn $.fn.layout.methods[_457](this,_458);\n}\n_457=_457||{};\nreturn this.each(function(){\nvar _459=$.data(this,"layout");\nif(_459){\n$.extend(_459.options,_457);\n}else{\nvar opts=$.extend({},$.fn.layout.defaults,$.fn.layout.parseOptions(this),_457);\n$.data(this,"layout",{options:opts,panels:{center:$(),north:$(),south:$(),east:$(),west:$()}});\ninit(this);\n}\n_401(this);\n_44b(this);\n});\n};\n$.fn.layout.methods={options:function(jq){\nreturn $.data(jq[0],"layout").options;\n},resize:function(jq,_45a){\nreturn jq.each(function(){\n_401(this,_45a);\n});\n},panel:function(jq,_45b){\nreturn $.data(jq[0],"layout").panels[_45b];\n},collapse:function(jq,_45c){\nreturn jq.each(function(){\n_42d(this,_45c);\n});\n},expand:function(jq,_45d){\nreturn jq.each(function(){\n_442(this,_45d);\n});\n},add:function(jq,_45e){\nreturn jq.each(function(){\n_410(this,_45e);\n_401(this);\nif($(this).layout("panel",_45e.region).panel("options").collapsed){\n_42d(this,_45e.region,0);\n}\n});\n},remove:function(jq,_45f){\nreturn jq.each(function(){\n_428(this,_45f);\n_401(this);\n});\n},split:function(jq,_460){\nreturn jq.each(function(){\n_452(this,_460,true);\n});\n},unsplit:function(jq,_461){\nreturn jq.each(function(){\n_452(this,_461,false);\n});\n},stopCollapsing:function(jq){\nreturn jq.each(function(){\nclearTimeout($(this).data("layout").collapseTimer);\n});\n}};\n$.fn.layout.parseOptions=function(_462){\nreturn $.extend({},$.parser.parseOptions(_462,[{fit:"boolean"}]));\n};\n$.fn.layout.defaults={fit:false,onExpand:function(_463){\n},onCollapse:function(_464){\n},onAdd:function(_465){\n},onRemove:function(_466){\n}};\n$.fn.layout.parsePanelOptions=function(_467){\nvar t=$(_467);\nreturn $.extend({},$.fn.panel.parseOptions(_467),$.parser.parseOptions(_467,["region",{split:"boolean",collpasedSize:"number",minWidth:"number",minHeight:"number",maxWidth:"number",maxHeight:"number"}]));\n};\n$.fn.layout.paneldefaults=$.extend({},$.fn.panel.defaults,{region:null,split:false,collapseDelay:100,collapsedSize:32,expandMode:"float",hideExpandTool:false,hideCollapsedContent:true,collapsedContent:function(_468){\nvar p=$(this);\nvar opts=p.panel("options");\nif(opts.region=="north"||opts.region=="south"){\nreturn _468;\n}\nvar cc=[];\nif(opts.iconCls){\ncc.push("<div class=\\"panel-icon "+opts.iconCls+"\\"></div>");\n}\ncc.push("<div class=\\"panel-title layout-expand-title");\ncc.push(" layout-expand-title-"+opts.titleDirection);\ncc.push(opts.iconCls?" layout-expand-with-icon":"");\ncc.push("\\">");\ncc.push(_468);\ncc.push("</div>");\nreturn cc.join("");\n},minWidth:10,minHeight:10,maxWidth:10000,maxHeight:10000});\n})(jQuery);\n(function($){\n$(function(){\n$(document)._unbind(".menu")._bind("mousedown.menu",function(e){\nvar m=$(e.target).closest("div.menu,div.combo-p");\nif(m.length){\nreturn;\n}\n$("body>div.menu-top:visible").not(".menu-inline").menu("hide");\n_469($("body>div.menu:visible").not(".menu-inline"));\n});\n});\nfunction init(_46a){\nvar opts=$.data(_46a,"menu").options;\n$(_46a).addClass("menu-top");\nopts.inline?$(_46a).addClass("menu-inline"):$(_46a).appendTo("body");\n$(_46a)._bind("_resize",function(e,_46b){\nif($(this).hasClass("easyui-fluid")||_46b){\n$(_46a).menu("resize",_46a);\n}\nreturn false;\n});\nvar _46c=_46d($(_46a));\nfor(var i=0;i<_46c.length;i++){\n_470(_46a,_46c[i]);\n}\nfunction _46d(menu){\nvar _46e=[];\nmenu.addClass("menu");\n_46e.push(menu);\nif(!menu.hasClass("menu-content")){\nmenu.children("div").each(function(){\nvar _46f=$(this).children("div");\nif(_46f.length){\n_46f.appendTo("body");\nthis.submenu=_46f;\nvar mm=_46d(_46f);\n_46e=_46e.concat(mm);\n}\n});\n}\nreturn _46e;\n};\n};\nfunction _470(_471,div){\nvar menu=$(div).addClass("menu");\nif(!menu.data("menu")){\nmenu.data("menu",{options:$.parser.parseOptions(menu[0],["width","height"])});\n}\nif(!menu.hasClass("menu-content")){\nmenu.children("div").each(function(){\n_472(_471,this);\n});\n$("<div class=\\"menu-line\\"></div>").prependTo(menu);\n}\n_473(_471,menu);\nif(!menu.hasClass("menu-inline")){\nmenu.hide();\n}\n_474(_471,menu);\n};\nfunction _472(_475,div,_476){\nvar item=$(div);\nvar _477=$.extend({},$.parser.parseOptions(item[0],["id","name","iconCls","href",{separator:"boolean"}]),{disabled:(item.attr("disabled")?true:undefined),text:$.trim(item.html()),onclick:item[0].onclick},_476||{});\n_477.onclick=_477.onclick||_477.handler||null;\nitem.data("menuitem",{options:_477});\nif(_477.separator){\nitem.addClass("menu-sep");\n}\nif(!item.hasClass("menu-sep")){\nitem.addClass("menu-item");\nitem.empty().append($("<div class=\\"menu-text\\"></div>").html(_477.text));\nif(_477.iconCls){\n$("<div class=\\"menu-icon\\"></div>").addClass(_477.iconCls).appendTo(item);\n}\nif(_477.id){\nitem.attr("id",_477.id);\n}\nif(_477.onclick){\nif(typeof _477.onclick=="string"){\nitem.attr("onclick",_477.onclick);\n}else{\nitem[0].onclick=eval(_477.onclick);\n}\n}\nif(_477.disabled){\n_478(_475,item[0],true);\n}\nif(item[0].submenu){\n$("<div class=\\"menu-rightarrow\\"></div>").appendTo(item);\n}\n}\n};\nfunction _473(_479,menu){\nvar opts=$.data(_479,"menu").options;\nvar _47a=menu.attr("style")||"";\nvar _47b=menu.is(":visible");\nmenu.css({display:"block",left:-10000,height:"auto",overflow:"hidden"});\nmenu.find(".menu-item").each(function(){\n$(this)._outerHeight(opts.itemHeight);\n$(this).find(".menu-text").css({height:(opts.itemHeight-2)+"px",lineHeight:(opts.itemHeight-2)+"px"});\n});\nmenu.removeClass("menu-noline").addClass(opts.noline?"menu-noline":"");\nvar _47c=menu.data("menu").options;\nvar _47d=_47c.width;\nvar _47e=_47c.height;\nif(isNaN(parseInt(_47d))){\n_47d=0;\nmenu.find("div.menu-text").each(function(){\nif(_47d<$(this).outerWidth()){\n_47d=$(this).outerWidth();\n}\n});\n_47d=_47d?_47d+40:"";\n}\nvar _47f=Math.round(menu.outerHeight());\nif(isNaN(parseInt(_47e))){\n_47e=_47f;\nif(menu.hasClass("menu-top")&&opts.alignTo){\nvar at=$(opts.alignTo);\nvar h1=at.offset().top-$(document).scrollTop();\nvar h2=$(window)._outerHeight()+$(document).scrollTop()-at.offset().top-at._outerHeight();\n_47e=Math.min(_47e,Math.max(h1,h2));\n}else{\nif(_47e>$(window)._outerHeight()){\n_47e=$(window).height();\n}\n}\n}\nmenu.attr("style",_47a);\nmenu.show();\nmenu._size($.extend({},_47c,{width:_47d,height:_47e,minWidth:_47c.minWidth||opts.minWidth,maxWidth:_47c.maxWidth||opts.maxWidth}));\nmenu.find(".easyui-fluid").triggerHandler("_resize",[true]);\nmenu.css("overflow",menu.outerHeight()<_47f?"auto":"hidden");\nmenu.children("div.menu-line")._outerHeight(_47f-2);\nif(!_47b){\nmenu.hide();\n}\n};\nfunction _474(_480,menu){\nvar _481=$.data(_480,"menu");\nvar opts=_481.options;\nmenu._unbind(".menu");\nfor(var _482 in opts.events){\nmenu._bind(_482+".menu",{target:_480},opts.events[_482]);\n}\n};\nfunction _483(e){\nvar _484=e.data.target;\nvar _485=$.data(_484,"menu");\nif(_485.timer){\nclearTimeout(_485.timer);\n_485.timer=null;\n}\n};\nfunction _486(e){\nvar _487=e.data.target;\nvar _488=$.data(_487,"menu");\nif(_488.options.hideOnUnhover){\n_488.timer=setTimeout(function(){\n_489(_487,$(_487).hasClass("menu-inline"));\n},_488.options.duration);\n}\n};\nfunction _48a(e){\nvar _48b=e.data.target;\nvar item=$(e.target).closest(".menu-item");\nif(item.length){\nitem.siblings().each(function(){\nif(this.submenu){\n_469(this.submenu);\n}\n$(this).removeClass("menu-active");\n});\nitem.addClass("menu-active");\nif(item.hasClass("menu-item-disabled")){\nitem.addClass("menu-active-disabled");\nreturn;\n}\nvar _48c=item[0].submenu;\nif(_48c){\n$(_48b).menu("show",{menu:_48c,parent:item});\n}\n}\n};\nfunction _48d(e){\nvar item=$(e.target).closest(".menu-item");\nif(item.length){\nitem.removeClass("menu-active menu-active-disabled");\nvar _48e=item[0].submenu;\nif(_48e){\nif(e.pageX>=parseInt(_48e.css("left"))){\nitem.addClass("menu-active");\n}else{\n_469(_48e);\n}\n}else{\nitem.removeClass("menu-active");\n}\n}\n};\nfunction _48f(e){\nvar _490=e.data.target;\nvar item=$(e.target).closest(".menu-item");\nif(item.length){\nvar opts=$(_490).data("menu").options;\nvar _491=item.data("menuitem").options;\nif(_491.disabled){\nreturn;\n}\nif(!item[0].submenu){\n_489(_490,opts.inline);\nif(_491.href){\nlocation.href=_491.href;\n}\n}\nitem.trigger("mouseenter");\nopts.onClick.call(_490,$(_490).menu("getItem",item[0]));\n}\n};\nfunction _489(_492,_493){\nvar _494=$.data(_492,"menu");\nif(_494){\nif($(_492).is(":visible")){\n_469($(_492));\nif(_493){\n$(_492).show();\n}else{\n_494.options.onHide.call(_492);\n}\n}\n}\nreturn false;\n};\nfunction _495(_496,_497){\n_497=_497||{};\nvar left,top;\nvar opts=$.data(_496,"menu").options;\nvar menu=$(_497.menu||_496);\n$(_496).menu("resize",menu[0]);\nif(menu.hasClass("menu-top")){\n$.extend(opts,_497);\nleft=opts.left;\ntop=opts.top;\nif(opts.alignTo){\nvar at=$(opts.alignTo);\nleft=at.offset().left;\ntop=at.offset().top+at._outerHeight();\nif(opts.align=="right"){\nleft+=at.outerWidth()-menu.outerWidth();\n}\n}\nif(left+menu.outerWidth()>$(window)._outerWidth()+$(document)._scrollLeft()){\nleft=$(window)._outerWidth()+$(document).scrollLeft()-menu.outerWidth()-5;\n}\nif(left<0){\nleft=0;\n}\ntop=_498(top,opts.alignTo);\n}else{\nvar _499=_497.parent;\nleft=_499.offset().left+_499.outerWidth()-2;\nif(left+menu.outerWidth()+5>$(window)._outerWidth()+$(document).scrollLeft()){\nleft=_499.offset().left-menu.outerWidth()+2;\n}\ntop=_498(_499.offset().top-3);\n}\nfunction _498(top,_49a){\nif(top+menu.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()){\nif(_49a){\ntop=$(_49a).offset().top-menu._outerHeight();\n}else{\ntop=$(window)._outerHeight()+$(document).scrollTop()-menu.outerHeight();\n}\n}\nif(top<0){\ntop=0;\n}\nreturn top;\n};\nmenu.css(opts.position.call(_496,menu[0],left,top));\nmenu.show(0,function(){\nif(!menu[0].shadow){\nmenu[0].shadow=$("<div class=\\"menu-shadow\\"></div>").insertAfter(menu);\n}\nmenu[0].shadow.css({display:(menu.hasClass("menu-inline")?"none":"block"),zIndex:$.fn.menu.defaults.zIndex++,left:menu.css("left"),top:menu.css("top"),width:menu.outerWidth(),height:menu.outerHeight()});\nmenu.css("z-index",$.fn.menu.defaults.zIndex++);\nif(menu.hasClass("menu-top")){\nopts.onShow.call(_496);\n}\n});\n};\nfunction _469(menu){\nif(menu&&menu.length){\n_49b(menu);\nmenu.find("div.menu-item").each(function(){\nif(this.submenu){\n_469(this.submenu);\n}\n$(this).removeClass("menu-active");\n});\n}\nfunction _49b(m){\nm.stop(true,true);\nif(m[0].shadow){\nm[0].shadow.hide();\n}\nm.hide();\n};\n};\nfunction _49c(_49d,_49e){\nvar fn=$.isFunction(_49e)?_49e:function(item){\nfor(var p in _49e){\nif(item[p]!=_49e[p]){\nreturn false;\n}\n}\nreturn true;\n};\nvar _49f=[];\n_4a0(_49d,function(item){\nif(fn.call(_49d,item)==true){\n_49f.push(item);\n}\n});\nreturn _49f;\n};\nfunction _4a0(_4a1,cb){\nvar done=false;\nfunction nav(menu){\nmenu.children("div.menu-item").each(function(){\nif(done){\nreturn;\n}\nvar item=$(_4a1).menu("getItem",this);\nif(cb.call(_4a1,item)==false){\ndone=true;\n}\nif(this.submenu&&!done){\nnav(this.submenu);\n}\n});\n};\nnav($(_4a1));\n};\nfunction _478(_4a2,_4a3,_4a4){\nvar t=$(_4a3);\nif(t.hasClass("menu-item")){\nvar opts=t.data("menuitem").options;\nopts.disabled=_4a4;\nif(_4a4){\nt.addClass("menu-item-disabled");\nt[0].onclick=null;\n}else{\nt.removeClass("menu-item-disabled");\nt[0].onclick=opts.onclick;\n}\n}\n};\nfunction _4a5(_4a6,_4a7,_4a8){\nfor(var i=0;i<_4a7.length;i++){\nvar _4a9=$.extend({},_4a7[i],{parent:_4a8});\nif(_4a9.children&&_4a9.children.length){\n_4a9.id=_4a9.id||("menu_id_"+($.fn.menu.defaults.zIndex++));\n_4aa(_4a6,_4a9);\n_4a5(_4a6,_4a9.children,$("#"+_4a9.id)[0]);\n}else{\n_4aa(_4a6,_4a9);\n}\n}\n};\nfunction _4aa(_4ab,_4ac){\nvar opts=$.data(_4ab,"menu").options;\nvar menu=$(_4ab);\nif(_4ac.parent){\nif(!_4ac.parent.submenu){\nvar _4ad=$("<div></div>").appendTo("body");\n_4ac.parent.submenu=_4ad;\n$("<div class=\\"menu-rightarrow\\"></div>").appendTo(_4ac.parent);\n_470(_4ab,_4ad);\n}\nmenu=_4ac.parent.submenu;\n}\nvar div=$("<div></div>").appendTo(menu);\n_472(_4ab,div,_4ac);\n};\nfunction _4ae(_4af,_4b0){\nfunction _4b1(el){\nif(el.submenu){\nel.submenu.children("div.menu-item").each(function(){\n_4b1(this);\n});\nvar _4b2=el.submenu[0].shadow;\nif(_4b2){\n_4b2.remove();\n}\nel.submenu.remove();\n}\n$(el).remove();\n};\n_4b1(_4b0);\n};\nfunction _4b3(_4b4,_4b5,_4b6){\nvar menu=$(_4b5).parent();\nif(_4b6){\n$(_4b5).show();\n}else{\n$(_4b5).hide();\n}\n_473(_4b4,menu);\n};\nfunction _4b7(_4b8){\n$(_4b8).children("div.menu-item").each(function(){\n_4ae(_4b8,this);\n});\nif(_4b8.shadow){\n_4b8.shadow.remove();\n}\n$(_4b8).remove();\n};\n$.fn.menu=function(_4b9,_4ba){\nif(typeof _4b9=="string"){\nreturn $.fn.menu.methods[_4b9](this,_4ba);\n}\n_4b9=_4b9||{};\nreturn this.each(function(){\nvar _4bb=$.data(this,"menu");\nif(_4bb){\n$.extend(_4bb.options,_4b9);\n}else{\n_4bb=$.data(this,"menu",{options:$.extend({},$.fn.menu.defaults,$.fn.menu.parseOptions(this),_4b9)});\ninit(this);\n}\n$(this).css({left:_4bb.options.left,top:_4bb.options.top});\n});\n};\n$.fn.menu.methods={options:function(jq){\nreturn $.data(jq[0],"menu").options;\n},show:function(jq,pos){\nreturn jq.each(function(){\n_495(this,pos);\n});\n},hide:function(jq){\nreturn jq.each(function(){\n_489(this);\n});\n},clear:function(jq){\nreturn jq.each(function(){\nvar _4bc=this;\n$(_4bc).children(".menu-item,.menu-sep").each(function(){\n_4ae(_4bc,this);\n});\n});\n},destroy:function(jq){\nreturn jq.each(function(){\n_4b7(this);\n});\n},setText:function(jq,_4bd){\nreturn jq.each(function(){\nvar item=$(_4bd.target).data("menuitem").options;\nitem.text=_4bd.text;\n$(_4bd.target).children("div.menu-text").html(_4bd.text);\n});\n},setIcon:function(jq,_4be){\nreturn jq.each(function(){\nvar item=$(_4be.target).data("menuitem").options;\nitem.iconCls=_4be.iconCls;\n$(_4be.target).children("div.menu-icon").remove();\nif(_4be.iconCls){\n$("<div class=\\"menu-icon\\"></div>").addClass(_4be.iconCls).appendTo(_4be.target);\n}\n});\n},getItem:function(jq,_4bf){\nvar item=$(_4bf).data("menuitem").options;\nreturn $.extend({},item,{target:$(_4bf)[0]});\n},findItem:function(jq,text){\nvar _4c0=jq.menu("findItems",text);\nreturn _4c0.length?_4c0[0]:null;\n},findItems:function(jq,text){\nif(typeof text=="string"){\nreturn _49c(jq[0],function(item){\nreturn $("<div>"+item.text+"</div>").text()==text;\n});\n}else{\nreturn _49c(jq[0],text);\n}\n},navItems:function(jq,cb){\nreturn jq.each(function(){\n_4a0(this,cb);\n});\n},appendItems:function(jq,_4c1){\nreturn jq.each(function(){\n_4a5(this,_4c1);\n});\n},appendItem:function(jq,_4c2){\nreturn jq.each(function(){\n_4aa(this,_4c2);\n});\n},removeItem:function(jq,_4c3){\nreturn jq.each(function(){\n_4ae(this,_4c3);\n});\n},enableItem:function(jq,_4c4){\nreturn jq.each(function(){\n_478(this,_4c4,false);\n});\n},disableItem:function(jq,_4c5){\nreturn jq.each(function(){\n_478(this,_4c5,true);\n});\n},showItem:function(jq,_4c6){\nreturn jq.each(function(){\n_4b3(this,_4c6,true);\n});\n},hideItem:function(jq,_4c7){\nreturn jq.each(function(){\n_4b3(this,_4c7,false);\n});\n},resize:function(jq,_4c8){\nreturn jq.each(function(){\n_473(this,_4c8?$(_4c8):$(this));\n});\n}};\n$.fn.menu.parseOptions=function(_4c9){\nreturn $.extend({},$.parser.parseOptions(_4c9,[{minWidth:"number",itemHeight:"number",duration:"number",hideOnUnhover:"boolean"},{fit:"boolean",inline:"boolean",noline:"boolean"}]));\n};\n$.fn.menu.defaults={zIndex:110000,left:0,top:0,alignTo:null,align:"left",minWidth:150,itemHeight:32,duration:100,hideOnUnhover:true,inline:false,fit:false,noline:false,events:{mouseenter:_483,mouseleave:_486,mouseover:_48a,mouseout:_48d,click:_48f},position:function(_4ca,left,top){\nreturn {left:left,top:top};\n},onShow:function(){\n},onHide:function(){\n},onClick:function(item){\n}};\n})(jQuery);\n(function($){\nvar _4cb=1;\nfunction init(_4cc){\n$(_4cc).addClass("sidemenu");\n};\nfunction _4cd(_4ce,_4cf){\nvar opts=$(_4ce).sidemenu("options");\nif(_4cf){\n$.extend(opts,{width:_4cf.width,height:_4cf.height});\n}\n$(_4ce)._size(opts);\n$(_4ce).find(".accordion").accordion("resize");\n};\nfunction _4d0(_4d1,_4d2,data){\nvar opts=$(_4d1).sidemenu("options");\nvar tt=$("<ul class=\\"sidemenu-tree\\"></ul>").appendTo(_4d2);\ntt.tree({data:data,animate:opts.animate,onBeforeSelect:function(node){\nif(node.children){\nreturn false;\n}\n},onSelect:function(node){\n_4d3(_4d1,node.id,true);\n},onExpand:function(node){\n_4e0(_4d1,node);\n},onCollapse:function(node){\n_4e0(_4d1,node);\n},onClick:function(node){\nif(node.children){\nif(node.state=="open"){\n$(node.target).addClass("tree-node-nonleaf-collapsed");\n}else{\n$(node.target).removeClass("tree-node-nonleaf-collapsed");\n}\n$(this).tree("toggle",node.target);\n}\n}});\ntt._unbind(".sidemenu")._bind("mouseleave.sidemenu",function(){\n$(_4d2).trigger("mouseleave");\n});\n_4d3(_4d1,opts.selectedItemId);\n};\nfunction _4d4(_4d5,_4d6,data){\nvar opts=$(_4d5).sidemenu("options");\n$(_4d6).tooltip({content:$("<div></div>"),position:opts.floatMenuPosition,valign:"top",data:data,onUpdate:function(_4d7){\nvar _4d8=$(this).tooltip("options");\nvar data=_4d8.data;\n_4d7.accordion({width:opts.floatMenuWidth,multiple:false}).accordion("add",{title:data.text,collapsed:false,collapsible:false});\n_4d0(_4d5,_4d7.accordion("panels")[0],data.children);\n},onShow:function(){\nvar t=$(this);\nvar tip=t.tooltip("tip").addClass("sidemenu-tooltip");\ntip.children(".tooltip-content").addClass("sidemenu");\ntip.find(".accordion").accordion("resize");\ntip.add(tip.find("ul.tree"))._unbind(".sidemenu")._bind("mouseover.sidemenu",function(){\nt.tooltip("show");\n})._bind("mouseleave.sidemenu",function(){\nt.tooltip("hide");\n});\nt.tooltip("reposition");\n},onPosition:function(left,top){\nvar tip=$(this).tooltip("tip");\nif(!opts.collapsed){\ntip.css({left:-999999});\n}else{\nif(top+tip.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()){\ntop=$(window)._outerHeight()+$(document).scrollTop()-tip.outerHeight();\ntip.css("top",top);\n}\n}\n}});\n};\nfunction _4d9(_4da,_4db){\n$(_4da).find(".sidemenu-tree").each(function(){\n_4db($(this));\n});\n$(_4da).find(".tooltip-f").each(function(){\nvar tip=$(this).tooltip("tip");\nif(tip){\ntip.find(".sidemenu-tree").each(function(){\n_4db($(this));\n});\n$(this).tooltip("reposition");\n}\n});\n};\nfunction _4d3(_4dc,_4dd,_4de){\nvar _4df=null;\nvar opts=$(_4dc).sidemenu("options");\n_4d9(_4dc,function(t){\nt.find("div.tree-node-selected").removeClass("tree-node-selected");\nvar node=t.tree("find",_4dd);\nif(node){\n$(node.target).addClass("tree-node-selected");\nopts.selectedItemId=node.id;\nt.trigger("mouseleave.sidemenu");\n_4df=node;\n}\n});\nif(_4de&&_4df){\nopts.onSelect.call(_4dc,_4df);\n}\n};\nfunction _4e0(_4e1,item){\n_4d9(_4e1,function(t){\nvar node=t.tree("find",item.id);\nif(node){\nvar _4e2=t.tree("options");\nvar _4e3=_4e2.animate;\n_4e2.animate=false;\nt.tree(item.state=="open"?"expand":"collapse",node.target);\n_4e2.animate=_4e3;\n}\n});\n};\nfunction _4e4(_4e5){\nvar opts=$(_4e5).sidemenu("options");\n$(_4e5).empty();\nif(opts.data){\n$.easyui.forEach(opts.data,true,function(node){\nif(!node.id){\nnode.id="_easyui_sidemenu_"+(_4cb++);\n}\nif(!node.iconCls){\nnode.iconCls="sidemenu-default-icon";\n}\nif(node.children){\nnode.nodeCls="tree-node-nonleaf";\nif(!node.state){\nnode.state="closed";\n}\nif(node.state=="open"){\nnode.nodeCls="tree-node-nonleaf";\n}else{\nnode.nodeCls="tree-node-nonleaf tree-node-nonleaf-collapsed";\n}\n}\n});\nvar acc=$("<div></div>").appendTo(_4e5);\nacc.accordion({fit:opts.height=="auto"?false:true,border:opts.border,multiple:opts.multiple});\nvar data=opts.data;\nfor(var i=0;i<data.length;i++){\nacc.accordion("add",{title:data[i].text,selected:data[i].state=="open",iconCls:data[i].iconCls,onBeforeExpand:function(){\nreturn !opts.collapsed;\n}});\nvar ap=acc.accordion("panels")[i];\n_4d0(_4e5,ap,data[i].children);\n_4d4(_4e5,ap.panel("header"),data[i]);\n}\n}\n};\nfunction _4e6(_4e7,_4e8){\nvar opts=$(_4e7).sidemenu("options");\nopts.collapsed=_4e8;\nvar acc=$(_4e7).find(".accordion");\nvar _4e9=acc.accordion("panels");\nacc.accordion("options").animate=false;\nif(opts.collapsed){\n$(_4e7).addClass("sidemenu-collapsed");\nfor(var i=0;i<_4e9.length;i++){\nvar _4ea=_4e9[i];\nif(_4ea.panel("options").collapsed){\nopts.data[i].state="closed";\n}else{\nopts.data[i].state="open";\nacc.accordion("unselect",i);\n}\nvar _4eb=_4ea.panel("header");\n_4eb.find(".panel-title").html("");\n_4eb.find(".panel-tool").hide();\n}\n}else{\n$(_4e7).removeClass("sidemenu-collapsed");\nfor(var i=0;i<_4e9.length;i++){\nvar _4ea=_4e9[i];\nif(opts.data[i].state=="open"){\nacc.accordion("select",i);\n}\nvar _4eb=_4ea.panel("header");\n_4eb.find(".panel-title").html(_4ea.panel("options").title);\n_4eb.find(".panel-tool").show();\n}\n}\nacc.accordion("options").animate=opts.animate;\n};\nfunction _4ec(_4ed){\n$(_4ed).find(".tooltip-f").each(function(){\n$(this).tooltip("destroy");\n});\n$(_4ed).remove();\n};\n$.fn.sidemenu=function(_4ee,_4ef){\nif(typeof _4ee=="string"){\nvar _4f0=$.fn.sidemenu.methods[_4ee];\nreturn _4f0(this,_4ef);\n}\n_4ee=_4ee||{};\nreturn this.each(function(){\nvar _4f1=$.data(this,"sidemenu");\nif(_4f1){\n$.extend(_4f1.options,_4ee);\n}else{\n_4f1=$.data(this,"sidemenu",{options:$.extend({},$.fn.sidemenu.defaults,$.fn.sidemenu.parseOptions(this),_4ee)});\ninit(this);\n}\n_4cd(this);\n_4e4(this);\n_4e6(this,_4f1.options.collapsed);\n});\n};\n$.fn.sidemenu.methods={options:function(jq){\nreturn jq.data("sidemenu").options;\n},resize:function(jq,_4f2){\nreturn jq.each(function(){\n_4cd(this,_4f2);\n});\n},collapse:function(jq){\nreturn jq.each(function(){\n_4e6(this,true);\n});\n},expand:function(jq){\nreturn jq.each(function(){\n_4e6(this,false);\n});\n},destroy:function(jq){\nreturn jq.each(function(){\n_4ec(this);\n});\n}};\n$.fn.sidemenu.parseOptions=function(_4f3){\nvar t=$(_4f3);\nreturn $.extend({},$.parser.parseOptions(_4f3,["width","height"]));\n};\n$.fn.sidemenu.defaults={width:200,height:"auto",border:true,animate:true,multiple:true,collapsed:false,data:null,floatMenuWidth:200,floatMenuPosition:"right",onSelect:function(item){\n}};\n})(jQuery);\n(function($){\nfunction init(_4f4){\nvar opts=$.data(_4f4,"menubutton").options;\nvar btn=$(_4f4);\nbtn.linkbutton(opts);\nif(opts.hasDownArrow){\nbtn.removeClass(opts.cls.btn1+" "+opts.cls.btn2).addClass("m-btn");\nbtn.removeClass("m-btn-small m-btn-medium m-btn-large").addClass("m-btn-"+opts.size);\nvar _4f5=btn.find(".l-btn-left");\n$("<span></span>").addClass(opts.cls.arrow).appendTo(_4f5);\n$("<span></span>").addClass("m-btn-line").appendTo(_4f5);\n}\n$(_4f4).menubutton("resize");\nif(opts.menu){\nif(typeof opts.menu=="string"){\n$(opts.menu).menu({duration:opts.duration});\n}else{\nif(!(opts.menu instanceof jQuery)){\nvar _4f6=opts.menu;\nopts.menu=$("<div></div>").appendTo("body").menu({duration:opts.duration});\nopts.menu.menu("appendItems",_4f6);\n}\n}\nvar _4f7=$(opts.menu).menu("options");\nvar _4f8=_4f7.onShow;\nvar _4f9=_4f7.onHide;\n$.extend(_4f7,{onShow:function(){\nvar _4fa=$(this).menu("options");\nvar btn=$(_4fa.alignTo);\nvar opts=btn.menubutton("options");\nbtn.addClass((opts.plain==true)?opts.cls.btn2:opts.cls.btn1);\n_4f8.call(this);\n},onHide:function(){\nvar _4fb=$(this).menu("options");\nvar btn=$(_4fb.alignTo);\nvar opts=btn.menubutton("options");\nbtn.removeClass((opts.plain==true)?opts.cls.btn2:opts.cls.btn1);\n_4f9.call(this);\n}});\n}\n};\nfunction _4fc(_4fd){\nvar opts=$.data(_4fd,"menubutton").options;\nvar btn=$(_4fd);\nvar t=btn.find("."+opts.cls.trigger);\nif(!t.length){\nt=btn;\n}\nt._unbind(".menubutton");\nvar _4fe=null;\nt._bind(opts.showEvent+".menubutton",function(){\nif(!_4ff()){\n_4fe=setTimeout(function(){\n_500(_4fd);\n},opts.duration);\nreturn false;\n}\n})._bind(opts.hideEvent+".menubutton",function(){\nif(_4fe){\nclearTimeout(_4fe);\n}\n$(opts.menu).triggerHandler("mouseleave");\n});\nfunction _4ff(){\nreturn $(_4fd).linkbutton("options").disabled;\n};\n};\nfunction _500(_501){\nvar opts=$(_501).menubutton("options");\nif(opts.disabled||!opts.menu){\nreturn;\n}\n$("body>div.menu-top").menu("hide");\nvar btn=$(_501);\nvar mm=$(opts.menu);\nif(mm.length){\nmm.menu("options").alignTo=btn;\nmm.menu("show",{alignTo:btn,align:opts.menuAlign});\n}\nbtn.blur();\n};\n$.fn.menubutton=function(_502,_503){\nif(typeof _502=="string"){\nvar _504=$.fn.menubutton.methods[_502];\nif(_504){\nreturn _504(this,_503);\n}else{\nreturn this.linkbutton(_502,_503);\n}\n}\n_502=_502||{};\nreturn this.each(function(){\nvar _505=$.data(this,"menubutton");\nif(_505){\n$.extend(_505.options,_502);\n}else{\n$.data(this,"menubutton",{options:$.extend({},$.fn.menubutton.defaults,$.fn.menubutton.parseOptions(this),_502)});\n$(this)._propAttr("disabled",false);\n}\ninit(this);\n_4fc(this);\n});\n};\n$.fn.menubutton.methods={options:function(jq){\nvar _506=jq.linkbutton("options");\nreturn $.extend($.data(jq[0],"menubutton").options,{toggle:_506.toggle,selected:_506.selected,disabled:_506.disabled});\n},destroy:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).menubutton("options");\nif(opts.menu){\n$(opts.menu).menu("destroy");\n}\n$(this).remove();\n});\n}};\n$.fn.menubutton.parseOptions=function(_507){\nvar t=$(_507);\nreturn $.extend({},$.fn.linkbutton.parseOptions(_507),$.parser.parseOptions(_507,["menu",{plain:"boolean",hasDownArrow:"boolean",duration:"number"}]));\n};\n$.fn.menubutton.defaults=$.extend({},$.fn.linkbutton.defaults,{plain:true,hasDownArrow:true,menu:null,menuAlign:"left",duration:100,showEvent:"mouseenter",hideEvent:"mouseleave",cls:{btn1:"m-btn-active",btn2:"m-btn-plain-active",arrow:"m-btn-downarrow",trigger:"m-btn"}});\n})(jQuery);\n(function($){\nfunction init(_508){\nvar opts=$.data(_508,"splitbutton").options;\n$(_508).menubutton(opts);\n$(_508).addClass("s-btn");\n};\n$.fn.splitbutton=function(_509,_50a){\nif(typeof _509=="string"){\nvar _50b=$.fn.splitbutton.methods[_509];\nif(_50b){\nreturn _50b(this,_50a);\n}else{\nreturn this.menubutton(_509,_50a);\n}\n}\n_509=_509||{};\nreturn this.each(function(){\nvar _50c=$.data(this,"splitbutton");\nif(_50c){\n$.extend(_50c.options,_509);\n}else{\n$.data(this,"splitbutton",{options:$.extend({},$.fn.splitbutton.defaults,$.fn.splitbutton.parseOptions(this),_509)});\n$(this)._propAttr("disabled",false);\n}\ninit(this);\n});\n};\n$.fn.splitbutton.methods={options:function(jq){\nvar _50d=jq.menubutton("options");\nvar _50e=$.data(jq[0],"splitbutton").options;\n$.extend(_50e,{disabled:_50d.disabled,toggle:_50d.toggle,selected:_50d.selected});\nreturn _50e;\n}};\n$.fn.splitbutton.parseOptions=function(_50f){\nvar t=$(_50f);\nreturn $.extend({},$.fn.linkbutton.parseOptions(_50f),$.parser.parseOptions(_50f,["menu",{plain:"boolean",duration:"number"}]));\n};\n$.fn.splitbutton.defaults=$.extend({},$.fn.linkbutton.defaults,{plain:true,menu:null,duration:100,cls:{btn1:"m-btn-active s-btn-active",btn2:"m-btn-plain-active s-btn-plain-active",arrow:"m-btn-downarrow",trigger:"m-btn-line"}});\n})(jQuery);\n(function($){\nvar _510=1;\nfunction init(_511){\nvar _512=$("<span class=\\"switchbutton\\">"+"<span class=\\"switchbutton-inner\\">"+"<span class=\\"switchbutton-on\\"></span>"+"<span class=\\"switchbutton-handle\\"></span>"+"<span class=\\"switchbutton-off\\"></span>"+"<input class=\\"switchbutton-value\\" type=\\"checkbox\\" tabindex=\\"-1\\">"+"</span>"+"</span>").insertAfter(_511);\nvar t=$(_511);\nt.addClass("switchbutton-f").hide();\nvar name=t.attr("name");\nif(name){\nt.removeAttr("name").attr("switchbuttonName",name);\n_512.find(".switchbutton-value").attr("name",name);\n}\n_512._bind("_resize",function(e,_513){\nif($(this).hasClass("easyui-fluid")||_513){\n_514(_511);\n}\nreturn false;\n});\nreturn _512;\n};\nfunction _514(_515,_516){\nvar _517=$.data(_515,"switchbutton");\nvar opts=_517.options;\nvar _518=_517.switchbutton;\nif(_516){\n$.extend(opts,_516);\n}\nvar _519=_518.is(":visible");\nif(!_519){\n_518.appendTo("body");\n}\n_518._size(opts);\nif(opts.label&&opts.labelPosition){\nif(opts.labelPosition=="top"){\n_517.label._size({width:opts.labelWidth},_518);\n}else{\n_517.label._size({width:opts.labelWidth,height:_518.outerHeight()},_518);\n_517.label.css("lineHeight",_518.outerHeight()+"px");\n}\n}\nvar w=_518.width();\nvar h=_518.height();\nvar w=_518.outerWidth();\nvar h=_518.outerHeight();\nvar _51a=parseInt(opts.handleWidth)||_518.height();\nvar _51b=w*2-_51a;\n_518.find(".switchbutton-inner").css({width:_51b+"px",height:h+"px",lineHeight:h+"px"});\n_518.find(".switchbutton-handle")._outerWidth(_51a)._outerHeight(h).css({marginLeft:-_51a/2+"px"});\n_518.find(".switchbutton-on").css({width:(w-_51a/2)+"px",textIndent:(opts.reversed?"":"-")+_51a/2+"px"});\n_518.find(".switchbutton-off").css({width:(w-_51a/2)+"px",textIndent:(opts.reversed?"-":"")+_51a/2+"px"});\nopts.marginWidth=w-_51a;\n_51c(_515,opts.checked,false);\nif(!_519){\n_518.insertAfter(_515);\n}\n};\nfunction _51d(_51e){\nvar _51f=$.data(_51e,"switchbutton");\nvar opts=_51f.options;\nvar _520=_51f.switchbutton;\nvar _521=_520.find(".switchbutton-inner");\nvar on=_521.find(".switchbutton-on").html(opts.onText);\nvar off=_521.find(".switchbutton-off").html(opts.offText);\nvar _522=_521.find(".switchbutton-handle").html(opts.handleText);\nif(opts.reversed){\noff.prependTo(_521);\non.insertAfter(_522);\n}else{\non.prependTo(_521);\noff.insertAfter(_522);\n}\nvar _523="_easyui_switchbutton_"+(++_510);\nvar _524=_520.find(".switchbutton-value")._propAttr("checked",opts.checked).attr("id",_523);\n_524._unbind(".switchbutton")._bind("change.switchbutton",function(e){\nreturn false;\n});\n_520.removeClass("switchbutton-reversed").addClass(opts.reversed?"switchbutton-reversed":"");\nif(opts.label){\nif(typeof opts.label=="object"){\n_51f.label=$(opts.label);\n_51f.label.attr("for",_523);\n}else{\n$(_51f.label).remove();\n_51f.label=$("<label class=\\"textbox-label\\"></label>").html(opts.label);\n_51f.label.css("textAlign",opts.labelAlign).attr("for",_523);\nif(opts.labelPosition=="after"){\n_51f.label.insertAfter(_520);\n}else{\n_51f.label.insertBefore(_51e);\n}\n_51f.label.removeClass("textbox-label-left textbox-label-right textbox-label-top");\n_51f.label.addClass("textbox-label-"+opts.labelPosition);\n}\n}else{\n$(_51f.label).remove();\n}\n_51c(_51e,opts.checked);\n_525(_51e,opts.readonly);\n_526(_51e,opts.disabled);\n$(_51e).switchbutton("setValue",opts.value);\n};\nfunction _51c(_527,_528,_529){\nvar _52a=$.data(_527,"switchbutton");\nvar opts=_52a.options;\nvar _52b=_52a.switchbutton.find(".switchbutton-inner");\nvar _52c=_52b.find(".switchbutton-on");\nvar _52d=opts.reversed?(_528?opts.marginWidth:0):(_528?0:opts.marginWidth);\nvar dir=_52c.css("float").toLowerCase();\nvar css={};\ncss["margin-"+dir]=-_52d+"px";\n_529?_52b.animate(css,200):_52b.css(css);\nvar _52e=_52b.find(".switchbutton-value");\n$(_527).add(_52e)._propAttr("checked",_528);\nif(opts.checked!=_528){\nopts.checked=_528;\nopts.onChange.call(_527,opts.checked);\n$(_527).closest("form").trigger("_change",[_527]);\n}\n};\nfunction _526(_52f,_530){\nvar _531=$.data(_52f,"switchbutton");\nvar opts=_531.options;\nvar _532=_531.switchbutton;\nvar _533=_532.find(".switchbutton-value");\nif(_530){\nopts.disabled=true;\n$(_52f).add(_533)._propAttr("disabled",true);\n_532.addClass("switchbutton-disabled");\n_532.removeAttr("tabindex");\n}else{\nopts.disabled=false;\n$(_52f).add(_533)._propAttr("disabled",false);\n_532.removeClass("switchbutton-disabled");\n_532.attr("tabindex",$(_52f).attr("tabindex")||"");\n}\n};\nfunction _525(_534,mode){\nvar _535=$.data(_534,"switchbutton");\nvar opts=_535.options;\nopts.readonly=mode==undefined?true:mode;\n_535.switchbutton.removeClass("switchbutton-readonly").addClass(opts.readonly?"switchbutton-readonly":"");\n};\nfunction _536(_537){\nvar _538=$.data(_537,"switchbutton");\nvar opts=_538.options;\n_538.switchbutton._unbind(".switchbutton")._bind("click.switchbutton",function(){\nif(!opts.disabled&&!opts.readonly){\n_51c(_537,opts.checked?false:true,true);\n}\n})._bind("keydown.switchbutton",function(e){\nif(e.which==13||e.which==32){\nif(!opts.disabled&&!opts.readonly){\n_51c(_537,opts.checked?false:true,true);\nreturn false;\n}\n}\n});\n};\n$.fn.switchbutton=function(_539,_53a){\nif(typeof _539=="string"){\nreturn $.fn.switchbutton.methods[_539](this,_53a);\n}\n_539=_539||{};\nreturn this.each(function(){\nvar _53b=$.data(this,"switchbutton");\nif(_53b){\n$.extend(_53b.options,_539);\n}else{\n_53b=$.data(this,"switchbutton",{options:$.extend({},$.fn.switchbutton.defaults,$.fn.switchbutton.parseOptions(this),_539),switchbutton:init(this)});\n}\n_53b.options.originalChecked=_53b.options.checked;\n_51d(this);\n_514(this);\n_536(this);\n});\n};\n$.fn.switchbutton.methods={options:function(jq){\nvar _53c=jq.data("switchbutton");\nreturn $.extend(_53c.options,{value:_53c.switchbutton.find(".switchbutton-value").val()});\n},resize:function(jq,_53d){\nreturn jq.each(function(){\n_514(this,_53d);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_526(this,false);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_526(this,true);\n});\n},readonly:function(jq,mode){\nreturn jq.each(function(){\n_525(this,mode);\n});\n},check:function(jq){\nreturn jq.each(function(){\n_51c(this,true);\n});\n},uncheck:function(jq){\nreturn jq.each(function(){\n_51c(this,false);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_51c(this,false);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).switchbutton("options");\n_51c(this,opts.originalChecked);\n});\n},setValue:function(jq,_53e){\nreturn jq.each(function(){\n$(this).val(_53e);\n$.data(this,"switchbutton").switchbutton.find(".switchbutton-value").val(_53e);\n});\n}};\n$.fn.switchbutton.parseOptions=function(_53f){\nvar t=$(_53f);\nreturn $.extend({},$.parser.parseOptions(_53f,["onText","offText","handleText",{handleWidth:"number",reversed:"boolean"},"label","labelPosition","labelAlign",{labelWidth:"number"}]),{value:(t.val()||undefined),checked:(t.attr("checked")?true:undefined),disabled:(t.attr("disabled")?true:undefined),readonly:(t.attr("readonly")?true:undefined)});\n};\n$.fn.switchbutton.defaults={handleWidth:"auto",width:60,height:30,checked:false,disabled:false,readonly:false,reversed:false,onText:"ON",offText:"OFF",handleText:"",value:"on",label:null,labelWidth:"auto",labelPosition:"before",labelAlign:"left",onChange:function(_540){\n}};\n})(jQuery);\n(function($){\nvar _541=1;\nfunction init(_542){\nvar _543=$("<span class=\\"radiobutton inputbox\\">"+"<span class=\\"radiobutton-inner\\" style=\\"display:none\\"></span>"+"<input type=\\"radio\\" class=\\"radiobutton-value\\">"+"</span>").insertAfter(_542);\nvar t=$(_542);\nt.addClass("radiobutton-f").hide();\nvar name=t.attr("name");\nif(name){\nt.removeAttr("name").attr("radiobuttonName",name);\n_543.find(".radiobutton-value").attr("name",name);\n}\nreturn _543;\n};\nfunction _544(_545){\nvar _546=$.data(_545,"radiobutton");\nvar opts=_546.options;\nvar _547=_546.radiobutton;\nvar _548="_easyui_radiobutton_"+(++_541);\nvar _549=_547.find(".radiobutton-value").attr("id",_548);\n_549._unbind(".radiobutton")._bind("change.radiobutton",function(e){\nreturn false;\n});\nif(opts.label){\nif(typeof opts.label=="object"){\n_546.label=$(opts.label);\n_546.label.attr("for",_548);\n}else{\n$(_546.label).remove();\n_546.label=$("<label class=\\"textbox-label\\"></label>").html(opts.label);\n_546.label.css("textAlign",opts.labelAlign).attr("for",_548);\nif(opts.labelPosition=="after"){\n_546.label.insertAfter(_547);\n}else{\n_546.label.insertBefore(_545);\n}\n_546.label.removeClass("textbox-label-left textbox-label-right textbox-label-top");\n_546.label.addClass("textbox-label-"+opts.labelPosition);\n}\n}else{\n$(_546.label).remove();\n}\n$(_545).radiobutton("setValue",opts.value);\n_54a(_545,opts.checked);\n_54b(_545,opts.readonly);\n_54c(_545,opts.disabled);\n};\nfunction _54d(_54e){\nvar _54f=$.data(_54e,"radiobutton");\nvar opts=_54f.options;\nvar _550=_54f.radiobutton;\n_550._unbind(".radiobutton")._bind("click.radiobutton",function(){\nif(!opts.disabled&&!opts.readonly){\n_54a(_54e,true);\n}\n});\n};\nfunction _551(_552){\nvar _553=$.data(_552,"radiobutton");\nvar opts=_553.options;\nvar _554=_553.radiobutton;\n_554._size(opts,_554.parent());\nif(opts.label&&opts.labelPosition){\nif(opts.labelPosition=="top"){\n_553.label._size({width:opts.labelWidth},_554);\n}else{\n_553.label._size({width:opts.labelWidth,height:_554.outerHeight()},_554);\n_553.label.css("lineHeight",_554.outerHeight()+"px");\n}\n}\n};\nfunction _54a(_555,_556){\nif(_556){\nvar f=$(_555).closest("form");\nvar name=$(_555).attr("radiobuttonName");\nf.find(".radiobutton-f[radiobuttonName=\\""+name+"\\"]").each(function(){\nif(this!=_555){\n_557(this,false);\n}\n});\n_557(_555,true);\n}else{\n_557(_555,false);\n}\nfunction _557(b,c){\nvar _558=$(b).data("radiobutton");\nvar opts=_558.options;\nvar _559=_558.radiobutton;\n_559.find(".radiobutton-inner").css("display",c?"":"none");\n_559.find(".radiobutton-value")._propAttr("checked",c);\nif(c){\n_559.addClass("radiobutton-checked");\n$(_558.label).addClass("textbox-label-checked");\n}else{\n_559.removeClass("radiobutton-checked");\n$(_558.label).removeClass("textbox-label-checked");\n}\nif(opts.checked!=c){\nopts.checked=c;\nopts.onChange.call($(b)[0],c);\n$(b).closest("form").trigger("_change",[$(b)[0]]);\n}\n};\n};\nfunction _54c(_55a,_55b){\nvar _55c=$.data(_55a,"radiobutton");\nvar opts=_55c.options;\nvar _55d=_55c.radiobutton;\nvar rv=_55d.find(".radiobutton-value");\nopts.disabled=_55b;\nif(_55b){\n$(_55a).add(rv)._propAttr("disabled",true);\n_55d.addClass("radiobutton-disabled");\n$(_55c.label).addClass("textbox-label-disabled");\n}else{\n$(_55a).add(rv)._propAttr("disabled",false);\n_55d.removeClass("radiobutton-disabled");\n$(_55c.label).removeClass("textbox-label-disabled");\n}\n};\nfunction _54b(_55e,mode){\nvar _55f=$.data(_55e,"radiobutton");\nvar opts=_55f.options;\nopts.readonly=mode==undefined?true:mode;\nif(opts.readonly){\n_55f.radiobutton.addClass("radiobutton-readonly");\n$(_55f.label).addClass("textbox-label-readonly");\n}else{\n_55f.radiobutton.removeClass("radiobutton-readonly");\n$(_55f.label).removeClass("textbox-label-readonly");\n}\n};\n$.fn.radiobutton=function(_560,_561){\nif(typeof _560=="string"){\nreturn $.fn.radiobutton.methods[_560](this,_561);\n}\n_560=_560||{};\nreturn this.each(function(){\nvar _562=$.data(this,"radiobutton");\nif(_562){\n$.extend(_562.options,_560);\n}else{\n_562=$.data(this,"radiobutton",{options:$.extend({},$.fn.radiobutton.defaults,$.fn.radiobutton.parseOptions(this),_560),radiobutton:init(this)});\n}\n_562.options.originalChecked=_562.options.checked;\n_544(this);\n_54d(this);\n_551(this);\n});\n};\n$.fn.radiobutton.methods={options:function(jq){\nvar _563=jq.data("radiobutton");\nreturn $.extend(_563.options,{value:_563.radiobutton.find(".radiobutton-value").val()});\n},setValue:function(jq,_564){\nreturn jq.each(function(){\n$(this).val(_564);\n$.data(this,"radiobutton").radiobutton.find(".radiobutton-value").val(_564);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_54c(this,false);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_54c(this,true);\n});\n},readonly:function(jq,mode){\nreturn jq.each(function(){\n_54b(this,mode);\n});\n},check:function(jq){\nreturn jq.each(function(){\n_54a(this,true);\n});\n},uncheck:function(jq){\nreturn jq.each(function(){\n_54a(this,false);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_54a(this,false);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).radiobutton("options");\n_54a(this,opts.originalChecked);\n});\n}};\n$.fn.radiobutton.parseOptions=function(_565){\nvar t=$(_565);\nreturn $.extend({},$.parser.parseOptions(_565,["label","labelPosition","labelAlign",{labelWidth:"number"}]),{value:(t.val()||undefined),checked:(t.attr("checked")?true:undefined),disabled:(t.attr("disabled")?true:undefined),readonly:(t.attr("readonly")?true:undefined)});\n};\n$.fn.radiobutton.defaults={width:20,height:20,value:null,disabled:false,readonly:false,checked:false,label:null,labelWidth:"auto",labelPosition:"before",labelAlign:"left",onChange:function(_566){\n}};\n})(jQuery);\n(function($){\nvar _567=1;\nfunction init(_568){\nvar _569=$("<span class=\\"checkbox inputbox\\">"+"<span class=\\"checkbox-inner\\">"+"<svg xml:space=\\"preserve\\" focusable=\\"false\\" version=\\"1.1\\" viewBox=\\"0 0 24 24\\"><path d=\\"M4.1,12.7 9,17.6 20.3,6.3\\" fill=\\"none\\" stroke=\\"white\\"></path></svg>"+"</span>"+"<input type=\\"checkbox\\" class=\\"checkbox-value\\">"+"</span>").insertAfter(_568);\nvar t=$(_568);\nt.addClass("checkbox-f").hide();\nvar name=t.attr("name");\nif(name){\nt.removeAttr("name").attr("checkboxName",name);\n_569.find(".checkbox-value").attr("name",name);\n}\nreturn _569;\n};\nfunction _56a(_56b){\nvar _56c=$.data(_56b,"checkbox");\nvar opts=_56c.options;\nvar _56d=_56c.checkbox;\nvar _56e="_easyui_checkbox_"+(++_567);\nvar _56f=_56d.find(".checkbox-value").attr("id",_56e);\n_56f._unbind(".checkbox")._bind("change.checkbox",function(e){\nreturn false;\n});\nif(opts.label){\nif(typeof opts.label=="object"){\n_56c.label=$(opts.label);\n_56c.label.attr("for",_56e);\n}else{\n$(_56c.label).remove();\n_56c.label=$("<label class=\\"textbox-label\\"></label>").html(opts.label);\n_56c.label.css("textAlign",opts.labelAlign).attr("for",_56e);\nif(opts.labelPosition=="after"){\n_56c.label.insertAfter(_56d);\n}else{\n_56c.label.insertBefore(_56b);\n}\n_56c.label.removeClass("textbox-label-left textbox-label-right textbox-label-top");\n_56c.label.addClass("textbox-label-"+opts.labelPosition);\n}\n}else{\n$(_56c.label).remove();\n}\n$(_56b).checkbox("setValue",opts.value);\n_570(_56b,opts.checked);\n_571(_56b,opts.readonly);\n_572(_56b,opts.disabled);\n};\nfunction _573(_574){\nvar _575=$.data(_574,"checkbox");\nvar opts=_575.options;\nvar _576=_575.checkbox;\n_576._unbind(".checkbox")._bind("click.checkbox",function(){\nif(!opts.disabled&&!opts.readonly){\n_570(_574,!opts.checked);\n}\n});\n};\nfunction _577(_578){\nvar _579=$.data(_578,"checkbox");\nvar opts=_579.options;\nvar _57a=_579.checkbox;\n_57a._size(opts,_57a.parent());\nif(opts.label&&opts.labelPosition){\nif(opts.labelPosition=="top"){\n_579.label._size({width:opts.labelWidth},_57a);\n}else{\n_579.label._size({width:opts.labelWidth,height:_57a.outerHeight()},_57a);\n_579.label.css("lineHeight",_57a.outerHeight()+"px");\n}\n}\n};\nfunction _570(_57b,_57c){\nvar _57d=$.data(_57b,"checkbox");\nvar opts=_57d.options;\nvar _57e=_57d.checkbox;\n_57e.find(".checkbox-value")._propAttr("checked",_57c);\nvar _57f=_57e.find(".checkbox-inner").css("display",_57c?"":"none");\nif(_57c){\n_57e.addClass("checkbox-checked");\n$(_57d.label).addClass("textbox-label-checked");\n}else{\n_57e.removeClass("checkbox-checked");\n$(_57d.label).removeClass("textbox-label-checked");\n}\nif(opts.checked!=_57c){\nopts.checked=_57c;\nopts.onChange.call(_57b,_57c);\n$(_57b).closest("form").trigger("_change",[_57b]);\n}\n};\nfunction _571(_580,mode){\nvar _581=$.data(_580,"checkbox");\nvar opts=_581.options;\nopts.readonly=mode==undefined?true:mode;\nif(opts.readonly){\n_581.checkbox.addClass("checkbox-readonly");\n$(_581.label).addClass("textbox-label-readonly");\n}else{\n_581.checkbox.removeClass("checkbox-readonly");\n$(_581.label).removeClass("textbox-label-readonly");\n}\n};\nfunction _572(_582,_583){\nvar _584=$.data(_582,"checkbox");\nvar opts=_584.options;\nvar _585=_584.checkbox;\nvar rv=_585.find(".checkbox-value");\nopts.disabled=_583;\nif(_583){\n$(_582).add(rv)._propAttr("disabled",true);\n_585.addClass("checkbox-disabled");\n$(_584.label).addClass("textbox-label-disabled");\n}else{\n$(_582).add(rv)._propAttr("disabled",false);\n_585.removeClass("checkbox-disabled");\n$(_584.label).removeClass("textbox-label-disabled");\n}\n};\n$.fn.checkbox=function(_586,_587){\nif(typeof _586=="string"){\nreturn $.fn.checkbox.methods[_586](this,_587);\n}\n_586=_586||{};\nreturn this.each(function(){\nvar _588=$.data(this,"checkbox");\nif(_588){\n$.extend(_588.options,_586);\n}else{\n_588=$.data(this,"checkbox",{options:$.extend({},$.fn.checkbox.defaults,$.fn.checkbox.parseOptions(this),_586),checkbox:init(this)});\n}\n_588.options.originalChecked=_588.options.checked;\n_56a(this);\n_573(this);\n_577(this);\n});\n};\n$.fn.checkbox.methods={options:function(jq){\nvar _589=jq.data("checkbox");\nreturn $.extend(_589.options,{value:_589.checkbox.find(".checkbox-value").val()});\n},setValue:function(jq,_58a){\nreturn jq.each(function(){\n$(this).val(_58a);\n$.data(this,"checkbox").checkbox.find(".checkbox-value").val(_58a);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_572(this,false);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_572(this,true);\n});\n},readonly:function(jq,mode){\nreturn jq.each(function(){\n_571(this,mode);\n});\n},check:function(jq){\nreturn jq.each(function(){\n_570(this,true);\n});\n},uncheck:function(jq){\nreturn jq.each(function(){\n_570(this,false);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_570(this,false);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).checkbox("options");\n_570(this,opts.originalChecked);\n});\n}};\n$.fn.checkbox.parseOptions=function(_58b){\nvar t=$(_58b);\nreturn $.extend({},$.parser.parseOptions(_58b,["label","labelPosition","labelAlign",{labelWidth:"number"}]),{value:(t.val()||undefined),checked:(t.attr("checked")?true:undefined),disabled:(t.attr("disabled")?true:undefined),readonly:(t.attr("readonly")?true:undefined)});\n};\n$.fn.checkbox.defaults={width:20,height:20,value:null,disabled:false,readonly:false,checked:false,label:null,labelWidth:"auto",labelPosition:"before",labelAlign:"left",onChange:function(_58c){\n}};\n})(jQuery);\n(function($){\nvar _58d=1;\nfunction _58e(_58f){\nvar _590=$.data(_58f,"radiogroup");\nvar opts=_590.options;\n$(_58f).addClass("radiogroup").empty();\nvar c=$("<div></div>").appendTo(_58f);\nif(opts.dir=="h"){\nc.addClass("f-row");\nc.css("flex-wrap","wrap");\n}else{\nc.addClass("f-column");\n}\nvar name=opts.name||("radioname"+_58d++);\nfor(var i=0;i<opts.data.length;i++){\nvar _591=$("<div class=\\"radiogroup-item f-row f-vcenter f-noshrink\\"></div>").appendTo(c);\nif(opts.itemStyle){\n_591.css(opts.itemStyle);\n}\nvar rb=$("<input>").attr("name",name).appendTo(_591);\nrb.radiobutton($.extend({},{labelWidth:opts.labelWidth,labelPosition:opts.labelPosition,labelAlign:opts.labelAlign},opts.data[i],{checked:opts.data[i].value==opts.value,item:opts.data[i],onChange:function(){\nc.find(".radiobutton-f").each(function(){\nvar _592=$(this).radiobutton("options");\nif(_592.checked){\nopts.value=_592.item.value;\nopts.onChange.call(_58f,_592.item.value);\n}\n});\n}}));\nvar _590=rb.data("radiobutton");\nif(_590.options.labelWidth=="auto"){\n$(_590.label).css("width","auto");\n}\n}\n};\nfunction _593(_594,_595){\n$(_594).find(".radiobutton-f").each(function(){\nvar _596=$(this).radiobutton("options");\nif(_596.item.value==_595){\n$(this).radiobutton("check");\n}\n});\n};\n$.fn.radiogroup=function(_597,_598){\nif(typeof _597=="string"){\nreturn $.fn.radiogroup.methods[_597](this,_598);\n}\n_597=_597||{};\nreturn this.each(function(){\nvar _599=$.data(this,"radiogroup");\nif(_599){\n$.extend(_599.options,_597);\n}else{\n_599=$.data(this,"radiogroup",{options:$.extend({},$.fn.radiogroup.defaults,$.fn.radiogroup.parseOptions(this),_597)});\n}\n_58e(this);\n});\n};\n$.fn.radiogroup.methods={options:function(jq){\nreturn jq.data("radiogroup").options;\n},setValue:function(jq,_59a){\nreturn jq.each(function(){\n_593(this,_59a);\n});\n},getValue:function(jq){\nreturn jq.radiogroup("options").value;\n}};\n$.fn.radiogroup.parseOptions=function(_59b){\nreturn $.extend({},$.parser.parseOptions(_59b,["dir","name","value","labelPosition","labelAlign",{labelWidth:"number"}]));\n};\n$.fn.radiogroup.defaults={dir:"h",name:null,value:null,labelWidth:"",labelPosition:"after",labelAlign:"left",itemStyle:{height:30},onChange:function(_59c){\n}};\n})(jQuery);\n(function($){\nvar _59d=1;\nfunction _59e(_59f){\nvar _5a0=$.data(_59f,"checkgroup");\nvar opts=_5a0.options;\n$(_59f).addClass("checkgroup").empty();\nvar c=$("<div></div>").appendTo(_59f);\nif(opts.dir=="h"){\nc.addClass("f-row");\nc.css("flex-wrap","wrap");\n}else{\nc.addClass("f-column");\n}\nvar name=opts.name||("checkname"+_59d++);\nfor(var i=0;i<opts.data.length;i++){\nvar _5a1=$("<div class=\\"checkgroup-item f-row f-vcenter f-noshrink\\"></div>").appendTo(c);\nif(opts.itemStyle){\n_5a1.css(opts.itemStyle);\n}\nvar ck=$("<input>").attr("name",name).appendTo(_5a1);\nck.checkbox($.extend({},{labelWidth:opts.labelWidth,labelPosition:opts.labelPosition,labelAlign:opts.labelAlign},opts.data[i],{checked:$.inArray(opts.data[i].value,opts.value)>=0,item:opts.data[i],onChange:function(){\nvar vv=[];\nc.find(".checkbox-f").each(function(){\nvar _5a2=$(this).checkbox("options");\nif(_5a2.checked){\nvv.push(_5a2.item.value);\n}\n});\nopts.value=vv;\nopts.onChange.call(_59f,vv);\n}}));\nvar _5a0=ck.data("checkbox");\nif(_5a0.options.labelWidth=="auto"){\n$(_5a0.label).css("width","auto");\n}\n}\n};\nfunction _5a3(_5a4,_5a5){\nvar _5a6=$.data(_5a4,"checkgroup");\nvar opts=_5a6.options;\nvar _5a7=opts.onChange;\nopts.onChange=function(){\n};\nvar _5a8=$.extend([],opts.value).sort().join(",");\n$(_5a4).find(".checkbox-f").each(function(){\nvar _5a9=$(this).checkbox("options");\nif($.inArray(_5a9.item.value,_5a5)>=0){\n$(this).checkbox("check");\n}else{\n$(this).checkbox("uncheck");\n}\n});\nopts.onChange=_5a7;\nvar _5aa=$.extend([],opts.value).sort().join(",");\nif(_5aa!=_5a8){\nopts.onChange.call(_5a4,opts.value);\n}\n};\n$.fn.checkgroup=function(_5ab,_5ac){\nif(typeof _5ab=="string"){\nreturn $.fn.checkgroup.methods[_5ab](this,_5ac);\n}\n_5ab=_5ab||{};\nreturn this.each(function(){\nvar _5ad=$.data(this,"checkgroup");\nif(_5ad){\n$.extend(_5ad.options,_5ab);\n}else{\n_5ad=$.data(this,"checkgroup",{options:$.extend({},$.fn.checkgroup.defaults,$.fn.checkgroup.parseOptions(this),_5ab)});\n}\n_59e(this);\n});\n};\n$.fn.checkgroup.methods={options:function(jq){\nreturn jq.data("checkgroup").options;\n},setValue:function(jq,_5ae){\nreturn jq.each(function(){\n_5a3(this,_5ae);\n});\n},getValue:function(jq){\nreturn jq.checkgroup("options").value;\n}};\n$.fn.checkgroup.parseOptions=function(_5af){\nreturn $.extend({},$.parser.parseOptions(_5af,["dir","name","value","labelPosition","labelAlign",{labelWidth:"number"}]));\n};\n$.fn.checkgroup.defaults={dir:"h",name:null,value:[],labelWidth:"",labelPosition:"after",labelAlign:"left",itemStyle:{height:30},onChange:function(_5b0){\n}};\n})(jQuery);\n(function($){\nfunction init(_5b1){\n$(_5b1).addClass("validatebox-text");\n};\nfunction _5b2(_5b3){\nvar _5b4=$.data(_5b3,"validatebox");\n_5b4.validating=false;\nif(_5b4.vtimer){\nclearTimeout(_5b4.vtimer);\n}\nif(_5b4.ftimer){\nclearTimeout(_5b4.ftimer);\n}\n$(_5b3).tooltip("destroy");\n$(_5b3)._unbind();\n$(_5b3).remove();\n};\nfunction _5b5(_5b6){\nvar opts=$.data(_5b6,"validatebox").options;\n$(_5b6)._unbind(".validatebox");\nif(opts.novalidate||opts.disabled){\nreturn;\n}\nfor(var _5b7 in opts.events){\n$(_5b6)._bind(_5b7+".validatebox",{target:_5b6},opts.events[_5b7]);\n}\n};\nfunction _5b8(e){\nvar _5b9=e.data.target;\nvar _5ba=$.data(_5b9,"validatebox");\nvar opts=_5ba.options;\nif($(_5b9).attr("readonly")){\nreturn;\n}\n_5ba.validating=true;\n_5ba.value=opts.val(_5b9);\n(function f(){\nif(!$(_5b9).is(":visible")){\n_5ba.validating=false;\n}\nif(_5ba.validating){\nvar _5bb=opts.val(_5b9);\nif(_5ba.value!=_5bb){\n_5ba.value=_5bb;\nif(_5ba.vtimer){\nclearTimeout(_5ba.vtimer);\n}\n_5ba.vtimer=setTimeout(function(){\n$(_5b9).validatebox("validate");\n},opts.delay);\n}else{\nif(_5ba.message){\nopts.err(_5b9,_5ba.message);\n}\n}\n_5ba.ftimer=setTimeout(f,opts.interval);\n}\n})();\n};\nfunction _5bc(e){\nvar _5bd=e.data.target;\nvar _5be=$.data(_5bd,"validatebox");\nvar opts=_5be.options;\n_5be.validating=false;\nif(_5be.vtimer){\nclearTimeout(_5be.vtimer);\n_5be.vtimer=undefined;\n}\nif(_5be.ftimer){\nclearTimeout(_5be.ftimer);\n_5be.ftimer=undefined;\n}\nif(opts.validateOnBlur){\nsetTimeout(function(){\n$(_5bd).validatebox("validate");\n},0);\n}\nopts.err(_5bd,_5be.message,"hide");\n};\nfunction _5bf(e){\nvar _5c0=e.data.target;\nvar _5c1=$.data(_5c0,"validatebox");\n_5c1.options.err(_5c0,_5c1.message,"show");\n};\nfunction _5c2(e){\nvar _5c3=e.data.target;\nvar _5c4=$.data(_5c3,"validatebox");\nif(!_5c4.validating){\n_5c4.options.err(_5c3,_5c4.message,"hide");\n}\n};\nfunction _5c5(_5c6,_5c7,_5c8){\nvar _5c9=$.data(_5c6,"validatebox");\nvar opts=_5c9.options;\nvar t=$(_5c6);\nif(_5c8=="hide"||!_5c7){\nt.tooltip("hide");\n}else{\nif((t.is(":focus")&&_5c9.validating)||_5c8=="show"){\nt.tooltip($.extend({},opts.tipOptions,{content:_5c7,position:opts.tipPosition,deltaX:opts.deltaX,deltaY:opts.deltaY})).tooltip("show");\n}\n}\n};\nfunction _5ca(_5cb){\nvar _5cc=$.data(_5cb,"validatebox");\nvar opts=_5cc.options;\nvar box=$(_5cb);\nopts.onBeforeValidate.call(_5cb);\nvar _5cd=_5ce();\n_5cd?box.removeClass("validatebox-invalid"):box.addClass("validatebox-invalid");\nopts.err(_5cb,_5cc.message);\nopts.onValidate.call(_5cb,_5cd);\nreturn _5cd;\nfunction _5cf(msg){\n_5cc.message=msg;\n};\nfunction _5d0(_5d1,_5d2){\nvar _5d3=opts.val(_5cb);\nvar _5d4=/([a-zA-Z_]+)(.*)/.exec(_5d1);\nvar rule=opts.rules[_5d4[1]];\nif(rule&&_5d3){\nvar _5d5=_5d2||opts.validParams||eval(_5d4[2]);\nif(!rule["validator"].call(_5cb,_5d3,_5d5)){\nvar _5d6=rule["message"];\nif(_5d5){\nfor(var i=0;i<_5d5.length;i++){\n_5d6=_5d6.replace(new RegExp("\\\\{"+i+"\\\\}","g"),_5d5[i]);\n}\n}\n_5cf(opts.invalidMessage||_5d6);\nreturn false;\n}\n}\nreturn true;\n};\nfunction _5ce(){\n_5cf("");\nif(!opts._validateOnCreate){\nsetTimeout(function(){\nopts._validateOnCreate=true;\n},0);\nreturn true;\n}\nif(opts.novalidate||opts.disabled){\nreturn true;\n}\nif(opts.required){\nif(opts.val(_5cb)==""){\n_5cf(opts.missingMessage);\nreturn false;\n}\n}\nif(opts.validType){\nif($.isArray(opts.validType)){\nfor(var i=0;i<opts.validType.length;i++){\nif(!_5d0(opts.validType[i])){\nreturn false;\n}\n}\n}else{\nif(typeof opts.validType=="string"){\nif(!_5d0(opts.validType)){\nreturn false;\n}\n}else{\nfor(var _5d7 in opts.validType){\nvar _5d8=opts.validType[_5d7];\nif(!_5d0(_5d7,_5d8)){\nreturn false;\n}\n}\n}\n}\n}\nreturn true;\n};\n};\nfunction _5d9(_5da,_5db){\nvar opts=$.data(_5da,"validatebox").options;\nif(_5db!=undefined){\nopts.disabled=_5db;\n}\nif(opts.disabled){\n$(_5da).addClass("validatebox-disabled")._propAttr("disabled",true);\n}else{\n$(_5da).removeClass("validatebox-disabled")._propAttr("disabled",false);\n}\n};\nfunction _5dc(_5dd,mode){\nvar opts=$.data(_5dd,"validatebox").options;\nopts.readonly=mode==undefined?true:mode;\nif(opts.readonly||!opts.editable){\n$(_5dd).triggerHandler("blur.validatebox");\n$(_5dd).addClass("validatebox-readonly")._propAttr("readonly",true);\n}else{\n$(_5dd).removeClass("validatebox-readonly")._propAttr("readonly",false);\n}\n};\nfunction _5de(_5df,mode){\nvar opts=$.data(_5df,"validatebox").options;\nopts.editable=mode==undefined?true:mode;\n_5dc(_5df,opts.readonly);\n};\n$.fn.validatebox=function(_5e0,_5e1){\nif(typeof _5e0=="string"){\nreturn $.fn.validatebox.methods[_5e0](this,_5e1);\n}\n_5e0=_5e0||{};\nreturn this.each(function(){\nvar _5e2=$.data(this,"validatebox");\nif(_5e2){\n$.extend(_5e2.options,_5e0);\n}else{\ninit(this);\n_5e2=$.data(this,"validatebox",{options:$.extend({},$.fn.validatebox.defaults,$.fn.validatebox.parseOptions(this),_5e0)});\n}\n_5e2.options._validateOnCreate=_5e2.options.validateOnCreate;\n_5d9(this,_5e2.options.disabled);\n_5dc(this,_5e2.options.readonly);\n_5b5(this);\n_5ca(this);\n});\n};\n$.fn.validatebox.methods={options:function(jq){\nreturn $.data(jq[0],"validatebox").options;\n},destroy:function(jq){\nreturn jq.each(function(){\n_5b2(this);\n});\n},validate:function(jq){\nreturn jq.each(function(){\n_5ca(this);\n});\n},isValid:function(jq){\nreturn _5ca(jq[0]);\n},enableValidation:function(jq){\nreturn jq.each(function(){\n$(this).validatebox("options").novalidate=false;\n_5b5(this);\n_5ca(this);\n});\n},disableValidation:function(jq){\nreturn jq.each(function(){\n$(this).validatebox("options").novalidate=true;\n_5b5(this);\n_5ca(this);\n});\n},resetValidation:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).validatebox("options");\nopts._validateOnCreate=opts.validateOnCreate;\n_5ca(this);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_5d9(this,false);\n_5b5(this);\n_5ca(this);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_5d9(this,true);\n_5b5(this);\n_5ca(this);\n});\n},readonly:function(jq,mode){\nreturn jq.each(function(){\n_5dc(this,mode);\n_5b5(this);\n_5ca(this);\n});\n},setEditable:function(jq,mode){\nreturn jq.each(function(){\n_5de(this,mode);\n_5b5(this);\n_5ca(this);\n});\n}};\n$.fn.validatebox.parseOptions=function(_5e3){\nvar t=$(_5e3);\nreturn $.extend({},$.parser.parseOptions(_5e3,["validType","missingMessage","invalidMessage","tipPosition",{delay:"number",interval:"number",deltaX:"number"},{editable:"boolean",validateOnCreate:"boolean",validateOnBlur:"boolean"}]),{required:(t.attr("required")?true:undefined),disabled:(t.attr("disabled")?true:undefined),readonly:(t.attr("readonly")?true:undefined),novalidate:(t.attr("novalidate")!=undefined?true:undefined)});\n};\n$.fn.validatebox.defaults={required:false,validType:null,validParams:null,delay:200,interval:200,missingMessage:"This field is required.",invalidMessage:null,tipPosition:"right",deltaX:0,deltaY:0,novalidate:false,editable:true,disabled:false,readonly:false,validateOnCreate:true,validateOnBlur:false,events:{focus:_5b8,blur:_5bc,mouseenter:_5bf,mouseleave:_5c2,click:function(e){\nvar t=$(e.data.target);\nif(t.attr("type")=="checkbox"||t.attr("type")=="radio"){\nt.focus().validatebox("validate");\n}\n}},val:function(_5e4){\nreturn $(_5e4).val();\n},err:function(_5e5,_5e6,_5e7){\n_5c5(_5e5,_5e6,_5e7);\n},tipOptions:{showEvent:"none",hideEvent:"none",showDelay:0,hideDelay:0,zIndex:"",onShow:function(){\n$(this).tooltip("tip").css({color:"#000",borderColor:"#CC9933",backgroundColor:"#FFFFCC"});\n},onHide:function(){\n$(this).tooltip("destroy");\n}},rules:{email:{validator:function(_5e8){\nreturn /^((([a-z]|\\d|[!#\\$%&\'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&\'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?$/i.test(_5e8);\n},message:"Please enter a valid email address."},url:{validator:function(_5e9){\nreturn /^(https?|ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&\'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&\'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&\'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&\'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&\'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i.test(_5e9);\n},message:"Please enter a valid URL."},length:{validator:function(_5ea,_5eb){\nvar len=$.trim(_5ea).length;\nreturn len>=_5eb[0]&&len<=_5eb[1];\n},message:"Please enter a value between {0} and {1}."},remote:{validator:function(_5ec,_5ed){\nvar data={};\ndata[_5ed[1]]=_5ec;\nvar _5ee=$.ajax({url:_5ed[0],dataType:"json",data:data,async:false,cache:false,type:"post"}).responseText;\nreturn _5ee.replace(/\\s/g,"")=="true";\n},message:"Please fix this field."}},onBeforeValidate:function(){\n},onValidate:function(_5ef){\n}};\n})(jQuery);\n(function($){\nvar _5f0=0;\nfunction init(_5f1){\n$(_5f1).addClass("textbox-f").hide();\nvar span=$("<span class=\\"textbox\\">"+"<input class=\\"textbox-text\\" autocomplete=\\"off\\">"+"<input type=\\"hidden\\" class=\\"textbox-value\\">"+"</span>").insertAfter(_5f1);\nvar name=$(_5f1).attr("name");\nif(name){\nspan.find("input.textbox-value").attr("name",name);\n$(_5f1).removeAttr("name").attr("textboxName",name);\n}\nreturn span;\n};\nfunction _5f2(_5f3){\nvar _5f4=$.data(_5f3,"textbox");\nvar opts=_5f4.options;\nvar tb=_5f4.textbox;\nvar _5f5="_easyui_textbox_input"+(++_5f0);\ntb.addClass(opts.cls);\ntb.find(".textbox-text").remove();\nif(opts.multiline){\n$("<textarea id=\\""+_5f5+"\\" class=\\"textbox-text\\" autocomplete=\\"off\\"></textarea>").prependTo(tb);\n}else{\n$("<input id=\\""+_5f5+"\\" type=\\""+opts.type+"\\" class=\\"textbox-text\\" autocomplete=\\"off\\">").prependTo(tb);\n}\n$("#"+_5f5).attr("tabindex",$(_5f3).attr("tabindex")||"").css("text-align",_5f3.style.textAlign||"");\ntb.find(".textbox-addon").remove();\nvar bb=opts.icons?$.extend(true,[],opts.icons):[];\nif(opts.iconCls){\nbb.push({iconCls:opts.iconCls,disabled:true});\n}\nif(bb.length){\nvar bc=$("<span class=\\"textbox-addon\\"></span>").prependTo(tb);\nbc.addClass("textbox-addon-"+opts.iconAlign);\nfor(var i=0;i<bb.length;i++){\nbc.append("<a href=\\"javascript:;\\" class=\\"textbox-icon "+bb[i].iconCls+"\\" icon-index=\\""+i+"\\" tabindex=\\"-1\\"></a>");\n}\n}\ntb.find(".textbox-button").remove();\nif(opts.buttonText||opts.buttonIcon){\nvar btn=$("<a href=\\"javascript:;\\" class=\\"textbox-button\\"></a>").prependTo(tb);\nbtn.addClass("textbox-button-"+opts.buttonAlign).linkbutton({text:opts.buttonText,iconCls:opts.buttonIcon,onClick:function(){\nvar t=$(this).parent().prev();\nt.textbox("options").onClickButton.call(t[0]);\n}});\n}\nif(opts.label){\nif(typeof opts.label=="object"){\n_5f4.label=$(opts.label);\n_5f4.label.attr("for",_5f5);\n}else{\n$(_5f4.label).remove();\n_5f4.label=$("<label class=\\"textbox-label\\"></label>").html(opts.label);\n_5f4.label.css("textAlign",opts.labelAlign).attr("for",_5f5);\nif(opts.labelPosition=="after"){\n_5f4.label.insertAfter(tb);\n}else{\n_5f4.label.insertBefore(_5f3);\n}\n_5f4.label.removeClass("textbox-label-left textbox-label-right textbox-label-top");\n_5f4.label.addClass("textbox-label-"+opts.labelPosition);\n}\n}else{\n$(_5f4.label).remove();\n}\n_5f6(_5f3);\n_5f7(_5f3,opts.disabled);\n_5f8(_5f3,opts.readonly);\n};\nfunction _5f9(_5fa){\nvar _5fb=$.data(_5fa,"textbox");\nvar tb=_5fb.textbox;\ntb.find(".textbox-text").validatebox("destroy");\ntb.remove();\n$(_5fb.label).remove();\n$(_5fa).remove();\n};\nfunction _5fc(_5fd,_5fe){\nvar _5ff=$.data(_5fd,"textbox");\nvar opts=_5ff.options;\nvar tb=_5ff.textbox;\nvar _600=tb.parent();\nif(_5fe){\nif(typeof _5fe=="object"){\n$.extend(opts,_5fe);\n}else{\nopts.width=_5fe;\n}\n}\nif(isNaN(parseInt(opts.width))){\nvar c=$(_5fd).clone();\nc.css("visibility","hidden");\nc.insertAfter(_5fd);\nopts.width=c.outerWidth();\nc.remove();\n}\nif(opts.autoSize){\n$(_5fd).textbox("autoSize");\nopts.width=tb.css("width","").outerWidth();\nif(opts.labelPosition!="top"){\nopts.width+=$(_5ff.label).outerWidth();\n}\n}\nvar _601=tb.is(":visible");\nif(!_601){\ntb.appendTo("body");\n}\nvar _602=tb.find(".textbox-text");\nvar btn=tb.find(".textbox-button");\nvar _603=tb.find(".textbox-addon");\nvar _604=_603.find(".textbox-icon");\nif(opts.height=="auto"){\n_602.css({margin:"",paddingTop:"",paddingBottom:"",height:"",lineHeight:""});\n}\ntb._size(opts,_600);\nif(opts.label&&opts.labelPosition){\nif(opts.labelPosition=="top"){\n_5ff.label._size({width:opts.labelWidth=="auto"?tb.outerWidth():opts.labelWidth},tb);\nif(opts.height!="auto"){\ntb._size("height",tb.outerHeight()-_5ff.label.outerHeight());\n}\n}else{\n_5ff.label._size({width:opts.labelWidth,height:tb.outerHeight()},tb);\nif(!opts.multiline){\n_5ff.label.css("lineHeight",_5ff.label.height()+"px");\n}\ntb._size("width",tb.outerWidth()-_5ff.label.outerWidth());\n}\n}\nif(opts.buttonAlign=="left"||opts.buttonAlign=="right"){\nbtn.linkbutton("resize",{height:tb.height()});\n}else{\nbtn.linkbutton("resize",{width:"100%"});\n}\nvar _605=tb.width()-_604.length*opts.iconWidth-_606("left")-_606("right");\nvar _607=opts.height=="auto"?_602.outerHeight():(tb.height()-_606("top")-_606("bottom"));\n_603.css(opts.iconAlign,_606(opts.iconAlign)+"px");\n_603.css("top",_606("top")+"px");\n_604.css({width:opts.iconWidth+"px",height:_607+"px"});\n_602.css({paddingLeft:(_5fd.style.paddingLeft||""),paddingRight:(_5fd.style.paddingRight||""),marginLeft:_608("left"),marginRight:_608("right"),marginTop:_606("top"),marginBottom:_606("bottom")});\nif(opts.multiline){\n_602.css({paddingTop:(_5fd.style.paddingTop||""),paddingBottom:(_5fd.style.paddingBottom||"")});\n_602._outerHeight(_607);\n}else{\n_602.css({paddingTop:0,paddingBottom:0,height:_607+"px",lineHeight:_607+"px"});\n}\n_602._outerWidth(_605);\nopts.onResizing.call(_5fd,opts.width,opts.height);\nif(!_601){\ntb.insertAfter(_5fd);\n}\nopts.onResize.call(_5fd,opts.width,opts.height);\nfunction _608(_609){\nreturn (opts.iconAlign==_609?_603._outerWidth():0)+_606(_609);\n};\nfunction _606(_60a){\nvar w=0;\nbtn.filter(".textbox-button-"+_60a).each(function(){\nif(_60a=="left"||_60a=="right"){\nw+=$(this).outerWidth();\n}else{\nw+=$(this).outerHeight();\n}\n});\nreturn w;\n};\n};\nfunction _60b(_60c){\nvar opts=$(_60c).textbox("options");\nvar _60d=$(_60c).textbox("textbox");\nvar span=$(_60c).next();\nvar tmp=$("<span></span>").appendTo("body");\ntmp.attr("style",_60d.attr("style"));\ntmp.css({position:"absolute",top:-9999,left:-9999,width:"auto",fontFamily:_60d.css("fontFamily"),fontSize:_60d.css("fontSize"),fontWeight:_60d.css("fontWeight"),padding:_60d.css("padding"),whiteSpace:"nowrap"});\nvar _60e=_60f(_60d.val());\nvar _610=_60f(opts.prompt||"");\ntmp.remove();\nvar _611=Math.min(Math.max(_60e,_610)+20,span.width());\nvar _611=Math.max(_60e,_610);\n_60d._outerWidth(_611);\nfunction _60f(val){\nvar s=val.replace(/&/g,"&amp;").replace(/\\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");\ntmp.html(s);\nreturn tmp.outerWidth();\n};\n};\nfunction _5f6(_612){\nvar opts=$(_612).textbox("options");\nvar _613=$(_612).textbox("textbox");\n_613.validatebox($.extend({},opts,{deltaX:function(_614){\nreturn $(_612).textbox("getTipX",_614);\n},deltaY:function(_615){\nreturn $(_612).textbox("getTipY",_615);\n},onBeforeValidate:function(){\nopts.onBeforeValidate.call(_612);\nvar box=$(this);\nif(!box.is(":focus")){\nif(box.val()!==opts.value){\nopts.oldInputValue=box.val();\nbox.val(opts.value);\n}\n}\n},onValidate:function(_616){\nvar box=$(this);\nif(opts.oldInputValue!=undefined){\nbox.val(opts.oldInputValue);\nopts.oldInputValue=undefined;\n}\nvar tb=box.parent();\nif(_616){\ntb.removeClass("textbox-invalid");\n}else{\ntb.addClass("textbox-invalid");\n}\nopts.onValidate.call(_612,_616);\n}}));\n};\nfunction _617(_618){\nvar _619=$.data(_618,"textbox");\nvar opts=_619.options;\nvar tb=_619.textbox;\nvar _61a=tb.find(".textbox-text");\n_61a.attr("placeholder",opts.prompt);\n_61a._unbind(".textbox");\n$(_619.label)._unbind(".textbox");\nif(!opts.disabled&&!opts.readonly){\nif(_619.label){\n$(_619.label)._bind("click.textbox",function(e){\nif(!opts.hasFocusMe){\n_61a.focus();\n$(_618).textbox("setSelectionRange",{start:0,end:_61a.val().length});\n}\n});\n}\n_61a._bind("blur.textbox",function(e){\nif(!tb.hasClass("textbox-focused")){\nreturn;\n}\nopts.value=$(this).val();\nif(opts.value==""){\n$(this).val(opts.prompt).addClass("textbox-prompt");\n}else{\n$(this).removeClass("textbox-prompt");\n}\ntb.removeClass("textbox-focused");\ntb.closest(".form-field").removeClass("form-field-focused");\n})._bind("focus.textbox",function(e){\nopts.hasFocusMe=true;\nif(tb.hasClass("textbox-focused")){\nreturn;\n}\nif($(this).val()!=opts.value){\n$(this).val(opts.value);\n}\n$(this).removeClass("textbox-prompt");\ntb.addClass("textbox-focused");\ntb.closest(".form-field").addClass("form-field-focused");\n});\nfor(var _61b in opts.inputEvents){\n_61a._bind(_61b+".textbox",{target:_618},opts.inputEvents[_61b]);\n}\n}\nvar _61c=tb.find(".textbox-addon");\n_61c._unbind()._bind("click",{target:_618},function(e){\nvar icon=$(e.target).closest("a.textbox-icon:not(.textbox-icon-disabled)");\nif(icon.length){\nvar _61d=parseInt(icon.attr("icon-index"));\nvar conf=opts.icons[_61d];\nif(conf&&conf.handler){\nconf.handler.call(icon[0],e);\n}\nopts.onClickIcon.call(_618,_61d);\n}\n});\n_61c.find(".textbox-icon").each(function(_61e){\nvar conf=opts.icons[_61e];\nvar icon=$(this);\nif(!conf||conf.disabled||opts.disabled||opts.readonly){\nicon.addClass("textbox-icon-disabled");\n}else{\nicon.removeClass("textbox-icon-disabled");\n}\n});\nvar btn=tb.find(".textbox-button");\nbtn.linkbutton((opts.disabled||opts.readonly)?"disable":"enable");\ntb._unbind(".textbox")._bind("_resize.textbox",function(e,_61f){\nif($(this).hasClass("easyui-fluid")||_61f){\n_5fc(_618);\n}\nreturn false;\n});\n};\nfunction _5f7(_620,_621){\nvar _622=$.data(_620,"textbox");\nvar opts=_622.options;\nvar tb=_622.textbox;\nvar _623=tb.find(".textbox-text");\nvar ss=$(_620).add(tb.find(".textbox-value"));\nopts.disabled=_621;\nif(opts.disabled){\n_623.blur();\n_623.validatebox("disable");\ntb.addClass("textbox-disabled");\nss._propAttr("disabled",true);\n$(_622.label).addClass("textbox-label-disabled");\n}else{\n_623.validatebox("enable");\ntb.removeClass("textbox-disabled");\nss._propAttr("disabled",false);\n$(_622.label).removeClass("textbox-label-disabled");\n}\n};\nfunction _5f8(_624,mode){\nvar _625=$.data(_624,"textbox");\nvar opts=_625.options;\nvar tb=_625.textbox;\nvar _626=tb.find(".textbox-text");\nopts.readonly=mode==undefined?true:mode;\nif(opts.readonly){\n_626.triggerHandler("blur.textbox");\n}\n_626.validatebox("readonly",opts.readonly);\nif(opts.readonly){\ntb.addClass("textbox-readonly");\n$(_625.label).addClass("textbox-label-readonly");\n}else{\ntb.removeClass("textbox-readonly");\n$(_625.label).removeClass("textbox-label-readonly");\n}\n};\nfunction _627(_628,mode){\nvar _629=$.data(_628,"textbox");\nvar opts=_629.options;\nvar tb=_629.textbox;\nvar _62a=tb.find(".textbox-text");\nopts.editable=mode==undefined?true:mode;\n_62a.validatebox("setEditable",opts.editable);\n_5f8(_628,opts.readonly);\n};\n$.fn.textbox=function(_62b,_62c){\nif(typeof _62b=="string"){\nvar _62d=$.fn.textbox.methods[_62b];\nif(_62d){\nreturn _62d(this,_62c);\n}else{\nreturn this.each(function(){\nvar _62e=$(this).textbox("textbox");\n_62e.validatebox(_62b,_62c);\n});\n}\n}\n_62b=_62b||{};\nreturn this.each(function(){\nvar _62f=$.data(this,"textbox");\nif(_62f){\n$.extend(_62f.options,_62b);\nif(_62b.value!=undefined){\n_62f.options.originalValue=_62b.value;\n}\n}else{\n_62f=$.data(this,"textbox",{options:$.extend({},$.fn.textbox.defaults,$.fn.textbox.parseOptions(this),_62b),textbox:init(this)});\n_62f.options.originalValue=_62f.options.value;\n}\n_5f2(this);\n_617(this);\nif(_62f.options.doSize){\n_5fc(this);\n}\nvar _630=_62f.options.value;\n_62f.options.value="";\n$(this).textbox("initValue",_630);\n});\n};\n$.fn.textbox.methods={options:function(jq){\nreturn $.data(jq[0],"textbox").options;\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\nvar t=$(this);\nif(t.data("textbox")){\nreturn;\n}\nif(!$(from).data("textbox")){\n$(from).textbox();\n}\nvar opts=$.extend(true,{},$(from).textbox("options"));\nvar name=t.attr("name")||"";\nt.addClass("textbox-f").hide();\nt.removeAttr("name").attr("textboxName",name);\nvar span=$(from).next().clone().insertAfter(t);\nvar _631="_easyui_textbox_input"+(++_5f0);\nspan.find(".textbox-value").attr("name",name);\nspan.find(".textbox-text").attr("id",_631);\nvar _632=$($(from).textbox("label")).clone();\nif(_632.length){\n_632.attr("for",_631);\nif(opts.labelPosition=="after"){\n_632.insertAfter(t.next());\n}else{\n_632.insertBefore(t);\n}\n}\n$.data(this,"textbox",{options:opts,textbox:span,label:(_632.length?_632:undefined)});\nvar _633=$(from).textbox("button");\nif(_633.length){\nt.textbox("button").linkbutton($.extend(true,{},_633.linkbutton("options")));\n}\n_617(this);\n_5f6(this);\n});\n},textbox:function(jq){\nreturn $.data(jq[0],"textbox").textbox.find(".textbox-text");\n},button:function(jq){\nreturn $.data(jq[0],"textbox").textbox.find(".textbox-button");\n},label:function(jq){\nreturn $.data(jq[0],"textbox").label;\n},destroy:function(jq){\nreturn jq.each(function(){\n_5f9(this);\n});\n},resize:function(jq,_634){\nreturn jq.each(function(){\n_5fc(this,_634);\n});\n},autoSize:function(jq){\nreturn jq.each(function(){\n_60b(this);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n_5f7(this,true);\n_617(this);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n_5f7(this,false);\n_617(this);\n});\n},readonly:function(jq,mode){\nreturn jq.each(function(){\n_5f8(this,mode);\n_617(this);\n});\n},setEditable:function(jq,mode){\nreturn jq.each(function(){\n_627(this,mode);\n_617(this);\n});\n},isValid:function(jq){\nreturn jq.textbox("textbox").validatebox("isValid");\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).textbox("setValue","");\n});\n},setText:function(jq,_635){\nreturn jq.each(function(){\nvar opts=$(this).textbox("options");\nvar _636=$(this).textbox("textbox");\n_635=_635==undefined?"":String(_635);\nif($(this).textbox("getText")!=_635){\n_636.val(_635);\n}\nopts.value=_635;\nif(!_636.is(":focus")){\nif(_635){\n_636.removeClass("textbox-prompt");\n}else{\n_636.val(opts.prompt).addClass("textbox-prompt");\n}\n}\nif(opts.value){\n$(this).closest(".form-field").removeClass("form-field-empty");\n}else{\n$(this).closest(".form-field").addClass("form-field-empty");\n}\n$(this).textbox("validate");\nif(opts.autoSize){\n$(this).textbox("resize");\n}\n});\n},initValue:function(jq,_637){\nreturn jq.each(function(){\nvar _638=$.data(this,"textbox");\n$(this).textbox("setText",_637);\n_638.textbox.find(".textbox-value").val(_637);\n$(this).val(_637);\n});\n},setValue:function(jq,_639){\nreturn jq.each(function(){\nvar opts=$.data(this,"textbox").options;\nvar _63a=$(this).textbox("getValue");\n$(this).textbox("initValue",_639);\nif(_63a!=_639){\nopts.onChange.call(this,_639,_63a);\n$(this).closest("form").trigger("_change",[this]);\n}\n});\n},getText:function(jq){\nvar _63b=jq.textbox("textbox");\nif(_63b.is(":focus")){\nreturn _63b.val();\n}else{\nreturn jq.textbox("options").value;\n}\n},getValue:function(jq){\nreturn jq.data("textbox").textbox.find(".textbox-value").val();\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).textbox("options");\n$(this).textbox("textbox").val(opts.originalValue);\n$(this).textbox("setValue",opts.originalValue);\n});\n},getIcon:function(jq,_63c){\nreturn jq.data("textbox").textbox.find(".textbox-icon:eq("+_63c+")");\n},getTipX:function(jq,_63d){\nvar _63e=jq.data("textbox");\nvar opts=_63e.options;\nvar tb=_63e.textbox;\nvar _63f=tb.find(".textbox-text");\nvar _63d=_63d||opts.tipPosition;\nvar p1=tb.offset();\nvar p2=_63f.offset();\nvar w1=tb.outerWidth();\nvar w2=_63f.outerWidth();\nif(_63d=="right"){\nreturn w1-w2-p2.left+p1.left;\n}else{\nif(_63d=="left"){\nreturn p1.left-p2.left;\n}else{\nreturn (w1-w2-p2.left+p1.left)/2-(p2.left-p1.left)/2;\n}\n}\n},getTipY:function(jq,_640){\nvar _641=jq.data("textbox");\nvar opts=_641.options;\nvar tb=_641.textbox;\nvar _642=tb.find(".textbox-text");\nvar _640=_640||opts.tipPosition;\nvar p1=tb.offset();\nvar p2=_642.offset();\nvar h1=tb.outerHeight();\nvar h2=_642.outerHeight();\nif(_640=="left"||_640=="right"){\nreturn (h1-h2-p2.top+p1.top)/2-(p2.top-p1.top)/2;\n}else{\nif(_640=="bottom"){\nreturn (h1-h2-p2.top+p1.top);\n}else{\nreturn (p1.top-p2.top);\n}\n}\n},getSelectionStart:function(jq){\nreturn jq.textbox("getSelectionRange").start;\n},getSelectionRange:function(jq){\nvar _643=jq.textbox("textbox")[0];\nvar _644=0;\nvar end=0;\nif(typeof _643.selectionStart=="number"){\n_644=_643.selectionStart;\nend=_643.selectionEnd;\n}else{\nif(_643.createTextRange){\nvar s=document.selection.createRange();\nvar _645=_643.createTextRange();\n_645.setEndPoint("EndToStart",s);\n_644=_645.text.length;\nend=_644+s.text.length;\n}\n}\nreturn {start:_644,end:end};\n},setSelectionRange:function(jq,_646){\nreturn jq.each(function(){\nvar _647=$(this).textbox("textbox")[0];\nvar _648=_646.start;\nvar end=_646.end;\nif(_647.setSelectionRange){\n_647.setSelectionRange(_648,end);\n}else{\nif(_647.createTextRange){\nvar _649=_647.createTextRange();\n_649.collapse();\n_649.moveEnd("character",end);\n_649.moveStart("character",_648);\n_649.select();\n}\n}\n});\n},show:function(jq){\nreturn jq.each(function(){\n$(this).next().show();\n$($(this).textbox("label")).show();\n});\n},hide:function(jq){\nreturn jq.each(function(){\n$(this).next().hide();\n$($(this).textbox("label")).hide();\n});\n}};\n$.fn.textbox.parseOptions=function(_64a){\nvar t=$(_64a);\nreturn $.extend({},$.fn.validatebox.parseOptions(_64a),$.parser.parseOptions(_64a,["prompt","iconCls","iconAlign","buttonText","buttonIcon","buttonAlign","label","labelPosition","labelAlign","width","height",{multiline:"boolean",iconWidth:"number",labelWidth:"number",autoSize:"boolean"}]),{value:(t.val()||undefined),type:(t.attr("type")?t.attr("type"):undefined)});\n};\n$.fn.textbox.defaults=$.extend({},$.fn.validatebox.defaults,{doSize:true,autoSize:false,width:"auto",height:"auto",cls:null,prompt:"",value:"",type:"text",multiline:false,icons:[],iconCls:null,iconAlign:"right",iconWidth:26,buttonText:"",buttonIcon:null,buttonAlign:"right",label:null,labelWidth:"auto",labelPosition:"before",labelAlign:"left",inputEvents:{blur:function(e){\nvar t=$(e.data.target);\nvar opts=t.textbox("options");\nif(t.textbox("getValue")!=opts.value){\nt.textbox("setValue",opts.value);\n}\n},keydown:function(e){\nif(e.keyCode==13){\nvar t=$(e.data.target);\nt.textbox("setValue",t.textbox("getText"));\n}\nif($(e.data.target).textbox("options").autoSize){\nsetTimeout(function(){\n$(e.data.target).textbox("resize");\n},0);\n}\n}},onChange:function(_64b,_64c){\n},onResizing:function(_64d,_64e){\n},onResize:function(_64f,_650){\n},onClickButton:function(){\n},onClickIcon:function(_651){\n}});\n})(jQuery);\n(function($){\nfunction _652(_653){\nvar _654=$.data(_653,"passwordbox");\nvar opts=_654.options;\nvar _655=$.extend(true,[],opts.icons);\nif(opts.showEye){\n_655.push({iconCls:"passwordbox-open",handler:function(e){\nopts.revealed=!opts.revealed;\n_656(_653);\n}});\n}\n$(_653).addClass("passwordbox-f").textbox($.extend({},opts,{icons:_655}));\n_656(_653);\n};\nfunction _657(_658,_659,all){\nvar _65a=$(_658).data("passwordbox");\nvar t=$(_658);\nvar opts=t.passwordbox("options");\nif(opts.revealed){\nt.textbox("setValue",_659);\nreturn;\n}\n_65a.converting=true;\nvar _65b=unescape(opts.passwordChar);\nvar cc=_659.split("");\nvar vv=t.passwordbox("getValue").split("");\nfor(var i=0;i<cc.length;i++){\nvar c=cc[i];\nif(c!=vv[i]){\nif(c!=_65b){\nvv.splice(i,0,c);\n}\n}\n}\nvar pos=t.passwordbox("getSelectionStart");\nif(cc.length<vv.length){\nvv.splice(pos,vv.length-cc.length,"");\n}\nfor(var i=0;i<cc.length;i++){\nif(all||i!=pos-1){\ncc[i]=_65b;\n}\n}\nt.textbox("setValue",vv.join(""));\nt.textbox("setText",cc.join(""));\nt.textbox("setSelectionRange",{start:pos,end:pos});\nsetTimeout(function(){\n_65a.converting=false;\n},0);\n};\nfunction _656(_65c,_65d){\nvar t=$(_65c);\nvar opts=t.passwordbox("options");\nvar icon=t.next().find(".passwordbox-open");\nvar _65e=unescape(opts.passwordChar);\n_65d=_65d==undefined?t.textbox("getValue"):_65d;\nt.textbox("setValue",_65d);\nt.textbox("setText",opts.revealed?_65d:_65d.replace(/./ig,_65e));\nopts.revealed?icon.addClass("passwordbox-close"):icon.removeClass("passwordbox-close");\n};\nfunction _65f(e){\nvar _660=e.data.target;\nvar t=$(e.data.target);\nvar _661=t.data("passwordbox");\nvar opts=t.data("passwordbox").options;\n_661.checking=true;\n_661.value=t.passwordbox("getText");\n(function f(){\nif(_661.checking){\nvar _662=t.passwordbox("getText");\nif(_661.value!=_662){\n_661.value=_662;\nif(_661.lastTimer){\nclearTimeout(_661.lastTimer);\n_661.lastTimer=undefined;\n}\n_657(_660,_662);\n_661.lastTimer=setTimeout(function(){\n_657(_660,t.passwordbox("getText"),true);\n_661.lastTimer=undefined;\n},opts.lastDelay);\n}\nsetTimeout(f,opts.checkInterval);\n}\n})();\n};\nfunction _663(e){\nvar _664=e.data.target;\nvar _665=$(_664).data("passwordbox");\n_665.checking=false;\nif(_665.lastTimer){\nclearTimeout(_665.lastTimer);\n_665.lastTimer=undefined;\n}\n_656(_664);\n};\n$.fn.passwordbox=function(_666,_667){\nif(typeof _666=="string"){\nvar _668=$.fn.passwordbox.methods[_666];\nif(_668){\nreturn _668(this,_667);\n}else{\nreturn this.textbox(_666,_667);\n}\n}\n_666=_666||{};\nreturn this.each(function(){\nvar _669=$.data(this,"passwordbox");\nif(_669){\n$.extend(_669.options,_666);\n}else{\n_669=$.data(this,"passwordbox",{options:$.extend({},$.fn.passwordbox.defaults,$.fn.passwordbox.parseOptions(this),_666)});\n}\n_652(this);\n});\n};\n$.fn.passwordbox.methods={options:function(jq){\nreturn $.data(jq[0],"passwordbox").options;\n},setValue:function(jq,_66a){\nreturn jq.each(function(){\n_656(this,_66a);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_656(this,"");\n});\n},reset:function(jq){\nreturn jq.each(function(){\n$(this).textbox("reset");\n_656(this);\n});\n},showPassword:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).passwordbox("options");\nopts.revealed=true;\n_656(this);\n});\n},hidePassword:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).passwordbox("options");\nopts.revealed=false;\n_656(this);\n});\n}};\n$.fn.passwordbox.parseOptions=function(_66b){\nreturn $.extend({},$.fn.textbox.parseOptions(_66b),$.parser.parseOptions(_66b,["passwordChar",{checkInterval:"number",lastDelay:"number",revealed:"boolean",showEye:"boolean"}]));\n};\n$.fn.passwordbox.defaults=$.extend({},$.fn.textbox.defaults,{passwordChar:"%u25CF",checkInterval:200,lastDelay:500,revealed:false,showEye:true,inputEvents:{focus:_65f,blur:_663,keydown:function(e){\nvar _66c=$(e.data.target).data("passwordbox");\nreturn !_66c.converting;\n}},val:function(_66d){\nreturn $(_66d).parent().prev().passwordbox("getValue");\n}});\n})(jQuery);\n(function($){\nfunction _66e(_66f){\nvar _670=$(_66f).data("maskedbox");\nvar opts=_670.options;\n$(_66f).textbox(opts);\n$(_66f).maskedbox("initValue",opts.value);\n};\nfunction _671(_672,_673){\nvar opts=$(_672).maskedbox("options");\nvar tt=(_673||$(_672).maskedbox("getText")||"").split("");\nvar vv=[];\nfor(var i=0;i<opts.mask.length;i++){\nif(opts.masks[opts.mask[i]]){\nvar t=tt[i];\nvv.push(t!=opts.promptChar?t:" ");\n}\n}\nreturn vv.join("");\n};\nfunction _674(_675,_676){\nvar opts=$(_675).maskedbox("options");\nvar cc=_676.split("");\nvar tt=[];\nfor(var i=0;i<opts.mask.length;i++){\nvar m=opts.mask[i];\nvar r=opts.masks[m];\nif(r){\nvar c=cc.shift();\nif(c!=undefined){\nvar d=new RegExp(r,"i");\nif(d.test(c)){\ntt.push(c);\ncontinue;\n}\n}\ntt.push(opts.promptChar);\n}else{\ntt.push(m);\n}\n}\nreturn tt.join("");\n};\nfunction _677(_678,c){\nvar opts=$(_678).maskedbox("options");\nvar _679=$(_678).maskedbox("getSelectionRange");\nvar _67a=_67b(_678,_679.start);\nvar end=_67b(_678,_679.end);\nif(_67a!=-1){\nvar r=new RegExp(opts.masks[opts.mask[_67a]],"i");\nif(r.test(c)){\nvar vv=_671(_678).split("");\nvar _67c=_67a-_67d(_678,_67a);\nvar _67e=end-_67d(_678,end);\nvv.splice(_67c,_67e-_67c,c);\n$(_678).maskedbox("setValue",_674(_678,vv.join("")));\n_67a=_67b(_678,++_67a);\n$(_678).maskedbox("setSelectionRange",{start:_67a,end:_67a});\n}\n}\n};\nfunction _67f(_680,_681){\nvar opts=$(_680).maskedbox("options");\nvar vv=_671(_680).split("");\nvar _682=$(_680).maskedbox("getSelectionRange");\nif(_682.start==_682.end){\nif(_681){\nvar _683=_684(_680,_682.start);\n}else{\nvar _683=_67b(_680,_682.start);\n}\nvar _685=_683-_67d(_680,_683);\nif(_685>=0){\nvv.splice(_685,1);\n}\n}else{\nvar _683=_67b(_680,_682.start);\nvar end=_684(_680,_682.end);\nvar _685=_683-_67d(_680,_683);\nvar _686=end-_67d(_680,end);\nvv.splice(_685,_686-_685+1);\n}\n$(_680).maskedbox("setValue",_674(_680,vv.join("")));\n$(_680).maskedbox("setSelectionRange",{start:_683,end:_683});\n};\nfunction _67d(_687,pos){\nvar opts=$(_687).maskedbox("options");\nvar _688=0;\nif(pos>=opts.mask.length){\npos--;\n}\nfor(var i=pos;i>=0;i--){\nif(opts.masks[opts.mask[i]]==undefined){\n_688++;\n}\n}\nreturn _688;\n};\nfunction _67b(_689,pos){\nvar opts=$(_689).maskedbox("options");\nvar m=opts.mask[pos];\nvar r=opts.masks[m];\nwhile(pos<opts.mask.length&&!r){\npos++;\nm=opts.mask[pos];\nr=opts.masks[m];\n}\nreturn pos;\n};\nfunction _684(_68a,pos){\nvar opts=$(_68a).maskedbox("options");\nvar m=opts.mask[--pos];\nvar r=opts.masks[m];\nwhile(pos>=0&&!r){\npos--;\nm=opts.mask[pos];\nr=opts.masks[m];\n}\nreturn pos<0?0:pos;\n};\nfunction _68b(e){\nif(e.metaKey||e.ctrlKey){\nreturn;\n}\nvar _68c=e.data.target;\nvar opts=$(_68c).maskedbox("options");\nvar _68d=[9,13,35,36,37,39];\nif($.inArray(e.keyCode,_68d)!=-1){\nreturn true;\n}\nif(e.keyCode>=96&&e.keyCode<=105){\ne.keyCode-=48;\n}\nvar c=String.fromCharCode(e.keyCode);\nif(e.keyCode>=65&&e.keyCode<=90&&!e.shiftKey){\nc=c.toLowerCase();\n}else{\nif(e.keyCode==189){\nc="-";\n}else{\nif(e.keyCode==187){\nc="+";\n}else{\nif(e.keyCode==190){\nc=".";\n}\n}\n}\n}\nif(e.keyCode==8){\n_67f(_68c,true);\n}else{\nif(e.keyCode==46){\n_67f(_68c,false);\n}else{\n_677(_68c,c);\n}\n}\nreturn false;\n};\n$.extend($.fn.textbox.methods,{inputMask:function(jq,_68e){\nreturn jq.each(function(){\nvar _68f=this;\nvar opts=$.extend({},$.fn.maskedbox.defaults,_68e);\n$.data(_68f,"maskedbox",{options:opts});\nvar _690=$(_68f).textbox("textbox");\n_690._unbind(".maskedbox");\nfor(var _691 in opts.inputEvents){\n_690._bind(_691+".maskedbox",{target:_68f},opts.inputEvents[_691]);\n}\n});\n}});\n$.fn.maskedbox=function(_692,_693){\nif(typeof _692=="string"){\nvar _694=$.fn.maskedbox.methods[_692];\nif(_694){\nreturn _694(this,_693);\n}else{\nreturn this.textbox(_692,_693);\n}\n}\n_692=_692||{};\nreturn this.each(function(){\nvar _695=$.data(this,"maskedbox");\nif(_695){\n$.extend(_695.options,_692);\n}else{\n$.data(this,"maskedbox",{options:$.extend({},$.fn.maskedbox.defaults,$.fn.maskedbox.parseOptions(this),_692)});\n}\n_66e(this);\n});\n};\n$.fn.maskedbox.methods={options:function(jq){\nvar opts=jq.textbox("options");\nreturn $.extend($.data(jq[0],"maskedbox").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n},initValue:function(jq,_696){\nreturn jq.each(function(){\n_696=_674(this,_671(this,_696));\n$(this).textbox("initValue",_696);\n});\n},setValue:function(jq,_697){\nreturn jq.each(function(){\n_697=_674(this,_671(this,_697));\n$(this).textbox("setValue",_697);\n});\n}};\n$.fn.maskedbox.parseOptions=function(_698){\nvar t=$(_698);\nreturn $.extend({},$.fn.textbox.parseOptions(_698),$.parser.parseOptions(_698,["mask","promptChar"]),{});\n};\n$.fn.maskedbox.defaults=$.extend({},$.fn.textbox.defaults,{mask:"",promptChar:"_",masks:{"9":"[0-9]","a":"[a-zA-Z]","*":"[0-9a-zA-Z]"},inputEvents:{keydown:_68b}});\n})(jQuery);\n(function($){\nvar _699=0;\nfunction _69a(_69b){\nvar _69c=$.data(_69b,"filebox");\nvar opts=_69c.options;\nopts.fileboxId="filebox_file_id_"+(++_699);\n$(_69b).addClass("filebox-f").textbox(opts);\n$(_69b).textbox("textbox").attr("readonly","readonly");\n_69c.filebox=$(_69b).next().addClass("filebox");\nvar file=_69d(_69b);\nvar btn=$(_69b).filebox("button");\nif(btn.length){\n$("<label class=\\"filebox-label\\" for=\\""+opts.fileboxId+"\\"></label>").appendTo(btn);\nif(btn.linkbutton("options").disabled){\nfile._propAttr("disabled",true);\n}else{\nfile._propAttr("disabled",false);\n}\n}\n};\nfunction _69d(_69e){\nvar _69f=$.data(_69e,"filebox");\nvar opts=_69f.options;\n_69f.filebox.find(".textbox-value").remove();\nopts.oldValue="";\nvar file=$("<input type=\\"file\\" class=\\"textbox-value\\">").appendTo(_69f.filebox);\nfile.attr("id",opts.fileboxId).attr("name",$(_69e).attr("textboxName")||"");\nfile.attr("accept",opts.accept);\nfile.attr("capture",opts.capture);\nif(opts.multiple){\nfile.attr("multiple","multiple");\n}\nfile.change(function(){\nvar _6a0=this.value;\nif(this.files){\n_6a0=$.map(this.files,function(file){\nreturn file.name;\n}).join(opts.separator);\n}\n$(_69e).filebox("setText",_6a0);\nopts.onChange.call(_69e,_6a0,opts.oldValue);\nopts.oldValue=_6a0;\n});\nreturn file;\n};\n$.fn.filebox=function(_6a1,_6a2){\nif(typeof _6a1=="string"){\nvar _6a3=$.fn.filebox.methods[_6a1];\nif(_6a3){\nreturn _6a3(this,_6a2);\n}else{\nreturn this.textbox(_6a1,_6a2);\n}\n}\n_6a1=_6a1||{};\nreturn this.each(function(){\nvar _6a4=$.data(this,"filebox");\nif(_6a4){\n$.extend(_6a4.options,_6a1);\n}else{\n$.data(this,"filebox",{options:$.extend({},$.fn.filebox.defaults,$.fn.filebox.parseOptions(this),_6a1)});\n}\n_69a(this);\n});\n};\n$.fn.filebox.methods={options:function(jq){\nvar opts=jq.textbox("options");\nreturn $.extend($.data(jq[0],"filebox").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).textbox("clear");\n_69d(this);\n});\n},reset:function(jq){\nreturn jq.each(function(){\n$(this).filebox("clear");\n});\n},setValue:function(jq){\nreturn jq;\n},setValues:function(jq){\nreturn jq;\n},files:function(jq){\nreturn jq.next().find(".textbox-value")[0].files;\n}};\n$.fn.filebox.parseOptions=function(_6a5){\nvar t=$(_6a5);\nreturn $.extend({},$.fn.textbox.parseOptions(_6a5),$.parser.parseOptions(_6a5,["accept","capture","separator"]),{multiple:(t.attr("multiple")?true:undefined)});\n};\n$.fn.filebox.defaults=$.extend({},$.fn.textbox.defaults,{buttonIcon:null,buttonText:"Choose File",buttonAlign:"right",inputEvents:{},accept:"",capture:"",separator:",",multiple:false});\n})(jQuery);\n(function($){\nfunction _6a6(_6a7){\nvar _6a8=$.data(_6a7,"searchbox");\nvar opts=_6a8.options;\nvar _6a9=$.extend(true,[],opts.icons);\n_6a9.push({iconCls:"searchbox-button",handler:function(e){\nvar t=$(e.data.target);\nvar opts=t.searchbox("options");\nopts.searcher.call(e.data.target,t.searchbox("getValue"),t.searchbox("getName"));\n}});\n_6aa();\nvar _6ab=_6ac();\n$(_6a7).addClass("searchbox-f").textbox($.extend({},opts,{icons:_6a9,buttonText:(_6ab?_6ab.text:"")}));\n$(_6a7).attr("searchboxName",$(_6a7).attr("textboxName"));\n_6a8.searchbox=$(_6a7).next();\n_6a8.searchbox.addClass("searchbox");\n_6ad(_6ab);\nfunction _6aa(){\nif(opts.menu){\nif(typeof opts.menu=="string"){\n_6a8.menu=$(opts.menu).menu();\n}else{\nif(!_6a8.menu){\n_6a8.menu=$("<div></div>").appendTo("body").menu();\n}\n_6a8.menu.menu("clear").menu("appendItems",opts.menu);\n}\nvar _6ae=_6a8.menu.menu("options");\nvar _6af=_6ae.onClick;\n_6ae.onClick=function(item){\n_6ad(item);\n_6af.call(this,item);\n};\n}else{\nif(_6a8.menu){\n_6a8.menu.menu("destroy");\n}\n_6a8.menu=null;\n}\n};\nfunction _6ac(){\nif(_6a8.menu){\nvar item=_6a8.menu.children("div.menu-item:first");\n_6a8.menu.children("div.menu-item").each(function(){\nvar _6b0=$.extend({},$.parser.parseOptions(this),{selected:($(this).attr("selected")?true:undefined)});\nif(_6b0.selected){\nitem=$(this);\nreturn false;\n}\n});\nreturn _6a8.menu.menu("getItem",item[0]);\n}else{\nreturn null;\n}\n};\nfunction _6ad(item){\nif(!item){\nreturn;\n}\n$(_6a7).textbox("button").menubutton({text:item.text,iconCls:(item.iconCls||null),menu:_6a8.menu,menuAlign:opts.buttonAlign,duration:opts.duration,showEvent:opts.showEvent,hideEvent:opts.hideEvent,plain:false});\n_6a8.searchbox.find("input.textbox-value").attr("name",item.name||item.text);\n$(_6a7).searchbox("resize");\n};\n};\n$.fn.searchbox=function(_6b1,_6b2){\nif(typeof _6b1=="string"){\nvar _6b3=$.fn.searchbox.methods[_6b1];\nif(_6b3){\nreturn _6b3(this,_6b2);\n}else{\nreturn this.textbox(_6b1,_6b2);\n}\n}\n_6b1=_6b1||{};\nreturn this.each(function(){\nvar _6b4=$.data(this,"searchbox");\nif(_6b4){\n$.extend(_6b4.options,_6b1);\n}else{\n$.data(this,"searchbox",{options:$.extend({},$.fn.searchbox.defaults,$.fn.searchbox.parseOptions(this),_6b1)});\n}\n_6a6(this);\n});\n};\n$.fn.searchbox.methods={options:function(jq){\nvar opts=jq.textbox("options");\nreturn $.extend($.data(jq[0],"searchbox").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n},menu:function(jq){\nreturn $.data(jq[0],"searchbox").menu;\n},getName:function(jq){\nreturn $.data(jq[0],"searchbox").searchbox.find("input.textbox-value").attr("name");\n},selectName:function(jq,name){\nreturn jq.each(function(){\nvar menu=$.data(this,"searchbox").menu;\nif(menu){\nmenu.children("div.menu-item").each(function(){\nvar item=menu.menu("getItem",this);\nif(item.name==name){\n$(this).trigger("click");\nreturn false;\n}\n});\n}\n});\n},destroy:function(jq){\nreturn jq.each(function(){\nvar menu=$(this).searchbox("menu");\nif(menu){\nmenu.menu("destroy");\n}\n$(this).textbox("destroy");\n});\n}};\n$.fn.searchbox.parseOptions=function(_6b5){\nvar t=$(_6b5);\nreturn $.extend({},$.fn.textbox.parseOptions(_6b5),$.parser.parseOptions(_6b5,["menu",{duration:"number"}]),{searcher:(t.attr("searcher")?eval(t.attr("searcher")):undefined)});\n};\n$.fn.searchbox.defaults=$.extend({},$.fn.textbox.defaults,{inputEvents:$.extend({},$.fn.textbox.defaults.inputEvents,{keydown:function(e){\nif(e.keyCode==13){\ne.preventDefault();\nvar t=$(e.data.target);\nvar opts=t.searchbox("options");\nt.searchbox("setValue",$(this).val());\nopts.searcher.call(e.data.target,t.searchbox("getValue"),t.searchbox("getName"));\nreturn false;\n}\n}}),buttonAlign:"left",menu:null,duration:100,showEvent:"mouseenter",hideEvent:"mouseleave",searcher:function(_6b6,name){\n}});\n})(jQuery);\n(function($){\nfunction _6b7(_6b8,_6b9){\nvar opts=$.data(_6b8,"form").options;\n$.extend(opts,_6b9||{});\nvar _6ba=$.extend({},opts.queryParams);\nif(opts.onSubmit.call(_6b8,_6ba)==false){\nreturn;\n}\nvar _6bb=$(_6b8).find(".textbox-text:focus");\n_6bb.triggerHandler("blur");\n_6bb.focus();\nvar _6bc=null;\nif(opts.dirty){\nvar ff=[];\n$.map(opts.dirtyFields,function(f){\nif($(f).hasClass("textbox-f")){\n$(f).next().find(".textbox-value").each(function(){\nff.push(this);\n});\n}else{\nif($(f).hasClass("checkbox-f")){\n$(f).next().find(".checkbox-value").each(function(){\nff.push(this);\n});\n}else{\nif($(f).hasClass("radiobutton-f")){\n$(f).next().find(".radiobutton-value").each(function(){\nff.push(this);\n});\n}else{\nff.push(f);\n}\n}\n}\n});\n_6bc=$(_6b8).find("input[name]:enabled,textarea[name]:enabled,select[name]:enabled").filter(function(){\nreturn $.inArray(this,ff)==-1;\n});\n_6bc._propAttr("disabled",true);\n}\nif(opts.ajax){\nif(opts.iframe){\n_6bd(_6b8,_6ba);\n}else{\nif(window.FormData!==undefined){\n_6be(_6b8,_6ba);\n}else{\n_6bd(_6b8,_6ba);\n}\n}\n}else{\n$(_6b8).submit();\n}\nif(opts.dirty){\n_6bc._propAttr("disabled",false);\n}\n};\nfunction _6bd(_6bf,_6c0){\nvar opts=$.data(_6bf,"form").options;\nvar _6c1="easyui_frame_"+(new Date().getTime());\nvar _6c2=$("<iframe id="+_6c1+" name="+_6c1+"></iframe>").appendTo("body");\n_6c2.attr("src",window.ActiveXObject?"javascript:false":"about:blank");\n_6c2.css({position:"absolute",top:-1000,left:-1000});\n_6c2.bind("load",cb);\n_6c3(_6c0);\nfunction _6c3(_6c4){\nvar form=$(_6bf);\nif(opts.url){\nform.attr("action",opts.url);\n}\nvar t=form.attr("target"),a=form.attr("action");\nform.attr("target",_6c1);\nvar _6c5=$();\ntry{\nfor(var n in _6c4){\nvar _6c6=$("<input type=\\"hidden\\" name=\\""+n+"\\">").val(_6c4[n]).appendTo(form);\n_6c5=_6c5.add(_6c6);\n}\n_6c7();\nform[0].submit();\n}\nfinally{\nform.attr("action",a);\nt?form.attr("target",t):form.removeAttr("target");\n_6c5.remove();\n}\n};\nfunction _6c7(){\nvar f=$("#"+_6c1);\nif(!f.length){\nreturn;\n}\ntry{\nvar s=f.contents()[0].readyState;\nif(s&&s.toLowerCase()=="uninitialized"){\nsetTimeout(_6c7,100);\n}\n}\ncatch(e){\ncb();\n}\n};\nvar _6c8=10;\nfunction cb(){\nvar f=$("#"+_6c1);\nif(!f.length){\nreturn;\n}\nf.unbind();\nvar data="";\ntry{\nvar body=f.contents().find("body");\ndata=body.html();\nif(data==""){\nif(--_6c8){\nsetTimeout(cb,100);\nreturn;\n}\n}\nvar ta=body.find(">textarea");\nif(ta.length){\ndata=ta.val();\n}else{\nvar pre=body.find(">pre");\nif(pre.length){\ndata=pre.html();\n}\n}\n}\ncatch(e){\n}\nopts.success.call(_6bf,data);\nsetTimeout(function(){\nf.unbind();\nf.remove();\n},100);\n};\n};\nfunction _6be(_6c9,_6ca){\nvar opts=$.data(_6c9,"form").options;\nvar _6cb=new FormData($(_6c9)[0]);\nfor(var name in _6ca){\n_6cb.append(name,_6ca[name]);\n}\n$.ajax({url:opts.url,type:"post",xhr:function(){\nvar xhr=$.ajaxSettings.xhr();\nif(xhr.upload){\nxhr.upload.addEventListener("progress",function(e){\nif(e.lengthComputable){\nvar _6cc=e.total;\nvar _6cd=e.loaded||e.position;\nvar _6ce=Math.ceil(_6cd*100/_6cc);\nopts.onProgress.call(_6c9,_6ce);\n}\n},false);\n}\nreturn xhr;\n},data:_6cb,dataType:"html",cache:false,contentType:false,processData:false,complete:function(res){\nopts.success.call(_6c9,res.responseText);\n}});\n};\nfunction load(_6cf,data){\nvar opts=$.data(_6cf,"form").options;\nif(typeof data=="string"){\nvar _6d0={};\nif(opts.onBeforeLoad.call(_6cf,_6d0)==false){\nreturn;\n}\n$.ajax({url:data,data:_6d0,dataType:"json",success:function(data){\n_6d1(data);\n},error:function(){\nopts.onLoadError.apply(_6cf,arguments);\n}});\n}else{\n_6d1(data);\n}\nfunction _6d1(data){\nvar form=$(_6cf);\nfor(var name in data){\nvar val=data[name];\nif(!_6d2(name,val)){\nif(!_6d3(name,val)){\nform.find("input[name=\\""+name+"\\"]").val(val);\nform.find("textarea[name=\\""+name+"\\"]").val(val);\nform.find("select[name=\\""+name+"\\"]").val(val);\n}\n}\n}\nopts.onLoadSuccess.call(_6cf,data);\nform.form("validate");\n};\nfunction _6d2(name,val){\nvar _6d4=["switchbutton","radiobutton","checkbox"];\nfor(var i=0;i<_6d4.length;i++){\nvar _6d5=_6d4[i];\nvar cc=$(_6cf).find("["+_6d5+"Name=\\""+name+"\\"]");\nif(cc.length){\ncc[_6d5]("uncheck");\ncc.each(function(){\nif(_6d6($(this)[_6d5]("options").value,val)){\n$(this)[_6d5]("check");\n}\n});\nreturn true;\n}\n}\nvar cc=$(_6cf).find("input[name=\\""+name+"\\"][type=radio], input[name=\\""+name+"\\"][type=checkbox]");\nif(cc.length){\ncc._propAttr("checked",false);\ncc.each(function(){\nif(_6d6($(this).val(),val)){\n$(this)._propAttr("checked",true);\n}\n});\nreturn true;\n}\nreturn false;\n};\nfunction _6d6(v,val){\nif(v==String(val)||$.inArray(v,$.isArray(val)?val:[val])>=0){\nreturn true;\n}else{\nreturn false;\n}\n};\nfunction _6d3(name,val){\nvar _6d7=$(_6cf).find("[textboxName=\\""+name+"\\"],[sliderName=\\""+name+"\\"]");\nif(_6d7.length){\nfor(var i=0;i<opts.fieldTypes.length;i++){\nvar type=opts.fieldTypes[i];\nvar _6d8=_6d7.data(type);\nif(_6d8){\nif(_6d8.options.multiple||_6d8.options.range){\n_6d7[type]("setValues",val);\n}else{\n_6d7[type]("setValue",val);\n}\nreturn true;\n}\n}\n}\nreturn false;\n};\n};\nfunction _6d9(_6da){\n$("input,select,textarea",_6da).each(function(){\nif($(this).hasClass("textbox-value")){\nreturn;\n}\nvar t=this.type,tag=this.tagName.toLowerCase();\nif(t=="text"||t=="hidden"||t=="password"||tag=="textarea"){\nthis.value="";\n}else{\nif(t=="file"){\nvar file=$(this);\nif(!file.hasClass("textbox-value")){\nvar _6db=file.clone().val("");\n_6db.insertAfter(file);\nif(file.data("validatebox")){\nfile.validatebox("destroy");\n_6db.validatebox();\n}else{\nfile.remove();\n}\n}\n}else{\nif(t=="checkbox"||t=="radio"){\nthis.checked=false;\n}else{\nif(tag=="select"){\nthis.selectedIndex=-1;\n}\n}\n}\n}\n});\nvar tmp=$();\nvar form=$(_6da);\nvar opts=$.data(_6da,"form").options;\nfor(var i=0;i<opts.fieldTypes.length;i++){\nvar type=opts.fieldTypes[i];\nvar _6dc=form.find("."+type+"-f").not(tmp);\nif(_6dc.length&&_6dc[type]){\n_6dc[type]("clear");\ntmp=tmp.add(_6dc);\n}\n}\nform.form("validate");\n};\nfunction _6dd(_6de){\n_6de.reset();\nvar form=$(_6de);\nvar opts=$.data(_6de,"form").options;\nfor(var i=opts.fieldTypes.length-1;i>=0;i--){\nvar type=opts.fieldTypes[i];\nvar _6df=form.find("."+type+"-f");\nif(_6df.length&&_6df[type]){\n_6df[type]("reset");\n}\n}\nform.form("validate");\n};\nfunction _6e0(_6e1){\nvar _6e2=$.data(_6e1,"form").options;\n$(_6e1).unbind(".form");\nif(_6e2.ajax){\n$(_6e1).bind("submit.form",function(){\nsetTimeout(function(){\n_6b7(_6e1,_6e2);\n},0);\nreturn false;\n});\n}\n$(_6e1).bind("_change.form",function(e,t){\nif($.inArray(t,_6e2.dirtyFields)==-1){\n_6e2.dirtyFields.push(t);\n}\n_6e2.onChange.call(this,t);\n}).bind("change.form",function(e){\nvar t=e.target;\nif(!$(t).hasClass("textbox-text")){\nif($.inArray(t,_6e2.dirtyFields)==-1){\n_6e2.dirtyFields.push(t);\n}\n_6e2.onChange.call(this,t);\n}\n});\n_6e3(_6e1,_6e2.novalidate);\n};\nfunction _6e4(_6e5,_6e6){\n_6e6=_6e6||{};\nvar _6e7=$.data(_6e5,"form");\nif(_6e7){\n$.extend(_6e7.options,_6e6);\n}else{\n$.data(_6e5,"form",{options:$.extend({},$.fn.form.defaults,$.fn.form.parseOptions(_6e5),_6e6)});\n}\n};\nfunction _6e8(_6e9){\nif($.fn.validatebox){\nvar opts=$.data(_6e9,"form").options;\nvar t=$(_6e9);\nt.find(".validatebox-text:not(:disabled)").validatebox("validate");\nvar _6ea=t.find(".validatebox-invalid");\nif(opts.focusOnValidate){\n_6ea.filter(":not(:disabled):first").focus();\n}\nreturn _6ea.length==0;\n}\nreturn true;\n};\nfunction _6e3(_6eb,_6ec){\nvar opts=$.data(_6eb,"form").options;\nopts.novalidate=_6ec;\n$(_6eb).find(".validatebox-text:not(:disabled)").validatebox(_6ec?"disableValidation":"enableValidation");\n};\n$.fn.form=function(_6ed,_6ee){\nif(typeof _6ed=="string"){\nthis.each(function(){\n_6e4(this);\n});\nreturn $.fn.form.methods[_6ed](this,_6ee);\n}\nreturn this.each(function(){\n_6e4(this,_6ed);\n_6e0(this);\n});\n};\n$.fn.form.methods={options:function(jq){\nreturn $.data(jq[0],"form").options;\n},submit:function(jq,_6ef){\nreturn jq.each(function(){\n_6b7(this,_6ef);\n});\n},load:function(jq,data){\nreturn jq.each(function(){\nload(this,data);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_6d9(this);\n});\n},reset:function(jq){\nreturn jq.each(function(){\n_6dd(this);\n});\n},validate:function(jq){\nreturn _6e8(jq[0]);\n},disableValidation:function(jq){\nreturn jq.each(function(){\n_6e3(this,true);\n});\n},enableValidation:function(jq){\nreturn jq.each(function(){\n_6e3(this,false);\n});\n},resetValidation:function(jq){\nreturn jq.each(function(){\n$(this).find(".validatebox-text:not(:disabled)").validatebox("resetValidation");\n});\n},resetDirty:function(jq){\nreturn jq.each(function(){\n$(this).form("options").dirtyFields=[];\n});\n}};\n$.fn.form.parseOptions=function(_6f0){\nvar t=$(_6f0);\nreturn $.extend({},$.parser.parseOptions(_6f0,[{ajax:"boolean",dirty:"boolean"}]),{url:(t.attr("action")?t.attr("action"):undefined)});\n};\n$.fn.form.defaults={fieldTypes:["tagbox","combobox","combotree","combogrid","combotreegrid","datetimebox","datebox","timepicker","combo","datetimespinner","timespinner","numberspinner","spinner","slider","searchbox","numberbox","passwordbox","filebox","textbox","switchbutton","radiobutton","checkbox"],novalidate:false,focusOnValidate:true,ajax:true,iframe:true,dirty:false,dirtyFields:[],url:null,queryParams:{},onSubmit:function(_6f1){\nreturn $(this).form("validate");\n},onProgress:function(_6f2){\n},success:function(data){\n},onBeforeLoad:function(_6f3){\n},onLoadSuccess:function(data){\n},onLoadError:function(){\n},onChange:function(_6f4){\n}};\n})(jQuery);\n(function($){\nfunction _6f5(_6f6){\nvar _6f7=$.data(_6f6,"numberbox");\nvar opts=_6f7.options;\n$(_6f6).addClass("numberbox-f").textbox(opts);\n$(_6f6).textbox("textbox").css({imeMode:"disabled"});\n$(_6f6).attr("numberboxName",$(_6f6).attr("textboxName"));\n_6f7.numberbox=$(_6f6).next();\n_6f7.numberbox.addClass("numberbox");\nvar _6f8=opts.parser.call(_6f6,opts.value);\nvar _6f9=opts.formatter.call(_6f6,_6f8);\n$(_6f6).numberbox("initValue",_6f8).numberbox("setText",_6f9);\n};\nfunction _6fa(_6fb,_6fc){\nvar _6fd=$.data(_6fb,"numberbox");\nvar opts=_6fd.options;\nopts.value=parseFloat(_6fc);\nvar _6fc=opts.parser.call(_6fb,_6fc);\nvar text=opts.formatter.call(_6fb,_6fc);\nopts.value=_6fc;\n$(_6fb).textbox("setText",text).textbox("setValue",_6fc);\ntext=opts.formatter.call(_6fb,$(_6fb).textbox("getValue"));\n$(_6fb).textbox("setText",text);\n};\n$.fn.numberbox=function(_6fe,_6ff){\nif(typeof _6fe=="string"){\nvar _700=$.fn.numberbox.methods[_6fe];\nif(_700){\nreturn _700(this,_6ff);\n}else{\nreturn this.textbox(_6fe,_6ff);\n}\n}\n_6fe=_6fe||{};\nreturn this.each(function(){\nvar _701=$.data(this,"numberbox");\nif(_701){\n$.extend(_701.options,_6fe);\n}else{\n_701=$.data(this,"numberbox",{options:$.extend({},$.fn.numberbox.defaults,$.fn.numberbox.parseOptions(this),_6fe)});\n}\n_6f5(this);\n});\n};\n$.fn.numberbox.methods={options:function(jq){\nvar opts=jq.data("textbox")?jq.textbox("options"):{};\nreturn $.extend($.data(jq[0],"numberbox").options,{width:opts.width,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).textbox("cloneFrom",from);\n$.data(this,"numberbox",{options:$.extend(true,{},$(from).numberbox("options"))});\n$(this).addClass("numberbox-f");\n});\n},fix:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).numberbox("options");\nopts.value=null;\nvar _702=opts.parser.call(this,$(this).numberbox("getText"));\n$(this).numberbox("setValue",_702);\n});\n},setValue:function(jq,_703){\nreturn jq.each(function(){\n_6fa(this,_703);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).textbox("clear");\n$(this).numberbox("options").value="";\n});\n},reset:function(jq){\nreturn jq.each(function(){\n$(this).textbox("reset");\n$(this).numberbox("setValue",$(this).numberbox("getValue"));\n});\n}};\n$.fn.numberbox.parseOptions=function(_704){\nvar t=$(_704);\nreturn $.extend({},$.fn.textbox.parseOptions(_704),$.parser.parseOptions(_704,["decimalSeparator","groupSeparator","suffix",{min:"number",max:"number",precision:"number"}]),{prefix:(t.attr("prefix")?t.attr("prefix"):undefined)});\n};\n$.fn.numberbox.defaults=$.extend({},$.fn.textbox.defaults,{inputEvents:{keypress:function(e){\nvar _705=e.data.target;\nvar opts=$(_705).numberbox("options");\nreturn opts.filter.call(_705,e);\n},blur:function(e){\n$(e.data.target).numberbox("fix");\n},keydown:function(e){\nif(e.keyCode==13){\n$(e.data.target).numberbox("fix");\n}\n}},min:null,max:null,precision:0,decimalSeparator:".",groupSeparator:"",prefix:"",suffix:"",filter:function(e){\nvar opts=$(this).numberbox("options");\nvar s=$(this).numberbox("getText");\nif(e.metaKey||e.ctrlKey){\nreturn true;\n}\nif($.inArray(String(e.which),["46","8","13","0"])>=0){\nreturn true;\n}\nvar tmp=$("<span></span>");\ntmp.html(String.fromCharCode(e.which));\nvar c=tmp.text();\ntmp.remove();\nif(!c){\nreturn true;\n}\nif(c=="-"&&opts.min!=null&&opts.min>=0){\nreturn false;\n}\nif(c=="-"||c==opts.decimalSeparator){\nreturn (s.indexOf(c)==-1)?true:false;\n}else{\nif(c==opts.groupSeparator){\nreturn true;\n}else{\nif("0123456789".indexOf(c)>=0){\nreturn true;\n}else{\nreturn false;\n}\n}\n}\n},formatter:function(_706){\nif(!_706){\nreturn _706;\n}\n_706=_706+"";\nvar opts=$(this).numberbox("options");\nvar s1=_706,s2="";\nvar dpos=_706.indexOf(".");\nif(dpos>=0){\ns1=_706.substring(0,dpos);\ns2=_706.substring(dpos+1,_706.length);\n}\nif(opts.groupSeparator){\nvar p=/(\\d+)(\\d{3})/;\nwhile(p.test(s1)){\ns1=s1.replace(p,"$1"+opts.groupSeparator+"$2");\n}\n}\nif(s2){\nreturn opts.prefix+s1+opts.decimalSeparator+s2+opts.suffix;\n}else{\nreturn opts.prefix+s1+opts.suffix;\n}\n},parser:function(s){\ns=s+"";\nvar opts=$(this).numberbox("options");\nif(opts.prefix){\ns=$.trim(s.replace(new RegExp("\\\\"+$.trim(opts.prefix),"g"),""));\n}\nif(opts.suffix){\ns=$.trim(s.replace(new RegExp("\\\\"+$.trim(opts.suffix),"g"),""));\n}\nif(parseFloat(s)!=opts.value){\nif(opts.groupSeparator){\ns=$.trim(s.replace(new RegExp("\\\\"+opts.groupSeparator,"g"),""));\n}\nif(opts.decimalSeparator){\ns=$.trim(s.replace(new RegExp("\\\\"+opts.decimalSeparator,"g"),"."));\n}\ns=s.replace(/\\s/g,"");\n}\nvar val=parseFloat(s).toFixed(opts.precision);\nif(isNaN(val)){\nval="";\n}else{\nif(typeof (opts.min)=="number"&&val<opts.min){\nval=opts.min.toFixed(opts.precision);\n}else{\nif(typeof (opts.max)=="number"&&val>opts.max){\nval=opts.max.toFixed(opts.precision);\n}\n}\n}\nreturn val;\n}});\n})(jQuery);\n(function($){\nfunction _707(_708,_709){\nvar opts=$.data(_708,"calendar").options;\nvar t=$(_708);\nif(_709){\n$.extend(opts,{width:_709.width,height:_709.height});\n}\nt._size(opts,t.parent());\nt.find(".calendar-body")._outerHeight(t.height()-t.find(".calendar-header")._outerHeight());\nif(t.find(".calendar-menu").is(":visible")){\n_70a(_708);\n}\n};\nfunction init(_70b){\n$(_70b).addClass("calendar").html("<div class=\\"calendar-header\\">"+"<div class=\\"calendar-nav calendar-prevmonth\\"></div>"+"<div class=\\"calendar-nav calendar-nextmonth\\"></div>"+"<div class=\\"calendar-nav calendar-prevyear\\"></div>"+"<div class=\\"calendar-nav calendar-nextyear\\"></div>"+"<div class=\\"calendar-title\\">"+"<span class=\\"calendar-text\\"></span>"+"</div>"+"</div>"+"<div class=\\"calendar-body\\">"+"<div class=\\"calendar-menu\\">"+"<div class=\\"calendar-menu-year-inner\\">"+"<span class=\\"calendar-nav calendar-menu-prev\\"></span>"+"<span><input class=\\"calendar-menu-year\\" type=\\"text\\"></span>"+"<span class=\\"calendar-nav calendar-menu-next\\"></span>"+"</div>"+"<div class=\\"calendar-menu-month-inner\\">"+"</div>"+"</div>"+"</div>");\n$(_70b)._bind("_resize",function(e,_70c){\nif($(this).hasClass("easyui-fluid")||_70c){\n_707(_70b);\n}\nreturn false;\n});\n};\nfunction _70d(_70e){\nvar opts=$.data(_70e,"calendar").options;\nvar menu=$(_70e).find(".calendar-menu");\nmenu.find(".calendar-menu-year")._unbind(".calendar")._bind("keypress.calendar",function(e){\nif(e.keyCode==13){\n_70f(true);\n}\n});\n$(_70e)._unbind(".calendar")._bind("mouseover.calendar",function(e){\nvar t=_710(e.target);\nif(t.hasClass("calendar-nav")||t.hasClass("calendar-text")||(t.hasClass("calendar-day")&&!t.hasClass("calendar-disabled"))){\nt.addClass("calendar-nav-hover");\n}\n})._bind("mouseout.calendar",function(e){\nvar t=_710(e.target);\nif(t.hasClass("calendar-nav")||t.hasClass("calendar-text")||(t.hasClass("calendar-day")&&!t.hasClass("calendar-disabled"))){\nt.removeClass("calendar-nav-hover");\n}\n})._bind("click.calendar",function(e){\nvar t=_710(e.target);\nif(t.hasClass("calendar-menu-next")||t.hasClass("calendar-nextyear")){\n_711(1);\n}else{\nif(t.hasClass("calendar-menu-prev")||t.hasClass("calendar-prevyear")){\n_711(-1);\n}else{\nif(t.hasClass("calendar-menu-month")){\nmenu.find(".calendar-selected").removeClass("calendar-selected");\nt.addClass("calendar-selected");\n_70f(true);\n}else{\nif(t.hasClass("calendar-prevmonth")){\n_712(-1);\n}else{\nif(t.hasClass("calendar-nextmonth")){\n_712(1);\n}else{\nif(t.hasClass("calendar-text")){\nif(menu.is(":visible")){\nmenu.hide();\n}else{\n_70a(_70e);\n}\n}else{\nif(t.hasClass("calendar-day")){\nif(t.hasClass("calendar-disabled")){\nreturn;\n}\nvar _713=opts.current;\nt.closest("div.calendar-body").find(".calendar-selected").removeClass("calendar-selected");\nt.addClass("calendar-selected");\nvar _714=t.attr("abbr").split(",");\nvar y=parseInt(_714[0]);\nvar m=parseInt(_714[1]);\nvar d=parseInt(_714[2]);\nopts.current=new opts.Date(y,m-1,d);\nopts.onSelect.call(_70e,opts.current);\nif(!_713||_713.getTime()!=opts.current.getTime()){\nopts.onChange.call(_70e,opts.current,_713);\n}\nif(opts.year!=y||opts.month!=m){\nopts.year=y;\nopts.month=m;\nshow(_70e);\n}\n}\n}\n}\n}\n}\n}\n}\n});\nfunction _710(t){\nvar day=$(t).closest(".calendar-day");\nif(day.length){\nreturn day;\n}else{\nreturn $(t);\n}\n};\nfunction _70f(_715){\nvar menu=$(_70e).find(".calendar-menu");\nvar year=menu.find(".calendar-menu-year").val();\nvar _716=menu.find(".calendar-selected").attr("abbr");\nif(!isNaN(year)){\nopts.year=parseInt(year);\nopts.month=parseInt(_716);\nshow(_70e);\n}\nif(_715){\nmenu.hide();\n}\n};\nfunction _711(_717){\nopts.year+=_717;\nshow(_70e);\nmenu.find(".calendar-menu-year").val(opts.year);\n};\nfunction _712(_718){\nopts.month+=_718;\nif(opts.month>12){\nopts.year++;\nopts.month=1;\n}else{\nif(opts.month<1){\nopts.year--;\nopts.month=12;\n}\n}\nshow(_70e);\nmenu.find("td.calendar-selected").removeClass("calendar-selected");\nmenu.find("td:eq("+(opts.month-1)+")").addClass("calendar-selected");\n};\n};\nfunction _70a(_719){\nvar opts=$.data(_719,"calendar").options;\n$(_719).find(".calendar-menu").show();\nif($(_719).find(".calendar-menu-month-inner").is(":empty")){\n$(_719).find(".calendar-menu-month-inner").empty();\nvar t=$("<table class=\\"calendar-mtable\\"></table>").appendTo($(_719).find(".calendar-menu-month-inner"));\nvar idx=0;\nfor(var i=0;i<3;i++){\nvar tr=$("<tr></tr>").appendTo(t);\nfor(var j=0;j<4;j++){\n$("<td class=\\"calendar-nav calendar-menu-month\\"></td>").html(opts.months[idx++]).attr("abbr",idx).appendTo(tr);\n}\n}\n}\nvar body=$(_719).find(".calendar-body");\nvar sele=$(_719).find(".calendar-menu");\nvar _71a=sele.find(".calendar-menu-year-inner");\nvar _71b=sele.find(".calendar-menu-month-inner");\n_71a.find("input").val(opts.year).focus();\n_71b.find("td.calendar-selected").removeClass("calendar-selected");\n_71b.find("td:eq("+(opts.month-1)+")").addClass("calendar-selected");\nsele._outerWidth(body._outerWidth());\nsele._outerHeight(body._outerHeight());\n_71b._outerHeight(sele.height()-_71a._outerHeight());\n};\nfunction _71c(_71d,year,_71e){\nvar opts=$.data(_71d,"calendar").options;\nvar _71f=[];\nvar _720=new opts.Date(year,_71e,0).getDate();\nfor(var i=1;i<=_720;i++){\n_71f.push([year,_71e,i]);\n}\nvar _721=[],week=[];\nvar _722=-1;\nwhile(_71f.length>0){\nvar date=_71f.shift();\nweek.push(date);\nvar day=new opts.Date(date[0],date[1]-1,date[2]).getDay();\nif(_722==day){\nday=0;\n}else{\nif(day==(opts.firstDay==0?7:opts.firstDay)-1){\n_721.push(week);\nweek=[];\n}\n}\n_722=day;\n}\nif(week.length){\n_721.push(week);\n}\nvar _723=_721[0];\nif(_723.length<7){\nwhile(_723.length<7){\nvar _724=_723[0];\nvar date=new opts.Date(_724[0],_724[1]-1,_724[2]-1);\n_723.unshift([date.getFullYear(),date.getMonth()+1,date.getDate()]);\n}\n}else{\nvar _724=_723[0];\nvar week=[];\nfor(var i=1;i<=7;i++){\nvar date=new opts.Date(_724[0],_724[1]-1,_724[2]-i);\nweek.unshift([date.getFullYear(),date.getMonth()+1,date.getDate()]);\n}\n_721.unshift(week);\n}\nvar _725=_721[_721.length-1];\nwhile(_725.length<7){\nvar _726=_725[_725.length-1];\nvar date=new opts.Date(_726[0],_726[1]-1,_726[2]+1);\n_725.push([date.getFullYear(),date.getMonth()+1,date.getDate()]);\n}\nif(_721.length<6){\nvar _726=_725[_725.length-1];\nvar week=[];\nfor(var i=1;i<=7;i++){\nvar date=new opts.Date(_726[0],_726[1]-1,_726[2]+i);\nweek.push([date.getFullYear(),date.getMonth()+1,date.getDate()]);\n}\n_721.push(week);\n}\nreturn _721;\n};\nfunction show(_727){\nvar opts=$.data(_727,"calendar").options;\nif(opts.current&&!opts.validator.call(_727,opts.current)){\nopts.current=null;\n}\nvar now=new opts.Date();\nvar _728=now.getFullYear()+","+(now.getMonth()+1)+","+now.getDate();\nvar _729=opts.current?(opts.current.getFullYear()+","+(opts.current.getMonth()+1)+","+opts.current.getDate()):"";\nvar _72a=6-opts.firstDay;\nvar _72b=_72a+1;\nif(_72a>=7){\n_72a-=7;\n}\nif(_72b>=7){\n_72b-=7;\n}\n$(_727).find(".calendar-title span").html(opts.months[opts.month-1]+" "+opts.year);\nvar body=$(_727).find("div.calendar-body");\nbody.children("table").remove();\nvar data=["<table class=\\"calendar-dtable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\">"];\ndata.push("<thead><tr>");\nif(opts.showWeek){\ndata.push("<th class=\\"calendar-week\\">"+opts.weekNumberHeader+"</th>");\n}\nfor(var i=opts.firstDay;i<opts.weeks.length;i++){\ndata.push("<th>"+opts.weeks[i]+"</th>");\n}\nfor(var i=0;i<opts.firstDay;i++){\ndata.push("<th>"+opts.weeks[i]+"</th>");\n}\ndata.push("</tr></thead>");\ndata.push("<tbody>");\nvar _72c=_71c(_727,opts.year,opts.month);\nfor(var i=0;i<_72c.length;i++){\nvar week=_72c[i];\nvar cls="";\nif(i==0){\ncls="calendar-first";\n}else{\nif(i==_72c.length-1){\ncls="calendar-last";\n}\n}\ndata.push("<tr class=\\""+cls+"\\">");\nif(opts.showWeek){\nvar _72d=opts.getWeekNumber(new opts.Date(week[0][0],parseInt(week[0][1])-1,week[0][2]));\ndata.push("<td class=\\"calendar-week\\">"+_72d+"</td>");\n}\nfor(var j=0;j<week.length;j++){\nvar day=week[j];\nvar s=day[0]+","+day[1]+","+day[2];\nvar _72e=new opts.Date(day[0],parseInt(day[1])-1,day[2]);\nvar d=opts.formatter.call(_727,_72e);\nvar css=opts.styler.call(_727,_72e);\nvar _72f="";\nvar _730="";\nif(typeof css=="string"){\n_730=css;\n}else{\nif(css){\n_72f=css["class"]||"";\n_730=css["style"]||"";\n}\n}\nvar cls="calendar-day";\nif(!(opts.year==day[0]&&opts.month==day[1])){\ncls+=" calendar-other-month";\n}\nif(s==_728){\ncls+=" calendar-today";\n}\nif(s==_729){\ncls+=" calendar-selected";\n}\nif(j==_72a){\ncls+=" calendar-saturday";\n}else{\nif(j==_72b){\ncls+=" calendar-sunday";\n}\n}\nif(j==0){\ncls+=" calendar-first";\n}else{\nif(j==week.length-1){\ncls+=" calendar-last";\n}\n}\ncls+=" "+_72f;\nif(!opts.validator.call(_727,_72e)){\ncls+=" calendar-disabled";\n}\ndata.push("<td class=\\""+cls+"\\" abbr=\\""+s+"\\" style=\\""+_730+"\\">"+d+"</td>");\n}\ndata.push("</tr>");\n}\ndata.push("</tbody>");\ndata.push("</table>");\nbody.append(data.join(""));\nbody.children("table.calendar-dtable").prependTo(body);\nopts.onNavigate.call(_727,opts.year,opts.month);\n};\n$.fn.calendar=function(_731,_732){\nif(typeof _731=="string"){\nreturn $.fn.calendar.methods[_731](this,_732);\n}\n_731=_731||{};\nreturn this.each(function(){\nvar _733=$.data(this,"calendar");\nif(_733){\n$.extend(_733.options,_731);\n}else{\n_733=$.data(this,"calendar",{options:$.extend({},$.fn.calendar.defaults,$.fn.calendar.parseOptions(this),_731)});\ninit(this);\n}\nif(_733.options.border==false){\n$(this).addClass("calendar-noborder");\n}\n_707(this);\n_70d(this);\nshow(this);\n$(this).find("div.calendar-menu").hide();\n});\n};\n$.fn.calendar.methods={options:function(jq){\nreturn $.data(jq[0],"calendar").options;\n},resize:function(jq,_734){\nreturn jq.each(function(){\n_707(this,_734);\n});\n},moveTo:function(jq,date){\nreturn jq.each(function(){\nvar opts=$(this).calendar("options");\nif(!date){\nvar now=new opts.Date();\n$(this).calendar({year:now.getFullYear(),month:now.getMonth()+1,current:date});\nreturn;\n}\nif(opts.validator.call(this,date)){\nvar _735=opts.current;\n$(this).calendar({year:date.getFullYear(),month:date.getMonth()+1,current:date});\nif(!_735||_735.getTime()!=date.getTime()){\nopts.onChange.call(this,opts.current,_735);\n}\n}\n});\n}};\n$.fn.calendar.parseOptions=function(_736){\nvar t=$(_736);\nreturn $.extend({},$.parser.parseOptions(_736,["weekNumberHeader",{firstDay:"number",fit:"boolean",border:"boolean",showWeek:"boolean"}]));\n};\n$.fn.calendar.defaults={Date:Date,width:180,height:180,fit:false,border:true,showWeek:false,firstDay:0,weeks:["S","M","T","W","T","F","S"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],year:new Date().getFullYear(),month:new Date().getMonth()+1,current:(function(){\nvar d=new Date();\nreturn new Date(d.getFullYear(),d.getMonth(),d.getDate());\n})(),weekNumberHeader:"",getWeekNumber:function(date){\nvar _737=new Date(date.getTime());\n_737.setDate(_737.getDate()+4-(_737.getDay()||7));\nvar time=_737.getTime();\n_737.setMonth(0);\n_737.setDate(1);\nreturn Math.floor(Math.round((time-_737)/86400000)/7)+1;\n},formatter:function(date){\nreturn date.getDate();\n},styler:function(date){\nreturn "";\n},validator:function(date){\nreturn true;\n},onSelect:function(date){\n},onChange:function(_738,_739){\n},onNavigate:function(year,_73a){\n}};\n})(jQuery);\n(function($){\nfunction _73b(_73c){\nvar _73d=$.data(_73c,"spinner");\nvar opts=_73d.options;\nvar _73e=$.extend(true,[],opts.icons);\nif(opts.spinAlign=="left"||opts.spinAlign=="right"){\nopts.spinArrow=true;\nopts.iconAlign=opts.spinAlign;\nvar _73f={iconCls:"spinner-button-updown",handler:function(e){\nvar spin=$(e.target).closest(".spinner-button-top,.spinner-button-bottom");\n_749(e.data.target,spin.hasClass("spinner-button-bottom"));\n}};\nif(opts.spinAlign=="left"){\n_73e.unshift(_73f);\n}else{\n_73e.push(_73f);\n}\n}else{\nopts.spinArrow=false;\nif(opts.spinAlign=="vertical"){\nif(opts.buttonAlign!="top"){\nopts.buttonAlign="bottom";\n}\nopts.clsLeft="textbox-button-bottom";\nopts.clsRight="textbox-button-top";\n}else{\nopts.clsLeft="textbox-button-left";\nopts.clsRight="textbox-button-right";\n}\n}\n$(_73c).addClass("spinner-f").textbox($.extend({},opts,{icons:_73e,doSize:false,onResize:function(_740,_741){\nif(!opts.spinArrow){\nvar span=$(this).next();\nvar btn=span.find(".textbox-button:not(.spinner-button)");\nif(btn.length){\nvar _742=btn.outerWidth();\nvar _743=btn.outerHeight();\nvar _744=span.find(".spinner-button."+opts.clsLeft);\nvar _745=span.find(".spinner-button."+opts.clsRight);\nif(opts.buttonAlign=="right"){\n_745.css("marginRight",_742+"px");\n}else{\nif(opts.buttonAlign=="left"){\n_744.css("marginLeft",_742+"px");\n}else{\nif(opts.buttonAlign=="top"){\n_745.css("marginTop",_743+"px");\n}else{\n_744.css("marginBottom",_743+"px");\n}\n}\n}\n}\n}\nopts.onResize.call(this,_740,_741);\n}}));\n$(_73c).attr("spinnerName",$(_73c).attr("textboxName"));\n_73d.spinner=$(_73c).next();\n_73d.spinner.addClass("spinner");\nif(opts.spinArrow){\nvar _746=_73d.spinner.find(".spinner-button-updown");\n_746.append("<span class=\\"spinner-arrow spinner-button-top\\">"+"<span class=\\"spinner-arrow-up\\"></span>"+"</span>"+"<span class=\\"spinner-arrow spinner-button-bottom\\">"+"<span class=\\"spinner-arrow-down\\"></span>"+"</span>");\n}else{\nvar _747=$("<a href=\\"javascript:;\\" class=\\"textbox-button spinner-button\\" tabindex=\\"-1\\"></a>").addClass(opts.clsLeft).appendTo(_73d.spinner);\nvar _748=$("<a href=\\"javascript:;\\" class=\\"textbox-button spinner-button\\" tabindex=\\"-1\\"></a>").addClass(opts.clsRight).appendTo(_73d.spinner);\n_747.linkbutton({iconCls:opts.reversed?"spinner-button-up":"spinner-button-down",onClick:function(){\n_749(_73c,!opts.reversed);\n}});\n_748.linkbutton({iconCls:opts.reversed?"spinner-button-down":"spinner-button-up",onClick:function(){\n_749(_73c,opts.reversed);\n}});\nif(opts.disabled){\n$(_73c).spinner("disable");\n}\nif(opts.readonly){\n$(_73c).spinner("readonly");\n}\n}\n$(_73c).spinner("resize");\n};\nfunction _749(_74a,down){\nvar opts=$(_74a).spinner("options");\nopts.spin.call(_74a,down);\nopts[down?"onSpinDown":"onSpinUp"].call(_74a);\n$(_74a).spinner("validate");\n};\n$.fn.spinner=function(_74b,_74c){\nif(typeof _74b=="string"){\nvar _74d=$.fn.spinner.methods[_74b];\nif(_74d){\nreturn _74d(this,_74c);\n}else{\nreturn this.textbox(_74b,_74c);\n}\n}\n_74b=_74b||{};\nreturn this.each(function(){\nvar _74e=$.data(this,"spinner");\nif(_74e){\n$.extend(_74e.options,_74b);\n}else{\n_74e=$.data(this,"spinner",{options:$.extend({},$.fn.spinner.defaults,$.fn.spinner.parseOptions(this),_74b)});\n}\n_73b(this);\n});\n};\n$.fn.spinner.methods={options:function(jq){\nvar opts=jq.textbox("options");\nreturn $.extend($.data(jq[0],"spinner").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n}};\n$.fn.spinner.parseOptions=function(_74f){\nreturn $.extend({},$.fn.textbox.parseOptions(_74f),$.parser.parseOptions(_74f,["min","max","spinAlign",{increment:"number",reversed:"boolean"}]));\n};\n$.fn.spinner.defaults=$.extend({},$.fn.textbox.defaults,{min:null,max:null,increment:1,spinAlign:"right",reversed:false,spin:function(down){\n},onSpinUp:function(){\n},onSpinDown:function(){\n}});\n})(jQuery);\n(function($){\nfunction _750(_751){\n$(_751).addClass("numberspinner-f");\nvar opts=$.data(_751,"numberspinner").options;\n$(_751).numberbox($.extend({},opts,{doSize:false})).spinner(opts);\n$(_751).numberbox("setValue",opts.value);\n};\nfunction _752(_753,down){\nvar opts=$.data(_753,"numberspinner").options;\nvar v=parseFloat($(_753).numberbox("getValue")||opts.value)||0;\nif(down){\nv-=opts.increment;\n}else{\nv+=opts.increment;\n}\n$(_753).numberbox("setValue",v);\n};\n$.fn.numberspinner=function(_754,_755){\nif(typeof _754=="string"){\nvar _756=$.fn.numberspinner.methods[_754];\nif(_756){\nreturn _756(this,_755);\n}else{\nreturn this.numberbox(_754,_755);\n}\n}\n_754=_754||{};\nreturn this.each(function(){\nvar _757=$.data(this,"numberspinner");\nif(_757){\n$.extend(_757.options,_754);\n}else{\n$.data(this,"numberspinner",{options:$.extend({},$.fn.numberspinner.defaults,$.fn.numberspinner.parseOptions(this),_754)});\n}\n_750(this);\n});\n};\n$.fn.numberspinner.methods={options:function(jq){\nvar opts=jq.numberbox("options");\nreturn $.extend($.data(jq[0],"numberspinner").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n}};\n$.fn.numberspinner.parseOptions=function(_758){\nreturn $.extend({},$.fn.spinner.parseOptions(_758),$.fn.numberbox.parseOptions(_758),{});\n};\n$.fn.numberspinner.defaults=$.extend({},$.fn.spinner.defaults,$.fn.numberbox.defaults,{spin:function(down){\n_752(this,down);\n}});\n})(jQuery);\n(function($){\nfunction _759(_75a){\nvar opts=$.data(_75a,"timespinner").options;\n$(_75a).addClass("timespinner-f").spinner(opts);\nvar _75b=opts.formatter.call(_75a,opts.parser.call(_75a,opts.value));\n$(_75a).timespinner("initValue",_75b);\n};\nfunction _75c(e){\nvar _75d=e.data.target;\nvar opts=$.data(_75d,"timespinner").options;\nvar _75e=$(_75d).timespinner("getSelectionStart");\nfor(var i=0;i<opts.selections.length;i++){\nvar _75f=opts.selections[i];\nif(_75e>=_75f[0]&&_75e<=_75f[1]){\n_760(_75d,i);\nreturn;\n}\n}\n};\nfunction _760(_761,_762){\nvar opts=$.data(_761,"timespinner").options;\nif(_762!=undefined){\nopts.highlight=_762;\n}\nvar _763=opts.selections[opts.highlight];\nif(_763){\nvar tb=$(_761).timespinner("textbox");\n$(_761).timespinner("setSelectionRange",{start:_763[0],end:_763[1]});\ntb.focus();\n}\n};\nfunction _764(_765,_766){\nvar opts=$.data(_765,"timespinner").options;\nvar _766=opts.parser.call(_765,_766);\nvar text=opts.formatter.call(_765,_766);\n$(_765).spinner("setValue",text);\n};\nfunction _767(_768,down){\nvar opts=$.data(_768,"timespinner").options;\nvar s=$(_768).timespinner("getValue");\nvar _769=opts.selections[opts.highlight];\nvar s1=s.substring(0,_769[0]);\nvar s2=s.substring(_769[0],_769[1]);\nvar s3=s.substring(_769[1]);\nif(s2==opts.ampm[0]){\ns2=opts.ampm[1];\n}else{\nif(s2==opts.ampm[1]){\ns2=opts.ampm[0];\n}else{\ns2=parseInt(s2,10)||0;\nif(opts.selections.length-4==opts.highlight&&opts.hour12){\nif(s2==12){\ns2=0;\n}else{\nif(s2==11&&!down){\nvar tmp=s3.replace(opts.ampm[0],opts.ampm[1]);\nif(s3!=tmp){\ns3=tmp;\n}else{\ns3=s3.replace(opts.ampm[1],opts.ampm[0]);\n}\n}\n}\n}\ns2=s2+opts.increment*(down?-1:1);\n}\n}\nvar v=s1+s2+s3;\n$(_768).timespinner("setValue",v);\n_760(_768);\n};\n$.fn.timespinner=function(_76a,_76b){\nif(typeof _76a=="string"){\nvar _76c=$.fn.timespinner.methods[_76a];\nif(_76c){\nreturn _76c(this,_76b);\n}else{\nreturn this.spinner(_76a,_76b);\n}\n}\n_76a=_76a||{};\nreturn this.each(function(){\nvar _76d=$.data(this,"timespinner");\nif(_76d){\n$.extend(_76d.options,_76a);\n}else{\n$.data(this,"timespinner",{options:$.extend({},$.fn.timespinner.defaults,$.fn.timespinner.parseOptions(this),_76a)});\n}\n_759(this);\n});\n};\n$.fn.timespinner.methods={options:function(jq){\nvar opts=jq.data("spinner")?jq.spinner("options"):{};\nreturn $.extend($.data(jq[0],"timespinner").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n},setValue:function(jq,_76e){\nreturn jq.each(function(){\n_764(this,_76e);\n});\n},getHours:function(jq){\nvar opts=$.data(jq[0],"timespinner").options;\nvar date=opts.parser.call(jq[0],jq.timespinner("getValue"));\nreturn date?date.getHours():null;\n},getMinutes:function(jq){\nvar opts=$.data(jq[0],"timespinner").options;\nvar date=opts.parser.call(jq[0],jq.timespinner("getValue"));\nreturn date?date.getMinutes():null;\n},getSeconds:function(jq){\nvar opts=$.data(jq[0],"timespinner").options;\nvar date=opts.parser.call(jq[0],jq.timespinner("getValue"));\nreturn date?date.getSeconds():null;\n}};\n$.fn.timespinner.parseOptions=function(_76f){\nreturn $.extend({},$.fn.spinner.parseOptions(_76f),$.parser.parseOptions(_76f,["separator",{hour12:"boolean",showSeconds:"boolean",highlight:"number"}]));\n};\n$.fn.timespinner.defaults=$.extend({},$.fn.spinner.defaults,{inputEvents:$.extend({},$.fn.spinner.defaults.inputEvents,{click:function(e){\n_75c.call(this,e);\n},blur:function(e){\nvar t=$(e.data.target);\nt.timespinner("setValue",t.timespinner("getText"));\n},keydown:function(e){\nif(e.keyCode==13){\nvar t=$(e.data.target);\nt.timespinner("setValue",t.timespinner("getText"));\n}\n}}),formatter:function(date){\nif(!date){\nreturn "";\n}\nvar opts=$(this).timespinner("options");\nvar hour=date.getHours();\nvar _770=date.getMinutes();\nvar _771=date.getSeconds();\nvar ampm="";\nif(opts.hour12){\nampm=hour>=12?opts.ampm[1]:opts.ampm[0];\nhour=hour%12;\nif(hour==0){\nhour=12;\n}\n}\nvar tt=[_772(hour),_772(_770)];\nif(opts.showSeconds){\ntt.push(_772(_771));\n}\nvar s=tt.join(opts.separator)+" "+ampm;\nreturn $.trim(s);\nfunction _772(_773){\nreturn (_773<10?"0":"")+_773;\n};\n},parser:function(s){\nvar opts=$(this).timespinner("options");\nvar date=_774(s);\nif(date){\nvar min=_774(opts.min);\nvar max=_774(opts.max);\nif(min&&min>date){\ndate=min;\n}\nif(max&&max<date){\ndate=max;\n}\n}\nreturn date;\nfunction _774(s){\nif(!s){\nreturn null;\n}\nvar ss=s.split(" ");\nvar tt=ss[0].split(opts.separator);\nvar hour=parseInt(tt[0],10)||0;\nvar _775=parseInt(tt[1],10)||0;\nvar _776=parseInt(tt[2],10)||0;\nif(opts.hour12){\nvar ampm=ss[1];\nif(ampm==opts.ampm[1]&&hour<12){\nhour+=12;\n}else{\nif(ampm==opts.ampm[0]&&hour==12){\nhour-=12;\n}\n}\n}\nreturn new Date(1900,0,0,hour,_775,_776);\n};\n},selections:[[0,2],[3,5],[6,8],[9,11]],separator:":",showSeconds:false,highlight:0,hour12:false,ampm:["AM","PM"],spin:function(down){\n_767(this,down);\n}});\n})(jQuery);\n(function($){\nfunction _777(_778){\nvar opts=$.data(_778,"datetimespinner").options;\n$(_778).addClass("datetimespinner-f").timespinner(opts);\n};\n$.fn.datetimespinner=function(_779,_77a){\nif(typeof _779=="string"){\nvar _77b=$.fn.datetimespinner.methods[_779];\nif(_77b){\nreturn _77b(this,_77a);\n}else{\nreturn this.timespinner(_779,_77a);\n}\n}\n_779=_779||{};\nreturn this.each(function(){\nvar _77c=$.data(this,"datetimespinner");\nif(_77c){\n$.extend(_77c.options,_779);\n}else{\n$.data(this,"datetimespinner",{options:$.extend({},$.fn.datetimespinner.defaults,$.fn.datetimespinner.parseOptions(this),_779)});\n}\n_777(this);\n});\n};\n$.fn.datetimespinner.methods={options:function(jq){\nvar opts=jq.timespinner("options");\nreturn $.extend($.data(jq[0],"datetimespinner").options,{width:opts.width,value:opts.value,originalValue:opts.originalValue,disabled:opts.disabled,readonly:opts.readonly});\n}};\n$.fn.datetimespinner.parseOptions=function(_77d){\nreturn $.extend({},$.fn.timespinner.parseOptions(_77d),$.parser.parseOptions(_77d,[]));\n};\n$.fn.datetimespinner.defaults=$.extend({},$.fn.timespinner.defaults,{formatter:function(date){\nif(!date){\nreturn "";\n}\nreturn $.fn.datebox.defaults.formatter.call(this,date)+" "+$.fn.timespinner.defaults.formatter.call(this,date);\n},parser:function(s){\ns=$.trim(s);\nif(!s){\nreturn null;\n}\nvar dt=s.split(" ");\nvar _77e=$.fn.datebox.defaults.parser.call(this,dt[0]);\nif(dt.length<2){\nreturn _77e;\n}\nvar _77f=$.fn.timespinner.defaults.parser.call(this,dt[1]+(dt[2]?" "+dt[2]:""));\nreturn new Date(_77e.getFullYear(),_77e.getMonth(),_77e.getDate(),_77f.getHours(),_77f.getMinutes(),_77f.getSeconds());\n},selections:[[0,2],[3,5],[6,10],[11,13],[14,16],[17,19],[20,22]]});\n})(jQuery);\n(function($){\nvar _780=0;\nfunction _781(a,o){\nreturn $.easyui.indexOfArray(a,o);\n};\nfunction _782(a,o,id){\n$.easyui.removeArrayItem(a,o,id);\n};\nfunction _783(a,o,r){\n$.easyui.addArrayItem(a,o,r);\n};\nfunction _784(_785,aa){\nreturn $.data(_785,"treegrid")?aa.slice(1):aa;\n};\nfunction _786(_787){\nvar _788=$.data(_787,"datagrid");\nvar opts=_788.options;\nvar _789=_788.panel;\nvar dc=_788.dc;\nvar ss=null;\nif(opts.sharedStyleSheet){\nss=typeof opts.sharedStyleSheet=="boolean"?"head":opts.sharedStyleSheet;\n}else{\nss=_789.closest("div.datagrid-view");\nif(!ss.length){\nss=dc.view;\n}\n}\nvar cc=$(ss);\nvar _78a=$.data(cc[0],"ss");\nif(!_78a){\n_78a=$.data(cc[0],"ss",{cache:{},dirty:[]});\n}\nreturn {add:function(_78b){\nvar ss=["<style type=\\"text/css\\" easyui=\\"true\\">"];\nfor(var i=0;i<_78b.length;i++){\n_78a.cache[_78b[i][0]]={width:_78b[i][1]};\n}\nvar _78c=0;\nfor(var s in _78a.cache){\nvar item=_78a.cache[s];\nitem.index=_78c++;\nss.push(s+"{width:"+item.width+"}");\n}\nss.push("</style>");\n$(ss.join("\\n")).appendTo(cc);\ncc.children("style[easyui]:not(:last)").remove();\n},getRule:function(_78d){\nvar _78e=cc.children("style[easyui]:last")[0];\nvar _78f=_78e.styleSheet?_78e.styleSheet:(_78e.sheet||document.styleSheets[document.styleSheets.length-1]);\nvar _790=_78f.cssRules||_78f.rules;\nreturn _790[_78d];\n},set:function(_791,_792){\nvar item=_78a.cache[_791];\nif(item){\nitem.width=_792;\nvar rule=this.getRule(item.index);\nif(rule){\nrule.style["width"]=_792;\n}\n}\n},remove:function(_793){\nvar tmp=[];\nfor(var s in _78a.cache){\nif(s.indexOf(_793)==-1){\ntmp.push([s,_78a.cache[s].width]);\n}\n}\n_78a.cache={};\nthis.add(tmp);\n},dirty:function(_794){\nif(_794){\n_78a.dirty.push(_794);\n}\n},clean:function(){\nfor(var i=0;i<_78a.dirty.length;i++){\nthis.remove(_78a.dirty[i]);\n}\n_78a.dirty=[];\n}};\n};\nfunction _795(_796,_797){\nvar _798=$.data(_796,"datagrid");\nvar opts=_798.options;\nvar _799=_798.panel;\nif(_797){\n$.extend(opts,_797);\n}\nif(opts.fit==true){\nvar p=_799.panel("panel").parent();\nopts.width=p.width();\nopts.height=p.height();\n}\n_799.panel("resize",opts);\n};\nfunction _79a(_79b){\nvar _79c=$.data(_79b,"datagrid");\nvar opts=_79c.options;\nvar dc=_79c.dc;\nvar wrap=_79c.panel;\nif(!wrap.is(":visible")){\nreturn;\n}\nvar _79d=wrap.width();\nvar _79e=wrap.height();\nvar view=dc.view;\nvar _79f=dc.view1;\nvar _7a0=dc.view2;\nvar _7a1=_79f.children("div.datagrid-header");\nvar _7a2=_7a0.children("div.datagrid-header");\nvar _7a3=_7a1.find("table");\nvar _7a4=_7a2.find("table");\nview.width(_79d);\nvar _7a5=_7a1.children("div.datagrid-header-inner").show();\n_79f.width(_7a5.find("table").width());\nif(!opts.showHeader){\n_7a5.hide();\n}\n_7a0.width(_79d-_79f._outerWidth());\n_79f.children()._outerWidth(_79f.width());\n_7a0.children()._outerWidth(_7a0.width());\nvar all=_7a1.add(_7a2).add(_7a3).add(_7a4);\nall.css("height","");\nvar hh=Math.max(_7a3.height(),_7a4.height());\nall._outerHeight(hh);\nview.children(".datagrid-empty").css("top",hh+"px");\ndc.body1.add(dc.body2).children("table.datagrid-btable-frozen").css({position:"absolute",top:dc.header2._outerHeight()});\nvar _7a6=dc.body2.children("table.datagrid-btable-frozen")._outerHeight();\nvar _7a7=_7a6+_7a2._outerHeight()+_7a0.children(".datagrid-footer")._outerHeight();\nwrap.children(":not(.datagrid-view,.datagrid-mask,.datagrid-mask-msg)").each(function(){\n_7a7+=$(this)._outerHeight();\n});\nvar _7a8=wrap.outerHeight()-wrap.height();\nvar _7a9=wrap._size("minHeight")||"";\nvar _7aa=wrap._size("maxHeight")||"";\n_79f.add(_7a0).children("div.datagrid-body").css({marginTop:_7a6,height:(isNaN(parseInt(opts.height))?"":(_79e-_7a7)),minHeight:(_7a9?_7a9-_7a8-_7a7:""),maxHeight:(_7aa?_7aa-_7a8-_7a7:"")});\nview.height(_7a0.height());\n};\nfunction _7ab(_7ac,_7ad,_7ae){\nvar rows=$.data(_7ac,"datagrid").data.rows;\nvar opts=$.data(_7ac,"datagrid").options;\nvar dc=$.data(_7ac,"datagrid").dc;\nvar tmp=$("<tr class=\\"datagrid-row\\" style=\\"position:absolute;left:-999999px\\"></tr>").appendTo("body");\nvar _7af=tmp.outerHeight();\ntmp.remove();\nif(!dc.body1.is(":empty")&&(!opts.nowrap||opts.autoRowHeight||_7ae)){\nif(_7ad!=undefined){\nvar tr1=opts.finder.getTr(_7ac,_7ad,"body",1);\nvar tr2=opts.finder.getTr(_7ac,_7ad,"body",2);\n_7b0(tr1,tr2);\n}else{\nvar tr1=opts.finder.getTr(_7ac,0,"allbody",1);\nvar tr2=opts.finder.getTr(_7ac,0,"allbody",2);\n_7b0(tr1,tr2);\nif(opts.showFooter){\nvar tr1=opts.finder.getTr(_7ac,0,"allfooter",1);\nvar tr2=opts.finder.getTr(_7ac,0,"allfooter",2);\n_7b0(tr1,tr2);\n}\n}\n}\n_79a(_7ac);\nif(opts.height=="auto"){\nvar _7b1=dc.body1.parent();\nvar _7b2=dc.body2;\nvar _7b3=_7b4(_7b2);\nvar _7b5=_7b3.height;\nif(_7b3.width>_7b2.width()){\n_7b5+=18;\n}\n_7b5-=parseInt(_7b2.css("marginTop"))||0;\n_7b1.height(_7b5);\n_7b2.height(_7b5);\ndc.view.height(dc.view2.height());\n}\ndc.body2.triggerHandler("scroll");\nfunction _7b0(trs1,trs2){\nfor(var i=0;i<trs2.length;i++){\nvar tr1=$(trs1[i]);\nvar tr2=$(trs2[i]);\ntr1.css("height","");\ntr2.css("height","");\nvar _7b6=Math.max(tr1.outerHeight(),tr2.outerHeight());\nif(_7b6!=_7af){\n_7b6=Math.max(_7b6,_7af)+1;\ntr1.css("height",_7b6);\ntr2.css("height",_7b6);\n}\n}\n};\nfunction _7b4(cc){\nvar _7b7=0;\nvar _7b8=0;\n$(cc).children().each(function(){\nvar c=$(this);\nif(c.is(":visible")){\n_7b8+=c._outerHeight();\nif(_7b7<c._outerWidth()){\n_7b7=c._outerWidth();\n}\n}\n});\nreturn {width:_7b7,height:_7b8};\n};\n};\nfunction _7b9(_7ba,_7bb){\nvar _7bc=$.data(_7ba,"datagrid");\nvar opts=_7bc.options;\nvar dc=_7bc.dc;\nif(!dc.body2.children("table.datagrid-btable-frozen").length){\ndc.body1.add(dc.body2).prepend("<table class=\\"datagrid-btable datagrid-btable-frozen\\" cellspacing=\\"0\\" cellpadding=\\"0\\"></table>");\n}\n_7bd(true);\n_7bd(false);\n_79a(_7ba);\nfunction _7bd(_7be){\nvar _7bf=_7be?1:2;\nvar tr=opts.finder.getTr(_7ba,_7bb,"body",_7bf);\n(_7be?dc.body1:dc.body2).children("table.datagrid-btable-frozen").append(tr);\n};\n};\nfunction _7c0(_7c1,_7c2){\nfunction _7c3(){\nvar _7c4=[];\nvar _7c5=[];\n$(_7c1).children("thead").each(function(){\nvar opt=$.parser.parseOptions(this,[{frozen:"boolean"}]);\n$(this).find("tr").each(function(){\nvar cols=[];\n$(this).find("th").each(function(){\nvar th=$(this);\nvar col=$.extend({},$.parser.parseOptions(this,["id","field","align","halign","order","width",{sortable:"boolean",checkbox:"boolean",resizable:"boolean",fixed:"boolean"},{rowspan:"number",colspan:"number"}]),{title:(th.html()||undefined),hidden:(th.attr("hidden")?true:undefined),hformatter:(th.attr("hformatter")?eval(th.attr("hformatter")):undefined),hstyler:(th.attr("hstyler")?eval(th.attr("hstyler")):undefined),formatter:(th.attr("formatter")?eval(th.attr("formatter")):undefined),styler:(th.attr("styler")?eval(th.attr("styler")):undefined),sorter:(th.attr("sorter")?eval(th.attr("sorter")):undefined)});\nif(col.width&&String(col.width).indexOf("%")==-1){\ncol.width=parseInt(col.width);\n}\nif(th.attr("editor")){\nvar s=$.trim(th.attr("editor"));\nif(s.substr(0,1)=="{"){\ncol.editor=eval("("+s+")");\n}else{\ncol.editor=s;\n}\n}\ncols.push(col);\n});\nopt.frozen?_7c4.push(cols):_7c5.push(cols);\n});\n});\nreturn [_7c4,_7c5];\n};\nvar _7c6=$("<div class=\\"datagrid-wrap\\">"+"<div class=\\"datagrid-view\\">"+"<div class=\\"datagrid-view1\\">"+"<div class=\\"datagrid-header\\">"+"<div class=\\"datagrid-header-inner\\"></div>"+"</div>"+"<div class=\\"datagrid-body\\">"+"<div class=\\"datagrid-body-inner\\"></div>"+"</div>"+"<div class=\\"datagrid-footer\\">"+"<div class=\\"datagrid-footer-inner\\"></div>"+"</div>"+"</div>"+"<div class=\\"datagrid-view2\\">"+"<div class=\\"datagrid-header\\">"+"<div class=\\"datagrid-header-inner\\"></div>"+"</div>"+"<div class=\\"datagrid-body\\"></div>"+"<div class=\\"datagrid-footer\\">"+"<div class=\\"datagrid-footer-inner\\"></div>"+"</div>"+"</div>"+"</div>"+"</div>").insertAfter(_7c1);\n_7c6.panel({doSize:false,cls:"datagrid"});\n$(_7c1).addClass("datagrid-f").hide().appendTo(_7c6.children("div.datagrid-view"));\nvar cc=_7c3();\nvar view=_7c6.children("div.datagrid-view");\nvar _7c7=view.children("div.datagrid-view1");\nvar _7c8=view.children("div.datagrid-view2");\nreturn {panel:_7c6,frozenColumns:cc[0],columns:cc[1],dc:{view:view,view1:_7c7,view2:_7c8,header1:_7c7.children("div.datagrid-header").children("div.datagrid-header-inner"),header2:_7c8.children("div.datagrid-header").children("div.datagrid-header-inner"),body1:_7c7.children("div.datagrid-body").children("div.datagrid-body-inner"),body2:_7c8.children("div.datagrid-body"),footer1:_7c7.children("div.datagrid-footer").children("div.datagrid-footer-inner"),footer2:_7c8.children("div.datagrid-footer").children("div.datagrid-footer-inner")}};\n};\nfunction _7c9(_7ca){\nvar _7cb=$.data(_7ca,"datagrid");\nvar opts=_7cb.options;\nvar dc=_7cb.dc;\nvar _7cc=_7cb.panel;\n_7cb.ss=$(_7ca).datagrid("createStyleSheet");\n_7cc.panel($.extend({},opts,{id:null,doSize:false,onResize:function(_7cd,_7ce){\nif($.data(_7ca,"datagrid")){\n_79a(_7ca);\n$(_7ca).datagrid("fitColumns");\nopts.onResize.call(_7cc,_7cd,_7ce);\n}\n},onExpand:function(){\nif($.data(_7ca,"datagrid")){\n$(_7ca).datagrid("fixRowHeight").datagrid("fitColumns");\nopts.onExpand.call(_7cc);\n}\n}}));\nvar _7cf=$(_7ca).attr("id")||"";\nif(_7cf){\n_7cf+="_";\n}\n_7cb.rowIdPrefix=_7cf+"datagrid-row-r"+(++_780);\n_7cb.cellClassPrefix=_7cf+"datagrid-cell-c"+_780;\n_7d0(dc.header1,opts.frozenColumns,true);\n_7d0(dc.header2,opts.columns,false);\n_7d1();\ndc.header1.add(dc.header2).css("display",opts.showHeader?"block":"none");\ndc.footer1.add(dc.footer2).css("display",opts.showFooter?"block":"none");\nif(opts.toolbar){\nif($.isArray(opts.toolbar)){\n$("div.datagrid-toolbar",_7cc).remove();\nvar tb=$("<div class=\\"datagrid-toolbar\\"><table cellspacing=\\"0\\" cellpadding=\\"0\\"><tr></tr></table></div>").prependTo(_7cc);\nvar tr=tb.find("tr");\nfor(var i=0;i<opts.toolbar.length;i++){\nvar btn=opts.toolbar[i];\nif(btn=="-"){\n$("<td><div class=\\"datagrid-btn-separator\\"></div></td>").appendTo(tr);\n}else{\nvar td=$("<td></td>").appendTo(tr);\nbtn.type=btn.type||"linkbutton";\nbtn.plain=btn.plain||true;\nvar tool=$("<a href=\\"javascript:;\\"></a>").appendTo(td);\ntool[0].onclick=eval(btn.handler||function(){\n});\ntool[btn.type](btn);\nif(btn.onInit){\nbtn.onInit.call(tool[0]);\n}\n}\n}\n}else{\n$(opts.toolbar).addClass("datagrid-toolbar").prependTo(_7cc);\n$(opts.toolbar).show();\n}\n}else{\n$("div.datagrid-toolbar",_7cc).remove();\n}\n$("div.datagrid-pager",_7cc).remove();\nif(opts.pagination){\nvar _7d2=$("<div class=\\"datagrid-pager\\"></div>");\nif(opts.pagePosition=="bottom"){\n_7d2.appendTo(_7cc);\n}else{\nif(opts.pagePosition=="top"){\n_7d2.addClass("datagrid-pager-top").prependTo(_7cc);\n}else{\nvar ptop=$("<div class=\\"datagrid-pager datagrid-pager-top\\"></div>").prependTo(_7cc);\n_7d2.appendTo(_7cc);\n_7d2=_7d2.add(ptop);\n}\n}\n_7d2.pagination({total:0,pageNumber:opts.pageNumber,pageSize:opts.pageSize,pageList:opts.pageList,onSelectPage:function(_7d3,_7d4){\nopts.pageNumber=_7d3||1;\nopts.pageSize=_7d4;\n_7d2.pagination("refresh",{pageNumber:_7d3,pageSize:_7d4});\n_81e(_7ca);\n}});\nopts.pageSize=_7d2.pagination("options").pageSize;\n}\nfunction _7d0(_7d5,_7d6,_7d7){\nif(!_7d6){\nreturn;\n}\n$(_7d5).show();\n$(_7d5).empty();\nvar tmp=$("<div class=\\"datagrid-cell\\" style=\\"position:absolute;left:-99999px\\"></div>").appendTo("body");\ntmp._outerWidth(99);\nvar _7d8=100-parseInt(tmp[0].style.width);\ntmp.remove();\nvar _7d9=[];\nvar _7da=[];\nvar _7db=[];\nif(opts.sortName){\n_7d9=opts.sortName.split(",");\n_7da=opts.sortOrder.split(",");\n}\nvar t=$("<table class=\\"datagrid-htable\\" border=\\"0\\" cellspacing=\\"0\\" cellpadding=\\"0\\"><tbody></tbody></table>").appendTo(_7d5);\nfor(var i=0;i<_7d6.length;i++){\nvar tr=$("<tr class=\\"datagrid-header-row\\"></tr>").appendTo($("tbody",t));\nvar cols=_7d6[i];\nfor(var j=0;j<cols.length;j++){\nvar col=cols[j];\nvar attr="";\nif(col.rowspan){\nattr+="rowspan=\\""+col.rowspan+"\\" ";\n}\nif(col.colspan){\nattr+="colspan=\\""+col.colspan+"\\" ";\nif(!col.id){\ncol.id=["datagrid-td-group"+_780,i,j].join("-");\n}\n}\nif(col.id){\nattr+="id=\\""+col.id+"\\"";\n}\nvar css=col.hstyler?col.hstyler(col.title,col):"";\nif(typeof css=="string"){\nvar _7dc=css;\nvar _7dd="";\n}else{\ncss=css||{};\nvar _7dc=css["style"]||"";\nvar _7dd=css["class"]||"";\n}\nvar td=$("<td "+attr+" class=\\""+_7dd+"\\" style=\\""+_7dc+"\\""+"></td>").appendTo(tr);\nif(col.checkbox){\ntd.attr("field",col.field);\n$("<div class=\\"datagrid-header-check\\"></div>").html("<input type=\\"checkbox\\">").appendTo(td);\n}else{\nif(col.field){\ntd.attr("field",col.field);\ntd.append("<div class=\\"datagrid-cell\\"><span></span><span class=\\"datagrid-sort-icon\\"></span></div>");\ntd.find("span:first").html(col.hformatter?col.hformatter(col.title,col):col.title);\nvar cell=td.find("div.datagrid-cell");\nvar pos=_781(_7d9,col.field);\nif(pos>=0){\ncell.addClass("datagrid-sort-"+_7da[pos]);\n}\nif(col.sortable){\ncell.addClass("datagrid-sort");\n}\nif(col.resizable==false){\ncell.attr("resizable","false");\n}\nif(col.width){\nvar _7de=$.parser.parseValue("width",col.width,dc.view,opts.scrollbarSize+(opts.rownumbers?opts.rownumberWidth:0));\ncol.deltaWidth=_7d8;\ncol.boxWidth=_7de-_7d8;\n}else{\ncol.auto=true;\n}\ncell.css("text-align",(col.halign||col.align||""));\ncol.cellClass=_7cb.cellClassPrefix+"-"+col.field.replace(/[\\.|\\s]/g,"-");\ncell.addClass(col.cellClass);\n}else{\n$("<div class=\\"datagrid-cell-group\\"></div>").html(col.hformatter?col.hformatter(col.title,col):col.title).appendTo(td);\n}\n}\nif(col.hidden){\ntd.hide();\n_7db.push(col.field);\n}\n}\n}\nif(_7d7&&opts.rownumbers){\nvar td=$("<td rowspan=\\""+opts.frozenColumns.length+"\\"><div class=\\"datagrid-header-rownumber\\"></div></td>");\nif($("tr",t).length==0){\ntd.wrap("<tr class=\\"datagrid-header-row\\"></tr>").parent().appendTo($("tbody",t));\n}else{\ntd.prependTo($("tr:first",t));\n}\n}\nfor(var i=0;i<_7db.length;i++){\n_820(_7ca,_7db[i],-1);\n}\n};\nfunction _7d1(){\nvar _7df=[[".datagrid-header-rownumber",(opts.rownumberWidth-1)+"px"],[".datagrid-cell-rownumber",(opts.rownumberWidth-1)+"px"]];\nvar _7e0=_7e1(_7ca,true).concat(_7e1(_7ca));\nfor(var i=0;i<_7e0.length;i++){\nvar col=_7e2(_7ca,_7e0[i]);\nif(col&&!col.checkbox){\n_7df.push(["."+col.cellClass,col.boxWidth?col.boxWidth+"px":"auto"]);\n}\n}\n_7cb.ss.add(_7df);\n_7cb.ss.dirty(_7cb.cellSelectorPrefix);\n_7cb.cellSelectorPrefix="."+_7cb.cellClassPrefix;\n};\n};\nfunction _7e3(_7e4){\nvar _7e5=$.data(_7e4,"datagrid");\nvar _7e6=_7e5.panel;\nvar opts=_7e5.options;\nvar dc=_7e5.dc;\nvar _7e7=dc.header1.add(dc.header2);\n_7e7._unbind(".datagrid");\nfor(var _7e8 in opts.headerEvents){\n_7e7._bind(_7e8+".datagrid",opts.headerEvents[_7e8]);\n}\nvar _7e9=_7e7.find("div.datagrid-cell");\nvar _7ea=opts.resizeHandle=="right"?"e":(opts.resizeHandle=="left"?"w":"e,w");\n_7e9.each(function(){\n$(this).resizable({handles:_7ea,edge:opts.resizeEdge,disabled:($(this).attr("resizable")?$(this).attr("resizable")=="false":false),minWidth:25,onStartResize:function(e){\n_7e5.resizing=true;\n_7e7.css("cursor",$("body").css("cursor"));\nif(!_7e5.proxy){\n_7e5.proxy=$("<div class=\\"datagrid-resize-proxy\\"></div>").appendTo(dc.view);\n}\nif(e.data.dir=="e"){\ne.data.deltaEdge=$(this)._outerWidth()-(e.pageX-$(this).offset().left);\n}else{\ne.data.deltaEdge=$(this).offset().left-e.pageX-1;\n}\n_7e5.proxy.css({left:e.pageX-$(_7e6).offset().left-1+e.data.deltaEdge,display:"none"});\nsetTimeout(function(){\nif(_7e5.proxy){\n_7e5.proxy.show();\n}\n},500);\n},onResize:function(e){\n_7e5.proxy.css({left:e.pageX-$(_7e6).offset().left-1+e.data.deltaEdge,display:"block"});\nreturn false;\n},onStopResize:function(e){\n_7e7.css("cursor","");\n$(this).css("height","");\nvar _7eb=$(this).parent().attr("field");\nvar col=_7e2(_7e4,_7eb);\ncol.width=$(this)._outerWidth()+1;\ncol.boxWidth=col.width-col.deltaWidth;\ncol.auto=undefined;\n$(this).css("width","");\n$(_7e4).datagrid("fixColumnSize",_7eb);\n_7e5.proxy.remove();\n_7e5.proxy=null;\nif($(this).parents("div:first.datagrid-header").parent().hasClass("datagrid-view1")){\n_79a(_7e4);\n}\n$(_7e4).datagrid("fitColumns");\nopts.onResizeColumn.call(_7e4,_7eb,col.width);\nsetTimeout(function(){\n_7e5.resizing=false;\n},0);\n}});\n});\nvar bb=dc.body1.add(dc.body2);\nbb._unbind();\nfor(var _7e8 in opts.rowEvents){\nbb._bind(_7e8,opts.rowEvents[_7e8]);\n}\ndc.body1._bind("mousewheel DOMMouseScroll MozMousePixelScroll",function(e){\ne.preventDefault();\nvar e1=e.originalEvent||window.event;\nvar _7ec=e1.wheelDelta||e1.detail*(-1);\nif("deltaY" in e1){\n_7ec=e1.deltaY*-1;\n}\nvar dg=$(e.target).closest("div.datagrid-view").children(".datagrid-f");\nvar dc=dg.data("datagrid").dc;\ndc.body2.scrollTop(dc.body2.scrollTop()-_7ec);\n});\ndc.body2._bind("scroll",function(){\nvar b1=dc.view1.children("div.datagrid-body");\nvar stv=$(this).scrollTop();\n$(this).scrollTop(stv);\nb1.scrollTop(stv);\nvar c1=dc.body1.children(":first");\nvar c2=dc.body2.children(":first");\nif(c1.length&&c2.length){\nvar top1=c1.offset().top;\nvar top2=c2.offset().top;\nif(top1!=top2){\nb1.scrollTop(b1.scrollTop()+top1-top2);\n}\n}\ndc.view2.children("div.datagrid-header,div.datagrid-footer")._scrollLeft($(this)._scrollLeft());\ndc.body2.children("table.datagrid-btable-frozen").css("left",-$(this)._scrollLeft());\n});\n};\nfunction _7ed(_7ee){\nreturn function(e){\nvar td=$(e.target).closest("td[field]");\nif(td.length){\nvar _7ef=_7f0(td);\nif(!$(_7ef).data("datagrid").resizing&&_7ee){\ntd.addClass("datagrid-header-over");\n}else{\ntd.removeClass("datagrid-header-over");\n}\n}\n};\n};\nfunction _7f1(e){\nvar _7f2=_7f0(e.target);\nvar opts=$(_7f2).datagrid("options");\nvar ck=$(e.target).closest("input[type=checkbox]");\nif(ck.length){\nif(opts.singleSelect&&opts.selectOnCheck){\nreturn false;\n}\nif(ck.is(":checked")){\n_7f3(_7f2);\n}else{\n_7f4(_7f2);\n}\ne.stopPropagation();\n}else{\nvar cell=$(e.target).closest(".datagrid-cell");\nif(cell.length){\nvar p1=cell.offset().left+5;\nvar p2=cell.offset().left+cell._outerWidth()-5;\nif(e.pageX<p2&&e.pageX>p1){\n_7f5(_7f2,cell.parent().attr("field"));\n}\n}\n}\n};\nfunction _7f6(e){\nvar _7f7=_7f0(e.target);\nvar opts=$(_7f7).datagrid("options");\nvar cell=$(e.target).closest(".datagrid-cell");\nif(cell.length){\nvar p1=cell.offset().left+5;\nvar p2=cell.offset().left+cell._outerWidth()-5;\nvar cond=opts.resizeHandle=="right"?(e.pageX>p2):(opts.resizeHandle=="left"?(e.pageX<p1):(e.pageX<p1||e.pageX>p2));\nif(cond){\nvar _7f8=cell.parent().attr("field");\nvar col=_7e2(_7f7,_7f8);\nif(col.resizable==false){\nreturn;\n}\n$(_7f7).datagrid("autoSizeColumn",_7f8);\ncol.auto=false;\n}\n}\n};\nfunction _7f9(e){\nvar _7fa=_7f0(e.target);\nvar opts=$(_7fa).datagrid("options");\nvar td=$(e.target).closest("td[field]");\nopts.onHeaderContextMenu.call(_7fa,e,td.attr("field"));\n};\nfunction _7fb(_7fc){\nreturn function(e){\nvar tr=_7fd(e.target);\nif(!tr){\nreturn;\n}\nvar _7fe=_7f0(tr);\nif($.data(_7fe,"datagrid").resizing){\nreturn;\n}\nvar _7ff=_800(tr);\nif(_7fc){\n_801(_7fe,_7ff);\n}else{\nvar opts=$.data(_7fe,"datagrid").options;\nopts.finder.getTr(_7fe,_7ff).removeClass("datagrid-row-over");\n}\n};\n};\nfunction _802(e){\nvar tr=_7fd(e.target);\nif(!tr){\nreturn;\n}\nvar _803=_7f0(tr);\nvar opts=$.data(_803,"datagrid").options;\nvar _804=_800(tr);\nvar tt=$(e.target);\nif(tt.parent().hasClass("datagrid-cell-check")){\nif(opts.singleSelect&&opts.selectOnCheck){\ntt._propAttr("checked",!tt.is(":checked"));\n_805(_803,_804);\n}else{\nif(tt.is(":checked")){\ntt._propAttr("checked",false);\n_805(_803,_804);\n}else{\ntt._propAttr("checked",true);\n_806(_803,_804);\n}\n}\n}else{\nvar row=opts.finder.getRow(_803,_804);\nvar td=tt.closest("td[field]",tr);\nif(td.length){\nvar _807=td.attr("field");\nopts.onClickCell.call(_803,_804,_807,row[_807]);\n}\nif(opts.singleSelect==true){\n_808(_803,_804);\n}else{\nif(opts.ctrlSelect){\nif(e.metaKey||e.ctrlKey){\nif(tr.hasClass("datagrid-row-selected")){\n_809(_803,_804);\n}else{\n_808(_803,_804);\n}\n}else{\nif(e.shiftKey){\n$(_803).datagrid("clearSelections");\nvar _80a=Math.min(opts.lastSelectedIndex||0,_804);\nvar _80b=Math.max(opts.lastSelectedIndex||0,_804);\nfor(var i=_80a;i<=_80b;i++){\n_808(_803,i);\n}\n}else{\n$(_803).datagrid("clearSelections");\n_808(_803,_804);\nopts.lastSelectedIndex=_804;\n}\n}\n}else{\nif(tr.hasClass("datagrid-row-selected")){\n_809(_803,_804);\n}else{\n_808(_803,_804);\n}\n}\n}\nopts.onClickRow.apply(_803,_784(_803,[_804,row]));\n}\n};\nfunction _80c(e){\nvar tr=_7fd(e.target);\nif(!tr){\nreturn;\n}\nvar _80d=_7f0(tr);\nvar opts=$.data(_80d,"datagrid").options;\nvar _80e=_800(tr);\nvar row=opts.finder.getRow(_80d,_80e);\nvar td=$(e.target).closest("td[field]",tr);\nif(td.length){\nvar _80f=td.attr("field");\nopts.onDblClickCell.call(_80d,_80e,_80f,row[_80f]);\n}\nopts.onDblClickRow.apply(_80d,_784(_80d,[_80e,row]));\n};\nfunction _810(e){\nvar tr=_7fd(e.target);\nif(tr){\nvar _811=_7f0(tr);\nvar opts=$.data(_811,"datagrid").options;\nvar _812=_800(tr);\nvar row=opts.finder.getRow(_811,_812);\nopts.onRowContextMenu.call(_811,e,_812,row);\n}else{\nvar body=_7fd(e.target,".datagrid-body");\nif(body){\nvar _811=_7f0(body);\nvar opts=$.data(_811,"datagrid").options;\nopts.onRowContextMenu.call(_811,e,-1,null);\n}\n}\n};\nfunction _7f0(t){\nreturn $(t).closest("div.datagrid-view").children(".datagrid-f")[0];\n};\nfunction _7fd(t,_813){\nvar tr=$(t).closest(_813||"tr.datagrid-row");\nif(tr.length&&tr.parent().length){\nreturn tr;\n}else{\nreturn undefined;\n}\n};\nfunction _800(tr){\nif(tr.attr("datagrid-row-index")){\nreturn parseInt(tr.attr("datagrid-row-index"));\n}else{\nreturn tr.attr("node-id");\n}\n};\nfunction _7f5(_814,_815){\nvar _816=$.data(_814,"datagrid");\nvar opts=_816.options;\n_815=_815||{};\nvar _817={sortName:opts.sortName,sortOrder:opts.sortOrder};\nif(typeof _815=="object"){\n$.extend(_817,_815);\n}\nvar _818=[];\nvar _819=[];\nif(_817.sortName){\n_818=_817.sortName.split(",");\n_819=_817.sortOrder.split(",");\n}\nif(typeof _815=="string"){\nvar _81a=_815;\nvar col=_7e2(_814,_81a);\nif(!col.sortable||_816.resizing){\nreturn;\n}\nvar _81b=col.order||"asc";\nvar pos=_781(_818,_81a);\nif(pos>=0){\nvar _81c=_819[pos]=="asc"?"desc":"asc";\nif(opts.multiSort&&_81c==_81b){\n_818.splice(pos,1);\n_819.splice(pos,1);\n}else{\n_819[pos]=_81c;\n}\n}else{\nif(opts.multiSort){\n_818.push(_81a);\n_819.push(_81b);\n}else{\n_818=[_81a];\n_819=[_81b];\n}\n}\n_817.sortName=_818.join(",");\n_817.sortOrder=_819.join(",");\n}\nif(opts.onBeforeSortColumn.call(_814,_817.sortName,_817.sortOrder)==false){\nreturn;\n}\n$.extend(opts,_817);\nvar dc=_816.dc;\nvar _81d=dc.header1.add(dc.header2);\n_81d.find("div.datagrid-cell").removeClass("datagrid-sort-asc datagrid-sort-desc");\nfor(var i=0;i<_818.length;i++){\nvar col=_7e2(_814,_818[i]);\n_81d.find("div."+col.cellClass).addClass("datagrid-sort-"+_819[i]);\n}\nif(opts.remoteSort){\n_81e(_814);\n}else{\n_81f(_814,$(_814).datagrid("getData"));\n}\nopts.onSortColumn.call(_814,opts.sortName,opts.sortOrder);\n};\nfunction _820(_821,_822,_823){\n_824(true);\n_824(false);\nfunction _824(_825){\nvar aa=_826(_821,_825);\nif(aa.length){\nvar _827=aa[aa.length-1];\nvar _828=_781(_827,_822);\nif(_828>=0){\nfor(var _829=0;_829<aa.length-1;_829++){\nvar td=$("#"+aa[_829][_828]);\nvar _82a=parseInt(td.attr("colspan")||1)+(_823||0);\ntd.attr("colspan",_82a);\nif(_82a){\ntd.show();\n}else{\ntd.hide();\n}\n}\n}\n}\n};\n};\nfunction _82b(_82c){\nvar _82d=$.data(_82c,"datagrid");\nvar opts=_82d.options;\nvar dc=_82d.dc;\nvar _82e=dc.view2.children("div.datagrid-header");\nvar _82f=_82e.children("div.datagrid-header-inner");\ndc.body2.css("overflow-x","");\n_830();\n_831();\n_832();\n_830(true);\n_82f.show();\nif(_82e.width()>=_82e.find("table").width()){\ndc.body2.css("overflow-x","hidden");\n}\nif(!opts.showHeader){\n_82f.hide();\n}\nfunction _832(){\nif(!opts.fitColumns){\nreturn;\n}\nif(!_82d.leftWidth){\n_82d.leftWidth=0;\n}\nvar _833=0;\nvar cc=[];\nvar _834=_7e1(_82c,false);\nfor(var i=0;i<_834.length;i++){\nvar col=_7e2(_82c,_834[i]);\nif(_835(col)){\n_833+=col.width;\ncc.push({field:col.field,col:col,addingWidth:0});\n}\n}\nif(!_833){\nreturn;\n}\ncc[cc.length-1].addingWidth-=_82d.leftWidth;\n_82f.show();\nvar _836=_82e.width()-_82e.find("table").width()-opts.scrollbarSize+_82d.leftWidth;\nvar rate=_836/_833;\nif(!opts.showHeader){\n_82f.hide();\n}\nfor(var i=0;i<cc.length;i++){\nvar c=cc[i];\nvar _837=parseInt(c.col.width*rate);\nc.addingWidth+=_837;\n_836-=_837;\n}\ncc[cc.length-1].addingWidth+=_836;\nfor(var i=0;i<cc.length;i++){\nvar c=cc[i];\nif(c.col.boxWidth+c.addingWidth>0){\nc.col.boxWidth+=c.addingWidth;\nc.col.width+=c.addingWidth;\n}\n}\n_82d.leftWidth=_836;\n$(_82c).datagrid("fixColumnSize");\n};\nfunction _831(){\nvar _838=false;\nvar _839=_7e1(_82c,true).concat(_7e1(_82c,false));\n$.map(_839,function(_83a){\nvar col=_7e2(_82c,_83a);\nif(String(col.width||"").indexOf("%")>=0){\nvar _83b=$.parser.parseValue("width",col.width,dc.view,opts.scrollbarSize+(opts.rownumbers?opts.rownumberWidth:0))-col.deltaWidth;\nif(_83b>0){\ncol.boxWidth=_83b;\n_838=true;\n}\n}\n});\nif(_838){\n$(_82c).datagrid("fixColumnSize");\n}\n};\nfunction _830(fit){\nvar _83c=dc.header1.add(dc.header2).find(".datagrid-cell-group");\nif(_83c.length){\n_83c.each(function(){\n$(this)._outerWidth(fit?$(this).parent().width():10);\n});\nif(fit){\n_79a(_82c);\n}\n}\n};\nfunction _835(col){\nif(String(col.width||"").indexOf("%")>=0){\nreturn false;\n}\nif(!col.hidden&&!col.checkbox&&!col.auto&&!col.fixed){\nreturn true;\n}\n};\n};\nfunction _83d(_83e,_83f){\nvar _840=$.data(_83e,"datagrid");\nvar opts=_840.options;\nvar dc=_840.dc;\nvar tmp=$("<div class=\\"datagrid-cell\\" style=\\"position:absolute;left:-9999px\\"></div>").appendTo("body");\nif(_83f){\n_795(_83f);\n$(_83e).datagrid("fitColumns");\n}else{\nvar _841=false;\nvar _842=_7e1(_83e,true).concat(_7e1(_83e,false));\nfor(var i=0;i<_842.length;i++){\nvar _83f=_842[i];\nvar col=_7e2(_83e,_83f);\nif(col.auto){\n_795(_83f);\n_841=true;\n}\n}\nif(_841){\n$(_83e).datagrid("fitColumns");\n}\n}\ntmp.remove();\nfunction _795(_843){\nvar _844=dc.view.find("div.datagrid-header td[field=\\""+_843+"\\"] div.datagrid-cell");\n_844.css("width","");\nvar col=$(_83e).datagrid("getColumnOption",_843);\ncol.width=undefined;\ncol.boxWidth=undefined;\ncol.auto=true;\n$(_83e).datagrid("fixColumnSize",_843);\nvar _845=Math.max(_846("header"),_846("allbody"),_846("allfooter"))+1;\n_844._outerWidth(_845-1);\ncol.width=_845;\ncol.boxWidth=parseInt(_844[0].style.width);\ncol.deltaWidth=_845-col.boxWidth;\n_844.css("width","");\n$(_83e).datagrid("fixColumnSize",_843);\nopts.onResizeColumn.call(_83e,_843,col.width);\nfunction _846(type){\nvar _847=0;\nif(type=="header"){\n_847=_848(_844);\n}else{\nopts.finder.getTr(_83e,0,type).find("td[field=\\""+_843+"\\"] div.datagrid-cell").each(function(){\nvar w=_848($(this));\nif(_847<w){\n_847=w;\n}\n});\n}\nreturn _847;\nfunction _848(cell){\nreturn cell.is(":visible")?cell._outerWidth():tmp.html(cell.html())._outerWidth();\n};\n};\n};\n};\nfunction _849(_84a,_84b){\nvar _84c=$.data(_84a,"datagrid");\nvar opts=_84c.options;\nvar dc=_84c.dc;\nvar _84d=dc.view.find("table.datagrid-btable,table.datagrid-ftable");\n_84d.css("table-layout","fixed");\nif(_84b){\nfix(_84b);\n}else{\nvar ff=_7e1(_84a,true).concat(_7e1(_84a,false));\nfor(var i=0;i<ff.length;i++){\nfix(ff[i]);\n}\n}\n_84d.css("table-layout","");\n_84e(_84a);\n_7ab(_84a);\n_84f(_84a);\nfunction fix(_850){\nvar col=_7e2(_84a,_850);\nif(col.cellClass){\n_84c.ss.set("."+col.cellClass,col.boxWidth?col.boxWidth+"px":"auto");\n}\n};\n};\nfunction _84e(_851,tds){\nvar dc=$.data(_851,"datagrid").dc;\ntds=tds||dc.view.find("td.datagrid-td-merged");\ntds.each(function(){\nvar td=$(this);\nvar _852=td.attr("colspan")||1;\nif(_852>1){\nvar col=_7e2(_851,td.attr("field"));\nvar _853=col.boxWidth+col.deltaWidth-1;\nfor(var i=1;i<_852;i++){\ntd=td.next();\ncol=_7e2(_851,td.attr("field"));\n_853+=col.boxWidth+col.deltaWidth;\n}\n$(this).children("div.datagrid-cell")._outerWidth(_853);\n}\n});\n};\nfunction _84f(_854){\nvar dc=$.data(_854,"datagrid").dc;\ndc.view.find("div.datagrid-editable").each(function(){\nvar cell=$(this);\nvar _855=cell.parent().attr("field");\nvar col=$(_854).datagrid("getColumnOption",_855);\ncell._outerWidth(col.boxWidth+col.deltaWidth-1);\nvar ed=$.data(this,"datagrid.editor");\nif(ed.actions.resize){\ned.actions.resize(ed.target,cell.width());\n}\n});\n};\nfunction _7e2(_856,_857){\nfunction find(_858){\nif(_858){\nfor(var i=0;i<_858.length;i++){\nvar cc=_858[i];\nfor(var j=0;j<cc.length;j++){\nvar c=cc[j];\nif(c.field==_857){\nreturn c;\n}\n}\n}\n}\nreturn null;\n};\nvar opts=$.data(_856,"datagrid").options;\nvar col=find(opts.columns);\nif(!col){\ncol=find(opts.frozenColumns);\n}\nreturn col;\n};\nfunction _826(_859,_85a){\nvar opts=$.data(_859,"datagrid").options;\nvar _85b=_85a?opts.frozenColumns:opts.columns;\nvar aa=[];\nvar _85c=_85d();\nfor(var i=0;i<_85b.length;i++){\naa[i]=new Array(_85c);\n}\nfor(var _85e=0;_85e<_85b.length;_85e++){\n$.map(_85b[_85e],function(col){\nvar _85f=_860(aa[_85e]);\nif(_85f>=0){\nvar _861=col.field||col.id||"";\nfor(var c=0;c<(col.colspan||1);c++){\nfor(var r=0;r<(col.rowspan||1);r++){\naa[_85e+r][_85f]=_861;\n}\n_85f++;\n}\n}\n});\n}\nreturn aa;\nfunction _85d(){\nvar _862=0;\n$.map(_85b[0]||[],function(col){\n_862+=col.colspan||1;\n});\nreturn _862;\n};\nfunction _860(a){\nfor(var i=0;i<a.length;i++){\nif(a[i]==undefined){\nreturn i;\n}\n}\nreturn -1;\n};\n};\nfunction _7e1(_863,_864){\nvar aa=_826(_863,_864);\nreturn aa.length?aa[aa.length-1]:aa;\n};\nfunction _81f(_865,data){\nvar _866=$.data(_865,"datagrid");\nvar opts=_866.options;\nvar dc=_866.dc;\ndata=opts.loadFilter.call(_865,data);\nif($.isArray(data)){\ndata={total:data.length,rows:data};\n}\ndata.total=parseInt(data.total);\n_866.data=data;\nif(data.footer){\n_866.footer=data.footer;\n}\nif(!opts.remoteSort&&opts.sortName){\nvar _867=opts.sortName.split(",");\nvar _868=opts.sortOrder.split(",");\ndata.rows.sort(function(r1,r2){\nvar r=0;\nfor(var i=0;i<_867.length;i++){\nvar sn=_867[i];\nvar so=_868[i];\nvar col=_7e2(_865,sn);\nvar _869=col.sorter||function(a,b){\nreturn a==b?0:(a>b?1:-1);\n};\nr=_869(r1[sn],r2[sn],r1,r2)*(so=="asc"?1:-1);\nif(r!=0){\nreturn r;\n}\n}\nreturn r;\n});\n}\nif(opts.view.onBeforeRender){\nopts.view.onBeforeRender.call(opts.view,_865,data.rows);\n}\nopts.view.render.call(opts.view,_865,dc.body2,false);\nopts.view.render.call(opts.view,_865,dc.body1,true);\nif(opts.showFooter){\nopts.view.renderFooter.call(opts.view,_865,dc.footer2,false);\nopts.view.renderFooter.call(opts.view,_865,dc.footer1,true);\n}\nif(opts.view.onAfterRender){\nopts.view.onAfterRender.call(opts.view,_865);\n}\n_866.ss.clean();\nvar _86a=$(_865).datagrid("getPager");\nif(_86a.length){\nvar _86b=_86a.pagination("options");\nif(_86b.total!=data.total){\n_86a.pagination("refresh",{pageNumber:opts.pageNumber,total:data.total});\nif(opts.pageNumber!=_86b.pageNumber&&_86b.pageNumber>0){\nopts.pageNumber=_86b.pageNumber;\n_81e(_865);\n}\n}\n}\n_7ab(_865);\ndc.body2.triggerHandler("scroll");\n$(_865).datagrid("setSelectionState");\n$(_865).datagrid("autoSizeColumn");\nopts.onLoadSuccess.call(_865,data);\n};\nfunction _86c(_86d){\nvar _86e=$.data(_86d,"datagrid");\nvar opts=_86e.options;\nvar dc=_86e.dc;\ndc.header1.add(dc.header2).find("input[type=checkbox]")._propAttr("checked",false);\nif(opts.idField){\nvar _86f=$.data(_86d,"treegrid")?true:false;\nvar _870=opts.onSelect;\nvar _871=opts.onCheck;\nopts.onSelect=opts.onCheck=function(){\n};\nvar rows=opts.finder.getRows(_86d);\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nvar _872=_86f?row[opts.idField]:$(_86d).datagrid("getRowIndex",row[opts.idField]);\nif(_873(_86e.selectedRows,row)){\n_808(_86d,_872,true,true);\n}\nif(_873(_86e.checkedRows,row)){\n_805(_86d,_872,true);\n}\n}\nopts.onSelect=_870;\nopts.onCheck=_871;\n}\nfunction _873(a,r){\nfor(var i=0;i<a.length;i++){\nif(a[i][opts.idField]==r[opts.idField]){\na[i]=r;\nreturn true;\n}\n}\nreturn false;\n};\n};\nfunction _874(_875,row){\nvar _876=$.data(_875,"datagrid");\nvar opts=_876.options;\nvar rows=_876.data.rows;\nif(typeof row=="object"){\nreturn _781(rows,row);\n}else{\nfor(var i=0;i<rows.length;i++){\nif(rows[i][opts.idField]==row){\nreturn i;\n}\n}\nreturn -1;\n}\n};\nfunction _877(_878){\nvar _879=$.data(_878,"datagrid");\nvar opts=_879.options;\nvar data=_879.data;\nif(opts.idField){\nreturn _879.selectedRows;\n}else{\nvar rows=[];\nopts.finder.getTr(_878,"","selected",2).each(function(){\nrows.push(opts.finder.getRow(_878,$(this)));\n});\nreturn rows;\n}\n};\nfunction _87a(_87b){\nvar _87c=$.data(_87b,"datagrid");\nvar opts=_87c.options;\nif(opts.idField){\nreturn _87c.checkedRows;\n}else{\nvar rows=[];\nopts.finder.getTr(_87b,"","checked",2).each(function(){\nrows.push(opts.finder.getRow(_87b,$(this)));\n});\nreturn rows;\n}\n};\nfunction _87d(_87e,_87f){\nvar _880=$.data(_87e,"datagrid");\nvar dc=_880.dc;\nvar opts=_880.options;\nvar tr=opts.finder.getTr(_87e,_87f);\nif(tr.length){\nif(tr.closest("table").hasClass("datagrid-btable-frozen")){\nreturn;\n}\nvar _881=dc.view2.children("div.datagrid-header")._outerHeight();\nvar _882=dc.body2;\nvar _883=opts.scrollbarSize;\nif(_882[0].offsetHeight&&_882[0].clientHeight&&_882[0].offsetHeight<=_882[0].clientHeight){\n_883=0;\n}\nvar _884=_882.outerHeight(true)-_882.outerHeight();\nvar top=tr.offset().top-dc.view2.offset().top-_881-_884;\nif(top<0){\n_882.scrollTop(_882.scrollTop()+top);\n}else{\nif(top+tr._outerHeight()>_882.height()-_883){\n_882.scrollTop(_882.scrollTop()+top+tr._outerHeight()-_882.height()+_883);\n}\n}\n}\n};\nfunction _801(_885,_886){\nvar _887=$.data(_885,"datagrid");\nvar opts=_887.options;\nopts.finder.getTr(_885,_887.highlightIndex).removeClass("datagrid-row-over");\nopts.finder.getTr(_885,_886).addClass("datagrid-row-over");\n_887.highlightIndex=_886;\n};\nfunction _808(_888,_889,_88a,_88b){\nvar _88c=$.data(_888,"datagrid");\nvar opts=_88c.options;\nvar row=opts.finder.getRow(_888,_889);\nif(!row){\nreturn;\n}\nvar tr=opts.finder.getTr(_888,_889);\nif(tr.hasClass("datagrid-row-selected")){\nreturn;\n}\nif(opts.onBeforeSelect.apply(_888,_784(_888,[_889,row]))==false){\nreturn;\n}\nif(opts.singleSelect){\n_88d(_888,true);\n_88c.selectedRows=[];\n}\nif(!_88a&&opts.checkOnSelect){\n_805(_888,_889,true);\n}\nif(opts.idField){\n_783(_88c.selectedRows,opts.idField,row);\n}\ntr.addClass("datagrid-row-selected");\nif(_88c.selectingData){\n_88c.selectingData.push(row);\n}\nopts.onSelect.apply(_888,_784(_888,[_889,row]));\nif(!_88b&&opts.scrollOnSelect){\n_87d(_888,_889);\n}\n};\nfunction _809(_88e,_88f,_890){\nvar _891=$.data(_88e,"datagrid");\nvar dc=_891.dc;\nvar opts=_891.options;\nvar row=opts.finder.getRow(_88e,_88f);\nif(!row){\nreturn;\n}\nvar tr=opts.finder.getTr(_88e,_88f);\nif(!tr.hasClass("datagrid-row-selected")){\nreturn;\n}\nif(opts.onBeforeUnselect.apply(_88e,_784(_88e,[_88f,row]))==false){\nreturn;\n}\nif(!_890&&opts.checkOnSelect){\n_806(_88e,_88f,true);\n}\ntr.removeClass("datagrid-row-selected");\nif(opts.idField){\n_782(_891.selectedRows,opts.idField,row[opts.idField]);\n}\nif(_891.selectingData){\n_891.selectingData.push(row);\n}\nopts.onUnselect.apply(_88e,_784(_88e,[_88f,row]));\n};\nfunction _892(_893,_894){\nvar _895=$.data(_893,"datagrid");\nvar opts=_895.options;\nvar _896=$.data(_893,"treegrid")?true:false;\nvar _897=opts.scrollOnSelect;\nopts.scrollOnSelect=false;\n_895.selectingData=[];\nif(!_894&&opts.checkOnSelect){\n_7f3(_893,true);\n}\nvar rows=opts.finder.getRows(_893);\nfor(var i=0;i<rows.length;i++){\nvar _898=_896?rows[i][opts.idField]:$(_893).datagrid("getRowIndex",rows[i]);\n_808(_893,_898);\n}\nvar _899=_895.selectingData;\n_895.selectingData=null;\nopts.scrollOnSelect=_897;\nopts.onSelectAll.call(_893,_899);\n};\nfunction _88d(_89a,_89b){\nvar _89c=$.data(_89a,"datagrid");\nvar opts=_89c.options;\nvar _89d=$.data(_89a,"treegrid")?true:false;\n_89c.selectingData=[];\nif(!_89b&&opts.checkOnSelect){\n_7f4(_89a,true);\n}\nvar rows=opts.finder.getRows(_89a);\nfor(var i=0;i<rows.length;i++){\nvar _89e=_89d?rows[i][opts.idField]:$(_89a).datagrid("getRowIndex",rows[i]);\n_809(_89a,_89e);\n}\nvar _89f=_89c.selectingData;\n_89c.selectingData=null;\nopts.onUnselectAll.call(_89a,_89f);\n};\nfunction _8a0(_8a1){\nvar _8a2=$.data(_8a1,"datagrid");\nvar opts=_8a2.options;\nvar _8a3=[];\nvar rows=opts.finder.getRows(_8a1);\nfor(var i=0;i<rows.length;i++){\nvar _8a4=_874(_8a1,rows[i]);\nif(opts.onBeforeCheck.apply(_8a1,_784(_8a1,[_8a4,rows[i]]))!=false){\n_8a3.push(rows[i]);\n}\n}\nvar trs=opts.finder.getTr(_8a1,"","checked",2);\nvar _8a5=trs.length==_8a3.length;\nvar dc=_8a2.dc;\ndc.header1.add(dc.header2).find("input[type=checkbox]")._propAttr("checked",_8a5);\n};\nfunction _805(_8a6,_8a7,_8a8){\nvar _8a9=$.data(_8a6,"datagrid");\nvar opts=_8a9.options;\nvar row=opts.finder.getRow(_8a6,_8a7);\nif(!row){\nreturn;\n}\nvar tr=opts.finder.getTr(_8a6,_8a7);\nvar ck=tr.find(".datagrid-cell-check input[type=checkbox]");\nif(ck.is(":checked")){\nreturn;\n}\nif(opts.onBeforeCheck.apply(_8a6,_784(_8a6,[_8a7,row]))==false){\nreturn;\n}\nif(opts.singleSelect&&opts.selectOnCheck){\n_7f4(_8a6,true);\n_8a9.checkedRows=[];\n}\nif(!_8a8&&opts.selectOnCheck){\n_808(_8a6,_8a7,true);\n}\ntr.addClass("datagrid-row-checked");\nck._propAttr("checked",true);\nif(!opts.notSetHeaderCheck){\n_8a0(_8a6);\n}\nif(opts.idField){\n_783(_8a9.checkedRows,opts.idField,row);\n}\nif(_8a9.checkingData){\n_8a9.checkingData.push(row);\n}\nopts.onCheck.apply(_8a6,_784(_8a6,[_8a7,row]));\n};\nfunction _806(_8aa,_8ab,_8ac){\nvar _8ad=$.data(_8aa,"datagrid");\nvar opts=_8ad.options;\nvar row=opts.finder.getRow(_8aa,_8ab);\nif(!row){\nreturn;\n}\nvar tr=opts.finder.getTr(_8aa,_8ab);\nvar ck=tr.find("div.datagrid-cell-check input[type=checkbox]");\nif(!ck.is(":checked")){\nreturn;\n}\nif(opts.onBeforeUncheck.apply(_8aa,_784(_8aa,[_8ab,row]))==false){\nreturn;\n}\nif(!_8ac&&opts.selectOnCheck){\n_809(_8aa,_8ab,true);\n}\ntr.removeClass("datagrid-row-checked");\nck._propAttr("checked",false);\nvar dc=_8ad.dc;\nvar _8ae=dc.header1.add(dc.header2);\n_8ae.find("input[type=checkbox]")._propAttr("checked",false);\nif(opts.idField){\n_782(_8ad.checkedRows,opts.idField,row[opts.idField]);\n}\nif(_8ad.checkingData){\n_8ad.checkingData.push(row);\n}\nopts.onUncheck.apply(_8aa,_784(_8aa,[_8ab,row]));\n};\nfunction _7f3(_8af,_8b0){\nvar _8b1=$.data(_8af,"datagrid");\nvar opts=_8b1.options;\nvar _8b2=$.data(_8af,"treegrid")?true:false;\nvar _8b3=opts.scrollOnSelect;\nopts.scrollOnSelect=false;\nopts.notSetHeaderCheck=true;\n_8b1.checkingData=[];\nif(!_8b0&&opts.selectOnCheck){\n_892(_8af,true);\n}\nvar rows=opts.finder.getRows(_8af);\nfor(var i=0;i<rows.length;i++){\nvar _8b4=_8b2?rows[i][opts.idField]:$(_8af).datagrid("getRowIndex",rows[i]);\n_805(_8af,_8b4);\n}\n_8a0(_8af);\nvar _8b5=_8b1.checkingData;\n_8b1.checkingData=null;\nopts.scrollOnSelect=_8b3;\nopts.notSetHeaderCheck=false;\nopts.onCheckAll.call(_8af,_8b5);\n};\nfunction _7f4(_8b6,_8b7){\nvar _8b8=$.data(_8b6,"datagrid");\nvar opts=_8b8.options;\nvar _8b9=$.data(_8b6,"treegrid")?true:false;\n_8b8.checkingData=[];\nif(!_8b7&&opts.selectOnCheck){\n_88d(_8b6,true);\n}\nvar rows=opts.finder.getRows(_8b6);\nfor(var i=0;i<rows.length;i++){\nvar _8ba=_8b9?rows[i][opts.idField]:$(_8b6).datagrid("getRowIndex",rows[i]);\n_806(_8b6,_8ba);\n}\nvar _8bb=_8b8.checkingData;\n_8b8.checkingData=null;\nopts.onUncheckAll.call(_8b6,_8bb);\n};\nfunction _8bc(_8bd,_8be){\nvar opts=$.data(_8bd,"datagrid").options;\nvar tr=opts.finder.getTr(_8bd,_8be);\nvar row=opts.finder.getRow(_8bd,_8be);\nif(tr.hasClass("datagrid-row-editing")){\nreturn;\n}\nif(opts.onBeforeEdit.apply(_8bd,_784(_8bd,[_8be,row]))==false){\nreturn;\n}\ntr.addClass("datagrid-row-editing");\n_8bf(_8bd,_8be);\n_84f(_8bd);\ntr.find("div.datagrid-editable").each(function(){\nvar _8c0=$(this).parent().attr("field");\nvar ed=$.data(this,"datagrid.editor");\ned.actions.setValue(ed.target,row[_8c0]);\n});\n_8c1(_8bd,_8be);\nopts.onBeginEdit.apply(_8bd,_784(_8bd,[_8be,row]));\n};\nfunction _8c2(_8c3,_8c4,_8c5){\nvar _8c6=$.data(_8c3,"datagrid");\nvar opts=_8c6.options;\nvar _8c7=_8c6.updatedRows;\nvar _8c8=_8c6.insertedRows;\nvar tr=opts.finder.getTr(_8c3,_8c4);\nvar row=opts.finder.getRow(_8c3,_8c4);\nif(!tr.hasClass("datagrid-row-editing")){\nreturn;\n}\nif(!_8c5){\nif(!_8c1(_8c3,_8c4)){\nreturn;\n}\nvar _8c9=false;\nvar _8ca={};\ntr.find("div.datagrid-editable").each(function(){\nvar _8cb=$(this).parent().attr("field");\nvar ed=$.data(this,"datagrid.editor");\nvar t=$(ed.target);\nvar _8cc=t.data("textbox")?t.textbox("textbox"):t;\nif(_8cc.is(":focus")){\n_8cc.triggerHandler("blur");\n}\nvar _8cd=ed.actions.getValue(ed.target);\nif(row[_8cb]!==_8cd){\nrow[_8cb]=_8cd;\n_8c9=true;\n_8ca[_8cb]=_8cd;\n}\n});\nif(_8c9){\nif(_781(_8c8,row)==-1){\nif(_781(_8c7,row)==-1){\n_8c7.push(row);\n}\n}\n}\nopts.onEndEdit.apply(_8c3,_784(_8c3,[_8c4,row,_8ca]));\n}\ntr.removeClass("datagrid-row-editing");\n_8ce(_8c3,_8c4);\n$(_8c3).datagrid("refreshRow",_8c4);\nif(!_8c5){\nopts.onAfterEdit.apply(_8c3,_784(_8c3,[_8c4,row,_8ca]));\n}else{\nopts.onCancelEdit.apply(_8c3,_784(_8c3,[_8c4,row]));\n}\n};\nfunction _8cf(_8d0,_8d1){\nvar opts=$.data(_8d0,"datagrid").options;\nvar tr=opts.finder.getTr(_8d0,_8d1);\nvar _8d2=[];\ntr.children("td").each(function(){\nvar cell=$(this).find("div.datagrid-editable");\nif(cell.length){\nvar ed=$.data(cell[0],"datagrid.editor");\n_8d2.push(ed);\n}\n});\nreturn _8d2;\n};\nfunction _8d3(_8d4,_8d5){\nvar _8d6=_8cf(_8d4,_8d5.index!=undefined?_8d5.index:_8d5.id);\nfor(var i=0;i<_8d6.length;i++){\nif(_8d6[i].field==_8d5.field){\nreturn _8d6[i];\n}\n}\nreturn null;\n};\nfunction _8bf(_8d7,_8d8){\nvar opts=$.data(_8d7,"datagrid").options;\nvar tr=opts.finder.getTr(_8d7,_8d8);\ntr.children("td").each(function(){\nvar cell=$(this).find("div.datagrid-cell");\nvar _8d9=$(this).attr("field");\nvar col=_7e2(_8d7,_8d9);\nif(col&&col.editor){\nvar _8da,_8db;\nif(typeof col.editor=="string"){\n_8da=col.editor;\n}else{\n_8da=col.editor.type;\n_8db=col.editor.options;\n}\nvar _8dc=opts.editors[_8da];\nif(_8dc){\nvar _8dd=cell.html();\nvar _8de=cell._outerWidth();\ncell.addClass("datagrid-editable");\ncell._outerWidth(_8de);\ncell.html("<table border=\\"0\\" cellspacing=\\"0\\" cellpadding=\\"1\\"><tr><td></td></tr></table>");\ncell.children("table")._bind("click dblclick contextmenu",function(e){\ne.stopPropagation();\n});\n$.data(cell[0],"datagrid.editor",{actions:_8dc,target:_8dc.init(cell.find("td"),$.extend({height:opts.editorHeight},_8db)),field:_8d9,type:_8da,oldHtml:_8dd});\n}\n}\n});\n_7ab(_8d7,_8d8,true);\n};\nfunction _8ce(_8df,_8e0){\nvar opts=$.data(_8df,"datagrid").options;\nvar tr=opts.finder.getTr(_8df,_8e0);\ntr.children("td").each(function(){\nvar cell=$(this).find("div.datagrid-editable");\nif(cell.length){\nvar ed=$.data(cell[0],"datagrid.editor");\nif(ed.actions.destroy){\ned.actions.destroy(ed.target);\n}\ncell.html(ed.oldHtml);\n$.removeData(cell[0],"datagrid.editor");\ncell.removeClass("datagrid-editable");\ncell.css("width","");\n}\n});\n};\nfunction _8c1(_8e1,_8e2){\nvar tr=$.data(_8e1,"datagrid").options.finder.getTr(_8e1,_8e2);\nif(!tr.hasClass("datagrid-row-editing")){\nreturn true;\n}\nvar vbox=tr.find(".validatebox-text");\nvbox.validatebox("validate");\nvbox.trigger("mouseleave");\nvar _8e3=tr.find(".validatebox-invalid");\nreturn _8e3.length==0;\n};\nfunction _8e4(_8e5,_8e6){\nvar _8e7=$.data(_8e5,"datagrid").insertedRows;\nvar _8e8=$.data(_8e5,"datagrid").deletedRows;\nvar _8e9=$.data(_8e5,"datagrid").updatedRows;\nif(!_8e6){\nvar rows=[];\nrows=rows.concat(_8e7);\nrows=rows.concat(_8e8);\nrows=rows.concat(_8e9);\nreturn rows;\n}else{\nif(_8e6=="inserted"){\nreturn _8e7;\n}else{\nif(_8e6=="deleted"){\nreturn _8e8;\n}else{\nif(_8e6=="updated"){\nreturn _8e9;\n}\n}\n}\n}\nreturn [];\n};\nfunction _8ea(_8eb,_8ec){\nvar _8ed=$.data(_8eb,"datagrid");\nvar opts=_8ed.options;\nvar data=_8ed.data;\nvar _8ee=_8ed.insertedRows;\nvar _8ef=_8ed.deletedRows;\n$(_8eb).datagrid("cancelEdit",_8ec);\nvar row=opts.finder.getRow(_8eb,_8ec);\nif(_781(_8ee,row)>=0){\n_782(_8ee,row);\n}else{\n_8ef.push(row);\n}\n_782(_8ed.selectedRows,opts.idField,row[opts.idField]);\n_782(_8ed.checkedRows,opts.idField,row[opts.idField]);\nopts.view.deleteRow.call(opts.view,_8eb,_8ec);\nif(opts.height=="auto"){\n_7ab(_8eb);\n}\n$(_8eb).datagrid("getPager").pagination("refresh",{total:data.total});\n};\nfunction _8f0(_8f1,_8f2){\nvar data=$.data(_8f1,"datagrid").data;\nvar view=$.data(_8f1,"datagrid").options.view;\nvar _8f3=$.data(_8f1,"datagrid").insertedRows;\nview.insertRow.call(view,_8f1,_8f2.index,_8f2.row);\n_8f3.push(_8f2.row);\n$(_8f1).datagrid("getPager").pagination("refresh",{total:data.total});\n};\nfunction _8f4(_8f5,row){\nvar data=$.data(_8f5,"datagrid").data;\nvar view=$.data(_8f5,"datagrid").options.view;\nvar _8f6=$.data(_8f5,"datagrid").insertedRows;\nview.insertRow.call(view,_8f5,null,row);\n_8f6.push(row);\n$(_8f5).datagrid("getPager").pagination("refresh",{total:data.total});\n};\nfunction _8f7(_8f8,_8f9){\nvar _8fa=$.data(_8f8,"datagrid");\nvar opts=_8fa.options;\nvar row=opts.finder.getRow(_8f8,_8f9.index);\nvar _8fb=false;\n_8f9.row=_8f9.row||{};\nfor(var _8fc in _8f9.row){\nif(row[_8fc]!==_8f9.row[_8fc]){\n_8fb=true;\nbreak;\n}\n}\nif(_8fb){\nif(_781(_8fa.insertedRows,row)==-1){\nif(_781(_8fa.updatedRows,row)==-1){\n_8fa.updatedRows.push(row);\n}\n}\nopts.view.updateRow.call(opts.view,_8f8,_8f9.index,_8f9.row);\n}\n};\nfunction _8fd(_8fe){\nvar _8ff=$.data(_8fe,"datagrid");\nvar data=_8ff.data;\nvar rows=data.rows;\nvar _900=[];\nfor(var i=0;i<rows.length;i++){\n_900.push($.extend({},rows[i]));\n}\n_8ff.originalRows=_900;\n_8ff.updatedRows=[];\n_8ff.insertedRows=[];\n_8ff.deletedRows=[];\n};\nfunction _901(_902){\nvar data=$.data(_902,"datagrid").data;\nvar ok=true;\nfor(var i=0,len=data.rows.length;i<len;i++){\nif(_8c1(_902,i)){\n$(_902).datagrid("endEdit",i);\n}else{\nok=false;\n}\n}\nif(ok){\n_8fd(_902);\n}\n};\nfunction _903(_904){\nvar _905=$.data(_904,"datagrid");\nvar opts=_905.options;\nvar _906=_905.originalRows;\nvar _907=_905.insertedRows;\nvar _908=_905.deletedRows;\nvar _909=_905.selectedRows;\nvar _90a=_905.checkedRows;\nvar data=_905.data;\nfunction _90b(a){\nvar ids=[];\nfor(var i=0;i<a.length;i++){\nids.push(a[i][opts.idField]);\n}\nreturn ids;\n};\nfunction _90c(ids,_90d){\nfor(var i=0;i<ids.length;i++){\nvar _90e=_874(_904,ids[i]);\nif(_90e>=0){\n(_90d=="s"?_808:_805)(_904,_90e,true);\n}\n}\n};\nfor(var i=0;i<data.rows.length;i++){\n$(_904).datagrid("cancelEdit",i);\n}\nvar _90f=_90b(_909);\nvar _910=_90b(_90a);\n_909.splice(0,_909.length);\n_90a.splice(0,_90a.length);\ndata.total+=_908.length-_907.length;\ndata.rows=_906;\n_81f(_904,data);\n_90c(_90f,"s");\n_90c(_910,"c");\n_8fd(_904);\n};\nfunction _81e(_911,_912,cb){\nvar opts=$.data(_911,"datagrid").options;\nif(_912){\nopts.queryParams=_912;\n}\nvar _913=$.extend({},opts.queryParams);\nif(opts.pagination){\n$.extend(_913,{page:opts.pageNumber||1,rows:opts.pageSize});\n}\nif(opts.sortName&&opts.remoteSort){\n$.extend(_913,{sort:opts.sortName,order:opts.sortOrder});\n}\nif(opts.onBeforeLoad.call(_911,_913)==false){\nopts.view.setEmptyMsg(_911);\nreturn;\n}\n$(_911).datagrid("loading");\nvar _914=opts.loader.call(_911,_913,function(data){\n$(_911).datagrid("loaded");\n$(_911).datagrid("loadData",data);\nif(cb){\ncb();\n}\n},function(){\n$(_911).datagrid("loaded");\nopts.onLoadError.apply(_911,arguments);\n});\nif(_914==false){\n$(_911).datagrid("loaded");\nopts.view.setEmptyMsg(_911);\n}\n};\nfunction _915(_916,_917){\nvar opts=$.data(_916,"datagrid").options;\n_917.type=_917.type||"body";\n_917.rowspan=_917.rowspan||1;\n_917.colspan=_917.colspan||1;\nif(_917.rowspan==1&&_917.colspan==1){\nreturn;\n}\nvar tr=opts.finder.getTr(_916,(_917.index!=undefined?_917.index:_917.id),_917.type);\nif(!tr.length){\nreturn;\n}\nvar td=tr.find("td[field=\\""+_917.field+"\\"]");\ntd.attr("rowspan",_917.rowspan).attr("colspan",_917.colspan);\ntd.addClass("datagrid-td-merged");\n_918(td.next(),_917.colspan-1);\nfor(var i=1;i<_917.rowspan;i++){\ntr=tr.next();\nif(!tr.length){\nbreak;\n}\n_918(tr.find("td[field=\\""+_917.field+"\\"]"),_917.colspan);\n}\n_84e(_916,td);\nfunction _918(td,_919){\nfor(var i=0;i<_919;i++){\ntd.hide();\ntd=td.next();\n}\n};\n};\n$.fn.datagrid=function(_91a,_91b){\nif(typeof _91a=="string"){\nreturn $.fn.datagrid.methods[_91a](this,_91b);\n}\n_91a=_91a||{};\nreturn this.each(function(){\nvar _91c=$.data(this,"datagrid");\nvar opts;\nif(_91c){\nopts=$.extend(_91c.options,_91a);\n_91c.options=opts;\n}else{\nopts=$.extend({},$.extend({},$.fn.datagrid.defaults,{queryParams:{}}),$.fn.datagrid.parseOptions(this),_91a);\n$(this).css("width","").css("height","");\nvar _91d=_7c0(this,opts.rownumbers);\nif(!opts.columns){\nopts.columns=_91d.columns;\n}\nif(!opts.frozenColumns){\nopts.frozenColumns=_91d.frozenColumns;\n}\nopts.columns=$.extend(true,[],opts.columns);\nopts.frozenColumns=$.extend(true,[],opts.frozenColumns);\nopts.view=$.extend({},opts.view);\n$.data(this,"datagrid",{options:opts,panel:_91d.panel,dc:_91d.dc,ss:null,selectedRows:[],checkedRows:[],data:{total:0,rows:[]},originalRows:[],updatedRows:[],insertedRows:[],deletedRows:[]});\n}\n_7c9(this);\n_7e3(this);\n_795(this);\nif(opts.data){\n$(this).datagrid("loadData",opts.data);\n}else{\nvar data=$.fn.datagrid.parseData(this);\nif(data.total>0){\n$(this).datagrid("loadData",data);\n}else{\n$(this).datagrid("autoSizeColumn");\n}\n}\n_81e(this);\n});\n};\nfunction _91e(_91f){\nvar _920={};\n$.map(_91f,function(name){\n_920[name]=_921(name);\n});\nreturn _920;\nfunction _921(name){\nfunction isA(_922){\nreturn $.data($(_922)[0],name)!=undefined;\n};\nreturn {init:function(_923,_924){\nvar _925=$("<input type=\\"text\\" class=\\"datagrid-editable-input\\">").appendTo(_923);\nif(_925[name]&&name!="text"){\nreturn _925[name](_924);\n}else{\nreturn _925;\n}\n},destroy:function(_926){\nif(isA(_926,name)){\n$(_926)[name]("destroy");\n}\n},getValue:function(_927){\nif(isA(_927,name)){\nvar opts=$(_927)[name]("options");\nif(opts.multiple){\nreturn $(_927)[name]("getValues").join(opts.separator);\n}else{\nreturn $(_927)[name]("getValue");\n}\n}else{\nreturn $(_927).val();\n}\n},setValue:function(_928,_929){\nif(isA(_928,name)){\nvar opts=$(_928)[name]("options");\nif(opts.multiple){\nif(_929){\n$(_928)[name]("setValues",_929.split(opts.separator));\n}else{\n$(_928)[name]("clear");\n}\n}else{\n$(_928)[name]("setValue",_929);\n}\n}else{\n$(_928).val(_929);\n}\n},resize:function(_92a,_92b){\nif(isA(_92a,name)){\n$(_92a)[name]("resize",_92b);\n}else{\n$(_92a)._size({width:_92b,height:$.fn.datagrid.defaults.editorHeight});\n}\n}};\n};\n};\nvar _92c=$.extend({},_91e(["text","textbox","passwordbox","filebox","numberbox","numberspinner","combobox","combotree","combogrid","combotreegrid","datebox","datetimebox","timespinner","datetimespinner"]),{textarea:{init:function(_92d,_92e){\nvar _92f=$("<textarea class=\\"datagrid-editable-input\\"></textarea>").appendTo(_92d);\n_92f.css("vertical-align","middle")._outerHeight(_92e.height);\nreturn _92f;\n},getValue:function(_930){\nreturn $(_930).val();\n},setValue:function(_931,_932){\n$(_931).val(_932);\n},resize:function(_933,_934){\n$(_933)._outerWidth(_934);\n}},checkbox:{init:function(_935,_936){\nvar _937=$("<input type=\\"checkbox\\">").appendTo(_935);\n_937.val(_936.on);\n_937.attr("offval",_936.off);\nreturn _937;\n},getValue:function(_938){\nif($(_938).is(":checked")){\nreturn $(_938).val();\n}else{\nreturn $(_938).attr("offval");\n}\n},setValue:function(_939,_93a){\nvar _93b=false;\nif($(_939).val()==_93a){\n_93b=true;\n}\n$(_939)._propAttr("checked",_93b);\n}},validatebox:{init:function(_93c,_93d){\nvar _93e=$("<input type=\\"text\\" class=\\"datagrid-editable-input\\">").appendTo(_93c);\n_93e.validatebox(_93d);\nreturn _93e;\n},destroy:function(_93f){\n$(_93f).validatebox("destroy");\n},getValue:function(_940){\nreturn $(_940).val();\n},setValue:function(_941,_942){\n$(_941).val(_942);\n},resize:function(_943,_944){\n$(_943)._outerWidth(_944)._outerHeight($.fn.datagrid.defaults.editorHeight);\n}}});\n$.fn.datagrid.methods={options:function(jq){\nvar _945=$.data(jq[0],"datagrid").options;\nvar _946=$.data(jq[0],"datagrid").panel.panel("options");\nvar opts=$.extend(_945,{width:_946.width,height:_946.height,closed:_946.closed,collapsed:_946.collapsed,minimized:_946.minimized,maximized:_946.maximized});\nreturn opts;\n},setSelectionState:function(jq){\nreturn jq.each(function(){\n_86c(this);\n});\n},createStyleSheet:function(jq){\nreturn _786(jq[0]);\n},getPanel:function(jq){\nreturn $.data(jq[0],"datagrid").panel;\n},getPager:function(jq){\nreturn $.data(jq[0],"datagrid").panel.children("div.datagrid-pager");\n},getColumnFields:function(jq,_947){\nreturn _7e1(jq[0],_947);\n},getColumnOption:function(jq,_948){\nreturn _7e2(jq[0],_948);\n},resize:function(jq,_949){\nreturn jq.each(function(){\n_795(this,_949);\n});\n},load:function(jq,_94a){\nreturn jq.each(function(){\nvar opts=$(this).datagrid("options");\nif(typeof _94a=="string"){\nopts.url=_94a;\n_94a=null;\n}\nopts.pageNumber=1;\nvar _94b=$(this).datagrid("getPager");\n_94b.pagination("refresh",{pageNumber:1});\n_81e(this,_94a);\n});\n},reload:function(jq,_94c){\nreturn jq.each(function(){\nvar opts=$(this).datagrid("options");\nif(typeof _94c=="string"){\nopts.url=_94c;\n_94c=null;\n}\n_81e(this,_94c);\n});\n},reloadFooter:function(jq,_94d){\nreturn jq.each(function(){\nvar opts=$.data(this,"datagrid").options;\nvar dc=$.data(this,"datagrid").dc;\nif(_94d){\n$.data(this,"datagrid").footer=_94d;\n}\nif(opts.showFooter){\nopts.view.renderFooter.call(opts.view,this,dc.footer2,false);\nopts.view.renderFooter.call(opts.view,this,dc.footer1,true);\nif(opts.view.onAfterRender){\nopts.view.onAfterRender.call(opts.view,this);\n}\n$(this).datagrid("fixRowHeight");\n}\n});\n},loading:function(jq){\nreturn jq.each(function(){\nvar opts=$.data(this,"datagrid").options;\n$(this).datagrid("getPager").pagination("loading");\nif(opts.loadMsg){\nvar _94e=$(this).datagrid("getPanel");\nif(!_94e.children("div.datagrid-mask").length){\n$("<div class=\\"datagrid-mask\\" style=\\"display:block\\"></div>").appendTo(_94e);\nvar msg=$("<div class=\\"datagrid-mask-msg\\" style=\\"display:block;left:50%\\"></div>").html(opts.loadMsg).appendTo(_94e);\nmsg._outerHeight(40);\nmsg.css({marginLeft:(-msg.outerWidth()/2),lineHeight:(msg.height()+"px")});\n}\n}\n});\n},loaded:function(jq){\nreturn jq.each(function(){\n$(this).datagrid("getPager").pagination("loaded");\nvar _94f=$(this).datagrid("getPanel");\n_94f.children("div.datagrid-mask-msg").remove();\n_94f.children("div.datagrid-mask").remove();\n});\n},fitColumns:function(jq){\nreturn jq.each(function(){\n_82b(this);\n});\n},fixColumnSize:function(jq,_950){\nreturn jq.each(function(){\n_849(this,_950);\n});\n},fixRowHeight:function(jq,_951){\nreturn jq.each(function(){\n_7ab(this,_951);\n});\n},freezeRow:function(jq,_952){\nreturn jq.each(function(){\n_7b9(this,_952);\n});\n},autoSizeColumn:function(jq,_953){\nreturn jq.each(function(){\n_83d(this,_953);\n});\n},loadData:function(jq,data){\nreturn jq.each(function(){\n_81f(this,data);\n_8fd(this);\n});\n},getData:function(jq){\nreturn $.data(jq[0],"datagrid").data;\n},getRows:function(jq){\nreturn $.data(jq[0],"datagrid").data.rows;\n},getFooterRows:function(jq){\nreturn $.data(jq[0],"datagrid").footer;\n},getRowIndex:function(jq,id){\nreturn _874(jq[0],id);\n},getChecked:function(jq){\nreturn _87a(jq[0]);\n},getSelected:function(jq){\nvar rows=_877(jq[0]);\nreturn rows.length>0?rows[0]:null;\n},getSelections:function(jq){\nreturn _877(jq[0]);\n},clearSelections:function(jq){\nreturn jq.each(function(){\nvar _954=$.data(this,"datagrid");\nvar _955=_954.selectedRows;\nvar _956=_954.checkedRows;\n_955.splice(0,_955.length);\n_88d(this);\nif(_954.options.checkOnSelect){\n_956.splice(0,_956.length);\n}\n});\n},clearChecked:function(jq){\nreturn jq.each(function(){\nvar _957=$.data(this,"datagrid");\nvar _958=_957.selectedRows;\nvar _959=_957.checkedRows;\n_959.splice(0,_959.length);\n_7f4(this);\nif(_957.options.selectOnCheck){\n_958.splice(0,_958.length);\n}\n});\n},scrollTo:function(jq,_95a){\nreturn jq.each(function(){\n_87d(this,_95a);\n});\n},highlightRow:function(jq,_95b){\nreturn jq.each(function(){\n_801(this,_95b);\n_87d(this,_95b);\n});\n},selectAll:function(jq){\nreturn jq.each(function(){\n_892(this);\n});\n},unselectAll:function(jq){\nreturn jq.each(function(){\n_88d(this);\n});\n},selectRow:function(jq,_95c){\nreturn jq.each(function(){\n_808(this,_95c);\n});\n},selectRecord:function(jq,id){\nreturn jq.each(function(){\nvar opts=$.data(this,"datagrid").options;\nif(opts.idField){\nvar _95d=_874(this,id);\nif(_95d>=0){\n$(this).datagrid("selectRow",_95d);\n}\n}\n});\n},unselectRow:function(jq,_95e){\nreturn jq.each(function(){\n_809(this,_95e);\n});\n},checkRow:function(jq,_95f){\nreturn jq.each(function(){\n_805(this,_95f);\n});\n},uncheckRow:function(jq,_960){\nreturn jq.each(function(){\n_806(this,_960);\n});\n},checkAll:function(jq){\nreturn jq.each(function(){\n_7f3(this);\n});\n},uncheckAll:function(jq){\nreturn jq.each(function(){\n_7f4(this);\n});\n},beginEdit:function(jq,_961){\nreturn jq.each(function(){\n_8bc(this,_961);\n});\n},endEdit:function(jq,_962){\nreturn jq.each(function(){\n_8c2(this,_962,false);\n});\n},cancelEdit:function(jq,_963){\nreturn jq.each(function(){\n_8c2(this,_963,true);\n});\n},getEditors:function(jq,_964){\nreturn _8cf(jq[0],_964);\n},getEditor:function(jq,_965){\nreturn _8d3(jq[0],_965);\n},refreshRow:function(jq,_966){\nreturn jq.each(function(){\nvar opts=$.data(this,"datagrid").options;\nopts.view.refreshRow.call(opts.view,this,_966);\n});\n},validateRow:function(jq,_967){\nreturn _8c1(jq[0],_967);\n},updateRow:function(jq,_968){\nreturn jq.each(function(){\n_8f7(this,_968);\n});\n},appendRow:function(jq,row){\nreturn jq.each(function(){\n_8f4(this,row);\n});\n},insertRow:function(jq,_969){\nreturn jq.each(function(){\n_8f0(this,_969);\n});\n},deleteRow:function(jq,_96a){\nreturn jq.each(function(){\n_8ea(this,_96a);\n});\n},getChanges:function(jq,_96b){\nreturn _8e4(jq[0],_96b);\n},acceptChanges:function(jq){\nreturn jq.each(function(){\n_901(this);\n});\n},rejectChanges:function(jq){\nreturn jq.each(function(){\n_903(this);\n});\n},mergeCells:function(jq,_96c){\nreturn jq.each(function(){\n_915(this,_96c);\n});\n},showColumn:function(jq,_96d){\nreturn jq.each(function(){\nvar col=$(this).datagrid("getColumnOption",_96d);\nif(col.hidden){\ncol.hidden=false;\n$(this).datagrid("getPanel").find("td[field=\\""+_96d+"\\"]").show();\n_820(this,_96d,1);\n$(this).datagrid("fitColumns");\n}\n});\n},hideColumn:function(jq,_96e){\nreturn jq.each(function(){\nvar col=$(this).datagrid("getColumnOption",_96e);\nif(!col.hidden){\ncol.hidden=true;\n$(this).datagrid("getPanel").find("td[field=\\""+_96e+"\\"]").hide();\n_820(this,_96e,-1);\n$(this).datagrid("fitColumns");\n}\n});\n},sort:function(jq,_96f){\nreturn jq.each(function(){\n_7f5(this,_96f);\n});\n},gotoPage:function(jq,_970){\nreturn jq.each(function(){\nvar _971=this;\nvar page,cb;\nif(typeof _970=="object"){\npage=_970.page;\ncb=_970.callback;\n}else{\npage=_970;\n}\n$(_971).datagrid("options").pageNumber=page;\n$(_971).datagrid("getPager").pagination("refresh",{pageNumber:page});\n_81e(_971,null,function(){\nif(cb){\ncb.call(_971,page);\n}\n});\n});\n}};\n$.fn.datagrid.parseOptions=function(_972){\nvar t=$(_972);\nreturn $.extend({},$.fn.panel.parseOptions(_972),$.parser.parseOptions(_972,["url","toolbar","idField","sortName","sortOrder","pagePosition","resizeHandle",{sharedStyleSheet:"boolean",fitColumns:"boolean",autoRowHeight:"boolean",striped:"boolean",nowrap:"boolean"},{rownumbers:"boolean",singleSelect:"boolean",ctrlSelect:"boolean",checkOnSelect:"boolean",selectOnCheck:"boolean"},{pagination:"boolean",pageSize:"number",pageNumber:"number"},{multiSort:"boolean",remoteSort:"boolean",showHeader:"boolean",showFooter:"boolean"},{scrollbarSize:"number",scrollOnSelect:"boolean"}]),{pageList:(t.attr("pageList")?eval(t.attr("pageList")):undefined),loadMsg:(t.attr("loadMsg")!=undefined?t.attr("loadMsg"):undefined),rowStyler:(t.attr("rowStyler")?eval(t.attr("rowStyler")):undefined)});\n};\n$.fn.datagrid.parseData=function(_973){\nvar t=$(_973);\nvar data={total:0,rows:[]};\nvar _974=t.datagrid("getColumnFields",true).concat(t.datagrid("getColumnFields",false));\nt.find("tbody tr").each(function(){\ndata.total++;\nvar row={};\n$.extend(row,$.parser.parseOptions(this,["iconCls","state"]));\nfor(var i=0;i<_974.length;i++){\nrow[_974[i]]=$(this).find("td:eq("+i+")").html();\n}\ndata.rows.push(row);\n});\nreturn data;\n};\nvar _975={render:function(_976,_977,_978){\nvar rows=$(_976).datagrid("getRows");\n$(_977).empty().html(this.renderTable(_976,0,rows,_978));\n},renderFooter:function(_979,_97a,_97b){\nvar opts=$.data(_979,"datagrid").options;\nvar rows=$.data(_979,"datagrid").footer||[];\nvar _97c=$(_979).datagrid("getColumnFields",_97b);\nvar _97d=["<table class=\\"datagrid-ftable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>"];\nfor(var i=0;i<rows.length;i++){\n_97d.push("<tr class=\\"datagrid-row\\" datagrid-row-index=\\""+i+"\\">");\n_97d.push(this.renderRow.call(this,_979,_97c,_97b,i,rows[i]));\n_97d.push("</tr>");\n}\n_97d.push("</tbody></table>");\n$(_97a).html(_97d.join(""));\n},renderTable:function(_97e,_97f,rows,_980){\nvar _981=$.data(_97e,"datagrid");\nvar opts=_981.options;\nif(_980){\nif(!(opts.rownumbers||(opts.frozenColumns&&opts.frozenColumns.length))){\nreturn "";\n}\n}\nvar _982=$(_97e).datagrid("getColumnFields",_980);\nvar _983=["<table class=\\"datagrid-btable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>"];\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nvar css=opts.rowStyler?opts.rowStyler.call(_97e,_97f,row):"";\nvar cs=this.getStyleValue(css);\nvar cls="class=\\"datagrid-row "+(_97f%2&&opts.striped?"datagrid-row-alt ":" ")+cs.c+"\\"";\nvar _984=cs.s?"style=\\""+cs.s+"\\"":"";\nvar _985=_981.rowIdPrefix+"-"+(_980?1:2)+"-"+_97f;\n_983.push("<tr id=\\""+_985+"\\" datagrid-row-index=\\""+_97f+"\\" "+cls+" "+_984+">");\n_983.push(this.renderRow.call(this,_97e,_982,_980,_97f,row));\n_983.push("</tr>");\n_97f++;\n}\n_983.push("</tbody></table>");\nreturn _983.join("");\n},renderRow:function(_986,_987,_988,_989,_98a){\nvar opts=$.data(_986,"datagrid").options;\nvar cc=[];\nif(_988&&opts.rownumbers){\nvar _98b=_989+1;\nif(opts.pagination){\n_98b+=(opts.pageNumber-1)*opts.pageSize;\n}\ncc.push("<td class=\\"datagrid-td-rownumber\\"><div class=\\"datagrid-cell-rownumber\\">"+_98b+"</div></td>");\n}\nfor(var i=0;i<_987.length;i++){\nvar _98c=_987[i];\nvar col=$(_986).datagrid("getColumnOption",_98c);\nif(col){\nvar _98d=_98a[_98c];\nvar css=col.styler?(col.styler.call(_986,_98d,_98a,_989)||""):"";\nvar cs=this.getStyleValue(css);\nvar cls=cs.c?"class=\\""+cs.c+"\\"":"";\nvar _98e=col.hidden?"style=\\"display:none;"+cs.s+"\\"":(cs.s?"style=\\""+cs.s+"\\"":"");\ncc.push("<td field=\\""+_98c+"\\" "+cls+" "+_98e+">");\nvar _98e="";\nif(!col.checkbox){\nif(col.align){\n_98e+="text-align:"+col.align+";";\n}\nif(!opts.nowrap){\n_98e+="white-space:normal;height:auto;";\n}else{\nif(opts.autoRowHeight){\n_98e+="height:auto;";\n}\n}\n}\ncc.push("<div style=\\""+_98e+"\\" ");\ncc.push(col.checkbox?"class=\\"datagrid-cell-check\\"":"class=\\"datagrid-cell "+col.cellClass+"\\"");\ncc.push(">");\nif(col.checkbox){\ncc.push("<input type=\\"checkbox\\" "+(_98a.checked?"checked=\\"checked\\"":""));\ncc.push(" name=\\""+_98c+"\\" value=\\""+(_98d!=undefined?_98d:"")+"\\">");\n}else{\nif(col.formatter){\ncc.push(col.formatter(_98d,_98a,_989));\n}else{\ncc.push(_98d);\n}\n}\ncc.push("</div>");\ncc.push("</td>");\n}\n}\nreturn cc.join("");\n},getStyleValue:function(css){\nvar _98f="";\nvar _990="";\nif(typeof css=="string"){\n_990=css;\n}else{\nif(css){\n_98f=css["class"]||"";\n_990=css["style"]||"";\n}\n}\nreturn {c:_98f,s:_990};\n},refreshRow:function(_991,_992){\nthis.updateRow.call(this,_991,_992,{});\n},updateRow:function(_993,_994,row){\nvar opts=$.data(_993,"datagrid").options;\nvar _995=opts.finder.getRow(_993,_994);\n$.extend(_995,row);\nvar cs=_996.call(this,_994);\nvar _997=cs.s;\nvar cls="datagrid-row "+(_994%2&&opts.striped?"datagrid-row-alt ":" ")+cs.c;\nfunction _996(_998){\nvar css=opts.rowStyler?opts.rowStyler.call(_993,_998,_995):"";\nreturn this.getStyleValue(css);\n};\nfunction _999(_99a){\nvar tr=opts.finder.getTr(_993,_994,"body",(_99a?1:2));\nif(!tr.length){\nreturn;\n}\nvar _99b=$(_993).datagrid("getColumnFields",_99a);\nvar _99c=tr.find("div.datagrid-cell-check input[type=checkbox]").is(":checked");\ntr.html(this.renderRow.call(this,_993,_99b,_99a,_994,_995));\nvar _99d=(tr.hasClass("datagrid-row-checked")?" datagrid-row-checked":"")+(tr.hasClass("datagrid-row-selected")?" datagrid-row-selected":"");\ntr.attr("style",_997).attr("class",cls+_99d);\nif(_99c){\ntr.find("div.datagrid-cell-check input[type=checkbox]")._propAttr("checked",true);\n}\n};\n_999.call(this,true);\n_999.call(this,false);\n$(_993).datagrid("fixRowHeight",_994);\n},insertRow:function(_99e,_99f,row){\nvar _9a0=$.data(_99e,"datagrid");\nvar opts=_9a0.options;\nvar dc=_9a0.dc;\nvar data=_9a0.data;\nif(_99f==undefined||_99f==null){\n_99f=data.rows.length;\n}\nif(_99f>data.rows.length){\n_99f=data.rows.length;\n}\nfunction _9a1(_9a2){\nvar _9a3=_9a2?1:2;\nfor(var i=data.rows.length-1;i>=_99f;i--){\nvar tr=opts.finder.getTr(_99e,i,"body",_9a3);\ntr.attr("datagrid-row-index",i+1);\ntr.attr("id",_9a0.rowIdPrefix+"-"+_9a3+"-"+(i+1));\nif(_9a2&&opts.rownumbers){\nvar _9a4=i+2;\nif(opts.pagination){\n_9a4+=(opts.pageNumber-1)*opts.pageSize;\n}\ntr.find("div.datagrid-cell-rownumber").html(_9a4);\n}\nif(opts.striped){\ntr.removeClass("datagrid-row-alt").addClass((i+1)%2?"datagrid-row-alt":"");\n}\n}\n};\nfunction _9a5(_9a6){\nvar _9a7=_9a6?1:2;\nvar _9a8=$(_99e).datagrid("getColumnFields",_9a6);\nvar _9a9=_9a0.rowIdPrefix+"-"+_9a7+"-"+_99f;\nvar tr="<tr id=\\""+_9a9+"\\" class=\\"datagrid-row\\" datagrid-row-index=\\""+_99f+"\\"></tr>";\nif(_99f>=data.rows.length){\nif(data.rows.length){\nopts.finder.getTr(_99e,"","last",_9a7).after(tr);\n}else{\nvar cc=_9a6?dc.body1:dc.body2;\ncc.html("<table class=\\"datagrid-btable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>"+tr+"</tbody></table>");\n}\n}else{\nopts.finder.getTr(_99e,_99f+1,"body",_9a7).before(tr);\n}\n};\n_9a1.call(this,true);\n_9a1.call(this,false);\n_9a5.call(this,true);\n_9a5.call(this,false);\ndata.total+=1;\ndata.rows.splice(_99f,0,row);\nthis.setEmptyMsg(_99e);\nthis.refreshRow.call(this,_99e,_99f);\n},deleteRow:function(_9aa,_9ab){\nvar _9ac=$.data(_9aa,"datagrid");\nvar opts=_9ac.options;\nvar data=_9ac.data;\nfunction _9ad(_9ae){\nvar _9af=_9ae?1:2;\nfor(var i=_9ab+1;i<data.rows.length;i++){\nvar tr=opts.finder.getTr(_9aa,i,"body",_9af);\ntr.attr("datagrid-row-index",i-1);\ntr.attr("id",_9ac.rowIdPrefix+"-"+_9af+"-"+(i-1));\nif(_9ae&&opts.rownumbers){\nvar _9b0=i;\nif(opts.pagination){\n_9b0+=(opts.pageNumber-1)*opts.pageSize;\n}\ntr.find("div.datagrid-cell-rownumber").html(_9b0);\n}\nif(opts.striped){\ntr.removeClass("datagrid-row-alt").addClass((i-1)%2?"datagrid-row-alt":"");\n}\n}\n};\nopts.finder.getTr(_9aa,_9ab).remove();\n_9ad.call(this,true);\n_9ad.call(this,false);\ndata.total-=1;\ndata.rows.splice(_9ab,1);\nthis.setEmptyMsg(_9aa);\n},onBeforeRender:function(_9b1,rows){\n},onAfterRender:function(_9b2){\nvar _9b3=$.data(_9b2,"datagrid");\nvar opts=_9b3.options;\nif(opts.showFooter){\nvar _9b4=$(_9b2).datagrid("getPanel").find("div.datagrid-footer");\n_9b4.find("div.datagrid-cell-rownumber,div.datagrid-cell-check").css("visibility","hidden");\n}\nthis.setEmptyMsg(_9b2);\n},setEmptyMsg:function(_9b5){\nvar _9b6=$.data(_9b5,"datagrid");\nvar opts=_9b6.options;\nvar _9b7=opts.finder.getRows(_9b5).length==0;\nif(_9b7){\nthis.renderEmptyRow(_9b5);\n}\nif(opts.emptyMsg){\n_9b6.dc.view.children(".datagrid-empty").remove();\nif(_9b7){\nvar h=_9b6.dc.header2.parent().outerHeight();\nvar d=$("<div class=\\"datagrid-empty\\"></div>").appendTo(_9b6.dc.view);\nd.html(opts.emptyMsg).css("top",h+"px");\n}\n}\n},renderEmptyRow:function(_9b8){\nvar opts=$(_9b8).datagrid("options");\nvar cols=$.map($(_9b8).datagrid("getColumnFields"),function(_9b9){\nreturn $(_9b8).datagrid("getColumnOption",_9b9);\n});\n$.map(cols,function(col){\ncol.formatter1=col.formatter;\ncol.styler1=col.styler;\ncol.formatter=col.styler=undefined;\n});\nvar _9ba=opts.rowStyler;\nopts.rowStyler=function(){\n};\nvar _9bb=$.data(_9b8,"datagrid").dc.body2;\n_9bb.html(this.renderTable(_9b8,0,[{}],false));\n_9bb.find("tbody *").css({height:1,borderColor:"transparent",background:"transparent"});\nvar tr=_9bb.find(".datagrid-row");\ntr.removeClass("datagrid-row").removeAttr("datagrid-row-index");\ntr.find(".datagrid-cell,.datagrid-cell-check").empty();\n$.map(cols,function(col){\ncol.formatter=col.formatter1;\ncol.styler=col.styler1;\ncol.formatter1=col.styler1=undefined;\n});\nopts.rowStyler=_9ba;\n}};\n$.fn.datagrid.defaults=$.extend({},$.fn.panel.defaults,{sharedStyleSheet:false,frozenColumns:undefined,columns:undefined,fitColumns:false,resizeHandle:"right",resizeEdge:5,autoRowHeight:true,toolbar:null,striped:false,method:"post",nowrap:true,idField:null,url:null,data:null,loadMsg:"Processing, please wait ...",emptyMsg:"",rownumbers:false,singleSelect:false,ctrlSelect:false,selectOnCheck:true,checkOnSelect:true,pagination:false,pagePosition:"bottom",pageNumber:1,pageSize:10,pageList:[10,20,30,40,50],queryParams:{},sortName:null,sortOrder:"asc",multiSort:false,remoteSort:true,showHeader:true,showFooter:false,scrollOnSelect:true,scrollbarSize:18,rownumberWidth:30,editorHeight:31,headerEvents:{mouseover:_7ed(true),mouseout:_7ed(false),click:_7f1,dblclick:_7f6,contextmenu:_7f9},rowEvents:{mouseover:_7fb(true),mouseout:_7fb(false),click:_802,dblclick:_80c,contextmenu:_810},rowStyler:function(_9bc,_9bd){\n},loader:function(_9be,_9bf,_9c0){\nvar opts=$(this).datagrid("options");\nif(!opts.url){\nreturn false;\n}\n$.ajax({type:opts.method,url:opts.url,data:_9be,dataType:"json",success:function(data){\n_9bf(data);\n},error:function(){\n_9c0.apply(this,arguments);\n}});\n},loadFilter:function(data){\nreturn data;\n},editors:_92c,finder:{getTr:function(_9c1,_9c2,type,_9c3){\ntype=type||"body";\n_9c3=_9c3||0;\nvar _9c4=$.data(_9c1,"datagrid");\nvar dc=_9c4.dc;\nvar opts=_9c4.options;\nif(_9c3==0){\nvar tr1=opts.finder.getTr(_9c1,_9c2,type,1);\nvar tr2=opts.finder.getTr(_9c1,_9c2,type,2);\nreturn tr1.add(tr2);\n}else{\nif(type=="body"){\nvar tr=$("#"+_9c4.rowIdPrefix+"-"+_9c3+"-"+_9c2);\nif(!tr.length){\ntr=(_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr[datagrid-row-index="+_9c2+"]");\n}\nreturn tr;\n}else{\nif(type=="footer"){\nreturn (_9c3==1?dc.footer1:dc.footer2).find(">table>tbody>tr[datagrid-row-index="+_9c2+"]");\n}else{\nif(type=="selected"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr.datagrid-row-selected");\n}else{\nif(type=="highlight"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr.datagrid-row-over");\n}else{\nif(type=="checked"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr.datagrid-row-checked");\n}else{\nif(type=="editing"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr.datagrid-row-editing");\n}else{\nif(type=="last"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr[datagrid-row-index]:last");\n}else{\nif(type=="allbody"){\nreturn (_9c3==1?dc.body1:dc.body2).find(">table>tbody>tr[datagrid-row-index]");\n}else{\nif(type=="allfooter"){\nreturn (_9c3==1?dc.footer1:dc.footer2).find(">table>tbody>tr[datagrid-row-index]");\n}\n}\n}\n}\n}\n}\n}\n}\n}\n}\n},getRow:function(_9c5,p){\nvar _9c6=(typeof p=="object")?p.attr("datagrid-row-index"):p;\nreturn $.data(_9c5,"datagrid").data.rows[parseInt(_9c6)];\n},getRows:function(_9c7){\nreturn $(_9c7).datagrid("getRows");\n}},view:_975,onBeforeLoad:function(_9c8){\n},onLoadSuccess:function(){\n},onLoadError:function(){\n},onClickRow:function(_9c9,_9ca){\n},onDblClickRow:function(_9cb,_9cc){\n},onClickCell:function(_9cd,_9ce,_9cf){\n},onDblClickCell:function(_9d0,_9d1,_9d2){\n},onBeforeSortColumn:function(sort,_9d3){\n},onSortColumn:function(sort,_9d4){\n},onResizeColumn:function(_9d5,_9d6){\n},onBeforeSelect:function(_9d7,_9d8){\n},onSelect:function(_9d9,_9da){\n},onBeforeUnselect:function(_9db,_9dc){\n},onUnselect:function(_9dd,_9de){\n},onSelectAll:function(rows){\n},onUnselectAll:function(rows){\n},onBeforeCheck:function(_9df,_9e0){\n},onCheck:function(_9e1,_9e2){\n},onBeforeUncheck:function(_9e3,_9e4){\n},onUncheck:function(_9e5,_9e6){\n},onCheckAll:function(rows){\n},onUncheckAll:function(rows){\n},onBeforeEdit:function(_9e7,_9e8){\n},onBeginEdit:function(_9e9,_9ea){\n},onEndEdit:function(_9eb,_9ec,_9ed){\n},onAfterEdit:function(_9ee,_9ef,_9f0){\n},onCancelEdit:function(_9f1,_9f2){\n},onHeaderContextMenu:function(e,_9f3){\n},onRowContextMenu:function(e,_9f4,_9f5){\n}});\n})(jQuery);\n(function($){\nvar _9f6;\n$(document)._unbind(".propertygrid")._bind("mousedown.propertygrid",function(e){\nvar p=$(e.target).closest("div.datagrid-view,div.combo-panel");\nif(p.length){\nreturn;\n}\n_9f7(_9f6);\n_9f6=undefined;\n});\nfunction _9f8(_9f9){\nvar _9fa=$.data(_9f9,"propertygrid");\nvar opts=$.data(_9f9,"propertygrid").options;\n$(_9f9).datagrid($.extend({},opts,{cls:"propertygrid",view:(opts.showGroup?opts.groupView:opts.view),onBeforeEdit:function(_9fb,row){\nif(opts.onBeforeEdit.call(_9f9,_9fb,row)==false){\nreturn false;\n}\nvar dg=$(this);\nvar row=dg.datagrid("getRows")[_9fb];\nvar col=dg.datagrid("getColumnOption","value");\ncol.editor=row.editor;\n},onClickCell:function(_9fc,_9fd,_9fe){\nif(_9f6!=this){\n_9f7(_9f6);\n_9f6=this;\n}\nif(opts.editIndex!=_9fc){\n_9f7(_9f6);\n$(this).datagrid("beginEdit",_9fc);\nvar ed=$(this).datagrid("getEditor",{index:_9fc,field:_9fd});\nif(!ed){\ned=$(this).datagrid("getEditor",{index:_9fc,field:"value"});\n}\nif(ed){\nvar t=$(ed.target);\nvar _9ff=t.data("textbox")?t.textbox("textbox"):t;\n_9ff.focus();\nopts.editIndex=_9fc;\n}\n}\nopts.onClickCell.call(_9f9,_9fc,_9fd,_9fe);\n},loadFilter:function(data){\n_9f7(this);\nreturn opts.loadFilter.call(this,data);\n}}));\n};\nfunction _9f7(_a00){\nvar t=$(_a00);\nif(!t.length){\nreturn;\n}\nvar opts=$.data(_a00,"propertygrid").options;\nopts.finder.getTr(_a00,null,"editing").each(function(){\nvar _a01=parseInt($(this).attr("datagrid-row-index"));\nif(t.datagrid("validateRow",_a01)){\nt.datagrid("endEdit",_a01);\n}else{\nt.datagrid("cancelEdit",_a01);\n}\n});\nopts.editIndex=undefined;\n};\n$.fn.propertygrid=function(_a02,_a03){\nif(typeof _a02=="string"){\nvar _a04=$.fn.propertygrid.methods[_a02];\nif(_a04){\nreturn _a04(this,_a03);\n}else{\nreturn this.datagrid(_a02,_a03);\n}\n}\n_a02=_a02||{};\nreturn this.each(function(){\nvar _a05=$.data(this,"propertygrid");\nif(_a05){\n$.extend(_a05.options,_a02);\n}else{\nvar opts=$.extend({},$.fn.propertygrid.defaults,$.fn.propertygrid.parseOptions(this),_a02);\nopts.frozenColumns=$.extend(true,[],opts.frozenColumns);\nopts.columns=$.extend(true,[],opts.columns);\n$.data(this,"propertygrid",{options:opts});\n}\n_9f8(this);\n});\n};\n$.fn.propertygrid.methods={options:function(jq){\nreturn $.data(jq[0],"propertygrid").options;\n}};\n$.fn.propertygrid.parseOptions=function(_a06){\nreturn $.extend({},$.fn.datagrid.parseOptions(_a06),$.parser.parseOptions(_a06,[{showGroup:"boolean"}]));\n};\nvar _a07=$.extend({},$.fn.datagrid.defaults.view,{render:function(_a08,_a09,_a0a){\nvar _a0b=[];\nvar _a0c=this.groups;\nfor(var i=0;i<_a0c.length;i++){\n_a0b.push(this.renderGroup.call(this,_a08,i,_a0c[i],_a0a));\n}\n$(_a09).html(_a0b.join(""));\n},renderGroup:function(_a0d,_a0e,_a0f,_a10){\nvar _a11=$.data(_a0d,"datagrid");\nvar opts=_a11.options;\nvar _a12=$(_a0d).datagrid("getColumnFields",_a10);\nvar _a13=opts.frozenColumns&&opts.frozenColumns.length;\nif(_a10){\nif(!(opts.rownumbers||_a13)){\nreturn "";\n}\n}\nvar _a14=[];\nvar css=opts.groupStyler.call(_a0d,_a0f.value,_a0f.rows);\nvar cs=_a15(css,"datagrid-group");\n_a14.push("<div group-index="+_a0e+" "+cs+">");\nif((_a10&&(opts.rownumbers||opts.frozenColumns.length))||(!_a10&&!(opts.rownumbers||opts.frozenColumns.length))){\n_a14.push("<span class=\\"datagrid-group-expander\\">");\n_a14.push("<span class=\\"datagrid-row-expander datagrid-row-collapse\\">&nbsp;</span>");\n_a14.push("</span>");\n}\nif((_a10&&_a13)||(!_a10)){\n_a14.push("<span class=\\"datagrid-group-title\\">");\n_a14.push(opts.groupFormatter.call(_a0d,_a0f.value,_a0f.rows));\n_a14.push("</span>");\n}\n_a14.push("</div>");\n_a14.push("<table class=\\"datagrid-btable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>");\nvar _a16=_a0f.startIndex;\nfor(var j=0;j<_a0f.rows.length;j++){\nvar css=opts.rowStyler?opts.rowStyler.call(_a0d,_a16,_a0f.rows[j]):"";\nvar _a17="";\nvar _a18="";\nif(typeof css=="string"){\n_a18=css;\n}else{\nif(css){\n_a17=css["class"]||"";\n_a18=css["style"]||"";\n}\n}\nvar cls="class=\\"datagrid-row "+(_a16%2&&opts.striped?"datagrid-row-alt ":" ")+_a17+"\\"";\nvar _a19=_a18?"style=\\""+_a18+"\\"":"";\nvar _a1a=_a11.rowIdPrefix+"-"+(_a10?1:2)+"-"+_a16;\n_a14.push("<tr id=\\""+_a1a+"\\" datagrid-row-index=\\""+_a16+"\\" "+cls+" "+_a19+">");\n_a14.push(this.renderRow.call(this,_a0d,_a12,_a10,_a16,_a0f.rows[j]));\n_a14.push("</tr>");\n_a16++;\n}\n_a14.push("</tbody></table>");\nreturn _a14.join("");\nfunction _a15(css,cls){\nvar _a1b="";\nvar _a1c="";\nif(typeof css=="string"){\n_a1c=css;\n}else{\nif(css){\n_a1b=css["class"]||"";\n_a1c=css["style"]||"";\n}\n}\nreturn "class=\\""+cls+(_a1b?" "+_a1b:"")+"\\" "+"style=\\""+_a1c+"\\"";\n};\n},bindEvents:function(_a1d){\nvar _a1e=$.data(_a1d,"datagrid");\nvar dc=_a1e.dc;\nvar body=dc.body1.add(dc.body2);\nvar _a1f=($.data(body[0],"events")||$._data(body[0],"events")).click[0].handler;\nbody._unbind("click")._bind("click",function(e){\nvar tt=$(e.target);\nvar _a20=tt.closest("span.datagrid-row-expander");\nif(_a20.length){\nvar _a21=_a20.closest("div.datagrid-group").attr("group-index");\nif(_a20.hasClass("datagrid-row-collapse")){\n$(_a1d).datagrid("collapseGroup",_a21);\n}else{\n$(_a1d).datagrid("expandGroup",_a21);\n}\n}else{\n_a1f(e);\n}\ne.stopPropagation();\n});\n},onBeforeRender:function(_a22,rows){\nvar _a23=$.data(_a22,"datagrid");\nvar opts=_a23.options;\n_a24();\nvar _a25=[];\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nvar _a26=_a27(row[opts.groupField]);\nif(!_a26){\n_a26={value:row[opts.groupField],rows:[row]};\n_a25.push(_a26);\n}else{\n_a26.rows.push(row);\n}\n}\nvar _a28=0;\nvar _a29=[];\nfor(var i=0;i<_a25.length;i++){\nvar _a26=_a25[i];\n_a26.startIndex=_a28;\n_a28+=_a26.rows.length;\n_a29=_a29.concat(_a26.rows);\n}\n_a23.data.rows=_a29;\nthis.groups=_a25;\nvar that=this;\nsetTimeout(function(){\nthat.bindEvents(_a22);\n},0);\nfunction _a27(_a2a){\nfor(var i=0;i<_a25.length;i++){\nvar _a2b=_a25[i];\nif(_a2b.value==_a2a){\nreturn _a2b;\n}\n}\nreturn null;\n};\nfunction _a24(){\nif(!$("#datagrid-group-style").length){\n$("head").append("<style id=\\"datagrid-group-style\\">"+".datagrid-group{height:"+opts.groupHeight+"px;overflow:hidden;font-weight:bold;border-bottom:1px solid #ccc;white-space:nowrap;word-break:normal;}"+".datagrid-group-title,.datagrid-group-expander{display:inline-block;vertical-align:bottom;height:100%;line-height:"+opts.groupHeight+"px;padding:0 4px;}"+".datagrid-group-title{position:relative;}"+".datagrid-group-expander{width:"+opts.expanderWidth+"px;text-align:center;padding:0}"+".datagrid-group-expander .datagrid-row-expander{margin:"+Math.floor((opts.groupHeight-16)/2)+"px 0;display:inline-block;width:16px;height:16px;cursor:pointer}"+"</style>");\n}\n};\n},onAfterRender:function(_a2c){\n$.fn.datagrid.defaults.view.onAfterRender.call(this,_a2c);\nvar view=this;\nvar _a2d=$.data(_a2c,"datagrid");\nvar opts=_a2d.options;\nif(!_a2d.onResizeColumn){\n_a2d.onResizeColumn=opts.onResizeColumn;\n}\nif(!_a2d.onResize){\n_a2d.onResize=opts.onResize;\n}\nopts.onResizeColumn=function(_a2e,_a2f){\nview.resizeGroup(_a2c);\n_a2d.onResizeColumn.call(_a2c,_a2e,_a2f);\n};\nopts.onResize=function(_a30,_a31){\nview.resizeGroup(_a2c);\n_a2d.onResize.call($(_a2c).datagrid("getPanel")[0],_a30,_a31);\n};\nview.resizeGroup(_a2c);\n}});\n$.extend($.fn.datagrid.methods,{groups:function(jq){\nreturn jq.datagrid("options").view.groups;\n},expandGroup:function(jq,_a32){\nreturn jq.each(function(){\nvar opts=$(this).datagrid("options");\nvar view=$.data(this,"datagrid").dc.view;\nvar _a33=view.find(_a32!=undefined?"div.datagrid-group[group-index=\\""+_a32+"\\"]":"div.datagrid-group");\nvar _a34=_a33.find("span.datagrid-row-expander");\nif(_a34.hasClass("datagrid-row-expand")){\n_a34.removeClass("datagrid-row-expand").addClass("datagrid-row-collapse");\n_a33.next("table").show();\n}\n$(this).datagrid("fixRowHeight");\nif(opts.onExpandGroup){\nopts.onExpandGroup.call(this,_a32);\n}\n});\n},collapseGroup:function(jq,_a35){\nreturn jq.each(function(){\nvar opts=$(this).datagrid("options");\nvar view=$.data(this,"datagrid").dc.view;\nvar _a36=view.find(_a35!=undefined?"div.datagrid-group[group-index=\\""+_a35+"\\"]":"div.datagrid-group");\nvar _a37=_a36.find("span.datagrid-row-expander");\nif(_a37.hasClass("datagrid-row-collapse")){\n_a37.removeClass("datagrid-row-collapse").addClass("datagrid-row-expand");\n_a36.next("table").hide();\n}\n$(this).datagrid("fixRowHeight");\nif(opts.onCollapseGroup){\nopts.onCollapseGroup.call(this,_a35);\n}\n});\n},scrollToGroup:function(jq,_a38){\nreturn jq.each(function(){\nvar _a39=$.data(this,"datagrid");\nvar dc=_a39.dc;\nvar grow=dc.body2.children("div.datagrid-group[group-index=\\""+_a38+"\\"]");\nif(grow.length){\nvar _a3a=grow.outerHeight();\nvar _a3b=dc.view2.children("div.datagrid-header")._outerHeight();\nvar _a3c=dc.body2.outerHeight(true)-dc.body2.outerHeight();\nvar top=grow.position().top-_a3b-_a3c;\nif(top<0){\ndc.body2.scrollTop(dc.body2.scrollTop()+top);\n}else{\nif(top+_a3a>dc.body2.height()-18){\ndc.body2.scrollTop(dc.body2.scrollTop()+top+_a3a-dc.body2.height()+18);\n}\n}\n}\n});\n}});\n$.extend(_a07,{refreshGroupTitle:function(_a3d,_a3e){\nvar _a3f=$.data(_a3d,"datagrid");\nvar opts=_a3f.options;\nvar dc=_a3f.dc;\nvar _a40=this.groups[_a3e];\nvar span=dc.body1.add(dc.body2).children("div.datagrid-group[group-index="+_a3e+"]").find("span.datagrid-group-title");\nspan.html(opts.groupFormatter.call(_a3d,_a40.value,_a40.rows));\n},resizeGroup:function(_a41,_a42){\nvar _a43=$.data(_a41,"datagrid");\nvar dc=_a43.dc;\nvar ht=dc.header2.find("table");\nvar fr=ht.find("tr.datagrid-filter-row").hide();\nvar ww=dc.body2.children("table.datagrid-btable:first").width();\nif(_a42==undefined){\nvar _a44=dc.body2.children("div.datagrid-group");\n}else{\nvar _a44=dc.body2.children("div.datagrid-group[group-index="+_a42+"]");\n}\n_a44._outerWidth(ww);\nvar opts=_a43.options;\nif(opts.frozenColumns&&opts.frozenColumns.length){\nvar _a45=dc.view1.width()-opts.expanderWidth;\nvar _a46=dc.view1.css("direction").toLowerCase()=="rtl";\n_a44.find(".datagrid-group-title").css(_a46?"right":"left",-_a45+"px");\n}\nif(fr.length){\nif(opts.showFilterBar){\nfr.show();\n}\n}\n},insertRow:function(_a47,_a48,row){\nvar _a49=$.data(_a47,"datagrid");\nvar opts=_a49.options;\nvar dc=_a49.dc;\nvar _a4a=null;\nvar _a4b;\nif(!_a49.data.rows.length){\n$(_a47).datagrid("loadData",[row]);\nreturn;\n}\nfor(var i=0;i<this.groups.length;i++){\nif(this.groups[i].value==row[opts.groupField]){\n_a4a=this.groups[i];\n_a4b=i;\nbreak;\n}\n}\nif(_a4a){\nif(_a48==undefined||_a48==null){\n_a48=_a49.data.rows.length;\n}\nif(_a48<_a4a.startIndex){\n_a48=_a4a.startIndex;\n}else{\nif(_a48>_a4a.startIndex+_a4a.rows.length){\n_a48=_a4a.startIndex+_a4a.rows.length;\n}\n}\n$.fn.datagrid.defaults.view.insertRow.call(this,_a47,_a48,row);\nif(_a48>=_a4a.startIndex+_a4a.rows.length){\n_a4c(_a48,true);\n_a4c(_a48,false);\n}\n_a4a.rows.splice(_a48-_a4a.startIndex,0,row);\n}else{\n_a4a={value:row[opts.groupField],rows:[row],startIndex:_a49.data.rows.length};\n_a4b=this.groups.length;\ndc.body1.append(this.renderGroup.call(this,_a47,_a4b,_a4a,true));\ndc.body2.append(this.renderGroup.call(this,_a47,_a4b,_a4a,false));\nthis.groups.push(_a4a);\n_a49.data.rows.push(row);\n}\nthis.setGroupIndex(_a47);\nthis.refreshGroupTitle(_a47,_a4b);\nthis.resizeGroup(_a47);\nfunction _a4c(_a4d,_a4e){\nvar _a4f=_a4e?1:2;\nvar _a50=opts.finder.getTr(_a47,_a4d-1,"body",_a4f);\nvar tr=opts.finder.getTr(_a47,_a4d,"body",_a4f);\ntr.insertAfter(_a50);\n};\n},updateRow:function(_a51,_a52,row){\nvar opts=$.data(_a51,"datagrid").options;\n$.fn.datagrid.defaults.view.updateRow.call(this,_a51,_a52,row);\nvar tb=opts.finder.getTr(_a51,_a52,"body",2).closest("table.datagrid-btable");\nvar _a53=parseInt(tb.prev().attr("group-index"));\nthis.refreshGroupTitle(_a51,_a53);\n},deleteRow:function(_a54,_a55){\nvar _a56=$.data(_a54,"datagrid");\nvar opts=_a56.options;\nvar dc=_a56.dc;\nvar body=dc.body1.add(dc.body2);\nvar tb=opts.finder.getTr(_a54,_a55,"body",2).closest("table.datagrid-btable");\nvar _a57=parseInt(tb.prev().attr("group-index"));\n$.fn.datagrid.defaults.view.deleteRow.call(this,_a54,_a55);\nvar _a58=this.groups[_a57];\nif(_a58.rows.length>1){\n_a58.rows.splice(_a55-_a58.startIndex,1);\nthis.refreshGroupTitle(_a54,_a57);\n}else{\nbody.children("div.datagrid-group[group-index="+_a57+"]").remove();\nfor(var i=_a57+1;i<this.groups.length;i++){\nbody.children("div.datagrid-group[group-index="+i+"]").attr("group-index",i-1);\n}\nthis.groups.splice(_a57,1);\n}\nthis.setGroupIndex(_a54);\n},setGroupIndex:function(_a59){\nvar _a5a=0;\nfor(var i=0;i<this.groups.length;i++){\nvar _a5b=this.groups[i];\n_a5b.startIndex=_a5a;\n_a5a+=_a5b.rows.length;\n}\n}});\n$.fn.propertygrid.defaults=$.extend({},$.fn.datagrid.defaults,{groupHeight:28,expanderWidth:20,singleSelect:true,remoteSort:false,fitColumns:true,loadMsg:"",frozenColumns:[[{field:"f",width:20,resizable:false}]],columns:[[{field:"name",title:"Name",width:100,sortable:true},{field:"value",title:"Value",width:100,resizable:false}]],showGroup:false,groupView:_a07,groupField:"group",groupStyler:function(_a5c,rows){\nreturn "";\n},groupFormatter:function(_a5d,rows){\nreturn _a5d;\n}});\n})(jQuery);\n(function($){\nfunction _a5e(_a5f){\nvar _a60=$.data(_a5f,"treegrid");\nvar opts=_a60.options;\n$(_a5f).datagrid($.extend({},opts,{url:null,data:null,loader:function(){\nreturn false;\n},onBeforeLoad:function(){\nreturn false;\n},onLoadSuccess:function(){\n},onResizeColumn:function(_a61,_a62){\n_a6f(_a5f);\nopts.onResizeColumn.call(_a5f,_a61,_a62);\n},onBeforeSortColumn:function(sort,_a63){\nif(opts.onBeforeSortColumn.call(_a5f,sort,_a63)==false){\nreturn false;\n}\n},onSortColumn:function(sort,_a64){\nopts.sortName=sort;\nopts.sortOrder=_a64;\nif(opts.remoteSort){\n_a6e(_a5f);\n}else{\nvar data=$(_a5f).treegrid("getData");\n_a9d(_a5f,null,data);\n}\nopts.onSortColumn.call(_a5f,sort,_a64);\n},onClickCell:function(_a65,_a66){\nopts.onClickCell.call(_a5f,_a66,find(_a5f,_a65));\n},onDblClickCell:function(_a67,_a68){\nopts.onDblClickCell.call(_a5f,_a68,find(_a5f,_a67));\n},onRowContextMenu:function(e,_a69){\nopts.onContextMenu.call(_a5f,e,find(_a5f,_a69));\n}}));\nvar _a6a=$.data(_a5f,"datagrid").options;\nopts.columns=_a6a.columns;\nopts.frozenColumns=_a6a.frozenColumns;\n_a60.dc=$.data(_a5f,"datagrid").dc;\nif(opts.pagination){\nvar _a6b=$(_a5f).datagrid("getPager");\n_a6b.pagination({total:0,pageNumber:opts.pageNumber,pageSize:opts.pageSize,pageList:opts.pageList,onSelectPage:function(_a6c,_a6d){\nopts.pageNumber=_a6c||1;\nopts.pageSize=_a6d;\n_a6b.pagination("refresh",{pageNumber:_a6c,pageSize:_a6d});\n_a6e(_a5f);\n}});\nopts.pageSize=_a6b.pagination("options").pageSize;\n}\n};\nfunction _a6f(_a70,_a71){\nvar opts=$.data(_a70,"datagrid").options;\nvar dc=$.data(_a70,"datagrid").dc;\nif(!dc.body1.is(":empty")&&(!opts.nowrap||opts.autoRowHeight)){\nif(_a71!=undefined){\nvar _a72=_a73(_a70,_a71);\nfor(var i=0;i<_a72.length;i++){\n_a74(_a72[i][opts.idField]);\n}\n}\n}\n$(_a70).datagrid("fixRowHeight",_a71);\nfunction _a74(_a75){\nvar tr1=opts.finder.getTr(_a70,_a75,"body",1);\nvar tr2=opts.finder.getTr(_a70,_a75,"body",2);\ntr1.css("height","");\ntr2.css("height","");\nvar _a76=Math.max(tr1.height(),tr2.height());\ntr1.css("height",_a76);\ntr2.css("height",_a76);\n};\n};\nfunction _a77(_a78){\nvar dc=$.data(_a78,"datagrid").dc;\nvar opts=$.data(_a78,"treegrid").options;\nif(!opts.rownumbers){\nreturn;\n}\ndc.body1.find("div.datagrid-cell-rownumber").each(function(i){\n$(this).html(i+1);\n});\n};\nfunction _a79(_a7a){\nreturn function(e){\n$.fn.datagrid.defaults.rowEvents[_a7a?"mouseover":"mouseout"](e);\nvar tt=$(e.target);\nvar fn=_a7a?"addClass":"removeClass";\nif(tt.hasClass("tree-hit")){\ntt.hasClass("tree-expanded")?tt[fn]("tree-expanded-hover"):tt[fn]("tree-collapsed-hover");\n}\n};\n};\nfunction _a7b(e){\nvar tt=$(e.target);\nvar tr=tt.closest("tr.datagrid-row");\nif(!tr.length||!tr.parent().length){\nreturn;\n}\nvar _a7c=tr.attr("node-id");\nvar _a7d=_a7e(tr);\nif(tt.hasClass("tree-hit")){\n_a7f(_a7d,_a7c);\n}else{\nif(tt.hasClass("tree-checkbox")){\n_a80(_a7d,_a7c);\n}else{\nvar opts=$(_a7d).datagrid("options");\nif(!tt.parent().hasClass("datagrid-cell-check")&&!opts.singleSelect&&e.shiftKey){\nvar rows=$(_a7d).treegrid("getChildren");\nvar idx1=$.easyui.indexOfArray(rows,opts.idField,opts.lastSelectedIndex);\nvar idx2=$.easyui.indexOfArray(rows,opts.idField,_a7c);\nvar from=Math.min(Math.max(idx1,0),idx2);\nvar to=Math.max(idx1,idx2);\nvar row=rows[idx2];\nvar td=tt.closest("td[field]",tr);\nif(td.length){\nvar _a81=td.attr("field");\nopts.onClickCell.call(_a7d,_a7c,_a81,row[_a81]);\n}\n$(_a7d).treegrid("clearSelections");\nfor(var i=from;i<=to;i++){\n$(_a7d).treegrid("selectRow",rows[i][opts.idField]);\n}\nopts.onClickRow.call(_a7d,row);\n}else{\n$.fn.datagrid.defaults.rowEvents.click(e);\n}\n}\n}\n};\nfunction _a7e(t){\nreturn $(t).closest("div.datagrid-view").children(".datagrid-f")[0];\n};\nfunction _a80(_a82,_a83,_a84,_a85){\nvar _a86=$.data(_a82,"treegrid");\nvar _a87=_a86.checkedRows;\nvar opts=_a86.options;\nif(!opts.checkbox){\nreturn;\n}\nvar row=find(_a82,_a83);\nif(!row.checkState){\nreturn;\n}\nvar tr=opts.finder.getTr(_a82,_a83);\nvar ck=tr.find(".tree-checkbox");\nif(_a84==undefined){\nif(ck.hasClass("tree-checkbox1")){\n_a84=false;\n}else{\nif(ck.hasClass("tree-checkbox0")){\n_a84=true;\n}else{\nif(row._checked==undefined){\nrow._checked=ck.hasClass("tree-checkbox1");\n}\n_a84=!row._checked;\n}\n}\n}\nrow._checked=_a84;\nif(_a84){\nif(ck.hasClass("tree-checkbox1")){\nreturn;\n}\n}else{\nif(ck.hasClass("tree-checkbox0")){\nreturn;\n}\n}\nif(!_a85){\nif(opts.onBeforeCheckNode.call(_a82,row,_a84)==false){\nreturn;\n}\n}\nif(opts.cascadeCheck){\n_a88(_a82,row,_a84);\n_a89(_a82,row);\n}else{\n_a8a(_a82,row,_a84?"1":"0");\n}\nif(!_a85){\nopts.onCheckNode.call(_a82,row,_a84);\n}\n};\nfunction _a8a(_a8b,row,flag){\nvar _a8c=$.data(_a8b,"treegrid");\nvar _a8d=_a8c.checkedRows;\nvar opts=_a8c.options;\nif(!row.checkState||flag==undefined){\nreturn;\n}\nvar tr=opts.finder.getTr(_a8b,row[opts.idField]);\nvar ck=tr.find(".tree-checkbox");\nif(!ck.length){\nreturn;\n}\nrow.checkState=["unchecked","checked","indeterminate"][flag];\nrow.checked=(row.checkState=="checked");\nck.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2");\nck.addClass("tree-checkbox"+flag);\nif(flag==0){\n$.easyui.removeArrayItem(_a8d,opts.idField,row[opts.idField]);\n}else{\n$.easyui.addArrayItem(_a8d,opts.idField,row);\n}\n};\nfunction _a88(_a8e,row,_a8f){\nvar flag=_a8f?1:0;\n_a8a(_a8e,row,flag);\n$.easyui.forEach(row.children||[],true,function(r){\n_a8a(_a8e,r,flag);\n});\n};\nfunction _a89(_a90,row){\nvar opts=$.data(_a90,"treegrid").options;\nvar prow=_a91(_a90,row[opts.idField]);\nif(prow){\n_a8a(_a90,prow,_a92(prow));\n_a89(_a90,prow);\n}\n};\nfunction _a92(row){\nvar len=0;\nvar c0=0;\nvar c1=0;\n$.easyui.forEach(row.children||[],false,function(r){\nif(r.checkState){\nlen++;\nif(r.checkState=="checked"){\nc1++;\n}else{\nif(r.checkState=="unchecked"){\nc0++;\n}\n}\n}\n});\nif(len==0){\nreturn undefined;\n}\nvar flag=0;\nif(c0==len){\nflag=0;\n}else{\nif(c1==len){\nflag=1;\n}else{\nflag=2;\n}\n}\nreturn flag;\n};\nfunction _a93(_a94,_a95){\nvar opts=$.data(_a94,"treegrid").options;\nif(!opts.checkbox){\nreturn;\n}\nvar row=find(_a94,_a95);\nvar tr=opts.finder.getTr(_a94,_a95);\nvar ck=tr.find(".tree-checkbox");\nif(opts.view.hasCheckbox(_a94,row)){\nif(!ck.length){\nrow.checkState=row.checkState||"unchecked";\n$("<span class=\\"tree-checkbox\\"></span>").insertBefore(tr.find(".tree-title"));\n}\nif(row.checkState=="checked"){\n_a80(_a94,_a95,true,true);\n}else{\nif(row.checkState=="unchecked"){\n_a80(_a94,_a95,false,true);\n}else{\nvar flag=_a92(row);\nif(flag===0){\n_a80(_a94,_a95,false,true);\n}else{\nif(flag===1){\n_a80(_a94,_a95,true,true);\n}\n}\n}\n}\n}else{\nck.remove();\nrow.checkState=undefined;\nrow.checked=undefined;\n_a89(_a94,row);\n}\n};\nfunction _a96(_a97,_a98){\nvar opts=$.data(_a97,"treegrid").options;\nvar tr1=opts.finder.getTr(_a97,_a98,"body",1);\nvar tr2=opts.finder.getTr(_a97,_a98,"body",2);\nvar _a99=$(_a97).datagrid("getColumnFields",true).length+(opts.rownumbers?1:0);\nvar _a9a=$(_a97).datagrid("getColumnFields",false).length;\n_a9b(tr1,_a99);\n_a9b(tr2,_a9a);\nfunction _a9b(tr,_a9c){\n$("<tr class=\\"treegrid-tr-tree\\">"+"<td style=\\"border:0px\\" colspan=\\""+_a9c+"\\">"+"<div></div>"+"</td>"+"</tr>").insertAfter(tr);\n};\n};\nfunction _a9d(_a9e,_a9f,data,_aa0,_aa1){\nvar _aa2=$.data(_a9e,"treegrid");\nvar opts=_aa2.options;\nvar dc=_aa2.dc;\ndata=opts.loadFilter.call(_a9e,data,_a9f);\nvar node=find(_a9e,_a9f);\nif(node){\nvar _aa3=opts.finder.getTr(_a9e,_a9f,"body",1);\nvar _aa4=opts.finder.getTr(_a9e,_a9f,"body",2);\nvar cc1=_aa3.next("tr.treegrid-tr-tree").children("td").children("div");\nvar cc2=_aa4.next("tr.treegrid-tr-tree").children("td").children("div");\nif(!_aa0){\nnode.children=[];\n}\n}else{\nvar cc1=dc.body1;\nvar cc2=dc.body2;\nif(!_aa0){\n_aa2.data=[];\n}\n}\nif(!_aa0){\ncc1.empty();\ncc2.empty();\n}\nif(opts.view.onBeforeRender){\nopts.view.onBeforeRender.call(opts.view,_a9e,_a9f,data);\n}\nopts.view.render.call(opts.view,_a9e,cc1,true);\nopts.view.render.call(opts.view,_a9e,cc2,false);\nif(opts.showFooter){\nopts.view.renderFooter.call(opts.view,_a9e,dc.footer1,true);\nopts.view.renderFooter.call(opts.view,_a9e,dc.footer2,false);\n}\nif(opts.view.onAfterRender){\nopts.view.onAfterRender.call(opts.view,_a9e);\n}\nif(!_a9f&&opts.pagination){\nvar _aa5=$.data(_a9e,"treegrid").total;\nvar _aa6=$(_a9e).datagrid("getPager");\nvar _aa7=_aa6.pagination("options");\nif(_aa7.total!=data.total){\n_aa6.pagination("refresh",{pageNumber:opts.pageNumber,total:data.total});\nif(opts.pageNumber!=_aa7.pageNumber&&_aa7.pageNumber>0){\nopts.pageNumber=_aa7.pageNumber;\n_a6e(_a9e);\n}\n}\n}\n_a6f(_a9e);\n_a77(_a9e);\n$(_a9e).treegrid("showLines");\n$(_a9e).treegrid("setSelectionState");\n$(_a9e).treegrid("autoSizeColumn");\nif(!_aa1){\nopts.onLoadSuccess.call(_a9e,node,data);\n}\n};\nfunction _a6e(_aa8,_aa9,_aaa,_aab,_aac){\nvar opts=$.data(_aa8,"treegrid").options;\nvar body=$(_aa8).datagrid("getPanel").find("div.datagrid-body");\nif(_aa9==undefined&&opts.queryParams){\nopts.queryParams.id=undefined;\n}\nif(_aaa){\nopts.queryParams=_aaa;\n}\nvar _aad=$.extend({},opts.queryParams);\nif(opts.pagination){\n$.extend(_aad,{page:opts.pageNumber,rows:opts.pageSize});\n}\nif(opts.sortName){\n$.extend(_aad,{sort:opts.sortName,order:opts.sortOrder});\n}\nvar row=find(_aa8,_aa9);\nif(opts.onBeforeLoad.call(_aa8,row,_aad)==false){\nreturn;\n}\nvar _aae=body.find("tr[node-id=\\""+_aa9+"\\"] span.tree-folder");\n_aae.addClass("tree-loading");\n$(_aa8).treegrid("loading");\nvar _aaf=opts.loader.call(_aa8,_aad,function(data){\n_aae.removeClass("tree-loading");\n$(_aa8).treegrid("loaded");\n_a9d(_aa8,_aa9,data,_aab);\nif(_aac){\n_aac();\n}\n},function(){\n_aae.removeClass("tree-loading");\n$(_aa8).treegrid("loaded");\nopts.onLoadError.apply(_aa8,arguments);\nif(_aac){\n_aac();\n}\n});\nif(_aaf==false){\n_aae.removeClass("tree-loading");\n$(_aa8).treegrid("loaded");\n}\n};\nfunction _ab0(_ab1){\nvar _ab2=_ab3(_ab1);\nreturn _ab2.length?_ab2[0]:null;\n};\nfunction _ab3(_ab4){\nreturn $.data(_ab4,"treegrid").data;\n};\nfunction _a91(_ab5,_ab6){\nvar row=find(_ab5,_ab6);\nif(row._parentId){\nreturn find(_ab5,row._parentId);\n}else{\nreturn null;\n}\n};\nfunction _a73(_ab7,_ab8){\nvar data=$.data(_ab7,"treegrid").data;\nif(_ab8){\nvar _ab9=find(_ab7,_ab8);\ndata=_ab9?(_ab9.children||[]):[];\n}\nvar _aba=[];\n$.easyui.forEach(data,true,function(node){\n_aba.push(node);\n});\nreturn _aba;\n};\nfunction _abb(_abc,_abd){\nvar opts=$.data(_abc,"treegrid").options;\nvar tr=opts.finder.getTr(_abc,_abd);\nvar node=tr.children("td[field=\\""+opts.treeField+"\\"]");\nreturn node.find("span.tree-indent,span.tree-hit").length;\n};\nfunction find(_abe,_abf){\nvar _ac0=$.data(_abe,"treegrid");\nvar opts=_ac0.options;\nvar _ac1=null;\n$.easyui.forEach(_ac0.data,true,function(node){\nif(node[opts.idField]==_abf){\n_ac1=node;\nreturn false;\n}\n});\nreturn _ac1;\n};\nfunction _ac2(_ac3,_ac4){\nvar opts=$.data(_ac3,"treegrid").options;\nvar row=find(_ac3,_ac4);\nvar tr=opts.finder.getTr(_ac3,_ac4);\nvar hit=tr.find("span.tree-hit");\nif(hit.length==0){\nreturn;\n}\nif(hit.hasClass("tree-collapsed")){\nreturn;\n}\nif(opts.onBeforeCollapse.call(_ac3,row)==false){\nreturn;\n}\nhit.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed");\nhit.next().removeClass("tree-folder-open");\nrow.state="closed";\ntr=tr.next("tr.treegrid-tr-tree");\nvar cc=tr.children("td").children("div");\nif(opts.animate){\ncc.slideUp("normal",function(){\n$(_ac3).treegrid("autoSizeColumn");\n_a6f(_ac3,_ac4);\nopts.onCollapse.call(_ac3,row);\n});\n}else{\ncc.hide();\n$(_ac3).treegrid("autoSizeColumn");\n_a6f(_ac3,_ac4);\nopts.onCollapse.call(_ac3,row);\n}\n};\nfunction _ac5(_ac6,_ac7){\nvar opts=$.data(_ac6,"treegrid").options;\nvar tr=opts.finder.getTr(_ac6,_ac7);\nvar hit=tr.find("span.tree-hit");\nvar row=find(_ac6,_ac7);\nif(hit.length==0){\nreturn;\n}\nif(hit.hasClass("tree-expanded")){\nreturn;\n}\nif(opts.onBeforeExpand.call(_ac6,row)==false){\nreturn;\n}\nhit.removeClass("tree-collapsed tree-collapsed-hover").addClass("tree-expanded");\nhit.next().addClass("tree-folder-open");\nvar _ac8=tr.next("tr.treegrid-tr-tree");\nif(_ac8.length){\nvar cc=_ac8.children("td").children("div");\n_ac9(cc);\n}else{\n_a96(_ac6,row[opts.idField]);\nvar _ac8=tr.next("tr.treegrid-tr-tree");\nvar cc=_ac8.children("td").children("div");\ncc.hide();\nvar _aca=$.extend({},opts.queryParams||{});\n_aca.id=row[opts.idField];\n_a6e(_ac6,row[opts.idField],_aca,true,function(){\nif(cc.is(":empty")){\n_ac8.remove();\n}else{\n_ac9(cc);\n}\n});\n}\nfunction _ac9(cc){\nrow.state="open";\nif(opts.animate){\ncc.slideDown("normal",function(){\n$(_ac6).treegrid("autoSizeColumn");\n_a6f(_ac6,_ac7);\nopts.onExpand.call(_ac6,row);\n});\n}else{\ncc.show();\n$(_ac6).treegrid("autoSizeColumn");\n_a6f(_ac6,_ac7);\nopts.onExpand.call(_ac6,row);\n}\n};\n};\nfunction _a7f(_acb,_acc){\nvar opts=$.data(_acb,"treegrid").options;\nvar tr=opts.finder.getTr(_acb,_acc);\nvar hit=tr.find("span.tree-hit");\nif(hit.hasClass("tree-expanded")){\n_ac2(_acb,_acc);\n}else{\n_ac5(_acb,_acc);\n}\n};\nfunction _acd(_ace,_acf){\nvar opts=$.data(_ace,"treegrid").options;\nvar _ad0=_a73(_ace,_acf);\nif(_acf){\n_ad0.unshift(find(_ace,_acf));\n}\nfor(var i=0;i<_ad0.length;i++){\n_ac2(_ace,_ad0[i][opts.idField]);\n}\n};\nfunction _ad1(_ad2,_ad3){\nvar opts=$.data(_ad2,"treegrid").options;\nvar _ad4=_a73(_ad2,_ad3);\nif(_ad3){\n_ad4.unshift(find(_ad2,_ad3));\n}\nfor(var i=0;i<_ad4.length;i++){\n_ac5(_ad2,_ad4[i][opts.idField]);\n}\n};\nfunction _ad5(_ad6,_ad7){\nvar opts=$.data(_ad6,"treegrid").options;\nvar ids=[];\nvar p=_a91(_ad6,_ad7);\nwhile(p){\nvar id=p[opts.idField];\nids.unshift(id);\np=_a91(_ad6,id);\n}\nfor(var i=0;i<ids.length;i++){\n_ac5(_ad6,ids[i]);\n}\n};\nfunction _ad8(_ad9,_ada){\nvar _adb=$.data(_ad9,"treegrid");\nvar opts=_adb.options;\nif(_ada.parent){\nvar tr=opts.finder.getTr(_ad9,_ada.parent);\nif(tr.next("tr.treegrid-tr-tree").length==0){\n_a96(_ad9,_ada.parent);\n}\nvar cell=tr.children("td[field=\\""+opts.treeField+"\\"]").children("div.datagrid-cell");\nvar _adc=cell.children("span.tree-icon");\nif(_adc.hasClass("tree-file")){\n_adc.removeClass("tree-file").addClass("tree-folder tree-folder-open");\nvar hit=$("<span class=\\"tree-hit tree-expanded\\"></span>").insertBefore(_adc);\nif(hit.prev().length){\nhit.prev().remove();\n}\n}\n}\n_a9d(_ad9,_ada.parent,_ada.data,_adb.data.length>0,true);\n};\nfunction _add(_ade,_adf){\nvar ref=_adf.before||_adf.after;\nvar opts=$.data(_ade,"treegrid").options;\nvar _ae0=_a91(_ade,ref);\n_ad8(_ade,{parent:(_ae0?_ae0[opts.idField]:null),data:[_adf.data]});\nvar _ae1=_ae0?_ae0.children:$(_ade).treegrid("getRoots");\nfor(var i=0;i<_ae1.length;i++){\nif(_ae1[i][opts.idField]==ref){\nvar _ae2=_ae1[_ae1.length-1];\n_ae1.splice(_adf.before?i:(i+1),0,_ae2);\n_ae1.splice(_ae1.length-1,1);\nbreak;\n}\n}\n_ae3(true);\n_ae3(false);\n_a77(_ade);\n$(_ade).treegrid("showLines");\nfunction _ae3(_ae4){\nvar _ae5=_ae4?1:2;\nvar tr=opts.finder.getTr(_ade,_adf.data[opts.idField],"body",_ae5);\nvar _ae6=tr.closest("table.datagrid-btable");\ntr=tr.parent().children();\nvar dest=opts.finder.getTr(_ade,ref,"body",_ae5);\nif(_adf.before){\ntr.insertBefore(dest);\n}else{\nvar sub=dest.next("tr.treegrid-tr-tree");\ntr.insertAfter(sub.length?sub:dest);\n}\n_ae6.remove();\n};\n};\nfunction _ae7(_ae8,_ae9){\nvar _aea=$.data(_ae8,"treegrid");\nvar opts=_aea.options;\nvar prow=_a91(_ae8,_ae9);\n$(_ae8).datagrid("deleteRow",_ae9);\n$.easyui.removeArrayItem(_aea.checkedRows,opts.idField,_ae9);\n_a77(_ae8);\nif(prow){\n_a93(_ae8,prow[opts.idField]);\n}\n_aea.total-=1;\n$(_ae8).datagrid("getPager").pagination("refresh",{total:_aea.total});\n$(_ae8).treegrid("showLines");\n};\nfunction _aeb(_aec){\nvar t=$(_aec);\nvar opts=t.treegrid("options");\nif(opts.lines){\nt.treegrid("getPanel").addClass("tree-lines");\n}else{\nt.treegrid("getPanel").removeClass("tree-lines");\nreturn;\n}\nt.treegrid("getPanel").find("span.tree-indent").removeClass("tree-line tree-join tree-joinbottom");\nt.treegrid("getPanel").find("div.datagrid-cell").removeClass("tree-node-last tree-root-first tree-root-one");\nvar _aed=t.treegrid("getRoots");\nif(_aed.length>1){\n_aee(_aed[0]).addClass("tree-root-first");\n}else{\nif(_aed.length==1){\n_aee(_aed[0]).addClass("tree-root-one");\n}\n}\n_aef(_aed);\n_af0(_aed);\nfunction _aef(_af1){\n$.map(_af1,function(node){\nif(node.children&&node.children.length){\n_aef(node.children);\n}else{\nvar cell=_aee(node);\ncell.find(".tree-icon").prev().addClass("tree-join");\n}\n});\nif(_af1.length){\nvar cell=_aee(_af1[_af1.length-1]);\ncell.addClass("tree-node-last");\ncell.find(".tree-join").removeClass("tree-join").addClass("tree-joinbottom");\n}\n};\nfunction _af0(_af2){\n$.map(_af2,function(node){\nif(node.children&&node.children.length){\n_af0(node.children);\n}\n});\nfor(var i=0;i<_af2.length-1;i++){\nvar node=_af2[i];\nvar _af3=t.treegrid("getLevel",node[opts.idField]);\nvar tr=opts.finder.getTr(_aec,node[opts.idField]);\nvar cc=tr.next().find("tr.datagrid-row td[field=\\""+opts.treeField+"\\"] div.datagrid-cell");\ncc.find("span:eq("+(_af3-1)+")").addClass("tree-line");\n}\n};\nfunction _aee(node){\nvar tr=opts.finder.getTr(_aec,node[opts.idField]);\nvar cell=tr.find("td[field=\\""+opts.treeField+"\\"] div.datagrid-cell");\nreturn cell;\n};\n};\n$.fn.treegrid=function(_af4,_af5){\nif(typeof _af4=="string"){\nvar _af6=$.fn.treegrid.methods[_af4];\nif(_af6){\nreturn _af6(this,_af5);\n}else{\nreturn this.datagrid(_af4,_af5);\n}\n}\n_af4=_af4||{};\nreturn this.each(function(){\nvar _af7=$.data(this,"treegrid");\nif(_af7){\n$.extend(_af7.options,_af4);\n}else{\n_af7=$.data(this,"treegrid",{options:$.extend({},$.fn.treegrid.defaults,$.fn.treegrid.parseOptions(this),_af4),data:[],checkedRows:[],tmpIds:[]});\n}\n_a5e(this);\nif(_af7.options.data){\n$(this).treegrid("loadData",_af7.options.data);\n}\n_a6e(this);\n});\n};\n$.fn.treegrid.methods={options:function(jq){\nreturn $.data(jq[0],"treegrid").options;\n},resize:function(jq,_af8){\nreturn jq.each(function(){\n$(this).datagrid("resize",_af8);\n});\n},fixRowHeight:function(jq,_af9){\nreturn jq.each(function(){\n_a6f(this,_af9);\n});\n},loadData:function(jq,data){\nreturn jq.each(function(){\n_a9d(this,data.parent,data);\n});\n},load:function(jq,_afa){\nreturn jq.each(function(){\n$(this).treegrid("options").pageNumber=1;\n$(this).treegrid("getPager").pagination({pageNumber:1});\n$(this).treegrid("reload",_afa);\n});\n},reload:function(jq,id){\nreturn jq.each(function(){\nvar opts=$(this).treegrid("options");\nvar _afb={};\nif(typeof id=="object"){\n_afb=id;\n}else{\n_afb=$.extend({},opts.queryParams);\n_afb.id=id;\n}\nif(_afb.id){\nvar node=$(this).treegrid("find",_afb.id);\nif(node.children){\nnode.children.splice(0,node.children.length);\n}\nopts.queryParams=_afb;\nvar tr=opts.finder.getTr(this,_afb.id);\ntr.next("tr.treegrid-tr-tree").remove();\ntr.find("span.tree-hit").removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed");\n_ac5(this,_afb.id);\n}else{\n_a6e(this,null,_afb);\n}\n});\n},reloadFooter:function(jq,_afc){\nreturn jq.each(function(){\nvar opts=$.data(this,"treegrid").options;\nvar dc=$.data(this,"datagrid").dc;\nif(_afc){\n$.data(this,"treegrid").footer=_afc;\n}\nif(opts.showFooter){\nopts.view.renderFooter.call(opts.view,this,dc.footer1,true);\nopts.view.renderFooter.call(opts.view,this,dc.footer2,false);\nif(opts.view.onAfterRender){\nopts.view.onAfterRender.call(opts.view,this);\n}\n$(this).treegrid("fixRowHeight");\n}\n});\n},getData:function(jq){\nreturn $.data(jq[0],"treegrid").data;\n},getFooterRows:function(jq){\nreturn $.data(jq[0],"treegrid").footer;\n},getRoot:function(jq){\nreturn _ab0(jq[0]);\n},getRoots:function(jq){\nreturn _ab3(jq[0]);\n},getParent:function(jq,id){\nreturn _a91(jq[0],id);\n},getChildren:function(jq,id){\nreturn _a73(jq[0],id);\n},getLevel:function(jq,id){\nreturn _abb(jq[0],id);\n},find:function(jq,id){\nreturn find(jq[0],id);\n},isLeaf:function(jq,id){\nvar opts=$.data(jq[0],"treegrid").options;\nvar tr=opts.finder.getTr(jq[0],id);\nvar hit=tr.find("span.tree-hit");\nreturn hit.length==0;\n},select:function(jq,id){\nreturn jq.each(function(){\n$(this).datagrid("selectRow",id);\n});\n},unselect:function(jq,id){\nreturn jq.each(function(){\n$(this).datagrid("unselectRow",id);\n});\n},collapse:function(jq,id){\nreturn jq.each(function(){\n_ac2(this,id);\n});\n},expand:function(jq,id){\nreturn jq.each(function(){\n_ac5(this,id);\n});\n},toggle:function(jq,id){\nreturn jq.each(function(){\n_a7f(this,id);\n});\n},collapseAll:function(jq,id){\nreturn jq.each(function(){\n_acd(this,id);\n});\n},expandAll:function(jq,id){\nreturn jq.each(function(){\n_ad1(this,id);\n});\n},expandTo:function(jq,id){\nreturn jq.each(function(){\n_ad5(this,id);\n});\n},append:function(jq,_afd){\nreturn jq.each(function(){\n_ad8(this,_afd);\n});\n},insert:function(jq,_afe){\nreturn jq.each(function(){\n_add(this,_afe);\n});\n},remove:function(jq,id){\nreturn jq.each(function(){\n_ae7(this,id);\n});\n},pop:function(jq,id){\nvar row=jq.treegrid("find",id);\njq.treegrid("remove",id);\nreturn row;\n},refresh:function(jq,id){\nreturn jq.each(function(){\nvar opts=$.data(this,"treegrid").options;\nopts.view.refreshRow.call(opts.view,this,id);\n});\n},update:function(jq,_aff){\nreturn jq.each(function(){\nvar opts=$.data(this,"treegrid").options;\nvar row=_aff.row;\nopts.view.updateRow.call(opts.view,this,_aff.id,row);\nif(row.checked!=undefined){\nrow=find(this,_aff.id);\n$.extend(row,{checkState:row.checked?"checked":(row.checked===false?"unchecked":undefined)});\n_a93(this,_aff.id);\n}\n});\n},beginEdit:function(jq,id){\nreturn jq.each(function(){\n$(this).datagrid("beginEdit",id);\n$(this).treegrid("fixRowHeight",id);\n});\n},endEdit:function(jq,id){\nreturn jq.each(function(){\n$(this).datagrid("endEdit",id);\n});\n},cancelEdit:function(jq,id){\nreturn jq.each(function(){\n$(this).datagrid("cancelEdit",id);\n});\n},showLines:function(jq){\nreturn jq.each(function(){\n_aeb(this);\n});\n},setSelectionState:function(jq){\nreturn jq.each(function(){\n$(this).datagrid("setSelectionState");\nvar _b00=$(this).data("treegrid");\nfor(var i=0;i<_b00.tmpIds.length;i++){\n_a80(this,_b00.tmpIds[i],true,true);\n}\n_b00.tmpIds=[];\n});\n},getCheckedNodes:function(jq,_b01){\n_b01=_b01||"checked";\nvar rows=[];\n$.easyui.forEach(jq.data("treegrid").checkedRows,false,function(row){\nif(row.checkState==_b01){\nrows.push(row);\n}\n});\nreturn rows;\n},checkNode:function(jq,id){\nreturn jq.each(function(){\n_a80(this,id,true);\n});\n},uncheckNode:function(jq,id){\nreturn jq.each(function(){\n_a80(this,id,false);\n});\n},clearChecked:function(jq){\nreturn jq.each(function(){\nvar _b02=this;\nvar opts=$(_b02).treegrid("options");\n$(_b02).datagrid("clearChecked");\n$.map($(_b02).treegrid("getCheckedNodes"),function(row){\n_a80(_b02,row[opts.idField],false,true);\n});\n});\n}};\n$.fn.treegrid.parseOptions=function(_b03){\nreturn $.extend({},$.fn.datagrid.parseOptions(_b03),$.parser.parseOptions(_b03,["treeField",{checkbox:"boolean",cascadeCheck:"boolean",onlyLeafCheck:"boolean"},{animate:"boolean"}]));\n};\nvar _b04=$.extend({},$.fn.datagrid.defaults.view,{render:function(_b05,_b06,_b07){\nvar opts=$.data(_b05,"treegrid").options;\nvar _b08=$(_b05).datagrid("getColumnFields",_b07);\nvar _b09=$.data(_b05,"datagrid").rowIdPrefix;\nif(_b07){\nif(!(opts.rownumbers||(opts.frozenColumns&&opts.frozenColumns.length))){\nreturn;\n}\n}\nvar view=this;\nif(this.treeNodes&&this.treeNodes.length){\nvar _b0a=_b0b.call(this,_b07,this.treeLevel,this.treeNodes);\n$(_b06).append(_b0a.join(""));\n}\nfunction _b0b(_b0c,_b0d,_b0e){\nvar _b0f=$(_b05).treegrid("getParent",_b0e[0][opts.idField]);\nvar _b10=(_b0f?_b0f.children.length:$(_b05).treegrid("getRoots").length)-_b0e.length;\nvar _b11=["<table class=\\"datagrid-btable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>"];\nfor(var i=0;i<_b0e.length;i++){\nvar row=_b0e[i];\nif(row.state!="open"&&row.state!="closed"){\nrow.state="open";\n}\nvar css=opts.rowStyler?opts.rowStyler.call(_b05,row):"";\nvar cs=this.getStyleValue(css);\nvar cls="class=\\"datagrid-row "+(_b10++%2&&opts.striped?"datagrid-row-alt ":" ")+cs.c+"\\"";\nvar _b12=cs.s?"style=\\""+cs.s+"\\"":"";\nvar _b13=_b09+"-"+(_b0c?1:2)+"-"+row[opts.idField];\n_b11.push("<tr id=\\""+_b13+"\\" node-id=\\""+row[opts.idField]+"\\" "+cls+" "+_b12+">");\n_b11=_b11.concat(view.renderRow.call(view,_b05,_b08,_b0c,_b0d,row));\n_b11.push("</tr>");\nif(row.children&&row.children.length){\nvar tt=_b0b.call(this,_b0c,_b0d+1,row.children);\nvar v=row.state=="closed"?"none":"block";\n_b11.push("<tr class=\\"treegrid-tr-tree\\"><td style=\\"border:0px\\" colspan="+(_b08.length+(opts.rownumbers?1:0))+"><div style=\\"display:"+v+"\\">");\n_b11=_b11.concat(tt);\n_b11.push("</div></td></tr>");\n}\n}\n_b11.push("</tbody></table>");\nreturn _b11;\n};\n},renderFooter:function(_b14,_b15,_b16){\nvar opts=$.data(_b14,"treegrid").options;\nvar rows=$.data(_b14,"treegrid").footer||[];\nvar _b17=$(_b14).datagrid("getColumnFields",_b16);\nvar _b18=["<table class=\\"datagrid-ftable\\" cellspacing=\\"0\\" cellpadding=\\"0\\" border=\\"0\\"><tbody>"];\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nrow[opts.idField]=row[opts.idField]||("foot-row-id"+i);\n_b18.push("<tr class=\\"datagrid-row\\" node-id=\\""+row[opts.idField]+"\\">");\n_b18.push(this.renderRow.call(this,_b14,_b17,_b16,0,row));\n_b18.push("</tr>");\n}\n_b18.push("</tbody></table>");\n$(_b15).html(_b18.join(""));\n},renderRow:function(_b19,_b1a,_b1b,_b1c,row){\nvar _b1d=$.data(_b19,"treegrid");\nvar opts=_b1d.options;\nvar cc=[];\nif(_b1b&&opts.rownumbers){\ncc.push("<td class=\\"datagrid-td-rownumber\\"><div class=\\"datagrid-cell-rownumber\\">0</div></td>");\n}\nfor(var i=0;i<_b1a.length;i++){\nvar _b1e=_b1a[i];\nvar col=$(_b19).datagrid("getColumnOption",_b1e);\nif(col){\nvar css=col.styler?(col.styler(row[_b1e],row)||""):"";\nvar cs=this.getStyleValue(css);\nvar cls=cs.c?"class=\\""+cs.c+"\\"":"";\nvar _b1f=col.hidden?"style=\\"display:none;"+cs.s+"\\"":(cs.s?"style=\\""+cs.s+"\\"":"");\ncc.push("<td field=\\""+_b1e+"\\" "+cls+" "+_b1f+">");\nvar _b1f="";\nif(!col.checkbox){\nif(col.align){\n_b1f+="text-align:"+col.align+";";\n}\nif(!opts.nowrap){\n_b1f+="white-space:normal;height:auto;";\n}else{\nif(opts.autoRowHeight){\n_b1f+="height:auto;";\n}\n}\n}\ncc.push("<div style=\\""+_b1f+"\\" ");\nif(col.checkbox){\ncc.push("class=\\"datagrid-cell-check ");\n}else{\ncc.push("class=\\"datagrid-cell "+col.cellClass);\n}\nif(_b1e==opts.treeField){\ncc.push(" tree-node");\n}\ncc.push("\\">");\nif(col.checkbox){\nif(row.checked){\ncc.push("<input type=\\"checkbox\\" checked=\\"checked\\"");\n}else{\ncc.push("<input type=\\"checkbox\\"");\n}\ncc.push(" name=\\""+_b1e+"\\" value=\\""+(row[_b1e]!=undefined?row[_b1e]:"")+"\\">");\n}else{\nvar val=null;\nif(col.formatter){\nval=col.formatter(row[_b1e],row);\n}else{\nval=row[_b1e];\n}\nif(_b1e==opts.treeField){\nfor(var j=0;j<_b1c;j++){\ncc.push("<span class=\\"tree-indent\\"></span>");\n}\nif(row.state=="closed"){\ncc.push("<span class=\\"tree-hit tree-collapsed\\"></span>");\ncc.push("<span class=\\"tree-icon tree-folder "+(row.iconCls?row.iconCls:"")+"\\"></span>");\n}else{\nif(row.children&&row.children.length){\ncc.push("<span class=\\"tree-hit tree-expanded\\"></span>");\ncc.push("<span class=\\"tree-icon tree-folder tree-folder-open "+(row.iconCls?row.iconCls:"")+"\\"></span>");\n}else{\ncc.push("<span class=\\"tree-indent\\"></span>");\ncc.push("<span class=\\"tree-icon tree-file "+(row.iconCls?row.iconCls:"")+"\\"></span>");\n}\n}\nif(this.hasCheckbox(_b19,row)){\nvar flag=0;\nvar crow=$.easyui.getArrayItem(_b1d.checkedRows,opts.idField,row[opts.idField]);\nif(crow){\nflag=crow.checkState=="checked"?1:2;\nrow.checkState=crow.checkState;\nrow.checked=crow.checked;\n$.easyui.addArrayItem(_b1d.checkedRows,opts.idField,row);\n}else{\nvar prow=$.easyui.getArrayItem(_b1d.checkedRows,opts.idField,row._parentId);\nif(prow&&prow.checkState=="checked"&&opts.cascadeCheck){\nflag=1;\nrow.checked=true;\n$.easyui.addArrayItem(_b1d.checkedRows,opts.idField,row);\n}else{\nif(row.checked){\n$.easyui.addArrayItem(_b1d.tmpIds,row[opts.idField]);\n}\n}\nrow.checkState=flag?"checked":"unchecked";\n}\ncc.push("<span class=\\"tree-checkbox tree-checkbox"+flag+"\\"></span>");\n}else{\nrow.checkState=undefined;\nrow.checked=undefined;\n}\ncc.push("<span class=\\"tree-title\\">"+val+"</span>");\n}else{\ncc.push(val);\n}\n}\ncc.push("</div>");\ncc.push("</td>");\n}\n}\nreturn cc.join("");\n},hasCheckbox:function(_b20,row){\nvar opts=$.data(_b20,"treegrid").options;\nif(opts.checkbox){\nif($.isFunction(opts.checkbox)){\nif(opts.checkbox.call(_b20,row)){\nreturn true;\n}else{\nreturn false;\n}\n}else{\nif(opts.onlyLeafCheck){\nif(row.state=="open"&&!(row.children&&row.children.length)){\nreturn true;\n}\n}else{\nreturn true;\n}\n}\n}\nreturn false;\n},refreshRow:function(_b21,id){\nthis.updateRow.call(this,_b21,id,{});\n},updateRow:function(_b22,id,row){\nvar opts=$.data(_b22,"treegrid").options;\nvar _b23=$(_b22).treegrid("find",id);\n$.extend(_b23,row);\nvar _b24=$(_b22).treegrid("getLevel",id)-1;\nvar _b25=opts.rowStyler?opts.rowStyler.call(_b22,_b23):"";\nvar _b26=$.data(_b22,"datagrid").rowIdPrefix;\nvar _b27=_b23[opts.idField];\nfunction _b28(_b29){\nvar _b2a=$(_b22).treegrid("getColumnFields",_b29);\nvar tr=opts.finder.getTr(_b22,id,"body",(_b29?1:2));\nvar _b2b=tr.find("div.datagrid-cell-rownumber").html();\nvar _b2c=tr.find("div.datagrid-cell-check input[type=checkbox]").is(":checked");\ntr.html(this.renderRow(_b22,_b2a,_b29,_b24,_b23));\ntr.attr("style",_b25||"");\ntr.find("div.datagrid-cell-rownumber").html(_b2b);\nif(_b2c){\ntr.find("div.datagrid-cell-check input[type=checkbox]")._propAttr("checked",true);\n}\nif(_b27!=id){\ntr.attr("id",_b26+"-"+(_b29?1:2)+"-"+_b27);\ntr.attr("node-id",_b27);\n}\n};\n_b28.call(this,true);\n_b28.call(this,false);\n$(_b22).treegrid("fixRowHeight",id);\n},deleteRow:function(_b2d,id){\nvar opts=$.data(_b2d,"treegrid").options;\nvar tr=opts.finder.getTr(_b2d,id);\ntr.next("tr.treegrid-tr-tree").remove();\ntr.remove();\nvar _b2e=del(id);\nif(_b2e){\nif(_b2e.children.length==0){\ntr=opts.finder.getTr(_b2d,_b2e[opts.idField]);\ntr.next("tr.treegrid-tr-tree").remove();\nvar cell=tr.children("td[field=\\""+opts.treeField+"\\"]").children("div.datagrid-cell");\ncell.find(".tree-icon").removeClass("tree-folder").addClass("tree-file");\ncell.find(".tree-hit").remove();\n$("<span class=\\"tree-indent\\"></span>").prependTo(cell);\n}\n}\nthis.setEmptyMsg(_b2d);\nfunction del(id){\nvar cc;\nvar _b2f=$(_b2d).treegrid("getParent",id);\nif(_b2f){\ncc=_b2f.children;\n}else{\ncc=$(_b2d).treegrid("getData");\n}\nfor(var i=0;i<cc.length;i++){\nif(cc[i][opts.idField]==id){\ncc.splice(i,1);\nbreak;\n}\n}\nreturn _b2f;\n};\n},onBeforeRender:function(_b30,_b31,data){\nif($.isArray(_b31)){\ndata={total:_b31.length,rows:_b31};\n_b31=null;\n}\nif(!data){\nreturn false;\n}\nvar _b32=$.data(_b30,"treegrid");\nvar opts=_b32.options;\nif(data.length==undefined){\nif(data.footer){\n_b32.footer=data.footer;\n}\nif(data.total){\n_b32.total=data.total;\n}\ndata=this.transfer(_b30,_b31,data.rows);\n}else{\nfunction _b33(_b34,_b35){\nfor(var i=0;i<_b34.length;i++){\nvar row=_b34[i];\nrow._parentId=_b35;\nif(row.children&&row.children.length){\n_b33(row.children,row[opts.idField]);\n}\n}\n};\n_b33(data,_b31);\n}\nthis.sort(_b30,data);\nthis.treeNodes=data;\nthis.treeLevel=$(_b30).treegrid("getLevel",_b31);\nvar node=find(_b30,_b31);\nif(node){\nif(node.children){\nnode.children=node.children.concat(data);\n}else{\nnode.children=data;\n}\n}else{\n_b32.data=_b32.data.concat(data);\n}\n},sort:function(_b36,data){\nvar opts=$.data(_b36,"treegrid").options;\nif(!opts.remoteSort&&opts.sortName){\nvar _b37=opts.sortName.split(",");\nvar _b38=opts.sortOrder.split(",");\n_b39(data);\n}\nfunction _b39(rows){\nrows.sort(function(r1,r2){\nvar r=0;\nfor(var i=0;i<_b37.length;i++){\nvar sn=_b37[i];\nvar so=_b38[i];\nvar col=$(_b36).treegrid("getColumnOption",sn);\nvar _b3a=col.sorter||function(a,b){\nreturn a==b?0:(a>b?1:-1);\n};\nr=_b3a(r1[sn],r2[sn])*(so=="asc"?1:-1);\nif(r!=0){\nreturn r;\n}\n}\nreturn r;\n});\nfor(var i=0;i<rows.length;i++){\nvar _b3b=rows[i].children;\nif(_b3b&&_b3b.length){\n_b39(_b3b);\n}\n}\n};\n},transfer:function(_b3c,_b3d,data){\nvar opts=$.data(_b3c,"treegrid").options;\nvar rows=$.extend([],data);\nvar _b3e=_b3f(_b3d,rows);\nvar toDo=$.extend([],_b3e);\nwhile(toDo.length){\nvar node=toDo.shift();\nvar _b40=_b3f(node[opts.idField],rows);\nif(_b40.length){\nif(node.children){\nnode.children=node.children.concat(_b40);\n}else{\nnode.children=_b40;\n}\ntoDo=toDo.concat(_b40);\n}\n}\nreturn _b3e;\nfunction _b3f(_b41,rows){\nvar rr=[];\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nif(row._parentId==_b41){\nrr.push(row);\nrows.splice(i,1);\ni--;\n}\n}\nreturn rr;\n};\n}});\n$.fn.treegrid.defaults=$.extend({},$.fn.datagrid.defaults,{treeField:null,checkbox:false,cascadeCheck:true,onlyLeafCheck:false,lines:false,animate:false,singleSelect:true,view:_b04,rowEvents:$.extend({},$.fn.datagrid.defaults.rowEvents,{mouseover:_a79(true),mouseout:_a79(false),click:_a7b}),loader:function(_b42,_b43,_b44){\nvar opts=$(this).treegrid("options");\nif(!opts.url){\nreturn false;\n}\n$.ajax({type:opts.method,url:opts.url,data:_b42,dataType:"json",success:function(data){\n_b43(data);\n},error:function(){\n_b44.apply(this,arguments);\n}});\n},loadFilter:function(data,_b45){\nreturn data;\n},finder:{getTr:function(_b46,id,type,_b47){\ntype=type||"body";\n_b47=_b47||0;\nvar dc=$.data(_b46,"datagrid").dc;\nif(_b47==0){\nvar opts=$.data(_b46,"treegrid").options;\nvar tr1=opts.finder.getTr(_b46,id,type,1);\nvar tr2=opts.finder.getTr(_b46,id,type,2);\nreturn tr1.add(tr2);\n}else{\nif(type=="body"){\nvar tr=$("#"+$.data(_b46,"datagrid").rowIdPrefix+"-"+_b47+"-"+id);\nif(!tr.length){\ntr=(_b47==1?dc.body1:dc.body2).find("tr[node-id=\\""+id+"\\"]");\n}\nreturn tr;\n}else{\nif(type=="footer"){\nreturn (_b47==1?dc.footer1:dc.footer2).find("tr[node-id=\\""+id+"\\"]");\n}else{\nif(type=="selected"){\nreturn (_b47==1?dc.body1:dc.body2).find("tr.datagrid-row-selected");\n}else{\nif(type=="highlight"){\nreturn (_b47==1?dc.body1:dc.body2).find("tr.datagrid-row-over");\n}else{\nif(type=="checked"){\nreturn (_b47==1?dc.body1:dc.body2).find("tr.datagrid-row-checked");\n}else{\nif(type=="last"){\nreturn (_b47==1?dc.body1:dc.body2).find("tr:last[node-id]");\n}else{\nif(type=="allbody"){\nreturn (_b47==1?dc.body1:dc.body2).find("tr[node-id]");\n}else{\nif(type=="allfooter"){\nreturn (_b47==1?dc.footer1:dc.footer2).find("tr[node-id]");\n}\n}\n}\n}\n}\n}\n}\n}\n}\n},getRow:function(_b48,p){\nvar id=(typeof p=="object")?p.attr("node-id"):p;\nreturn $(_b48).treegrid("find",id);\n},getRows:function(_b49){\nreturn $(_b49).treegrid("getChildren");\n}},onBeforeLoad:function(row,_b4a){\n},onLoadSuccess:function(row,data){\n},onLoadError:function(){\n},onBeforeCollapse:function(row){\n},onCollapse:function(row){\n},onBeforeExpand:function(row){\n},onExpand:function(row){\n},onClickRow:function(row){\n},onDblClickRow:function(row){\n},onClickCell:function(_b4b,row){\n},onDblClickCell:function(_b4c,row){\n},onContextMenu:function(e,row){\n},onBeforeEdit:function(row){\n},onAfterEdit:function(row,_b4d){\n},onCancelEdit:function(row){\n},onBeforeCheckNode:function(row,_b4e){\n},onCheckNode:function(row,_b4f){\n}});\n})(jQuery);\n(function($){\nfunction _b50(_b51){\nvar opts=$.data(_b51,"datalist").options;\n$(_b51).datagrid($.extend({},opts,{cls:"datalist"+(opts.lines?" datalist-lines":""),frozenColumns:(opts.frozenColumns&&opts.frozenColumns.length)?opts.frozenColumns:(opts.checkbox?[[{field:"_ck",checkbox:true}]]:undefined),columns:(opts.columns&&opts.columns.length)?opts.columns:[[{field:opts.textField,width:"100%",formatter:function(_b52,row,_b53){\nreturn opts.textFormatter?opts.textFormatter(_b52,row,_b53):_b52;\n}}]]}));\n};\nvar _b54=$.extend({},$.fn.datagrid.defaults.view,{render:function(_b55,_b56,_b57){\nvar _b58=$.data(_b55,"datagrid");\nvar opts=_b58.options;\nif(opts.groupField){\nvar g=this.groupRows(_b55,_b58.data.rows);\nthis.groups=g.groups;\n_b58.data.rows=g.rows;\nvar _b59=[];\nfor(var i=0;i<g.groups.length;i++){\n_b59.push(this.renderGroup.call(this,_b55,i,g.groups[i],_b57));\n}\n$(_b56).html(_b59.join(""));\n}else{\n$(_b56).html(this.renderTable(_b55,0,_b58.data.rows,_b57));\n}\n},renderGroup:function(_b5a,_b5b,_b5c,_b5d){\nvar _b5e=$.data(_b5a,"datagrid");\nvar opts=_b5e.options;\nvar _b5f=$(_b5a).datagrid("getColumnFields",_b5d);\nvar _b60=[];\n_b60.push("<div class=\\"datagrid-group\\" group-index="+_b5b+">");\nif(!_b5d){\n_b60.push("<span class=\\"datagrid-group-title\\">");\n_b60.push(opts.groupFormatter.call(_b5a,_b5c.value,_b5c.rows));\n_b60.push("</span>");\n}\n_b60.push("</div>");\n_b60.push(this.renderTable(_b5a,_b5c.startIndex,_b5c.rows,_b5d));\nreturn _b60.join("");\n},groupRows:function(_b61,rows){\nvar _b62=$.data(_b61,"datagrid");\nvar opts=_b62.options;\nvar _b63=[];\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nvar _b64=_b65(row[opts.groupField]);\nif(!_b64){\n_b64={value:row[opts.groupField],rows:[row]};\n_b63.push(_b64);\n}else{\n_b64.rows.push(row);\n}\n}\nvar _b66=0;\nvar rows=[];\nfor(var i=0;i<_b63.length;i++){\nvar _b64=_b63[i];\n_b64.startIndex=_b66;\n_b66+=_b64.rows.length;\nrows=rows.concat(_b64.rows);\n}\nreturn {groups:_b63,rows:rows};\nfunction _b65(_b67){\nfor(var i=0;i<_b63.length;i++){\nvar _b68=_b63[i];\nif(_b68.value==_b67){\nreturn _b68;\n}\n}\nreturn null;\n};\n}});\n$.fn.datalist=function(_b69,_b6a){\nif(typeof _b69=="string"){\nvar _b6b=$.fn.datalist.methods[_b69];\nif(_b6b){\nreturn _b6b(this,_b6a);\n}else{\nreturn this.datagrid(_b69,_b6a);\n}\n}\n_b69=_b69||{};\nreturn this.each(function(){\nvar _b6c=$.data(this,"datalist");\nif(_b6c){\n$.extend(_b6c.options,_b69);\n}else{\nvar opts=$.extend({},$.fn.datalist.defaults,$.fn.datalist.parseOptions(this),_b69);\nopts.columns=$.extend(true,[],opts.columns);\n_b6c=$.data(this,"datalist",{options:opts});\n}\n_b50(this);\nif(!_b6c.options.data){\nvar data=$.fn.datalist.parseData(this);\nif(data.total){\n$(this).datalist("loadData",data);\n}\n}\n});\n};\n$.fn.datalist.methods={options:function(jq){\nreturn $.data(jq[0],"datalist").options;\n}};\n$.fn.datalist.parseOptions=function(_b6d){\nreturn $.extend({},$.fn.datagrid.parseOptions(_b6d),$.parser.parseOptions(_b6d,["valueField","textField","groupField",{checkbox:"boolean",lines:"boolean"}]));\n};\n$.fn.datalist.parseData=function(_b6e){\nvar opts=$.data(_b6e,"datalist").options;\nvar data={total:0,rows:[]};\n$(_b6e).children().each(function(){\nvar _b6f=$.parser.parseOptions(this,["value","group"]);\nvar row={};\nvar html=$(this).html();\nrow[opts.valueField]=_b6f.value!=undefined?_b6f.value:html;\nrow[opts.textField]=html;\nif(opts.groupField){\nrow[opts.groupField]=_b6f.group;\n}\ndata.total++;\ndata.rows.push(row);\n});\nreturn data;\n};\n$.fn.datalist.defaults=$.extend({},$.fn.datagrid.defaults,{fitColumns:true,singleSelect:true,showHeader:false,checkbox:false,lines:false,valueField:"value",textField:"text",groupField:"",view:_b54,textFormatter:function(_b70,row){\nreturn _b70;\n},groupFormatter:function(_b71,rows){\nreturn _b71;\n}});\n})(jQuery);\n(function($){\n$(function(){\n$(document)._unbind(".combo")._bind("mousedown.combo mousewheel.combo",function(e){\nvar p=$(e.target).closest("span.combo,div.combo-p,div.menu");\nif(p.length){\n_b72(p);\nreturn;\n}\n$("body>div.combo-p>div.combo-panel:visible").panel("close");\n});\n});\nfunction _b73(_b74){\nvar _b75=$.data(_b74,"combo");\nvar opts=_b75.options;\nif(!_b75.panel){\n_b75.panel=$("<div class=\\"combo-panel\\"></div>").appendTo("html>body");\n_b75.panel.panel({minWidth:opts.panelMinWidth,maxWidth:opts.panelMaxWidth,minHeight:opts.panelMinHeight,maxHeight:opts.panelMaxHeight,doSize:false,closed:true,cls:"combo-p",style:{position:"absolute",zIndex:10},onOpen:function(){\nvar _b76=$(this).panel("options").comboTarget;\nvar _b77=$.data(_b76,"combo");\nif(_b77){\n_b77.options.onShowPanel.call(_b76);\n}\n},onBeforeClose:function(){\n_b72($(this).parent());\n},onClose:function(){\nvar _b78=$(this).panel("options").comboTarget;\nvar _b79=$(_b78).data("combo");\nif(_b79){\n_b79.options.onHidePanel.call(_b78);\n}\n}});\n}\nvar _b7a=$.extend(true,[],opts.icons);\nif(opts.hasDownArrow){\n_b7a.push({iconCls:"combo-arrow",handler:function(e){\n_b7f(e.data.target);\n}});\n}\n$(_b74).addClass("combo-f").textbox($.extend({},opts,{icons:_b7a,onChange:function(){\n}}));\n$(_b74).attr("comboName",$(_b74).attr("textboxName"));\n_b75.combo=$(_b74).next();\n_b75.combo.addClass("combo");\n_b75.panel._unbind(".combo");\nfor(var _b7b in opts.panelEvents){\n_b75.panel._bind(_b7b+".combo",{target:_b74},opts.panelEvents[_b7b]);\n}\n};\nfunction _b7c(_b7d){\nvar _b7e=$.data(_b7d,"combo");\nvar opts=_b7e.options;\nvar p=_b7e.panel;\nif(p.is(":visible")){\np.panel("close");\n}\nif(!opts.cloned){\np.panel("destroy");\n}\n$(_b7d).textbox("destroy");\n};\nfunction _b7f(_b80){\nvar _b81=$.data(_b80,"combo").panel;\nif(_b81.is(":visible")){\nvar _b82=_b81.combo("combo");\n_b83(_b82);\nif(_b82!=_b80){\n$(_b80).combo("showPanel");\n}\n}else{\nvar p=$(_b80).closest("div.combo-p").children(".combo-panel");\n$("div.combo-panel:visible").not(_b81).not(p).panel("close");\n$(_b80).combo("showPanel");\n}\n$(_b80).combo("textbox").focus();\n};\nfunction _b72(_b84){\n$(_b84).find(".combo-f").each(function(){\nvar p=$(this).combo("panel");\nif(p.is(":visible")){\np.panel("close");\n}\n});\n};\nfunction _b85(e){\nvar _b86=e.data.target;\nvar _b87=$.data(_b86,"combo");\nvar opts=_b87.options;\nif(!opts.editable){\n_b7f(_b86);\n}else{\nvar p=$(_b86).closest("div.combo-p").children(".combo-panel");\n$("div.combo-panel:visible").not(p).each(function(){\nvar _b88=$(this).combo("combo");\nif(_b88!=_b86){\n_b83(_b88);\n}\n});\n}\n};\nfunction _b89(e){\nvar _b8a=e.data.target;\nvar t=$(_b8a);\nvar _b8b=t.data("combo");\nvar opts=t.combo("options");\n_b8b.panel.panel("options").comboTarget=_b8a;\nswitch(e.keyCode){\ncase 38:\nopts.keyHandler.up.call(_b8a,e);\nbreak;\ncase 40:\nopts.keyHandler.down.call(_b8a,e);\nbreak;\ncase 37:\nopts.keyHandler.left.call(_b8a,e);\nbreak;\ncase 39:\nopts.keyHandler.right.call(_b8a,e);\nbreak;\ncase 13:\ne.preventDefault();\nopts.keyHandler.enter.call(_b8a,e);\nreturn false;\ncase 9:\ncase 27:\n_b83(_b8a);\nbreak;\ndefault:\nif(opts.editable){\nif(_b8b.timer){\nclearTimeout(_b8b.timer);\n}\n_b8b.timer=setTimeout(function(){\nvar q=t.combo("getText");\nif(_b8b.previousText!=q){\n_b8b.previousText=q;\nt.combo("showPanel");\nopts.keyHandler.query.call(_b8a,q,e);\nt.combo("validate");\n}\n},opts.delay);\n}\n}\n};\nfunction _b8c(e){\nvar _b8d=e.data.target;\nvar _b8e=$(_b8d).data("combo");\nif(_b8e.timer){\nclearTimeout(_b8e.timer);\n}\n};\nfunction _b8f(_b90){\nvar _b91=$.data(_b90,"combo");\nvar _b92=_b91.combo;\nvar _b93=_b91.panel;\nvar opts=$(_b90).combo("options");\nvar _b94=_b93.panel("options");\n_b94.comboTarget=_b90;\nif(_b94.closed){\n_b93.panel("panel").show().css({zIndex:($.fn.menu?$.fn.menu.defaults.zIndex++:($.fn.window?$.fn.window.defaults.zIndex++:99)),left:-999999});\n_b93.panel("resize",{width:(opts.panelWidth?opts.panelWidth:_b92._outerWidth()),height:opts.panelHeight});\n_b93.panel("panel").hide();\n_b93.panel("open");\n}\n(function f(){\nif(_b94.comboTarget==_b90&&_b93.is(":visible")){\n_b93.panel("move",{left:_b95(),top:_b96()});\nsetTimeout(f,200);\n}\n})();\nfunction _b95(){\nvar left=_b92.offset().left;\nif(opts.panelAlign=="right"){\nleft+=_b92._outerWidth()-_b93._outerWidth();\n}\nif(left+_b93._outerWidth()>$(window)._outerWidth()+$(document).scrollLeft()){\nleft=$(window)._outerWidth()+$(document).scrollLeft()-_b93._outerWidth();\n}\nif(left<0){\nleft=0;\n}\nreturn left;\n};\nfunction _b96(){\nif(opts.panelValign=="top"){\nvar top=_b92.offset().top-_b93._outerHeight();\n}else{\nif(opts.panelValign=="bottom"){\nvar top=_b92.offset().top+_b92._outerHeight();\n}else{\nvar top=_b92.offset().top+_b92._outerHeight();\nif(top+_b93._outerHeight()>$(window)._outerHeight()+$(document).scrollTop()){\ntop=_b92.offset().top-_b93._outerHeight();\n}\nif(top<$(document).scrollTop()){\ntop=_b92.offset().top+_b92._outerHeight();\n}\n}\n}\nreturn top;\n};\n};\nfunction _b83(_b97){\nvar _b98=$.data(_b97,"combo").panel;\n_b98.panel("close");\n};\nfunction _b99(_b9a,text){\nvar _b9b=$.data(_b9a,"combo");\nvar _b9c=$(_b9a).textbox("getText");\nif(_b9c!=text){\n$(_b9a).textbox("setText",text);\n}\n_b9b.previousText=text;\n};\nfunction _b9d(_b9e){\nvar _b9f=$.data(_b9e,"combo");\nvar opts=_b9f.options;\nvar _ba0=$(_b9e).next();\nvar _ba1=[];\n_ba0.find(".textbox-value").each(function(){\n_ba1.push($(this).val());\n});\nif(opts.multivalue){\nreturn _ba1;\n}else{\nreturn _ba1.length?_ba1[0].split(opts.separator):_ba1;\n}\n};\nfunction _ba2(_ba3,_ba4){\nvar _ba5=$.data(_ba3,"combo");\nvar _ba6=_ba5.combo;\nvar opts=$(_ba3).combo("options");\nif(!$.isArray(_ba4)){\n_ba4=_ba4.split(opts.separator);\n}\nvar _ba7=_b9d(_ba3);\n_ba6.find(".textbox-value").remove();\nif(_ba4.length){\nif(opts.multivalue){\nfor(var i=0;i<_ba4.length;i++){\n_ba8(_ba4[i]);\n}\n}else{\n_ba8(_ba4.join(opts.separator));\n}\n}\nfunction _ba8(_ba9){\nvar name=$(_ba3).attr("textboxName")||"";\nvar _baa=$("<input type=\\"hidden\\" class=\\"textbox-value\\">").appendTo(_ba6);\n_baa.attr("name",name);\nif(opts.disabled){\n_baa.attr("disabled","disabled");\n}\n_baa.val(_ba9);\n};\nvar _bab=(function(){\nif(opts.onChange==$.parser.emptyFn){\nreturn false;\n}\nif(_ba7.length!=_ba4.length){\nreturn true;\n}\nfor(var i=0;i<_ba4.length;i++){\nif(_ba4[i]!=_ba7[i]){\nreturn true;\n}\n}\nreturn false;\n})();\nif(_bab){\n$(_ba3).val(_ba4.join(opts.separator));\nif(opts.multiple){\nopts.onChange.call(_ba3,_ba4,_ba7);\n}else{\nopts.onChange.call(_ba3,_ba4[0],_ba7[0]);\n}\n$(_ba3).closest("form").trigger("_change",[_ba3]);\n}\n};\nfunction _bac(_bad){\nvar _bae=_b9d(_bad);\nreturn _bae[0];\n};\nfunction _baf(_bb0,_bb1){\n_ba2(_bb0,[_bb1]);\n};\nfunction _bb2(_bb3){\nvar opts=$.data(_bb3,"combo").options;\nvar _bb4=opts.onChange;\nopts.onChange=$.parser.emptyFn;\nif(opts.multiple){\n_ba2(_bb3,opts.value?opts.value:[]);\n}else{\n_baf(_bb3,opts.value);\n}\nopts.onChange=_bb4;\n};\n$.fn.combo=function(_bb5,_bb6){\nif(typeof _bb5=="string"){\nvar _bb7=$.fn.combo.methods[_bb5];\nif(_bb7){\nreturn _bb7(this,_bb6);\n}else{\nreturn this.textbox(_bb5,_bb6);\n}\n}\n_bb5=_bb5||{};\nreturn this.each(function(){\nvar _bb8=$.data(this,"combo");\nif(_bb8){\n$.extend(_bb8.options,_bb5);\nif(_bb5.value!=undefined){\n_bb8.options.originalValue=_bb5.value;\n}\n}else{\n_bb8=$.data(this,"combo",{options:$.extend({},$.fn.combo.defaults,$.fn.combo.parseOptions(this),_bb5),previousText:""});\nif(_bb8.options.multiple&&_bb8.options.value==""){\n_bb8.options.originalValue=[];\n}else{\n_bb8.options.originalValue=_bb8.options.value;\n}\n}\n_b73(this);\n_bb2(this);\n});\n};\n$.fn.combo.methods={options:function(jq){\nvar opts=jq.textbox("options");\nreturn $.extend($.data(jq[0],"combo").options,{width:opts.width,height:opts.height,disabled:opts.disabled,readonly:opts.readonly,editable:opts.editable});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).textbox("cloneFrom",from);\n$.data(this,"combo",{options:$.extend(true,{cloned:true},$(from).combo("options")),combo:$(this).next(),panel:$(from).combo("panel")});\n$(this).addClass("combo-f").attr("comboName",$(this).attr("textboxName"));\n});\n},combo:function(jq){\nreturn jq.closest(".combo-panel").panel("options").comboTarget;\n},panel:function(jq){\nreturn $.data(jq[0],"combo").panel;\n},destroy:function(jq){\nreturn jq.each(function(){\n_b7c(this);\n});\n},showPanel:function(jq){\nreturn jq.each(function(){\n_b8f(this);\n});\n},hidePanel:function(jq){\nreturn jq.each(function(){\n_b83(this);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).textbox("setText","");\nvar opts=$.data(this,"combo").options;\nif(opts.multiple){\n$(this).combo("setValues",[]);\n}else{\n$(this).combo("setValue","");\n}\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$.data(this,"combo").options;\nif(opts.multiple){\n$(this).combo("setValues",opts.originalValue);\n}else{\n$(this).combo("setValue",opts.originalValue);\n}\n});\n},setText:function(jq,text){\nreturn jq.each(function(){\n_b99(this,text);\n});\n},getValues:function(jq){\nreturn _b9d(jq[0]);\n},setValues:function(jq,_bb9){\nreturn jq.each(function(){\n_ba2(this,_bb9);\n});\n},getValue:function(jq){\nreturn _bac(jq[0]);\n},setValue:function(jq,_bba){\nreturn jq.each(function(){\n_baf(this,_bba);\n});\n}};\n$.fn.combo.parseOptions=function(_bbb){\nvar t=$(_bbb);\nreturn $.extend({},$.fn.textbox.parseOptions(_bbb),$.parser.parseOptions(_bbb,["separator","panelAlign",{panelWidth:"number",hasDownArrow:"boolean",delay:"number",reversed:"boolean",multivalue:"boolean",selectOnNavigation:"boolean"},{panelMinWidth:"number",panelMaxWidth:"number",panelMinHeight:"number",panelMaxHeight:"number"}]),{panelHeight:(t.attr("panelHeight")=="auto"?"auto":parseInt(t.attr("panelHeight"))||undefined),multiple:(t.attr("multiple")?true:undefined)});\n};\n$.fn.combo.defaults=$.extend({},$.fn.textbox.defaults,{inputEvents:{click:_b85,keydown:_b89,paste:_b89,drop:_b89,blur:_b8c},panelEvents:{mousedown:function(e){\ne.preventDefault();\ne.stopPropagation();\n}},panelWidth:null,panelHeight:300,panelMinWidth:null,panelMaxWidth:null,panelMinHeight:null,panelMaxHeight:null,panelAlign:"left",panelValign:"auto",reversed:false,multiple:false,multivalue:true,selectOnNavigation:true,separator:",",hasDownArrow:true,delay:200,keyHandler:{up:function(e){\n},down:function(e){\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n},query:function(q,e){\n}},onShowPanel:function(){\n},onHidePanel:function(){\n},onChange:function(_bbc,_bbd){\n}});\n})(jQuery);\n(function($){\nfunction _bbe(_bbf,_bc0){\nvar _bc1=$.data(_bbf,"combobox");\nreturn $.easyui.indexOfArray(_bc1.data,_bc1.options.valueField,_bc0);\n};\nfunction _bc2(_bc3,_bc4){\nvar opts=$.data(_bc3,"combobox").options;\nvar _bc5=$(_bc3).combo("panel");\nvar item=opts.finder.getEl(_bc3,_bc4);\nif(item.length){\nif(item.position().top<=0){\nvar h=_bc5.scrollTop()+item.position().top;\n_bc5.scrollTop(h);\n}else{\nif(item.position().top+item.outerHeight()>_bc5.height()){\nvar h=_bc5.scrollTop()+item.position().top+item.outerHeight()-_bc5.height();\n_bc5.scrollTop(h);\n}\n}\n}\n_bc5.triggerHandler("scroll");\n};\nfunction nav(_bc6,dir){\nvar opts=$.data(_bc6,"combobox").options;\nvar _bc7=$(_bc6).combobox("panel");\nvar item=_bc7.children("div.combobox-item-hover");\nif(!item.length){\nitem=_bc7.children("div.combobox-item-selected");\n}\nitem.removeClass("combobox-item-hover");\nvar _bc8="div.combobox-item:visible:not(.combobox-item-disabled):first";\nvar _bc9="div.combobox-item:visible:not(.combobox-item-disabled):last";\nif(!item.length){\nitem=_bc7.children(dir=="next"?_bc8:_bc9);\n}else{\nif(dir=="next"){\nitem=item.nextAll(_bc8);\nif(!item.length){\nitem=_bc7.children(_bc8);\n}\n}else{\nitem=item.prevAll(_bc8);\nif(!item.length){\nitem=_bc7.children(_bc9);\n}\n}\n}\nif(item.length){\nitem.addClass("combobox-item-hover");\nvar row=opts.finder.getRow(_bc6,item);\nif(row){\n$(_bc6).combobox("scrollTo",row[opts.valueField]);\nif(opts.selectOnNavigation){\n_bca(_bc6,row[opts.valueField]);\n}\n}\n}\n};\nfunction _bca(_bcb,_bcc,_bcd){\nvar opts=$.data(_bcb,"combobox").options;\nvar _bce=$(_bcb).combo("getValues");\nif($.inArray(_bcc+"",_bce)==-1){\nif(opts.multiple){\n_bce.push(_bcc);\n}else{\n_bce=[_bcc];\n}\n_bcf(_bcb,_bce,_bcd);\n}\n};\nfunction _bd0(_bd1,_bd2){\nvar opts=$.data(_bd1,"combobox").options;\nvar _bd3=$(_bd1).combo("getValues");\nvar _bd4=$.inArray(_bd2+"",_bd3);\nif(_bd4>=0){\n_bd3.splice(_bd4,1);\n_bcf(_bd1,_bd3);\n}\n};\nfunction _bcf(_bd5,_bd6,_bd7){\nvar opts=$.data(_bd5,"combobox").options;\nvar _bd8=$(_bd5).combo("panel");\nif(!$.isArray(_bd6)){\n_bd6=_bd6.split(opts.separator);\n}\nif(!opts.multiple){\n_bd6=_bd6.length?[_bd6[0]]:[""];\n}\nvar _bd9=$(_bd5).combo("getValues");\nif(_bd8.is(":visible")){\n_bd8.find(".combobox-item-selected").each(function(){\nvar row=opts.finder.getRow(_bd5,$(this));\nif(row){\nif($.easyui.indexOfArray(_bd9,row[opts.valueField])==-1){\n$(this).removeClass("combobox-item-selected");\n}\n}\n});\n}\n$.map(_bd9,function(v){\nif($.easyui.indexOfArray(_bd6,v)==-1){\nvar el=opts.finder.getEl(_bd5,v);\nif(el.hasClass("combobox-item-selected")){\nel.removeClass("combobox-item-selected");\nopts.onUnselect.call(_bd5,opts.finder.getRow(_bd5,v));\n}\n}\n});\nvar _bda=null;\nvar vv=[],ss=[];\nfor(var i=0;i<_bd6.length;i++){\nvar v=_bd6[i];\nvar s=v;\nvar row=opts.finder.getRow(_bd5,v);\nif(row){\ns=row[opts.textField];\n_bda=row;\nvar el=opts.finder.getEl(_bd5,v);\nif(!el.hasClass("combobox-item-selected")){\nel.addClass("combobox-item-selected");\nopts.onSelect.call(_bd5,row);\n}\n}else{\ns=_bdb(v,opts.mappingRows)||v;\n}\nvv.push(v);\nss.push(s);\n}\nif(!_bd7){\n$(_bd5).combo("setText",ss.join(opts.separator));\n}\nif(opts.showItemIcon){\nvar tb=$(_bd5).combobox("textbox");\ntb.removeClass("textbox-bgicon "+opts.textboxIconCls);\nif(_bda&&_bda.iconCls){\ntb.addClass("textbox-bgicon "+_bda.iconCls);\nopts.textboxIconCls=_bda.iconCls;\n}\n}\n$(_bd5).combo("setValues",vv);\n_bd8.triggerHandler("scroll");\nfunction _bdb(_bdc,a){\nvar item=$.easyui.getArrayItem(a,opts.valueField,_bdc);\nreturn item?item[opts.textField]:undefined;\n};\n};\nfunction _bdd(_bde,data,_bdf){\nvar _be0=$.data(_bde,"combobox");\nvar opts=_be0.options;\n_be0.data=opts.loadFilter.call(_bde,data);\nopts.view.render.call(opts.view,_bde,$(_bde).combo("panel"),_be0.data);\nvar vv=$(_bde).combobox("getValues");\n$.easyui.forEach(_be0.data,false,function(row){\nif(row["selected"]){\n$.easyui.addArrayItem(vv,row[opts.valueField]+"");\n}\n});\nif(opts.multiple){\n_bcf(_bde,vv,_bdf);\n}else{\n_bcf(_bde,vv.length?[vv[vv.length-1]]:[],_bdf);\n}\nopts.onLoadSuccess.call(_bde,data);\n};\nfunction _be1(_be2,url,_be3,_be4){\nvar opts=$.data(_be2,"combobox").options;\nif(url){\nopts.url=url;\n}\n_be3=$.extend({},opts.queryParams,_be3||{});\nif(opts.onBeforeLoad.call(_be2,_be3)==false){\nreturn;\n}\nopts.loader.call(_be2,_be3,function(data){\n_bdd(_be2,data,_be4);\n},function(){\nopts.onLoadError.apply(this,arguments);\n});\n};\nfunction _be5(_be6,q){\nvar _be7=$.data(_be6,"combobox");\nvar opts=_be7.options;\nvar _be8=$();\nvar qq=opts.multiple?q.split(opts.separator):[q];\nif(opts.mode=="remote"){\n_be9(qq);\n_be1(_be6,null,{q:q},true);\n}else{\nvar _bea=$(_be6).combo("panel");\n_bea.find(".combobox-item-hover").removeClass("combobox-item-hover");\n_bea.find(".combobox-item,.combobox-group").hide();\nvar data=_be7.data;\nvar vv=[];\n$.map(qq,function(q){\nq=$.trim(q);\nvar _beb=q;\nvar _bec=undefined;\n_be8=$();\nfor(var i=0;i<data.length;i++){\nvar row=data[i];\nif(opts.filter.call(_be6,q,row)){\nvar v=row[opts.valueField];\nvar s=row[opts.textField];\nvar g=row[opts.groupField];\nvar item=opts.finder.getEl(_be6,v).show();\nif(s.toLowerCase()==q.toLowerCase()){\n_beb=v;\nif(opts.reversed){\n_be8=item;\n}else{\n_bca(_be6,v,true);\n}\n}\nif(opts.groupField&&_bec!=g){\nopts.finder.getGroupEl(_be6,g).show();\n_bec=g;\n}\n}\n}\nvv.push(_beb);\n});\n_be9(vv);\n}\nfunction _be9(vv){\nif(opts.reversed){\n_be8.addClass("combobox-item-hover");\n}else{\n_bcf(_be6,opts.multiple?(q?vv:[]):vv,true);\n}\n};\n};\nfunction _bed(_bee){\nvar t=$(_bee);\nvar opts=t.combobox("options");\nvar _bef=t.combobox("panel");\nvar item=_bef.children("div.combobox-item-hover");\nif(item.length){\nitem.removeClass("combobox-item-hover");\nvar row=opts.finder.getRow(_bee,item);\nvar _bf0=row[opts.valueField];\nif(opts.multiple){\nif(item.hasClass("combobox-item-selected")){\nt.combobox("unselect",_bf0);\n}else{\nt.combobox("select",_bf0);\n}\n}else{\nt.combobox("select",_bf0);\n}\n}\nvar vv=[];\n$.map(t.combobox("getValues"),function(v){\nif(_bbe(_bee,v)>=0){\nvv.push(v);\n}\n});\nt.combobox("setValues",vv);\nif(!opts.multiple){\nt.combobox("hidePanel");\n}\n};\nfunction _bf1(_bf2){\nvar _bf3=$.data(_bf2,"combobox");\nvar opts=_bf3.options;\n$(_bf2).addClass("combobox-f");\n$(_bf2).combo($.extend({},opts,{onShowPanel:function(){\n$(this).combo("panel").find("div.combobox-item:hidden,div.combobox-group:hidden").show();\n_bcf(this,$(this).combobox("getValues"),true);\n$(this).combobox("scrollTo",$(this).combobox("getValue"));\nopts.onShowPanel.call(this);\n}}));\n};\nfunction _bf4(e){\n$(this).children("div.combobox-item-hover").removeClass("combobox-item-hover");\nvar item=$(e.target).closest("div.combobox-item");\nif(!item.hasClass("combobox-item-disabled")){\nitem.addClass("combobox-item-hover");\n}\ne.stopPropagation();\n};\nfunction _bf5(e){\n$(e.target).closest("div.combobox-item").removeClass("combobox-item-hover");\ne.stopPropagation();\n};\nfunction _bf6(e){\nvar _bf7=$(this).panel("options").comboTarget;\nif(!_bf7){\nreturn;\n}\nvar opts=$(_bf7).combobox("options");\nvar item=$(e.target).closest("div.combobox-item");\nif(!item.length||item.hasClass("combobox-item-disabled")){\nreturn;\n}\nvar row=opts.finder.getRow(_bf7,item);\nif(!row){\nreturn;\n}\nif(opts.blurTimer){\nclearTimeout(opts.blurTimer);\nopts.blurTimer=null;\n}\nopts.onClick.call(_bf7,row);\nvar _bf8=row[opts.valueField];\nif(opts.multiple){\nif(item.hasClass("combobox-item-selected")){\n_bd0(_bf7,_bf8);\n}else{\n_bca(_bf7,_bf8);\n}\n}else{\n$(_bf7).combobox("setValue",_bf8).combobox("hidePanel");\n}\ne.stopPropagation();\n};\nfunction _bf9(e){\nvar _bfa=$(this).panel("options").comboTarget;\nif(!_bfa){\nreturn;\n}\nvar opts=$(_bfa).combobox("options");\nif(opts.groupPosition=="sticky"){\nvar _bfb=$(this).children(".combobox-stick");\nif(!_bfb.length){\n_bfb=$("<div class=\\"combobox-stick\\"></div>").appendTo(this);\n}\n_bfb.hide();\nvar _bfc=$(_bfa).data("combobox");\n$(this).children(".combobox-group:visible").each(function(){\nvar g=$(this);\nvar _bfd=opts.finder.getGroup(_bfa,g);\nvar _bfe=_bfc.data[_bfd.startIndex+_bfd.count-1];\nvar last=opts.finder.getEl(_bfa,_bfe[opts.valueField]);\nif(g.position().top<0&&last.position().top>0){\n_bfb.show().html(g.html());\nreturn false;\n}\n});\n}\n};\n$.fn.combobox=function(_bff,_c00){\nif(typeof _bff=="string"){\nvar _c01=$.fn.combobox.methods[_bff];\nif(_c01){\nreturn _c01(this,_c00);\n}else{\nreturn this.combo(_bff,_c00);\n}\n}\n_bff=_bff||{};\nreturn this.each(function(){\nvar _c02=$.data(this,"combobox");\nif(_c02){\n$.extend(_c02.options,_bff);\n}else{\n_c02=$.data(this,"combobox",{options:$.extend({},$.fn.combobox.defaults,$.fn.combobox.parseOptions(this),_bff),data:[]});\n}\n_bf1(this);\nif(_c02.options.data){\n_bdd(this,_c02.options.data);\n}else{\nvar data=$.fn.combobox.parseData(this);\nif(data.length){\n_bdd(this,data);\n}\n}\n_be1(this);\n});\n};\n$.fn.combobox.methods={options:function(jq){\nvar _c03=jq.combo("options");\nreturn $.extend($.data(jq[0],"combobox").options,{width:_c03.width,height:_c03.height,originalValue:_c03.originalValue,disabled:_c03.disabled,readonly:_c03.readonly,editable:_c03.editable});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).combo("cloneFrom",from);\n$.data(this,"combobox",$(from).data("combobox"));\n$(this).addClass("combobox-f").attr("comboboxName",$(this).attr("textboxName"));\n});\n},getData:function(jq){\nreturn $.data(jq[0],"combobox").data;\n},setValues:function(jq,_c04){\nreturn jq.each(function(){\nvar opts=$(this).combobox("options");\nif($.isArray(_c04)){\n_c04=$.map(_c04,function(_c05){\nif(_c05&&typeof _c05=="object"){\n$.easyui.addArrayItem(opts.mappingRows,opts.valueField,_c05);\nreturn _c05[opts.valueField];\n}else{\nreturn _c05;\n}\n});\n}\n_bcf(this,_c04);\n});\n},setValue:function(jq,_c06){\nreturn jq.each(function(){\n$(this).combobox("setValues",$.isArray(_c06)?_c06:[_c06]);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n_bcf(this,[]);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).combobox("options");\nif(opts.multiple){\n$(this).combobox("setValues",opts.originalValue);\n}else{\n$(this).combobox("setValue",opts.originalValue);\n}\n});\n},loadData:function(jq,data){\nreturn jq.each(function(){\n_bdd(this,data);\n});\n},reload:function(jq,url){\nreturn jq.each(function(){\nif(typeof url=="string"){\n_be1(this,url);\n}else{\nif(url){\nvar opts=$(this).combobox("options");\nopts.queryParams=url;\n}\n_be1(this);\n}\n});\n},select:function(jq,_c07){\nreturn jq.each(function(){\n_bca(this,_c07);\n});\n},unselect:function(jq,_c08){\nreturn jq.each(function(){\n_bd0(this,_c08);\n});\n},scrollTo:function(jq,_c09){\nreturn jq.each(function(){\n_bc2(this,_c09);\n});\n}};\n$.fn.combobox.parseOptions=function(_c0a){\nvar t=$(_c0a);\nreturn $.extend({},$.fn.combo.parseOptions(_c0a),$.parser.parseOptions(_c0a,["valueField","textField","groupField","groupPosition","mode","method","url",{showItemIcon:"boolean",limitToList:"boolean"}]));\n};\n$.fn.combobox.parseData=function(_c0b){\nvar data=[];\nvar opts=$(_c0b).combobox("options");\n$(_c0b).children().each(function(){\nif(this.tagName.toLowerCase()=="optgroup"){\nvar _c0c=$(this).attr("label");\n$(this).children().each(function(){\n_c0d(this,_c0c);\n});\n}else{\n_c0d(this);\n}\n});\nreturn data;\nfunction _c0d(el,_c0e){\nvar t=$(el);\nvar row={};\nrow[opts.valueField]=t.attr("value")!=undefined?t.attr("value"):t.text();\nrow[opts.textField]=t.text();\nrow["iconCls"]=$.parser.parseOptions(el,["iconCls"]).iconCls;\nrow["selected"]=t.is(":selected");\nrow["disabled"]=t.is(":disabled");\nif(_c0e){\nopts.groupField=opts.groupField||"group";\nrow[opts.groupField]=_c0e;\n}\ndata.push(row);\n};\n};\nvar _c0f=0;\nvar _c10={render:function(_c11,_c12,data){\nvar _c13=$.data(_c11,"combobox");\nvar opts=_c13.options;\nvar _c14=$(_c11).attr("id")||"";\n_c0f++;\n_c13.itemIdPrefix=_c14+"_easyui_combobox_i"+_c0f;\n_c13.groupIdPrefix=_c14+"_easyui_combobox_g"+_c0f;\n_c13.groups=[];\nvar dd=[];\nvar _c15=undefined;\nfor(var i=0;i<data.length;i++){\nvar row=data[i];\nvar v=row[opts.valueField]+"";\nvar s=row[opts.textField];\nvar g=row[opts.groupField];\nif(g){\nif(_c15!=g){\n_c15=g;\n_c13.groups.push({value:g,startIndex:i,count:1});\ndd.push("<div id=\\""+(_c13.groupIdPrefix+"_"+(_c13.groups.length-1))+"\\" class=\\"combobox-group\\">");\ndd.push(opts.groupFormatter?opts.groupFormatter.call(_c11,g):g);\ndd.push("</div>");\n}else{\n_c13.groups[_c13.groups.length-1].count++;\n}\n}else{\n_c15=undefined;\n}\nvar cls="combobox-item"+(row.disabled?" combobox-item-disabled":"")+(g?" combobox-gitem":"");\ndd.push("<div id=\\""+(_c13.itemIdPrefix+"_"+i)+"\\" class=\\""+cls+"\\">");\nif(opts.showItemIcon&&row.iconCls){\ndd.push("<span class=\\"combobox-icon "+row.iconCls+"\\"></span>");\n}\ndd.push(opts.formatter?opts.formatter.call(_c11,row):s);\ndd.push("</div>");\n}\n$(_c12).html(dd.join(""));\n}};\n$.fn.combobox.defaults=$.extend({},$.fn.combo.defaults,{valueField:"value",textField:"text",groupPosition:"static",groupField:null,groupFormatter:function(_c16){\nreturn _c16;\n},mode:"local",method:"post",url:null,data:null,queryParams:{},showItemIcon:false,limitToList:false,unselectedValues:[],mappingRows:[],view:_c10,keyHandler:{up:function(e){\nnav(this,"prev");\ne.preventDefault();\n},down:function(e){\nnav(this,"next");\ne.preventDefault();\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_bed(this);\n},query:function(q,e){\n_be5(this,q);\n}},inputEvents:$.extend({},$.fn.combo.defaults.inputEvents,{blur:function(e){\n$.fn.combo.defaults.inputEvents.blur(e);\nvar _c17=e.data.target;\nvar opts=$(_c17).combobox("options");\nif(opts.reversed||opts.limitToList){\nif(opts.blurTimer){\nclearTimeout(opts.blurTimer);\n}\nopts.blurTimer=setTimeout(function(){\nvar _c18=$(_c17).parent().length;\nif(_c18){\nif(opts.reversed){\n$(_c17).combobox("setValues",$(_c17).combobox("getValues"));\n}else{\nif(opts.limitToList){\nvar vv=[];\n$.map($(_c17).combobox("getValues"),function(v){\nvar _c19=$.easyui.indexOfArray($(_c17).combobox("getData"),opts.valueField,v);\nif(_c19>=0){\nvv.push(v);\n}\n});\n$(_c17).combobox("setValues",vv);\n}\n}\nopts.blurTimer=null;\n}\n},50);\n}\n}}),panelEvents:{mouseover:_bf4,mouseout:_bf5,mousedown:function(e){\ne.preventDefault();\ne.stopPropagation();\n},click:_bf6,scroll:_bf9},filter:function(q,row){\nvar opts=$(this).combobox("options");\nreturn row[opts.textField].toLowerCase().indexOf(q.toLowerCase())>=0;\n},formatter:function(row){\nvar opts=$(this).combobox("options");\nreturn row[opts.textField];\n},loader:function(_c1a,_c1b,_c1c){\nvar opts=$(this).combobox("options");\nif(!opts.url){\nreturn false;\n}\n$.ajax({type:opts.method,url:opts.url,data:_c1a,dataType:"json",success:function(data){\n_c1b(data);\n},error:function(){\n_c1c.apply(this,arguments);\n}});\n},loadFilter:function(data){\nreturn data;\n},finder:{getEl:function(_c1d,_c1e){\nvar _c1f=_bbe(_c1d,_c1e);\nvar id=$.data(_c1d,"combobox").itemIdPrefix+"_"+_c1f;\nreturn $("#"+id);\n},getGroupEl:function(_c20,_c21){\nvar _c22=$.data(_c20,"combobox");\nvar _c23=$.easyui.indexOfArray(_c22.groups,"value",_c21);\nvar id=_c22.groupIdPrefix+"_"+_c23;\nreturn $("#"+id);\n},getGroup:function(_c24,p){\nvar _c25=$.data(_c24,"combobox");\nvar _c26=p.attr("id").substr(_c25.groupIdPrefix.length+1);\nreturn _c25.groups[parseInt(_c26)];\n},getRow:function(_c27,p){\nvar _c28=$.data(_c27,"combobox");\nvar _c29=(p instanceof $)?p.attr("id").substr(_c28.itemIdPrefix.length+1):_bbe(_c27,p);\nreturn _c28.data[parseInt(_c29)];\n}},onBeforeLoad:function(_c2a){\n},onLoadSuccess:function(data){\n},onLoadError:function(){\n},onSelect:function(_c2b){\n},onUnselect:function(_c2c){\n},onClick:function(_c2d){\n}});\n})(jQuery);\n(function($){\nfunction _c2e(_c2f){\nvar _c30=$.data(_c2f,"combotree");\nvar opts=_c30.options;\nvar tree=_c30.tree;\n$(_c2f).addClass("combotree-f");\n$(_c2f).combo($.extend({},opts,{onShowPanel:function(){\nif(opts.editable){\ntree.tree("doFilter","");\n}\nopts.onShowPanel.call(this);\n}}));\nvar _c31=$(_c2f).combo("panel");\nif(!tree){\ntree=$("<ul></ul>").appendTo(_c31);\n_c30.tree=tree;\n}\ntree.tree($.extend({},opts,{checkbox:opts.multiple,onLoadSuccess:function(node,data){\nvar _c32=$(_c2f).combotree("getValues");\nif(opts.multiple){\n$.map(tree.tree("getChecked"),function(node){\n$.easyui.addArrayItem(_c32,node.id);\n});\n}\n_c37(_c2f,_c32,_c30.remainText);\nopts.onLoadSuccess.call(this,node,data);\n},onClick:function(node){\nif(opts.multiple){\n$(this).tree(node.checked?"uncheck":"check",node.target);\n}else{\n$(_c2f).combo("hidePanel");\n}\n_c30.remainText=false;\n_c34(_c2f);\nopts.onClick.call(this,node);\n},onCheck:function(node,_c33){\n_c30.remainText=false;\n_c34(_c2f);\nopts.onCheck.call(this,node,_c33);\n}}));\n};\nfunction _c34(_c35){\nvar _c36=$.data(_c35,"combotree");\nvar opts=_c36.options;\nvar tree=_c36.tree;\nvar vv=[];\nif(opts.multiple){\nvv=$.map(tree.tree("getChecked"),function(node){\nreturn node.id;\n});\n}else{\nvar node=tree.tree("getSelected");\nif(node){\nvv.push(node.id);\n}\n}\nvv=vv.concat(opts.unselectedValues);\n_c37(_c35,vv,_c36.remainText);\n};\nfunction _c37(_c38,_c39,_c3a){\nvar _c3b=$.data(_c38,"combotree");\nvar opts=_c3b.options;\nvar tree=_c3b.tree;\nvar _c3c=tree.tree("options");\nvar _c3d=_c3c.onBeforeCheck;\nvar _c3e=_c3c.onCheck;\nvar _c3f=_c3c.onBeforeSelect;\nvar _c40=_c3c.onSelect;\n_c3c.onBeforeCheck=_c3c.onCheck=_c3c.onBeforeSelect=_c3c.onSelect=function(){\n};\nif(!$.isArray(_c39)){\n_c39=_c39.split(opts.separator);\n}\nif(!opts.multiple){\n_c39=_c39.length?[_c39[0]]:[""];\n}\nvar vv=$.map(_c39,function(_c41){\nreturn String(_c41);\n});\ntree.find("div.tree-node-selected").removeClass("tree-node-selected");\n$.map(tree.tree("getChecked"),function(node){\nif($.inArray(String(node.id),vv)==-1){\ntree.tree("uncheck",node.target);\n}\n});\nvar ss=[];\nopts.unselectedValues=[];\n$.map(vv,function(v){\nvar node=tree.tree("find",v);\nif(node){\ntree.tree("check",node.target).tree("select",node.target);\nss.push(_c42(node));\n}else{\nss.push(_c43(v,opts.mappingRows)||v);\nopts.unselectedValues.push(v);\n}\n});\nif(opts.multiple){\n$.map(tree.tree("getChecked"),function(node){\nvar id=String(node.id);\nif($.inArray(id,vv)==-1){\nvv.push(id);\nss.push(_c42(node));\n}\n});\n}\n_c3c.onBeforeCheck=_c3d;\n_c3c.onCheck=_c3e;\n_c3c.onBeforeSelect=_c3f;\n_c3c.onSelect=_c40;\nif(!_c3a){\nvar s=ss.join(opts.separator);\nif($(_c38).combo("getText")!=s){\n$(_c38).combo("setText",s);\n}\n}\n$(_c38).combo("setValues",vv);\nfunction _c43(_c44,a){\nvar item=$.easyui.getArrayItem(a,"id",_c44);\nreturn item?_c42(item):undefined;\n};\nfunction _c42(node){\nreturn node[opts.textField||""]||node.text;\n};\n};\nfunction _c45(_c46,q){\nvar _c47=$.data(_c46,"combotree");\nvar opts=_c47.options;\nvar tree=_c47.tree;\n_c47.remainText=true;\ntree.tree("doFilter",opts.multiple?q.split(opts.separator):q);\n};\nfunction _c48(_c49){\nvar _c4a=$.data(_c49,"combotree");\n_c4a.remainText=false;\n$(_c49).combotree("setValues",$(_c49).combotree("getValues"));\n$(_c49).combotree("hidePanel");\n};\n$.fn.combotree=function(_c4b,_c4c){\nif(typeof _c4b=="string"){\nvar _c4d=$.fn.combotree.methods[_c4b];\nif(_c4d){\nreturn _c4d(this,_c4c);\n}else{\nreturn this.combo(_c4b,_c4c);\n}\n}\n_c4b=_c4b||{};\nreturn this.each(function(){\nvar _c4e=$.data(this,"combotree");\nif(_c4e){\n$.extend(_c4e.options,_c4b);\n}else{\n$.data(this,"combotree",{options:$.extend({},$.fn.combotree.defaults,$.fn.combotree.parseOptions(this),_c4b)});\n}\n_c2e(this);\n});\n};\n$.fn.combotree.methods={options:function(jq){\nvar _c4f=jq.combo("options");\nreturn $.extend($.data(jq[0],"combotree").options,{width:_c4f.width,height:_c4f.height,originalValue:_c4f.originalValue,disabled:_c4f.disabled,readonly:_c4f.readonly,editable:_c4f.editable});\n},clone:function(jq,_c50){\nvar t=jq.combo("clone",_c50);\nt.data("combotree",{options:$.extend(true,{},jq.combotree("options")),tree:jq.combotree("tree")});\nreturn t;\n},tree:function(jq){\nreturn $.data(jq[0],"combotree").tree;\n},loadData:function(jq,data){\nreturn jq.each(function(){\nvar opts=$.data(this,"combotree").options;\nopts.data=data;\nvar tree=$.data(this,"combotree").tree;\ntree.tree("loadData",data);\n});\n},reload:function(jq,url){\nreturn jq.each(function(){\nvar opts=$.data(this,"combotree").options;\nvar tree=$.data(this,"combotree").tree;\nif(url){\nopts.url=url;\n}\ntree.tree({url:opts.url});\n});\n},setValues:function(jq,_c51){\nreturn jq.each(function(){\nvar opts=$(this).combotree("options");\nif($.isArray(_c51)){\n_c51=$.map(_c51,function(_c52){\nif(_c52&&typeof _c52=="object"){\n$.easyui.addArrayItem(opts.mappingRows,"id",_c52);\nreturn _c52.id;\n}else{\nreturn _c52;\n}\n});\n}\n_c37(this,_c51);\n});\n},setValue:function(jq,_c53){\nreturn jq.each(function(){\n$(this).combotree("setValues",$.isArray(_c53)?_c53:[_c53]);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).combotree("setValues",[]);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).combotree("options");\nif(opts.multiple){\n$(this).combotree("setValues",opts.originalValue);\n}else{\n$(this).combotree("setValue",opts.originalValue);\n}\n});\n}};\n$.fn.combotree.parseOptions=function(_c54){\nreturn $.extend({},$.fn.combo.parseOptions(_c54),$.fn.tree.parseOptions(_c54));\n};\n$.fn.combotree.defaults=$.extend({},$.fn.combo.defaults,$.fn.tree.defaults,{editable:false,textField:null,unselectedValues:[],mappingRows:[],keyHandler:{up:function(e){\n},down:function(e){\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_c48(this);\n},query:function(q,e){\n_c45(this,q);\n}}});\n})(jQuery);\n(function($){\nfunction _c55(_c56){\nvar _c57=$.data(_c56,"combogrid");\nvar opts=_c57.options;\nvar grid=_c57.grid;\n$(_c56).addClass("combogrid-f").combo($.extend({},opts,{onShowPanel:function(){\n_c6e(this,$(this).combogrid("getValues"),true);\nvar p=$(this).combogrid("panel");\nvar _c58=p.outerHeight()-p.height();\nvar _c59=p._size("minHeight");\nvar _c5a=p._size("maxHeight");\nvar dg=$(this).combogrid("grid");\ndg.datagrid("resize",{width:"100%",height:(isNaN(parseInt(opts.panelHeight))?"auto":"100%"),minHeight:(_c59?_c59-_c58:""),maxHeight:(_c5a?_c5a-_c58:"")});\nvar row=dg.datagrid("getSelected");\nif(row){\ndg.datagrid("scrollTo",dg.datagrid("getRowIndex",row));\n}\nopts.onShowPanel.call(this);\n}}));\nvar _c5b=$(_c56).combo("panel");\nif(!grid){\ngrid=$("<table></table>").appendTo(_c5b);\n_c57.grid=grid;\n}\ngrid.datagrid($.extend({},opts,{border:false,singleSelect:(!opts.multiple),onLoadSuccess:_c5c,onClickRow:_c5d,onSelect:_c5e("onSelect"),onUnselect:_c5e("onUnselect"),onSelectAll:_c5e("onSelectAll"),onUnselectAll:_c5e("onUnselectAll")}));\nfunction _c5f(dg){\nreturn $(dg).closest(".combo-panel").panel("options").comboTarget||_c56;\n};\nfunction _c5c(data){\nvar _c60=_c5f(this);\nvar _c61=$(_c60).data("combogrid");\nvar opts=_c61.options;\nvar _c62=$(_c60).combo("getValues");\n_c6e(_c60,_c62,_c61.remainText);\nopts.onLoadSuccess.call(this,data);\n};\nfunction _c5d(_c63,row){\nvar _c64=_c5f(this);\nvar _c65=$(_c64).data("combogrid");\nvar opts=_c65.options;\n_c65.remainText=false;\n_c66.call(this);\nif(!opts.multiple){\n$(_c64).combo("hidePanel");\n}\nopts.onClickRow.call(this,_c63,row);\n};\nfunction _c5e(_c67){\nreturn function(_c68,row){\nvar _c69=_c5f(this);\nvar opts=$(_c69).combogrid("options");\nif(_c67=="onUnselectAll"){\nif(opts.multiple){\n_c66.call(this);\n}\n}else{\n_c66.call(this);\n}\nopts[_c67].call(this,_c68,row);\n};\n};\nfunction _c66(){\nvar dg=$(this);\nvar _c6a=_c5f(dg);\nvar _c6b=$(_c6a).data("combogrid");\nvar opts=_c6b.options;\nvar vv=$.map(dg.datagrid("getSelections"),function(row){\nreturn row[opts.idField];\n});\nvv=vv.concat(opts.unselectedValues);\nvar _c6c=dg.data("datagrid").dc.body2;\nvar _c6d=_c6c.scrollTop();\n_c6e(_c6a,vv,_c6b.remainText);\n_c6c.scrollTop(_c6d);\n};\n};\nfunction nav(_c6f,dir){\nvar _c70=$.data(_c6f,"combogrid");\nvar opts=_c70.options;\nvar grid=_c70.grid;\nvar _c71=grid.datagrid("getRows").length;\nif(!_c71){\nreturn;\n}\nvar tr=opts.finder.getTr(grid[0],null,"highlight");\nif(!tr.length){\ntr=opts.finder.getTr(grid[0],null,"selected");\n}\nvar _c72;\nif(!tr.length){\n_c72=(dir=="next"?0:_c71-1);\n}else{\nvar _c72=parseInt(tr.attr("datagrid-row-index"));\n_c72+=(dir=="next"?1:-1);\nif(_c72<0){\n_c72=_c71-1;\n}\nif(_c72>=_c71){\n_c72=0;\n}\n}\ngrid.datagrid("highlightRow",_c72);\nif(opts.selectOnNavigation){\n_c70.remainText=false;\ngrid.datagrid("selectRow",_c72);\n}\n};\nfunction _c6e(_c73,_c74,_c75){\nvar _c76=$.data(_c73,"combogrid");\nvar opts=_c76.options;\nvar grid=_c76.grid;\nvar _c77=$(_c73).combo("getValues");\nvar _c78=$(_c73).combo("options");\nvar _c79=_c78.onChange;\n_c78.onChange=function(){\n};\nvar _c7a=grid.datagrid("options");\nvar _c7b=_c7a.onSelect;\nvar _c7c=_c7a.onUnselect;\nvar _c7d=_c7a.onUnselectAll;\n_c7a.onSelect=_c7a.onUnselect=_c7a.onUnselectAll=function(){\n};\nif(!$.isArray(_c74)){\n_c74=_c74.split(opts.separator);\n}\nif(!opts.multiple){\n_c74=_c74.length?[_c74[0]]:[""];\n}\nvar vv=$.map(_c74,function(_c7e){\nreturn String(_c7e);\n});\nvv=$.grep(vv,function(v,_c7f){\nreturn _c7f===$.inArray(v,vv);\n});\nvar _c80=$.grep(grid.datagrid("getSelections"),function(row,_c81){\nreturn $.inArray(String(row[opts.idField]),vv)>=0;\n});\ngrid.datagrid("clearSelections");\ngrid.data("datagrid").selectedRows=_c80;\nvar ss=[];\nopts.unselectedValues=[];\n$.map(vv,function(v){\nvar _c82=grid.datagrid("getRowIndex",v);\nif(_c82>=0){\ngrid.datagrid("selectRow",_c82);\n}else{\nif($.easyui.indexOfArray(_c80,opts.idField,v)==-1){\nopts.unselectedValues.push(v);\n}\n}\nss.push(_c83(v,grid.datagrid("getRows"))||_c83(v,_c80)||_c83(v,opts.mappingRows)||v);\n});\n$(_c73).combo("setValues",_c77);\n_c78.onChange=_c79;\n_c7a.onSelect=_c7b;\n_c7a.onUnselect=_c7c;\n_c7a.onUnselectAll=_c7d;\nif(!_c75){\nvar s=ss.join(opts.separator);\nif($(_c73).combo("getText")!=s){\n$(_c73).combo("setText",s);\n}\n}\n$(_c73).combo("setValues",_c74);\nfunction _c83(_c84,a){\nvar item=$.easyui.getArrayItem(a,opts.idField,_c84);\nreturn item?item[opts.textField]:undefined;\n};\n};\nfunction _c85(_c86,q){\nvar _c87=$.data(_c86,"combogrid");\nvar opts=_c87.options;\nvar grid=_c87.grid;\n_c87.remainText=true;\nvar qq=opts.multiple?q.split(opts.separator):[q];\nqq=$.grep(qq,function(q){\nreturn $.trim(q)!="";\n});\nif(opts.mode=="remote"){\n_c88(qq);\ngrid.datagrid("load",$.extend({},opts.queryParams,{q:q}));\n}else{\ngrid.datagrid("highlightRow",-1);\nvar rows=grid.datagrid("getRows");\nvar vv=[];\n$.map(qq,function(q){\nq=$.trim(q);\nvar _c89=q;\n_c8a(opts.mappingRows,q);\n_c8a(grid.datagrid("getSelections"),q);\nvar _c8b=_c8a(rows,q);\nif(_c8b>=0){\nif(opts.reversed){\ngrid.datagrid("highlightRow",_c8b);\n}\n}else{\n$.map(rows,function(row,i){\nif(opts.filter.call(_c86,q,row)){\ngrid.datagrid("highlightRow",i);\n}\n});\n}\n});\n_c88(vv);\n}\nfunction _c8a(rows,q){\nfor(var i=0;i<rows.length;i++){\nvar row=rows[i];\nif((row[opts.textField]||"").toLowerCase()==q.toLowerCase()){\nvv.push(row[opts.idField]);\nreturn i;\n}\n}\nreturn -1;\n};\nfunction _c88(vv){\nif(!opts.reversed){\n_c6e(_c86,vv,true);\n}\n};\n};\nfunction _c8c(_c8d){\nvar _c8e=$.data(_c8d,"combogrid");\nvar opts=_c8e.options;\nvar grid=_c8e.grid;\nvar tr=opts.finder.getTr(grid[0],null,"highlight");\n_c8e.remainText=false;\nif(tr.length){\nvar _c8f=parseInt(tr.attr("datagrid-row-index"));\nif(opts.multiple){\nif(tr.hasClass("datagrid-row-selected")){\ngrid.datagrid("unselectRow",_c8f);\n}else{\ngrid.datagrid("selectRow",_c8f);\n}\n}else{\ngrid.datagrid("selectRow",_c8f);\n}\n}\nvar vv=[];\n$.map(grid.datagrid("getSelections"),function(row){\nvv.push(row[opts.idField]);\n});\n$.map(opts.unselectedValues,function(v){\nif($.easyui.indexOfArray(opts.mappingRows,opts.idField,v)>=0){\n$.easyui.addArrayItem(vv,v);\n}\n});\n$(_c8d).combogrid("setValues",vv);\nif(!opts.multiple){\n$(_c8d).combogrid("hidePanel");\n}\n};\n$.fn.combogrid=function(_c90,_c91){\nif(typeof _c90=="string"){\nvar _c92=$.fn.combogrid.methods[_c90];\nif(_c92){\nreturn _c92(this,_c91);\n}else{\nreturn this.combo(_c90,_c91);\n}\n}\n_c90=_c90||{};\nreturn this.each(function(){\nvar _c93=$.data(this,"combogrid");\nif(_c93){\n$.extend(_c93.options,_c90);\n}else{\n_c93=$.data(this,"combogrid",{options:$.extend({},$.fn.combogrid.defaults,$.fn.combogrid.parseOptions(this),_c90)});\n}\n_c55(this);\n});\n};\n$.fn.combogrid.methods={options:function(jq){\nvar _c94=jq.combo("options");\nreturn $.extend($.data(jq[0],"combogrid").options,{width:_c94.width,height:_c94.height,originalValue:_c94.originalValue,disabled:_c94.disabled,readonly:_c94.readonly,editable:_c94.editable});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).combo("cloneFrom",from);\n$.data(this,"combogrid",{options:$.extend(true,{cloned:true},$(from).combogrid("options")),combo:$(this).next(),panel:$(from).combo("panel"),grid:$(from).combogrid("grid")});\n});\n},grid:function(jq){\nreturn $.data(jq[0],"combogrid").grid;\n},setValues:function(jq,_c95){\nreturn jq.each(function(){\nvar opts=$(this).combogrid("options");\nif($.isArray(_c95)){\n_c95=$.map(_c95,function(_c96){\nif(_c96&&typeof _c96=="object"){\n$.easyui.addArrayItem(opts.mappingRows,opts.idField,_c96);\nreturn _c96[opts.idField];\n}else{\nreturn _c96;\n}\n});\n}\n_c6e(this,_c95);\n});\n},setValue:function(jq,_c97){\nreturn jq.each(function(){\n$(this).combogrid("setValues",$.isArray(_c97)?_c97:[_c97]);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).combogrid("setValues",[]);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).combogrid("options");\nif(opts.multiple){\n$(this).combogrid("setValues",opts.originalValue);\n}else{\n$(this).combogrid("setValue",opts.originalValue);\n}\n});\n}};\n$.fn.combogrid.parseOptions=function(_c98){\nvar t=$(_c98);\nreturn $.extend({},$.fn.combo.parseOptions(_c98),$.fn.datagrid.parseOptions(_c98),$.parser.parseOptions(_c98,["idField","textField","mode"]));\n};\n$.fn.combogrid.defaults=$.extend({},$.fn.combo.defaults,$.fn.datagrid.defaults,{loadMsg:null,idField:null,textField:null,unselectedValues:[],mappingRows:[],mode:"local",keyHandler:{up:function(e){\nnav(this,"prev");\ne.preventDefault();\n},down:function(e){\nnav(this,"next");\ne.preventDefault();\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_c8c(this);\n},query:function(q,e){\n_c85(this,q);\n}},inputEvents:$.extend({},$.fn.combo.defaults.inputEvents,{blur:function(e){\n$.fn.combo.defaults.inputEvents.blur(e);\nvar _c99=e.data.target;\nvar opts=$(_c99).combogrid("options");\nif(opts.reversed){\n$(_c99).combogrid("setValues",$(_c99).combogrid("getValues"));\n}\n}}),panelEvents:{mousedown:function(e){\n}},filter:function(q,row){\nvar opts=$(this).combogrid("options");\nreturn (row[opts.textField]||"").toLowerCase().indexOf(q.toLowerCase())>=0;\n}});\n})(jQuery);\n(function($){\nfunction _c9a(_c9b){\nvar _c9c=$.data(_c9b,"combotreegrid");\nvar opts=_c9c.options;\n$(_c9b).addClass("combotreegrid-f").combo($.extend({},opts,{onShowPanel:function(){\nvar p=$(this).combotreegrid("panel");\nvar _c9d=p.outerHeight()-p.height();\nvar _c9e=p._size("minHeight");\nvar _c9f=p._size("maxHeight");\nvar dg=$(this).combotreegrid("grid");\ndg.treegrid("resize",{width:"100%",height:(isNaN(parseInt(opts.panelHeight))?"auto":"100%"),minHeight:(_c9e?_c9e-_c9d:""),maxHeight:(_c9f?_c9f-_c9d:"")});\nvar row=dg.treegrid("getSelected");\nif(row){\ndg.treegrid("scrollTo",row[opts.idField]);\n}\nopts.onShowPanel.call(this);\n}}));\nif(!_c9c.grid){\nvar _ca0=$(_c9b).combo("panel");\n_c9c.grid=$("<table></table>").appendTo(_ca0);\n}\n_c9c.grid.treegrid($.extend({},opts,{border:false,checkbox:opts.multiple,onLoadSuccess:function(row,data){\nvar _ca1=$(_c9b).combotreegrid("getValues");\nif(opts.multiple){\n$.map($(this).treegrid("getCheckedNodes"),function(row){\n$.easyui.addArrayItem(_ca1,row[opts.idField]);\n});\n}\n_ca6(_c9b,_ca1);\nopts.onLoadSuccess.call(this,row,data);\n_c9c.remainText=false;\n},onClickRow:function(row){\nif(opts.multiple){\n$(this).treegrid(row.checked?"uncheckNode":"checkNode",row[opts.idField]);\n$(this).treegrid("unselect",row[opts.idField]);\n}else{\n$(_c9b).combo("hidePanel");\n}\n_ca3(_c9b);\nopts.onClickRow.call(this,row);\n},onCheckNode:function(row,_ca2){\n_ca3(_c9b);\nopts.onCheckNode.call(this,row,_ca2);\n}}));\n};\nfunction _ca3(_ca4){\nvar _ca5=$.data(_ca4,"combotreegrid");\nvar opts=_ca5.options;\nvar grid=_ca5.grid;\nvar vv=[];\nif(opts.multiple){\nvv=$.map(grid.treegrid("getCheckedNodes"),function(row){\nreturn row[opts.idField];\n});\n}else{\nvar row=grid.treegrid("getSelected");\nif(row){\nvv.push(row[opts.idField]);\n}\n}\nvv=vv.concat(opts.unselectedValues);\n_ca6(_ca4,vv);\n};\nfunction _ca6(_ca7,_ca8){\nvar _ca9=$.data(_ca7,"combotreegrid");\nvar opts=_ca9.options;\nvar grid=_ca9.grid;\nvar _caa=grid.datagrid("options");\nvar _cab=_caa.onBeforeCheck;\nvar _cac=_caa.onCheck;\nvar _cad=_caa.onBeforeSelect;\nvar _cae=_caa.onSelect;\n_caa.onBeforeCheck=_caa.onCheck=_caa.onBeforeSelect=_caa.onSelect=function(){\n};\nif(!$.isArray(_ca8)){\n_ca8=_ca8.split(opts.separator);\n}\nif(!opts.multiple){\n_ca8=_ca8.length?[_ca8[0]]:[""];\n}\nvar vv=$.map(_ca8,function(_caf){\nreturn String(_caf);\n});\nvv=$.grep(vv,function(v,_cb0){\nreturn _cb0===$.inArray(v,vv);\n});\nvar _cb1=grid.treegrid("getSelected");\nif(_cb1){\ngrid.treegrid("unselect",_cb1[opts.idField]);\n}\n$.map(grid.treegrid("getCheckedNodes"),function(row){\nif($.inArray(String(row[opts.idField]),vv)==-1){\ngrid.treegrid("uncheckNode",row[opts.idField]);\n}\n});\nvar ss=[];\nopts.unselectedValues=[];\n$.map(vv,function(v){\nvar row=grid.treegrid("find",v);\nif(row){\nif(opts.multiple){\ngrid.treegrid("checkNode",v);\n}else{\ngrid.treegrid("select",v);\n}\nss.push(_cb2(row));\n}else{\nss.push(_cb3(v,opts.mappingRows)||v);\nopts.unselectedValues.push(v);\n}\n});\nif(opts.multiple){\n$.map(grid.treegrid("getCheckedNodes"),function(row){\nvar id=String(row[opts.idField]);\nif($.inArray(id,vv)==-1){\nvv.push(id);\nss.push(_cb2(row));\n}\n});\n}\n_caa.onBeforeCheck=_cab;\n_caa.onCheck=_cac;\n_caa.onBeforeSelect=_cad;\n_caa.onSelect=_cae;\nif(!_ca9.remainText){\nvar s=ss.join(opts.separator);\nif($(_ca7).combo("getText")!=s){\n$(_ca7).combo("setText",s);\n}\n}\n$(_ca7).combo("setValues",vv);\nfunction _cb3(_cb4,a){\nvar item=$.easyui.getArrayItem(a,opts.idField,_cb4);\nreturn item?_cb2(item):undefined;\n};\nfunction _cb2(row){\nreturn row[opts.textField||""]||row[opts.treeField];\n};\n};\nfunction _cb5(_cb6,q){\nvar _cb7=$.data(_cb6,"combotreegrid");\nvar opts=_cb7.options;\nvar grid=_cb7.grid;\n_cb7.remainText=true;\nvar qq=opts.multiple?q.split(opts.separator):[q];\nqq=$.grep(qq,function(q){\nreturn $.trim(q)!="";\n});\ngrid.treegrid("clearSelections").treegrid("clearChecked").treegrid("highlightRow",-1);\nif(opts.mode=="remote"){\n_cb8(qq);\ngrid.treegrid("load",$.extend({},opts.queryParams,{q:q}));\n}else{\nif(q){\nvar data=grid.treegrid("getData");\nvar vv=[];\n$.map(qq,function(q){\nq=$.trim(q);\nif(q){\nvar v=undefined;\n$.easyui.forEach(data,true,function(row){\nif(q.toLowerCase()==String(row[opts.treeField]).toLowerCase()){\nv=row[opts.idField];\nreturn false;\n}else{\nif(opts.filter.call(_cb6,q,row)){\ngrid.treegrid("expandTo",row[opts.idField]);\ngrid.treegrid("highlightRow",row[opts.idField]);\nreturn false;\n}\n}\n});\nif(v==undefined){\n$.easyui.forEach(opts.mappingRows,false,function(row){\nif(q.toLowerCase()==String(row[opts.treeField])){\nv=row[opts.idField];\nreturn false;\n}\n});\n}\nif(v!=undefined){\nvv.push(v);\n}else{\nvv.push(q);\n}\n}\n});\n_cb8(vv);\n_cb7.remainText=false;\n}\n}\nfunction _cb8(vv){\nif(!opts.reversed){\n$(_cb6).combotreegrid("setValues",vv);\n}\n};\n};\nfunction _cb9(_cba){\nvar _cbb=$.data(_cba,"combotreegrid");\nvar opts=_cbb.options;\nvar grid=_cbb.grid;\nvar tr=opts.finder.getTr(grid[0],null,"highlight");\n_cbb.remainText=false;\nif(tr.length){\nvar id=tr.attr("node-id");\nif(opts.multiple){\nif(tr.hasClass("datagrid-row-selected")){\ngrid.treegrid("uncheckNode",id);\n}else{\ngrid.treegrid("checkNode",id);\n}\n}else{\ngrid.treegrid("selectRow",id);\n}\n}\nvar vv=[];\nif(opts.multiple){\n$.map(grid.treegrid("getCheckedNodes"),function(row){\nvv.push(row[opts.idField]);\n});\n}else{\nvar row=grid.treegrid("getSelected");\nif(row){\nvv.push(row[opts.idField]);\n}\n}\n$.map(opts.unselectedValues,function(v){\nif($.easyui.indexOfArray(opts.mappingRows,opts.idField,v)>=0){\n$.easyui.addArrayItem(vv,v);\n}\n});\n$(_cba).combotreegrid("setValues",vv);\nif(!opts.multiple){\n$(_cba).combotreegrid("hidePanel");\n}\n};\n$.fn.combotreegrid=function(_cbc,_cbd){\nif(typeof _cbc=="string"){\nvar _cbe=$.fn.combotreegrid.methods[_cbc];\nif(_cbe){\nreturn _cbe(this,_cbd);\n}else{\nreturn this.combo(_cbc,_cbd);\n}\n}\n_cbc=_cbc||{};\nreturn this.each(function(){\nvar _cbf=$.data(this,"combotreegrid");\nif(_cbf){\n$.extend(_cbf.options,_cbc);\n}else{\n_cbf=$.data(this,"combotreegrid",{options:$.extend({},$.fn.combotreegrid.defaults,$.fn.combotreegrid.parseOptions(this),_cbc)});\n}\n_c9a(this);\n});\n};\n$.fn.combotreegrid.methods={options:function(jq){\nvar _cc0=jq.combo("options");\nreturn $.extend($.data(jq[0],"combotreegrid").options,{width:_cc0.width,height:_cc0.height,originalValue:_cc0.originalValue,disabled:_cc0.disabled,readonly:_cc0.readonly,editable:_cc0.editable});\n},grid:function(jq){\nreturn $.data(jq[0],"combotreegrid").grid;\n},setValues:function(jq,_cc1){\nreturn jq.each(function(){\nvar opts=$(this).combotreegrid("options");\nif($.isArray(_cc1)){\n_cc1=$.map(_cc1,function(_cc2){\nif(_cc2&&typeof _cc2=="object"){\n$.easyui.addArrayItem(opts.mappingRows,opts.idField,_cc2);\nreturn _cc2[opts.idField];\n}else{\nreturn _cc2;\n}\n});\n}\n_ca6(this,_cc1);\n});\n},setValue:function(jq,_cc3){\nreturn jq.each(function(){\n$(this).combotreegrid("setValues",$.isArray(_cc3)?_cc3:[_cc3]);\n});\n},clear:function(jq){\nreturn jq.each(function(){\n$(this).combotreegrid("setValues",[]);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).combotreegrid("options");\nif(opts.multiple){\n$(this).combotreegrid("setValues",opts.originalValue);\n}else{\n$(this).combotreegrid("setValue",opts.originalValue);\n}\n});\n}};\n$.fn.combotreegrid.parseOptions=function(_cc4){\nvar t=$(_cc4);\nreturn $.extend({},$.fn.combo.parseOptions(_cc4),$.fn.treegrid.parseOptions(_cc4),$.parser.parseOptions(_cc4,["mode",{limitToGrid:"boolean"}]));\n};\n$.fn.combotreegrid.defaults=$.extend({},$.fn.combo.defaults,$.fn.treegrid.defaults,{editable:false,singleSelect:true,limitToGrid:false,unselectedValues:[],mappingRows:[],mode:"local",textField:null,keyHandler:{up:function(e){\n},down:function(e){\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_cb9(this);\n},query:function(q,e){\n_cb5(this,q);\n}},inputEvents:$.extend({},$.fn.combo.defaults.inputEvents,{blur:function(e){\n$.fn.combo.defaults.inputEvents.blur(e);\nvar _cc5=e.data.target;\nvar opts=$(_cc5).combotreegrid("options");\nif(opts.limitToGrid){\n_cb9(_cc5);\n}\n}}),filter:function(q,row){\nvar opts=$(this).combotreegrid("options");\nreturn (row[opts.treeField]||"").toLowerCase().indexOf(q.toLowerCase())>=0;\n}});\n})(jQuery);\n(function($){\nfunction _cc6(_cc7){\nvar _cc8=$.data(_cc7,"tagbox");\nvar opts=_cc8.options;\n$(_cc7).addClass("tagbox-f").combobox($.extend({},opts,{cls:"tagbox",reversed:true,onChange:function(_cc9,_cca){\n_ccb();\n$(this).combobox("hidePanel");\nopts.onChange.call(_cc7,_cc9,_cca);\n},onResizing:function(_ccc,_ccd){\nvar _cce=$(this).combobox("textbox");\nvar tb=$(this).data("textbox").textbox;\nvar _ccf=tb.outerWidth();\ntb.css({height:"",paddingLeft:_cce.css("marginLeft"),paddingRight:_cce.css("marginRight")});\n_cce.css("margin",0);\ntb._outerWidth(_ccf);\n_ce2(_cc7);\n_cd4(this);\nopts.onResizing.call(_cc7,_ccc,_ccd);\n},onLoadSuccess:function(data){\n_ccb();\nopts.onLoadSuccess.call(_cc7,data);\n}}));\n_ccb();\n_ce2(_cc7);\nfunction _ccb(){\n$(_cc7).next().find(".tagbox-label").remove();\nvar _cd0=$(_cc7).tagbox("textbox");\nvar ss=[];\n$.map($(_cc7).tagbox("getValues"),function(_cd1,_cd2){\nvar row=opts.finder.getRow(_cc7,_cd1);\nvar text=opts.tagFormatter.call(_cc7,_cd1,row);\nvar cs={};\nvar css=opts.tagStyler.call(_cc7,_cd1,row)||"";\nif(typeof css=="string"){\ncs={s:css};\n}else{\ncs={c:css["class"]||"",s:css["style"]||""};\n}\nvar _cd3=$("<span class=\\"tagbox-label\\"></span>").insertBefore(_cd0).html(text);\n_cd3.attr("tagbox-index",_cd2);\n_cd3.attr("style",cs.s).addClass(cs.c);\n$("<a href=\\"javascript:;\\" class=\\"tagbox-remove\\"></a>").appendTo(_cd3);\n});\n_cd4(_cc7);\n$(_cc7).combobox("setText","");\n};\n};\nfunction _cd4(_cd5,_cd6){\nvar span=$(_cd5).next();\nvar _cd7=_cd6?$(_cd6):span.find(".tagbox-label");\nif(_cd7.length){\nvar _cd8=$(_cd5).tagbox("textbox");\nvar _cd9=$(_cd7[0]);\nvar _cda=_cd9.outerHeight(true)-_cd9.outerHeight();\nvar _cdb=_cd8.outerHeight()-_cda*2;\n_cd7.css({height:_cdb+"px",lineHeight:_cdb+"px"});\nvar _cdc=span.find(".textbox-addon").css("height","100%");\n_cdc.find(".textbox-icon").css("height","100%");\nspan.find(".textbox-button").linkbutton("resize",{height:"100%"});\n}\n};\nfunction _cdd(_cde){\nvar span=$(_cde).next();\nspan._unbind(".tagbox")._bind("click.tagbox",function(e){\nvar opts=$(_cde).tagbox("options");\nif(opts.disabled||opts.readonly){\nreturn;\n}\nif($(e.target).hasClass("tagbox-remove")){\nvar _cdf=parseInt($(e.target).parent().attr("tagbox-index"));\nvar _ce0=$(_cde).tagbox("getValues");\nif(opts.onBeforeRemoveTag.call(_cde,_ce0[_cdf])==false){\nreturn;\n}\nopts.onRemoveTag.call(_cde,_ce0[_cdf]);\n_ce0.splice(_cdf,1);\n$(_cde).tagbox("setValues",_ce0);\n}else{\nvar _ce1=$(e.target).closest(".tagbox-label");\nif(_ce1.length){\nvar _cdf=parseInt(_ce1.attr("tagbox-index"));\nvar _ce0=$(_cde).tagbox("getValues");\nopts.onClickTag.call(_cde,_ce0[_cdf]);\n}\n}\n$(this).find(".textbox-text").focus();\n})._bind("keyup.tagbox",function(e){\n_ce2(_cde);\n})._bind("mouseover.tagbox",function(e){\nif($(e.target).closest(".textbox-button,.textbox-addon,.tagbox-label").length){\n$(this).triggerHandler("mouseleave");\n}else{\n$(this).find(".textbox-text").triggerHandler("mouseenter");\n}\n})._bind("mouseleave.tagbox",function(e){\n$(this).find(".textbox-text").triggerHandler("mouseleave");\n});\n};\nfunction _ce2(_ce3){\nvar opts=$(_ce3).tagbox("options");\nvar _ce4=$(_ce3).tagbox("textbox");\nvar span=$(_ce3).next();\nvar tmp=$("<span></span>").appendTo("body");\ntmp.attr("style",_ce4.attr("style"));\ntmp.css({position:"absolute",top:-9999,left:-9999,width:"auto",fontFamily:_ce4.css("fontFamily"),fontSize:_ce4.css("fontSize"),fontWeight:_ce4.css("fontWeight"),whiteSpace:"nowrap"});\nvar _ce5=_ce6(_ce4.val());\nvar _ce7=_ce6(opts.prompt||"");\ntmp.remove();\nvar _ce8=Math.min(Math.max(_ce5,_ce7)+20,span.width());\n_ce4._outerWidth(_ce8);\nspan.find(".textbox-button").linkbutton("resize",{height:"100%"});\nfunction _ce6(val){\nvar s=val.replace(/&/g,"&amp;").replace(/\\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");\ntmp.html(s);\nreturn tmp.outerWidth();\n};\n};\nfunction _ce9(_cea){\nvar t=$(_cea);\nvar opts=t.tagbox("options");\nif(opts.limitToList){\nvar _ceb=t.tagbox("panel");\nvar item=_ceb.children("div.combobox-item-hover");\nif(item.length){\nitem.removeClass("combobox-item-hover");\nvar row=opts.finder.getRow(_cea,item);\nvar _cec=row[opts.valueField];\n$(_cea).tagbox(item.hasClass("combobox-item-selected")?"unselect":"select",_cec);\n}\n$(_cea).tagbox("hidePanel");\n}else{\nvar v=$.trim($(_cea).tagbox("getText"));\nif(v!==""){\nvar _ced=$(_cea).tagbox("getValues");\n_ced.push(v);\n$(_cea).tagbox("setValues",_ced);\n}\n}\n};\nfunction _cee(_cef,_cf0){\n$(_cef).combobox("setText","");\n_ce2(_cef);\n$(_cef).combobox("setValues",_cf0);\n$(_cef).combobox("setText","");\n$(_cef).tagbox("validate");\n};\n$.fn.tagbox=function(_cf1,_cf2){\nif(typeof _cf1=="string"){\nvar _cf3=$.fn.tagbox.methods[_cf1];\nif(_cf3){\nreturn _cf3(this,_cf2);\n}else{\nreturn this.combobox(_cf1,_cf2);\n}\n}\n_cf1=_cf1||{};\nreturn this.each(function(){\nvar _cf4=$.data(this,"tagbox");\nif(_cf4){\n$.extend(_cf4.options,_cf1);\n}else{\n$.data(this,"tagbox",{options:$.extend({},$.fn.tagbox.defaults,$.fn.tagbox.parseOptions(this),_cf1)});\n}\n_cc6(this);\n_cdd(this);\n});\n};\n$.fn.tagbox.methods={options:function(jq){\nvar _cf5=jq.combobox("options");\nreturn $.extend($.data(jq[0],"tagbox").options,{width:_cf5.width,height:_cf5.height,originalValue:_cf5.originalValue,disabled:_cf5.disabled,readonly:_cf5.readonly});\n},setValues:function(jq,_cf6){\nreturn jq.each(function(){\n_cee(this,_cf6);\n});\n},reset:function(jq){\nreturn jq.each(function(){\n$(this).combobox("reset").combobox("setText","");\n});\n}};\n$.fn.tagbox.parseOptions=function(_cf7){\nreturn $.extend({},$.fn.combobox.parseOptions(_cf7),$.parser.parseOptions(_cf7,[]));\n};\n$.fn.tagbox.defaults=$.extend({},$.fn.combobox.defaults,{hasDownArrow:false,multiple:true,reversed:true,selectOnNavigation:false,tipOptions:$.extend({},$.fn.textbox.defaults.tipOptions,{showDelay:200}),val:function(_cf8){\nvar vv=$(_cf8).parent().prev().tagbox("getValues");\nif($(_cf8).is(":focus")){\nvv.push($(_cf8).val());\n}\nreturn vv.join(",");\n},inputEvents:$.extend({},$.fn.combo.defaults.inputEvents,{blur:function(e){\nvar _cf9=e.data.target;\nvar opts=$(_cf9).tagbox("options");\nif(opts.limitToList){\n_ce9(_cf9);\n}\n}}),keyHandler:$.extend({},$.fn.combobox.defaults.keyHandler,{enter:function(e){\n_ce9(this);\n},query:function(q,e){\nvar opts=$(this).tagbox("options");\nif(opts.limitToList){\n$.fn.combobox.defaults.keyHandler.query.call(this,q,e);\n}else{\n$(this).combobox("hidePanel");\n}\n}}),tagFormatter:function(_cfa,row){\nvar opts=$(this).tagbox("options");\nreturn row?row[opts.textField]:_cfa;\n},tagStyler:function(_cfb,row){\nreturn "";\n},onClickTag:function(_cfc){\n},onBeforeRemoveTag:function(_cfd){\n},onRemoveTag:function(_cfe){\n}});\n})(jQuery);\n(function($){\nfunction _cff(_d00){\nvar _d01=$.data(_d00,"datebox");\nvar opts=_d01.options;\n$(_d00).addClass("datebox-f").combo($.extend({},opts,{onShowPanel:function(){\n_d02(this);\n_d03(this);\n_d04(this);\n_d12(this,$(this).datebox("getText"),true);\nopts.onShowPanel.call(this);\n}}));\nif(!_d01.calendar){\nvar _d05=$(_d00).combo("panel").css("overflow","hidden");\n_d05.panel("options").onBeforeDestroy=function(){\nvar c=$(this).find(".calendar-shared");\nif(c.length){\nc.insertBefore(c[0].pholder);\n}\n};\nvar cc=$("<div class=\\"datebox-calendar-inner\\"></div>").prependTo(_d05);\nif(opts.sharedCalendar){\nvar c=$(opts.sharedCalendar);\nif(!c[0].pholder){\nc[0].pholder=$("<div class=\\"calendar-pholder\\" style=\\"display:none\\"></div>").insertAfter(c);\n}\nc.addClass("calendar-shared").appendTo(cc);\nif(!c.hasClass("calendar")){\nc.calendar();\n}\n_d01.calendar=c;\n}else{\n_d01.calendar=$("<div></div>").appendTo(cc).calendar();\n}\n$.extend(_d01.calendar.calendar("options"),{fit:true,border:false,onSelect:function(date){\nvar _d06=this.target;\nvar opts=$(_d06).datebox("options");\nopts.onSelect.call(_d06,date);\n_d12(_d06,opts.formatter.call(_d06,date));\n$(_d06).combo("hidePanel");\n}});\n}\n$(_d00).combo("textbox").parent().addClass("datebox");\n$(_d00).datebox("initValue",opts.value);\nfunction _d02(_d07){\nvar opts=$(_d07).datebox("options");\nvar _d08=$(_d07).combo("panel");\n_d08._unbind(".datebox")._bind("click.datebox",function(e){\nif($(e.target).hasClass("datebox-button-a")){\nvar _d09=parseInt($(e.target).attr("datebox-button-index"));\nopts.buttons[_d09].handler.call(e.target,_d07);\n}\n});\n};\nfunction _d03(_d0a){\nvar _d0b=$(_d0a).combo("panel");\nif(_d0b.children("div.datebox-button").length){\nreturn;\n}\nvar _d0c=$("<div class=\\"datebox-button\\"><table cellspacing=\\"0\\" cellpadding=\\"0\\" style=\\"width:100%\\"><tr></tr></table></div>").appendTo(_d0b);\nvar tr=_d0c.find("tr");\nfor(var i=0;i<opts.buttons.length;i++){\nvar td=$("<td></td>").appendTo(tr);\nvar btn=opts.buttons[i];\nvar t=$("<a class=\\"datebox-button-a\\" href=\\"javascript:;\\"></a>").html($.isFunction(btn.text)?btn.text(_d0a):btn.text).appendTo(td);\nt.attr("datebox-button-index",i);\n}\ntr.find("td").css("width",(100/opts.buttons.length)+"%");\n};\nfunction _d04(_d0d){\nvar _d0e=$(_d0d).combo("panel");\nvar cc=_d0e.children("div.datebox-calendar-inner");\n_d0e.children()._outerWidth(_d0e.width());\n_d01.calendar.appendTo(cc);\n_d01.calendar[0].target=_d0d;\nif(opts.panelHeight!="auto"){\nvar _d0f=_d0e.height();\n_d0e.children().not(cc).each(function(){\n_d0f-=$(this).outerHeight();\n});\ncc._outerHeight(_d0f);\n}\n_d01.calendar.calendar("resize");\n};\n};\nfunction _d10(_d11,q){\n_d12(_d11,q,true);\n};\nfunction _d13(_d14){\nvar _d15=$.data(_d14,"datebox");\nvar opts=_d15.options;\nvar _d16=_d15.calendar.calendar("options").current;\nif(_d16){\n_d12(_d14,opts.formatter.call(_d14,_d16));\n$(_d14).combo("hidePanel");\n}\n};\nfunction _d12(_d17,_d18,_d19){\nvar _d1a=$.data(_d17,"datebox");\nvar opts=_d1a.options;\nvar _d1b=_d1a.calendar;\n_d1b.calendar("moveTo",opts.parser.call(_d17,_d18));\nif(_d19){\n$(_d17).combo("setValue",_d18);\n}else{\nif(_d18){\n_d18=opts.formatter.call(_d17,_d1b.calendar("options").current);\n}\n$(_d17).combo("setText",_d18).combo("setValue",_d18);\n}\n};\n$.fn.datebox=function(_d1c,_d1d){\nif(typeof _d1c=="string"){\nvar _d1e=$.fn.datebox.methods[_d1c];\nif(_d1e){\nreturn _d1e(this,_d1d);\n}else{\nreturn this.combo(_d1c,_d1d);\n}\n}\n_d1c=_d1c||{};\nreturn this.each(function(){\nvar _d1f=$.data(this,"datebox");\nif(_d1f){\n$.extend(_d1f.options,_d1c);\n}else{\n$.data(this,"datebox",{options:$.extend({},$.fn.datebox.defaults,$.fn.datebox.parseOptions(this),_d1c)});\n}\n_cff(this);\n});\n};\n$.fn.datebox.methods={options:function(jq){\nvar _d20=jq.combo("options");\nreturn $.extend($.data(jq[0],"datebox").options,{width:_d20.width,height:_d20.height,originalValue:_d20.originalValue,disabled:_d20.disabled,readonly:_d20.readonly});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).combo("cloneFrom",from);\n$.data(this,"datebox",{options:$.extend(true,{},$(from).datebox("options")),calendar:$(from).datebox("calendar")});\n$(this).addClass("datebox-f");\n});\n},calendar:function(jq){\nreturn $.data(jq[0],"datebox").calendar;\n},initValue:function(jq,_d21){\nreturn jq.each(function(){\nvar opts=$(this).datebox("options");\nif(_d21){\nvar date=opts.parser.call(this,_d21);\n_d21=opts.formatter.call(this,date);\n$(this).datebox("calendar").calendar("moveTo",date);\n}\n$(this).combo("initValue",_d21).combo("setText",_d21);\n});\n},setValue:function(jq,_d22){\nreturn jq.each(function(){\n_d12(this,_d22);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).datebox("options");\n$(this).datebox("setValue",opts.originalValue);\n});\n},setDate:function(jq,date){\nreturn jq.each(function(){\nvar opts=$(this).datebox("options");\n$(this).datebox("calendar").calendar("moveTo",date);\n_d12(this,date?opts.formatter.call(this,date):"");\n});\n},getDate:function(jq){\nif(jq.datebox("getValue")){\nreturn jq.datebox("calendar").calendar("options").current;\n}else{\nreturn null;\n}\n}};\n$.fn.datebox.parseOptions=function(_d23){\nreturn $.extend({},$.fn.combo.parseOptions(_d23),$.parser.parseOptions(_d23,["sharedCalendar"]));\n};\n$.fn.datebox.defaults=$.extend({},$.fn.combo.defaults,{panelWidth:250,panelHeight:"auto",sharedCalendar:null,keyHandler:{up:function(e){\n},down:function(e){\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_d13(this);\n},query:function(q,e){\n_d10(this,q);\n}},currentText:"Today",closeText:"Close",okText:"Ok",buttons:[{text:function(_d24){\nreturn $(_d24).datebox("options").currentText;\n},handler:function(_d25){\nvar opts=$(_d25).datebox("options");\nvar now=new Date();\nvar _d26=new Date(now.getFullYear(),now.getMonth(),now.getDate());\n$(_d25).datebox("calendar").calendar({year:_d26.getFullYear(),month:_d26.getMonth()+1,current:_d26});\nopts.onSelect.call(_d25,_d26);\n_d13(_d25);\n}},{text:function(_d27){\nreturn $(_d27).datebox("options").closeText;\n},handler:function(_d28){\n$(this).closest("div.combo-panel").panel("close");\n}}],formatter:function(date){\nvar y=date.getFullYear();\nvar m=date.getMonth()+1;\nvar d=date.getDate();\nreturn (m<10?("0"+m):m)+"/"+(d<10?("0"+d):d)+"/"+y;\n},parser:function(s){\nvar _d29=$.fn.calendar.defaults.Date;\nif($(this).data("datebox")){\n_d29=$(this).datebox("calendar").calendar("options").Date;\n}\nif(!s){\nreturn new _d29();\n}\nvar ss=s.split("/");\nvar m=parseInt(ss[0],10);\nvar d=parseInt(ss[1],10);\nvar y=parseInt(ss[2],10);\nif(!isNaN(y)&&!isNaN(m)&&!isNaN(d)){\nreturn new _d29(y,m-1,d);\n}else{\nreturn new _d29();\n}\n},onSelect:function(date){\n}});\n})(jQuery);\n(function($){\nfunction _d2a(_d2b){\nvar _d2c=$.data(_d2b,"datetimebox");\nvar opts=_d2c.options;\n$(_d2b).datebox($.extend({},opts,{onShowPanel:function(){\nvar _d2d=$(this).datetimebox("getValue");\n_d33(this,_d2d,true);\nopts.onShowPanel.call(this);\n},formatter:$.fn.datebox.defaults.formatter,parser:$.fn.datebox.defaults.parser}));\n$(_d2b).removeClass("datebox-f").addClass("datetimebox-f");\n$(_d2b).datebox("calendar").calendar({onSelect:function(date){\nopts.onSelect.call(this.target,date);\n}});\nif(!_d2c.spinner){\nvar _d2e=$(_d2b).datebox("panel");\nvar p=$("<div style=\\"padding:2px\\"><input></div>").insertAfter(_d2e.children("div.datebox-calendar-inner"));\n_d2c.spinner=p.children("input");\n}\n_d2c.spinner.timespinner({width:opts.spinnerWidth,showSeconds:opts.showSeconds,separator:opts.timeSeparator,hour12:opts.hour12});\n$(_d2b).datetimebox("initValue",opts.value);\n};\nfunction _d2f(_d30){\nvar c=$(_d30).datetimebox("calendar");\nvar t=$(_d30).datetimebox("spinner");\nvar date=c.calendar("options").current;\nreturn new Date(date.getFullYear(),date.getMonth(),date.getDate(),t.timespinner("getHours"),t.timespinner("getMinutes"),t.timespinner("getSeconds"));\n};\nfunction _d31(_d32,q){\n_d33(_d32,q,true);\n};\nfunction _d34(_d35){\nvar opts=$.data(_d35,"datetimebox").options;\nvar date=_d2f(_d35);\n_d33(_d35,opts.formatter.call(_d35,date));\n$(_d35).combo("hidePanel");\n};\nfunction _d33(_d36,_d37,_d38){\nvar opts=$.data(_d36,"datetimebox").options;\n$(_d36).combo("setValue",_d37);\nif(!_d38){\nif(_d37){\nvar date=opts.parser.call(_d36,_d37);\n$(_d36).combo("setText",opts.formatter.call(_d36,date));\n$(_d36).combo("setValue",opts.formatter.call(_d36,date));\n}else{\n$(_d36).combo("setText",_d37);\n}\n}\nvar date=opts.parser.call(_d36,_d37);\n$(_d36).datetimebox("calendar").calendar("moveTo",date);\n$(_d36).datetimebox("spinner").timespinner("setValue",_d39(date));\nfunction _d39(date){\nfunction _d3a(_d3b){\nreturn (_d3b<10?"0":"")+_d3b;\n};\nvar tt=[_d3a(date.getHours()),_d3a(date.getMinutes())];\nif(opts.showSeconds){\ntt.push(_d3a(date.getSeconds()));\n}\nreturn tt.join($(_d36).datetimebox("spinner").timespinner("options").separator);\n};\n};\n$.fn.datetimebox=function(_d3c,_d3d){\nif(typeof _d3c=="string"){\nvar _d3e=$.fn.datetimebox.methods[_d3c];\nif(_d3e){\nreturn _d3e(this,_d3d);\n}else{\nreturn this.datebox(_d3c,_d3d);\n}\n}\n_d3c=_d3c||{};\nreturn this.each(function(){\nvar _d3f=$.data(this,"datetimebox");\nif(_d3f){\n$.extend(_d3f.options,_d3c);\n}else{\n$.data(this,"datetimebox",{options:$.extend({},$.fn.datetimebox.defaults,$.fn.datetimebox.parseOptions(this),_d3c)});\n}\n_d2a(this);\n});\n};\n$.fn.datetimebox.methods={options:function(jq){\nvar _d40=jq.datebox("options");\nreturn $.extend($.data(jq[0],"datetimebox").options,{originalValue:_d40.originalValue,disabled:_d40.disabled,readonly:_d40.readonly});\n},cloneFrom:function(jq,from){\nreturn jq.each(function(){\n$(this).datebox("cloneFrom",from);\n$.data(this,"datetimebox",{options:$.extend(true,{},$(from).datetimebox("options")),spinner:$(from).datetimebox("spinner")});\n$(this).removeClass("datebox-f").addClass("datetimebox-f");\n});\n},spinner:function(jq){\nreturn $.data(jq[0],"datetimebox").spinner;\n},initValue:function(jq,_d41){\nreturn jq.each(function(){\nvar opts=$(this).datetimebox("options");\nvar _d42=opts.value;\nif(_d42){\nvar date=opts.parser.call(this,_d42);\n_d42=opts.formatter.call(this,date);\n$(this).datetimebox("calendar").calendar("moveTo",date);\n}\n$(this).combo("initValue",_d42).combo("setText",_d42);\n});\n},setValue:function(jq,_d43){\nreturn jq.each(function(){\n_d33(this,_d43);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).datetimebox("options");\n$(this).datetimebox("setValue",opts.originalValue);\n});\n},setDate:function(jq,date){\nreturn jq.each(function(){\nvar opts=$(this).datetimebox("options");\n$(this).datetimebox("calendar").calendar("moveTo",date);\n_d33(this,date?opts.formatter.call(this,date):"");\n});\n},getDate:function(jq){\nif(jq.datetimebox("getValue")){\nreturn jq.datetimebox("calendar").calendar("options").current;\n}else{\nreturn null;\n}\n}};\n$.fn.datetimebox.parseOptions=function(_d44){\nvar t=$(_d44);\nreturn $.extend({},$.fn.datebox.parseOptions(_d44),$.parser.parseOptions(_d44,["timeSeparator","spinnerWidth",{showSeconds:"boolean"}]));\n};\n$.fn.datetimebox.defaults=$.extend({},$.fn.datebox.defaults,{spinnerWidth:"100%",showSeconds:true,timeSeparator:":",hour12:false,panelEvents:{mousedown:function(e){\n}},keyHandler:{up:function(e){\n},down:function(e){\n},left:function(e){\n},right:function(e){\n},enter:function(e){\n_d34(this);\n},query:function(q,e){\n_d31(this,q);\n}},buttons:[{text:function(_d45){\nreturn $(_d45).datetimebox("options").currentText;\n},handler:function(_d46){\nvar opts=$(_d46).datetimebox("options");\n_d33(_d46,opts.formatter.call(_d46,new Date()));\n$(_d46).datetimebox("hidePanel");\n}},{text:function(_d47){\nreturn $(_d47).datetimebox("options").okText;\n},handler:function(_d48){\n_d34(_d48);\n}},{text:function(_d49){\nreturn $(_d49).datetimebox("options").closeText;\n},handler:function(_d4a){\n$(_d4a).datetimebox("hidePanel");\n}}],formatter:function(date){\nif(!date){\nreturn "";\n}\nreturn $.fn.datebox.defaults.formatter.call(this,date)+" "+$.fn.timespinner.defaults.formatter.call($(this).datetimebox("spinner")[0],date);\n},parser:function(s){\ns=$.trim(s);\nif(!s){\nreturn new Date();\n}\nvar dt=s.split(" ");\nvar _d4b=$.fn.datebox.defaults.parser.call(this,dt[0]);\nif(dt.length<2){\nreturn _d4b;\n}\nvar _d4c=$.fn.timespinner.defaults.parser.call($(this).datetimebox("spinner")[0],dt[1]+(dt[2]?" "+dt[2]:""));\nreturn new Date(_d4b.getFullYear(),_d4b.getMonth(),_d4b.getDate(),_d4c.getHours(),_d4c.getMinutes(),_d4c.getSeconds());\n}});\n})(jQuery);\n(function($){\nfunction _d4d(_d4e){\nvar _d4f=$.data(_d4e,"timepicker");\nvar opts=_d4f.options;\n$(_d4e).addClass("timepicker-f").combo($.extend({},opts,{onShowPanel:function(){\n_d50(this);\n_d51(_d4e);\n_d5b(_d4e,$(_d4e).timepicker("getValue"));\n}}));\n$(_d4e).timepicker("initValue",opts.value);\nfunction _d50(_d52){\nvar opts=$(_d52).timepicker("options");\nvar _d53=$(_d52).combo("panel");\n_d53._unbind(".timepicker")._bind("click.timepicker",function(e){\nif($(e.target).hasClass("datebox-button-a")){\nvar _d54=parseInt($(e.target).attr("datebox-button-index"));\nopts.buttons[_d54].handler.call(e.target,_d52);\n}\n});\n};\nfunction _d51(_d55){\nvar _d56=$(_d55).combo("panel");\nif(_d56.children("div.datebox-button").length){\nreturn;\n}\nvar _d57=$("<div class=\\"datebox-button\\"><table cellspacing=\\"0\\" cellpadding=\\"0\\" style=\\"width:100%\\"><tr></tr></table></div>").appendTo(_d56);\nvar tr=_d57.find("tr");\nfor(var i=0;i<opts.buttons.length;i++){\nvar td=$("<td></td>").appendTo(tr);\nvar btn=opts.buttons[i];\nvar t=$("<a class=\\"datebox-button-a\\" href=\\"javascript:;\\"></a>").html($.isFunction(btn.text)?btn.text(_d55):btn.text).appendTo(td);\nt.attr("datebox-button-index",i);\n}\ntr.find("td").css("width",(100/opts.buttons.length)+"%");\n};\n};\nfunction _d58(_d59,_d5a){\nvar opts=$(_d59).data("timepicker").options;\n_d5b(_d59,_d5a);\nopts.value=_d5c(_d59);\n$(_d59).combo("setValue",opts.value).combo("setText",opts.value);\n};\nfunction _d5b(_d5d,_d5e){\nvar opts=$(_d5d).data("timepicker").options;\nif(_d5e){\nvar _d5f=_d5e.split(" ");\nvar hm=_d5f[0].split(":");\nopts.selectingHour=parseInt(hm[0],10);\nopts.selectingMinute=parseInt(hm[1],10);\nopts.selectingAmpm=_d5f[1];\n}else{\nopts.selectingHour=12;\nopts.selectingMinute=0;\nopts.selectingAmpm=opts.ampm[0];\n}\n_d60(_d5d);\n};\nfunction _d5c(_d61){\nvar opts=$(_d61).data("timepicker").options;\nvar h=opts.selectingHour;\nvar m=opts.selectingMinute;\nvar ampm=opts.selectingAmpm;\nif(!ampm){\nampm=opts.ampm[0];\n}\nvar v=(h<10?"0"+h:h)+":"+(m<10?"0"+m:m);\nif(!opts.hour24){\nv+=" "+ampm;\n}\nreturn v;\n};\nfunction _d60(_d62){\nvar opts=$(_d62).data("timepicker").options;\nvar _d63=$(_d62).combo("panel");\nvar _d64=_d63.children(".timepicker-panel");\nif(!_d64.length){\nvar _d64=$("<div class=\\"timepicker-panel f-column\\"></div>").prependTo(_d63);\n}\n_d64.empty();\nif(opts.panelHeight!="auto"){\nvar _d65=_d63.height()-_d63.find(".datebox-button").outerHeight();\n_d64._outerHeight(_d65);\n}\n_d66(_d62);\n_d67(_d62);\n_d64.off(".timepicker");\n_d64.on("click.timepicker",".title-hour",function(e){\nopts.selectingType="hour";\n_d60(_d62);\n}).on("click.timepicker",".title-minute",function(e){\nopts.selectingType="minute";\n_d60(_d62);\n}).on("click.timepicker",".title-am",function(e){\nopts.selectingAmpm=opts.ampm[0];\n_d60(_d62);\n}).on("click.timepicker",".title-pm",function(e){\nopts.selectingAmpm=opts.ampm[1];\n_d60(_d62);\n}).on("click.timepicker",".item",function(e){\nvar _d68=parseInt($(this).text(),10);\nif(opts.selectingType=="hour"){\nopts.selectingHour=_d68;\n}else{\nopts.selectingMinute=_d68;\n}\n_d60(_d62);\n});\n};\nfunction _d66(_d69){\nvar opts=$(_d69).data("timepicker").options;\nvar _d6a=$(_d69).combo("panel");\nvar _d6b=_d6a.find(".timepicker-panel");\nvar hour=opts.selectingHour;\nvar _d6c=opts.selectingMinute;\n$("<div class=\\"panel-header f-noshrink f-row f-content-center\\">"+"<div class=\\"title title-hour\\">"+(hour<10?"0"+hour:hour)+"</div>"+"<div class=\\"sep\\">:</div>"+"<div class=\\"title title-minute\\">"+(_d6c<10?"0"+_d6c:_d6c)+"</div>"+"<div class=\\"ampm f-column\\">"+"<div class=\\"title title-am\\">"+opts.ampm[0]+"</div>"+"<div class=\\"title title-pm\\">"+opts.ampm[1]+"</div>"+"</div>"+"</div>").appendTo(_d6b);\nvar _d6d=_d6b.find(".panel-header");\nif(opts.selectingType=="hour"){\n_d6d.find(".title-hour").addClass("title-selected");\n}else{\n_d6d.find(".title-minute").addClass("title-selected");\n}\nif(opts.selectingAmpm==opts.ampm[0]){\n_d6d.find(".title-am").addClass("title-selected");\n}\nif(opts.selectingAmpm==opts.ampm[1]){\n_d6d.find(".title-pm").addClass("title-selected");\n}\nif(opts.hour24){\n_d6d.find(".ampm").hide();\n}\n};\nfunction _d67(_d6e){\nvar opts=$(_d6e).data("timepicker").options;\nvar _d6f=$(_d6e).combo("panel");\nvar _d70=_d6f.find(".timepicker-panel");\nvar _d71=$("<div class=\\"clock-wrap f-full f-column f-content-center\\">"+"</div>").appendTo(_d70);\nvar _d72=_d71.outerWidth();\nvar _d73=_d71.outerHeight();\nvar size=Math.min(_d72,_d73)-20;\nvar _d74=size/2;\n_d72=size;\n_d73=size;\nvar _d75=opts.selectingType=="hour"?opts.selectingHour:opts.selectingMinute;\nvar _d76=_d75/(opts.selectingType=="hour"?12:60)*360;\n_d76=parseFloat(_d76).toFixed(4);\nvar _d77={transform:"rotate("+_d76+"deg)",};\nif(opts.hour24&&opts.selectingType=="hour"){\nif(_d75==0){\n_d77.top=opts.hourDistance[0]+"px";\n}else{\nif(_d75<=12){\n_d77.top=opts.hourDistance[1]+"px";\n}\n}\n}\nvar _d78={width:_d72+"px",height:_d73+"px",marginLeft:-_d72/2+"px",marginTop:-_d73/2+"px"};\nvar _d79=[];\n_d79.push("<div class=\\"clock\\">");\n_d79.push("<div class=\\"center\\"></div>");\n_d79.push("<div class=\\"hand\\">");\n_d79.push("<div class=\\"drag\\"></div>");\n_d79.push("</div>");\nvar data=_d7a();\nif(opts.hour24&&opts.selectingType=="hour"){\nfor(var i=0;i<data.length;i++){\nvar _d7b=parseInt(data[i],10);\n_d7b+=12;\nif(_d7b==24){\n_d7b="00";\n}\nvar cls="item f-column f-content-center";\nif(_d7b==_d75){\ncls+=" item-selected";\n}\nvar _d76=_d7b/(opts.selectingType=="hour"?12:60)*360*Math.PI/180;\nvar x=(_d74-20)*Math.sin(_d76);\nvar y=-(_d74-20)*Math.cos(_d76);\n_d76=parseFloat(_d76).toFixed(4);\nx=parseFloat(x).toFixed(4);\ny=parseFloat(y).toFixed(4);\nvar _d7c={transform:"translate("+x+"px,"+y+"px)"};\nvar _d7c="transform:translate("+x+"px,"+y+"px)";\n_d79.push("<div class=\\""+cls+"\\" style=\\""+_d7c+"\\">"+(_d7b)+"</div>");\n}\n_d74-=opts.hourDistance[1]-opts.hourDistance[0];\n}\nfor(var i=0;i<data.length;i++){\nvar _d7b=data[i];\nvar cls="item f-column f-content-center";\nif(_d7b==_d75){\ncls+=" item-selected";\n}\nvar _d76=_d7b/(opts.selectingType=="hour"?12:60)*360*Math.PI/180;\nvar x=(_d74-20)*Math.sin(_d76);\nvar y=-(_d74-20)*Math.cos(_d76);\n_d76=parseFloat(_d76).toFixed(4);\nx=parseFloat(x).toFixed(4);\ny=parseFloat(y).toFixed(4);\nvar _d7c={transform:"translate("+x+"px,"+y+"px)"};\nvar _d7c="transform:translate("+x+"px,"+y+"px)";\n_d79.push("<div class=\\""+cls+"\\" style=\\""+_d7c+"\\">"+_d7b+"</div>");\n}\n_d79.push("</div>");\n_d71.html(_d79.join(""));\n_d71.find(".clock").css(_d78);\n_d71.find(".hand").css(_d77);\nfunction _d7a(){\nvar data=[];\nif(opts.selectingType=="hour"){\nfor(var i=0;i<12;i++){\ndata.push(String(i));\n}\ndata[0]="12";\n}else{\nfor(var i=0;i<60;i+=5){\ndata.push(i<10?"0"+i:String(i));\n}\ndata[0]="00";\n}\nreturn data;\n};\n};\n$.fn.timepicker=function(_d7d,_d7e){\nif(typeof _d7d=="string"){\nvar _d7f=$.fn.timepicker.methods[_d7d];\nif(_d7f){\nreturn _d7f(this,_d7e);\n}else{\nreturn this.combo(_d7d,_d7e);\n}\n}\n_d7d=_d7d||{};\nreturn this.each(function(){\nvar _d80=$.data(this,"timepicker");\nif(_d80){\n$.extend(_d80.options,_d7d);\n}else{\n$.data(this,"timepicker",{options:$.extend({},$.fn.timepicker.defaults,$.fn.timepicker.parseOptions(this),_d7d)});\n}\n_d4d(this);\n});\n};\n$.fn.timepicker.methods={options:function(jq){\nvar _d81=jq.combo("options");\nreturn $.extend($.data(jq[0],"timepicker").options,{width:_d81.width,height:_d81.height,originalValue:_d81.originalValue,disabled:_d81.disabled,readonly:_d81.readonly});\n},initValue:function(jq,_d82){\nreturn jq.each(function(){\nvar opts=$(this).timepicker("options");\nopts.value=_d82;\n_d5b(this,_d82);\nif(_d82){\nopts.value=_d5c(this);\n$(this).combo("initValue",opts.value).combo("setText",opts.value);\n}\n});\n},setValue:function(jq,_d83){\nreturn jq.each(function(){\n_d58(this,_d83);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).timepicker("options");\n$(this).timepicker("setValue",opts.originalValue);\n});\n}};\n$.fn.timepicker.parseOptions=function(_d84){\nreturn $.extend({},$.fn.combo.parseOptions(_d84),$.parser.parseOptions(_d84,[{hour24:"boolean"}]));\n};\n$.fn.timepicker.defaults=$.extend({},$.fn.combo.defaults,{closeText:"Close",okText:"Ok",buttons:[{text:function(_d85){\nreturn $(_d85).timepicker("options").okText;\n},handler:function(_d86){\n$(_d86).timepicker("setValue",_d5c(_d86));\n$(this).closest("div.combo-panel").panel("close");\n}},{text:function(_d87){\nreturn $(_d87).timepicker("options").closeText;\n},handler:function(_d88){\n$(this).closest("div.combo-panel").panel("close");\n}}],editable:false,ampm:["am","pm"],value:"",selectingHour:12,selectingMinute:0,selectingType:"hour",hour24:false,hourDistance:[20,50]});\n})(jQuery);\n(function($){\nfunction init(_d89){\nvar _d8a=$("<div class=\\"slider\\">"+"<div class=\\"slider-inner\\">"+"<a href=\\"javascript:;\\" class=\\"slider-handle\\"></a>"+"<span class=\\"slider-tip\\"></span>"+"</div>"+"<div class=\\"slider-rule\\"></div>"+"<div class=\\"slider-rulelabel\\"></div>"+"<div style=\\"clear:both\\"></div>"+"<input type=\\"hidden\\" class=\\"slider-value\\">"+"</div>").insertAfter(_d89);\nvar t=$(_d89);\nt.addClass("slider-f").hide();\nvar name=t.attr("name");\nif(name){\n_d8a.find("input.slider-value").attr("name",name);\nt.removeAttr("name").attr("sliderName",name);\n}\n_d8a._bind("_resize",function(e,_d8b){\nif($(this).hasClass("easyui-fluid")||_d8b){\n_d8c(_d89);\n}\nreturn false;\n});\nreturn _d8a;\n};\nfunction _d8c(_d8d,_d8e){\nvar _d8f=$.data(_d8d,"slider");\nvar opts=_d8f.options;\nvar _d90=_d8f.slider;\nif(_d8e){\nif(_d8e.width){\nopts.width=_d8e.width;\n}\nif(_d8e.height){\nopts.height=_d8e.height;\n}\n}\n_d90._size(opts);\nif(opts.mode=="h"){\n_d90.css("height","");\n_d90.children("div").css("height","");\n}else{\n_d90.css("width","");\n_d90.children("div").css("width","");\n_d90.children("div.slider-rule,div.slider-rulelabel,div.slider-inner")._outerHeight(_d90._outerHeight());\n}\n_d91(_d8d);\n};\nfunction _d92(_d93){\nvar _d94=$.data(_d93,"slider");\nvar opts=_d94.options;\nvar _d95=_d94.slider;\nvar aa=opts.mode=="h"?opts.rule:opts.rule.slice(0).reverse();\nif(opts.reversed){\naa=aa.slice(0).reverse();\n}\n_d96(aa);\nfunction _d96(aa){\nvar rule=_d95.find("div.slider-rule");\nvar _d97=_d95.find("div.slider-rulelabel");\nrule.empty();\n_d97.empty();\nfor(var i=0;i<aa.length;i++){\nvar _d98=i*100/(aa.length-1)+"%";\nvar span=$("<span></span>").appendTo(rule);\nspan.css((opts.mode=="h"?"left":"top"),_d98);\nif(aa[i]!="|"){\nspan=$("<span></span>").appendTo(_d97);\nspan.html(aa[i]);\nif(opts.mode=="h"){\nspan.css({left:_d98,marginLeft:-Math.round(span.outerWidth()/2)});\n}else{\nspan.css({top:_d98,marginTop:-Math.round(span.outerHeight()/2)});\n}\n}\n}\n};\n};\nfunction _d99(_d9a){\nvar _d9b=$.data(_d9a,"slider");\nvar opts=_d9b.options;\nvar _d9c=_d9b.slider;\n_d9c.removeClass("slider-h slider-v slider-disabled");\n_d9c.addClass(opts.mode=="h"?"slider-h":"slider-v");\n_d9c.addClass(opts.disabled?"slider-disabled":"");\nvar _d9d=_d9c.find(".slider-inner");\n_d9d.html("<a href=\\"javascript:;\\" class=\\"slider-handle\\"></a>"+"<span class=\\"slider-tip\\"></span>");\nif(opts.range){\n_d9d.append("<a href=\\"javascript:;\\" class=\\"slider-handle\\"></a>"+"<span class=\\"slider-tip\\"></span>");\n}\n_d9c.find("a.slider-handle").draggable({axis:opts.mode,cursor:"pointer",disabled:opts.disabled,onDrag:function(e){\nvar left=e.data.left;\nvar _d9e=_d9c.width();\nif(opts.mode!="h"){\nleft=e.data.top;\n_d9e=_d9c.height();\n}\nif(left<0||left>_d9e){\nreturn false;\n}else{\n_d9f(left,this);\nreturn false;\n}\n},onStartDrag:function(){\n_d9b.isDragging=true;\nopts.onSlideStart.call(_d9a,opts.value);\n},onStopDrag:function(e){\n_d9f(opts.mode=="h"?e.data.left:e.data.top,this);\nopts.onSlideEnd.call(_d9a,opts.value);\nopts.onComplete.call(_d9a,opts.value);\n_d9b.isDragging=false;\n}});\n_d9c.find("div.slider-inner")._unbind(".slider")._bind("mousedown.slider",function(e){\nif(_d9b.isDragging||opts.disabled){\nreturn;\n}\nvar pos=$(this).offset();\n_d9f(opts.mode=="h"?(e.pageX-pos.left):(e.pageY-pos.top));\nopts.onComplete.call(_d9a,opts.value);\n});\nfunction _da0(_da1){\nvar dd=String(opts.step).split(".");\nvar dlen=dd.length>1?dd[1].length:0;\nreturn parseFloat(_da1.toFixed(dlen));\n};\nfunction _d9f(pos,_da2){\nvar _da3=_da4(_d9a,pos);\nvar s=Math.abs(_da3%opts.step);\nif(_da3>=0){\nif(s<opts.step/2){\n_da3-=s;\n}else{\n_da3=_da3-s+opts.step;\n}\n}else{\nif(s<opts.step/2){\n_da3+=s;\n}else{\n_da3=_da3+s-opts.step;\n}\n}\n_da3=_da0(_da3);\nif(opts.range){\nvar v1=opts.value[0];\nvar v2=opts.value[1];\nvar m=parseFloat((v1+v2)/2);\nif(_da2){\nvar _da5=$(_da2).nextAll(".slider-handle").length>0;\nif(_da3<=v2&&_da5){\nv1=_da3;\n}else{\nif(_da3>=v1&&(!_da5)){\nv2=_da3;\n}\n}\n}else{\nif(_da3<v1){\nv1=_da3;\n}else{\nif(_da3>v2){\nv2=_da3;\n}else{\n_da3<m?v1=_da3:v2=_da3;\n}\n}\n}\n$(_d9a).slider("setValues",[v1,v2]);\n}else{\n$(_d9a).slider("setValue",_da3);\n}\n};\n};\nfunction _da6(_da7,_da8){\nvar _da9=$.data(_da7,"slider");\nvar opts=_da9.options;\nvar _daa=_da9.slider;\nvar _dab=$.isArray(opts.value)?opts.value:[opts.value];\nvar _dac=[];\nif(!$.isArray(_da8)){\n_da8=$.map(String(_da8).split(opts.separator),function(v){\nreturn parseFloat(v);\n});\n}\n_daa.find(".slider-value").remove();\nvar name=$(_da7).attr("sliderName")||"";\nfor(var i=0;i<_da8.length;i++){\nvar _dad=_da8[i];\nif(_dad<opts.min){\n_dad=opts.min;\n}\nif(_dad>opts.max){\n_dad=opts.max;\n}\nvar _dae=$("<input type=\\"hidden\\" class=\\"slider-value\\">").appendTo(_daa);\n_dae.attr("name",name);\n_dae.val(_dad);\n_dac.push(_dad);\nvar _daf=_daa.find(".slider-handle:eq("+i+")");\nvar tip=_daf.next();\nvar pos=_db0(_da7,_dad);\nif(opts.showTip){\ntip.show();\ntip.html(opts.tipFormatter.call(_da7,_dad));\n}else{\ntip.hide();\n}\nif(opts.mode=="h"){\nvar _db1="left:"+pos+"px;";\n_daf.attr("style",_db1);\ntip.attr("style",_db1+"margin-left:"+(-Math.round(tip.outerWidth()/2))+"px");\n}else{\nvar _db1="top:"+pos+"px;";\n_daf.attr("style",_db1);\ntip.attr("style",_db1+"margin-left:"+(-Math.round(tip.outerWidth()))+"px");\n}\n}\nopts.value=opts.range?_dac:_dac[0];\n$(_da7).val(opts.range?_dac.join(opts.separator):_dac[0]);\nif(_dab.join(",")!=_dac.join(",")){\nopts.onChange.call(_da7,opts.value,(opts.range?_dab:_dab[0]));\n}\n};\nfunction _d91(_db2){\nvar opts=$.data(_db2,"slider").options;\nvar fn=opts.onChange;\nopts.onChange=function(){\n};\n_da6(_db2,opts.value);\nopts.onChange=fn;\n};\nfunction _db0(_db3,_db4){\nvar _db5=$.data(_db3,"slider");\nvar opts=_db5.options;\nvar _db6=_db5.slider;\nvar size=opts.mode=="h"?_db6.width():_db6.height();\nvar pos=opts.converter.toPosition.call(_db3,_db4,size);\nif(opts.mode=="v"){\npos=_db6.height()-pos;\n}\nif(opts.reversed){\npos=size-pos;\n}\nreturn pos;\n};\nfunction _da4(_db7,pos){\nvar _db8=$.data(_db7,"slider");\nvar opts=_db8.options;\nvar _db9=_db8.slider;\nvar size=opts.mode=="h"?_db9.width():_db9.height();\nvar pos=opts.mode=="h"?(opts.reversed?(size-pos):pos):(opts.reversed?pos:(size-pos));\nvar _dba=opts.converter.toValue.call(_db7,pos,size);\nreturn _dba;\n};\n$.fn.slider=function(_dbb,_dbc){\nif(typeof _dbb=="string"){\nreturn $.fn.slider.methods[_dbb](this,_dbc);\n}\n_dbb=_dbb||{};\nreturn this.each(function(){\nvar _dbd=$.data(this,"slider");\nif(_dbd){\n$.extend(_dbd.options,_dbb);\n}else{\n_dbd=$.data(this,"slider",{options:$.extend({},$.fn.slider.defaults,$.fn.slider.parseOptions(this),_dbb),slider:init(this)});\n$(this)._propAttr("disabled",false);\n}\nvar opts=_dbd.options;\nopts.min=parseFloat(opts.min);\nopts.max=parseFloat(opts.max);\nif(opts.range){\nif(!$.isArray(opts.value)){\nopts.value=$.map(String(opts.value).split(opts.separator),function(v){\nreturn parseFloat(v);\n});\n}\nif(opts.value.length<2){\nopts.value.push(opts.max);\n}\n}else{\nopts.value=parseFloat(opts.value);\n}\nopts.step=parseFloat(opts.step);\nopts.originalValue=opts.value;\n_d99(this);\n_d92(this);\n_d8c(this);\n});\n};\n$.fn.slider.methods={options:function(jq){\nreturn $.data(jq[0],"slider").options;\n},destroy:function(jq){\nreturn jq.each(function(){\n$.data(this,"slider").slider.remove();\n$(this).remove();\n});\n},resize:function(jq,_dbe){\nreturn jq.each(function(){\n_d8c(this,_dbe);\n});\n},getValue:function(jq){\nreturn jq.slider("options").value;\n},getValues:function(jq){\nreturn jq.slider("options").value;\n},setValue:function(jq,_dbf){\nreturn jq.each(function(){\n_da6(this,[_dbf]);\n});\n},setValues:function(jq,_dc0){\nreturn jq.each(function(){\n_da6(this,_dc0);\n});\n},clear:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).slider("options");\n_da6(this,opts.range?[opts.min,opts.max]:[opts.min]);\n});\n},reset:function(jq){\nreturn jq.each(function(){\nvar opts=$(this).slider("options");\n$(this).slider(opts.range?"setValues":"setValue",opts.originalValue);\n});\n},enable:function(jq){\nreturn jq.each(function(){\n$.data(this,"slider").options.disabled=false;\n_d99(this);\n});\n},disable:function(jq){\nreturn jq.each(function(){\n$.data(this,"slider").options.disabled=true;\n_d99(this);\n});\n}};\n$.fn.slider.parseOptions=function(_dc1){\nvar t=$(_dc1);\nreturn $.extend({},$.parser.parseOptions(_dc1,["width","height","mode",{reversed:"boolean",showTip:"boolean",range:"boolean",min:"number",max:"number",step:"number"}]),{value:(t.val()||undefined),disabled:(t.attr("disabled")?true:undefined),rule:(t.attr("rule")?eval(t.attr("rule")):undefined)});\n};\n$.fn.slider.defaults={width:"auto",height:"auto",mode:"h",reversed:false,showTip:false,disabled:false,range:false,value:0,separator:",",min:0,max:100,step:1,rule:[],tipFormatter:function(_dc2){\nreturn _dc2;\n},converter:{toPosition:function(_dc3,size){\nvar opts=$(this).slider("options");\nvar p=(_dc3-opts.min)/(opts.max-opts.min)*size;\nreturn p;\n},toValue:function(pos,size){\nvar opts=$(this).slider("options");\nvar v=opts.min+(opts.max-opts.min)*(pos/size);\nreturn v;\n}},onChange:function(_dc4,_dc5){\n},onSlideStart:function(_dc6){\n},onSlideEnd:function(_dc7){\n},onComplete:function(_dc8){\n}};\n})(jQuery);\n\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/jquery.easyui.min.js?')},"./src/assets/js/jquery-easyui/locale lazy recursive ^\\.\\/easyui\\-lang\\-.*\\.js$":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var map = {\n\t"./easyui-lang-af.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-af.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-af_js"\n\t],\n\t"./easyui-lang-am.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-am.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-am_js"\n\t],\n\t"./easyui-lang-ar.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-ar.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-ar_js"\n\t],\n\t"./easyui-lang-bg.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-bg.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-bg_js"\n\t],\n\t"./easyui-lang-ca.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-ca.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-ca_js"\n\t],\n\t"./easyui-lang-cs.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-cs.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-cs_js"\n\t],\n\t"./easyui-lang-cz.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-cz.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-cz_js"\n\t],\n\t"./easyui-lang-da.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-da.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-da_js"\n\t],\n\t"./easyui-lang-de.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-de.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-de_js"\n\t],\n\t"./easyui-lang-el.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-el.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-el_js"\n\t],\n\t"./easyui-lang-en.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-en.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-en_js"\n\t],\n\t"./easyui-lang-es.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-es.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-es_js"\n\t],\n\t"./easyui-lang-fa.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-fa.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-fa_js"\n\t],\n\t"./easyui-lang-fr.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-fr.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-fr_js"\n\t],\n\t"./easyui-lang-it.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-it.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-it_js"\n\t],\n\t"./easyui-lang-jp.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-jp.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-jp_js"\n\t],\n\t"./easyui-lang-ko.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-ko.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-ko_js"\n\t],\n\t"./easyui-lang-nl.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-nl.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-nl_js"\n\t],\n\t"./easyui-lang-pl.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-pl.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-pl_js"\n\t],\n\t"./easyui-lang-pt_BR.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-pt_BR.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-pt_BR_js"\n\t],\n\t"./easyui-lang-ru.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-ru.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-ru_js"\n\t],\n\t"./easyui-lang-sv_SE.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-sv_SE.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-sv_SE_js"\n\t],\n\t"./easyui-lang-tr.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-tr.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-tr_js"\n\t],\n\t"./easyui-lang-ua.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-ua.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-ua_js"\n\t],\n\t"./easyui-lang-zh_CN.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-zh_CN.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-zh_CN_js"\n\t],\n\t"./easyui-lang-zh_TW.js": [\n\t\t"./src/assets/js/jquery-easyui/locale/easyui-lang-zh_TW.js",\n\t\t"src_assets_js_jquery-easyui_locale_easyui-lang-zh_TW_js"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\t\te.code = \'MODULE_NOT_FOUND\';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 7 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = "./src/assets/js/jquery-easyui/locale lazy recursive ^\\\\.\\\\/easyui\\\\-lang\\\\-.*\\\\.js$";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/locale/_lazy_^\\.\\/easyui\\-lang\\-.*\\.js$_namespace_object?')},"./src/assets/js/jquery-easyui/themes lazy recursive ^\\.\\/.*\\/easyui\\.css$":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var map = {\n\t"./aguas/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/aguas/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_aguas_easyui_css"\n\t],\n\t"./black/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/black/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_black_easyui_css"\n\t],\n\t"./bootstrap/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/bootstrap/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_bootstrap_easyui_css"\n\t],\n\t"./default/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/default/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_default_easyui_css"\n\t],\n\t"./gray/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/gray/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_gray_easyui_css"\n\t],\n\t"./material-blue/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/material-blue/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_material-blue_easyui_css"\n\t],\n\t"./material-teal/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/material-teal/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_material-teal_easyui_css"\n\t],\n\t"./material/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/material/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_material_easyui_css"\n\t],\n\t"./metro/easyui.css": [\n\t\t"./src/assets/js/jquery-easyui/themes/metro/easyui.css",\n\t\t"src_assets_js_jquery-easyui_themes_metro_easyui_css"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\t\te.code = \'MODULE_NOT_FOUND\';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = "./src/assets/js/jquery-easyui/themes lazy recursive ^\\\\.\\\\/.*\\\\/easyui\\\\.css$";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-easyui/themes/_lazy_^\\.\\/.*\\/easyui\\.css$_namespace_object?')},"./src/assets/js/jquery-plugin/jquery.min.js":(module,exports,__webpack_require__)=>{eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*! jQuery v@1.8.0 jquery.com | jquery.org/license */\r\n(function(a,b){function G(a){var b=F[a]={};return p.each(a.split(s),function(a,c){b[c]=!0}),b}function J(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(I,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:+d+""===d?+d:H.test(d)?p.parseJSON(d):d}catch(f){}p.data(a,c,d)}else d=b}return d}function K(a){var b;for(b in a){if(b==="data"&&p.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function ba(){return!1}function bb(){return!0}function bh(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function bi(a,b){do a=a[b];while(a&&a.nodeType!==1);return a}function bj(a,b,c){b=b||0;if(p.isFunction(b))return p.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return p.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=p.grep(a,function(a){return a.nodeType===1});if(be.test(b))return p.filter(b,d,!c);b=p.filter(b,d)}return p.grep(a,function(a,d){return p.inArray(a,b)>=0===c})}function bk(a){var b=bl.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function bC(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function bD(a,b){if(b.nodeType!==1||!p.hasData(a))return;var c,d,e,f=p._data(a),g=p._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)p.event.add(b,c,h[c][d])}g.data&&(g.data=p.extend({},g.data))}function bE(a,b){var c;if(b.nodeType!==1)return;b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?(b.parentNode&&(b.outerHTML=a.outerHTML),p.support.html5Clone&&a.innerHTML&&!p.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):c==="input"&&bv.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(p.expando)}function bF(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bG(a){bv.test(a.type)&&(a.defaultChecked=a.checked)}function bX(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=bV.length;while(e--){b=bV[e]+c;if(b in a)return b}return d}function bY(a,b){return a=b||a,p.css(a,"display")==="none"||!p.contains(a.ownerDocument,a)}function bZ(a,b){var c,d,e=[],f=0,g=a.length;for(;f<g;f++){c=a[f];if(!c.style)continue;e[f]=p._data(c,"olddisplay"),b?(!e[f]&&c.style.display==="none"&&(c.style.display=""),c.style.display===""&&bY(c)&&(e[f]=p._data(c,"olddisplay",cb(c.nodeName)))):(d=bH(c,"display"),!e[f]&&d!=="none"&&p._data(c,"olddisplay",d))}for(f=0;f<g;f++){c=a[f];if(!c.style)continue;if(!b||c.style.display==="none"||c.style.display==="")c.style.display=b?e[f]||"":"none"}return a}function b$(a,b,c){var d=bO.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function b_(a,b,c,d){var e=c===(d?"border":"content")?4:b==="width"?1:0,f=0;for(;e<4;e+=2)c==="margin"&&(f+=p.css(a,c+bU[e],!0)),d?(c==="content"&&(f-=parseFloat(bH(a,"padding"+bU[e]))||0),c!=="margin"&&(f-=parseFloat(bH(a,"border"+bU[e]+"Width"))||0)):(f+=parseFloat(bH(a,"padding"+bU[e]))||0,c!=="padding"&&(f+=parseFloat(bH(a,"border"+bU[e]+"Width"))||0));return f}function ca(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=!0,f=p.support.boxSizing&&p.css(a,"boxSizing")==="border-box";if(d<=0){d=bH(a,b);if(d<0||d==null)d=a.style[b];if(bP.test(d))return d;e=f&&(p.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+b_(a,b,c||(f?"border":"content"),e)+"px"}function cb(a){if(bR[a])return bR[a];var b=p("<"+a+">").appendTo(e.body),c=b.css("display");b.remove();if(c==="none"||c===""){bI=e.body.appendChild(bI||p.extend(e.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!bJ||!bI.createElement)bJ=(bI.contentWindow||bI.contentDocument).document,bJ.write("<!doctype html><html><body>"),bJ.close();b=bJ.body.appendChild(bJ.createElement(a)),c=bH(b,"display"),e.body.removeChild(bI)}return bR[a]=c,c}function ch(a,b,c,d){var e;if(p.isArray(b))p.each(b,function(b,e){c||cd.test(a)?d(a,e):ch(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)});else if(!c&&p.type(b)==="object")for(e in b)ch(a+"["+e+"]",b[e],c,d);else d(a,b)}function cy(a){return function(b,c){typeof b!="string"&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(s),h=0,i=g.length;if(p.isFunction(c))for(;h<i;h++)d=g[h],f=/^\\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}function cz(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h,i=a[f],j=0,k=i?i.length:0,l=a===cu;for(;j<k&&(l||!h);j++)h=i[j](c,d,e),typeof h=="string"&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=cz(a,c,d,e,h,g)));return(l||!h)&&!g["*"]&&(h=cz(a,c,d,e,"*",g)),h}function cA(a,c){var d,e,f=p.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&p.extend(!0,a,e)}function cB(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k)f in d&&(c[k[f]]=d[f]);while(j[0]==="*")j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}if(g)return g!==j[0]&&j.unshift(g),d[g]}function cC(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;a.dataFilter&&(b=a.dataFilter(b,a.dataType));if(g[1])for(c in a.converters)i[c.toLowerCase()]=a.converters[c];for(;e=g[++j];)if(e!=="*"){if(h!=="*"&&h!==e){c=i[h+" "+e]||i["* "+e];if(!c)for(d in i){f=d.split(" ");if(f[1]===e){c=i[h+" "+f[0]]||i["* "+f[0]];if(c){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}}}if(c!==!0)if(c&&a["throws"])b=c(b);else try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}h=e}return{state:"success",data:b}}function cK(){try{return new a.XMLHttpRequest}catch(b){}}function cL(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function cT(){return setTimeout(function(){cM=b},0),cM=p.now()}function cU(a,b){p.each(b,function(b,c){var d=(cS[b]||[]).concat(cS["*"]),e=0,f=d.length;for(;e<f;e++)if(d[e].call(a,b,c))return})}function cV(a,b,c){var d,e=0,f=0,g=cR.length,h=p.Deferred().always(function(){delete i.elem}),i=function(){var b=cM||cT(),c=Math.max(0,j.startTime+j.duration-b),d=1-(c/j.duration||0),e=0,f=j.tweens.length;for(;e<f;e++)j.tweens[e].run(d);return h.notifyWith(a,[j,d,c]),d<1&&f?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:cM||cT(),duration:c.duration,tweens:[],createTween:function(b,c,d){var e=p.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(e),e},stop:function(b){var c=0,d=b?j.tweens.length:0;for(;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;cW(k,j.opts.specialEasing);for(;e<g;e++){d=cR[e].call(j,a,k,j.opts);if(d)return d}return cU(j,k),p.isFunction(j.opts.start)&&j.opts.start.call(a,j),p.fx.timer(p.extend(i,{anim:j,queue:j.opts.queue,elem:a})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function cW(a,b){var c,d,e,f,g;for(c in a){d=p.camelCase(c),e=b[d],f=a[c],p.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=p.cssHooks[d];if(g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}}function cX(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.style,n={},o=[],q=a.nodeType&&bY(a);c.queue||(j=p._queueHooks(a,"fx"),j.unqueued==null&&(j.unqueued=0,k=j.empty.fire,j.empty.fire=function(){j.unqueued||k()}),j.unqueued++,l.always(function(){l.always(function(){j.unqueued--,p.queue(a,"fx").length||j.empty.fire()})})),a.nodeType===1&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],p.css(a,"display")==="inline"&&p.css(a,"float")==="none"&&(!p.support.inlineBlockNeedsLayout||cb(a.nodeName)==="inline"?m.display="inline-block":m.zoom=1)),c.overflow&&(m.overflow="hidden",p.support.shrinkWrapBlocks||l.done(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b){f=b[d];if(cO.exec(f)){delete b[d];if(f===(q?"hide":"show"))continue;o.push(d)}}g=o.length;if(g){h=p._data(a,"fxshow")||p._data(a,"fxshow",{}),q?p(a).show():l.done(function(){p(a).hide()}),l.done(function(){var b;p.removeData(a,"fxshow",!0);for(b in n)p.style(a,b,n[b])});for(d=0;d<g;d++)e=o[d],i=l.createTween(e,q?h[e]:0),n[e]=h[e]||p.style(a,e),e in h||(h[e]=i.start,q&&(i.end=i.start,i.start=e==="width"||e==="height"?1:0))}}function cY(a,b,c,d,e){return new cY.prototype.init(a,b,c,d,e)}function cZ(a,b){var c,d={height:a},e=0;for(;e<4;e+=2-b)c=bU[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function c_(a){return p.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var c,d,e=a.document,f=a.location,g=a.navigator,h=a.jQuery,i=a.$,j=Array.prototype.push,k=Array.prototype.slice,l=Array.prototype.indexOf,m=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=String.prototype.trim,p=function(a,b){return new p.fn.init(a,b,c)},q=/[\\-+]?(?:\\d*\\.|)\\d+(?:[eE][\\-+]?\\d+|)/.source,r=/\\S/,s=/\\s+/,t=r.test(" ")?/^[\\s\\xA0]+|[\\s\\xA0]+$/g:/^\\s+|\\s+$/g,u=/^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/,v=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,w=/^[\\],:{}\\s]*$/,x=/(?:^|:|,)(?:\\s*\\[)+/g,y=/\\\\(?:["\\\\\\/bfnrt]|u[\\da-fA-F]{4})/g,z=/"[^"\\\\\\r\\n]*"|true|false|null|-?(?:\\d\\d*\\.|)\\d+(?:[eE][\\-+]?\\d+|)/g,A=/^-ms-/,B=/-([\\da-z])/gi,C=function(a,b){return(b+"").toUpperCase()},D=function(){e.addEventListener?(e.removeEventListener("DOMContentLoaded",D,!1),p.ready()):e.readyState==="complete"&&(e.detachEvent("onreadystatechange",D),p.ready())},E={};p.fn=p.prototype={constructor:p,init:function(a,c,d){var f,g,h,i;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(typeof a=="string"){a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?f=[null,a,null]:f=u.exec(a);if(f&&(f[1]||!c)){if(f[1])return c=c instanceof p?c[0]:c,i=c&&c.nodeType?c.ownerDocument||c:e,a=p.parseHTML(f[1],i,!0),v.test(f[1])&&p.isPlainObject(c)&&this.attr.call(a,c,!0),p.merge(this,a);g=e.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2])return d.find(a);this.length=1,this[0]=g}return this.context=e,this.selector=a,this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return p.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),p.makeArray(a,this))},selector:"",jquery:"1.8.0",length:0,size:function(){return this.length},toArray:function(){return k.call(this)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=p.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return p.each(this,a,b)},ready:function(a){return p.ready.promise().done(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:j,sort:[].sort,splice:[].splice},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!p.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++)if((a=arguments[i])!=null)for(c in a){d=h[c],e=a[c];if(h===e)continue;k&&e&&(p.isPlainObject(e)||(f=p.isArray(e)))?(f?(f=!1,g=d&&p.isArray(d)?d:[]):g=d&&p.isPlainObject(d)?d:{},h[c]=p.extend(k,g,e)):e!==b&&(h[c]=e)}return h},p.extend({noConflict:function(b){return a.$===p&&(a.$=i),b&&a.jQuery===p&&(a.jQuery=h),p},isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:p.ready(!0)},ready:function(a){if(a===!0?--p.readyWait:p.isReady)return;if(!e.body)return setTimeout(p.ready,1);p.isReady=!0;if(a!==!0&&--p.readyWait>0)return;d.resolveWith(e,[p]),p.fn.trigger&&p(e).trigger("ready").off("ready")},isFunction:function(a){return p.type(a)==="function"},isArray:Array.isArray||function(a){return p.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):E[m.call(a)]||"object"},isPlainObject:function(a){if(!a||p.type(a)!=="object"||a.nodeType||p.isWindow(a))return!1;try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||n.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return!a||typeof a!="string"?null:(typeof b=="boolean"&&(c=b,b=0),b=b||e,(d=v.exec(a))?[b.createElement(d[1])]:(d=p.buildFragment([a],b,c?null:[]),p.merge([],(d.cacheable?p.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||typeof b!="string")return null;b=p.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(w.test(b.replace(y,"@").replace(z,"]").replace(x,"")))return(new Function("return "+b))();p.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||typeof c!="string")return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&r.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(A,"ms-").replace(B,C)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||p.isFunction(a);if(d){if(h){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;f<g;)if(c.apply(a[f++],d)===!1)break}else if(h){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(;f<g;)if(c.call(a[f],f,a[f++])===!1)break;return a},trim:o?function(a){return a==null?"":o.call(a)}:function(a){return a==null?"":a.toString().replace(t,"")},makeArray:function(a,b){var c,d=b||[];return a!=null&&(c=p.type(a),a.length==null||c==="string"||c==="function"||c==="regexp"||p.isWindow(a)?j.call(d,a):p.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(l)return l.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if(typeof d=="number")for(;f<d;f++)a[e++]=c[f];else while(c[f]!==b)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;c=!!c;for(;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof p||i!==b&&typeof i=="number"&&(i>0&&a[0]&&a[i-1]||i===0||p.isArray(a));if(j)for(;h<i;h++)e=c(a[h],h,d),e!=null&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),e!=null&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return typeof c=="string"&&(d=a[c],c=a,a=d),p.isFunction(a)?(e=k.call(arguments,2),f=function(){return a.apply(c,e.concat(k.call(arguments)))},f.guid=a.guid=a.guid||f.guid||p.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=d==null,k=0,l=a.length;if(d&&typeof d=="object"){for(k in d)p.access(a,c,k,d[k],1,g,e);f=1}else if(e!==b){i=h===b&&p.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(p(a),c)}):(c.call(a,e),c=null));if(c)for(;k<l;k++)c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h);f=1}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),p.ready.promise=function(b){if(!d){d=p.Deferred();if(e.readyState==="complete"||e.readyState!=="loading"&&e.addEventListener)setTimeout(p.ready,1);else if(e.addEventListener)e.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",p.ready,!1);else{e.attachEvent("onreadystatechange",D),a.attachEvent("onload",p.ready);var c=!1;try{c=a.frameElement==null&&e.documentElement}catch(f){}c&&c.doScroll&&function g(){if(!p.isReady){try{c.doScroll("left")}catch(a){return setTimeout(g,50)}p.ready()}}()}}return d.promise(b)},p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){E["[object "+b+"]"]=b.toLowerCase()}),c=p(e);var F={};p.Callbacks=function(a){a=typeof a=="string"?F[a]||G(a):p.extend({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],k=function(b){c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;for(;i&&h<g;h++)if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var b=i.length;(function d(b){p.each(b,function(b,c){p.isFunction(c)&&(!a.unique||!l.has(c))?i.push(c):c&&c.length&&d(c)})})(arguments),e?g=i.length:c&&(f=b,k(c))}return this},remove:function(){return i&&p.each(arguments,function(a,b){var c;while((c=p.inArray(b,i,c))>-1)i.splice(c,1),e&&(c<=g&&g--,c<=h&&h--)}),this},has:function(a){return p.inArray(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return!i},lock:function(){return j=b,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],i&&(!d||j)&&(e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},p.extend({Deferred:function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](p.isFunction(g)?function(){var a=g.apply(this,arguments);a&&p.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return typeof a=="object"?p.extend(a,d):d}},e={};return d.pipe=d.then,p.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=k.call(arguments),d=c.length,e=d!==1||a&&p.isFunction(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?k.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(d>1){h=new Array(d),i=new Array(d),j=new Array(d);for(;b<d;b++)c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}return e||f.resolveWith(j,c),f.promise()}}),p.support=function(){var b,c,d,f,g,h,i,j,k,l,m,n=e.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href=\'/a\'>a</a><input type=\'checkbox\'/>",c=n.getElementsByTagName("*"),d=n.getElementsByTagName("a")[0],d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length||!d)return{};f=e.createElement("select"),g=f.appendChild(e.createElement("option")),h=n.getElementsByTagName("input")[0],b={leadingWhitespace:n.firstChild.nodeType===3,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:n.className!=="t",enctype:!!e.createElement("form").enctype,html5Clone:e.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:e.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},h.checked=!0,b.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled;try{delete n.test}catch(o){b.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",m=function(){b.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",m)),h=e.createElement("input"),h.value="t",h.setAttribute("type","radio"),b.radioValue=h.value==="t",h.setAttribute("checked","checked"),h.setAttribute("name","t"),n.appendChild(h),i=e.createDocumentFragment(),i.appendChild(n.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=h.checked,i.removeChild(h),i.appendChild(n);if(n.attachEvent)for(k in{submit:!0,change:!0,focusin:!0})j="on"+k,l=j in n,l||(n.setAttribute(j,"return;"),l=typeof n[j]=="function"),b[k+"Bubbles"]=l;return p(function(){var c,d,f,g,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",i=e.getElementsByTagName("body")[0];if(!i)return;c=e.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",i.insertBefore(c,i.firstChild),d=e.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",l=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=l&&f[0].offsetHeight===0,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=d.offsetWidth===4,b.doesNotIncludeMarginInBodyOffset=i.offsetTop!==1,a.getComputedStyle&&(b.pixelPosition=(a.getComputedStyle(d,null)||{}).top!=="1%",b.boxSizingReliable=(a.getComputedStyle(d,null)||{width:"4px"}).width==="4px",g=e.createElement("div"),g.style.cssText=d.style.cssText=h,g.style.marginRight=g.style.width="0",d.style.width="1px",d.appendChild(g),b.reliableMarginRight=!parseFloat((a.getComputedStyle(g,null)||{}).marginRight)),typeof d.style.zoom!="undefined"&&(d.innerHTML="",d.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=d.offsetWidth===3,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=d.offsetWidth!==3,c.style.zoom=1),i.removeChild(c),c=d=f=g=null}),i.removeChild(n),c=d=f=g=h=i=n=null,b}();var H=/^(?:\\{.*\\}|\\[.*\\])$/,I=/([A-Z])/g;p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?p.cache[a[p.expando]]:a[p.expando],!!a&&!K(a)},data:function(a,c,d,e){if(!p.acceptData(a))return;var f,g,h=p.expando,i=typeof c=="string",j=a.nodeType,k=j?p.cache:a,l=j?a[h]:a[h]&&h;if((!l||!k[l]||!e&&!k[l].data)&&i&&d===b)return;l||(j?a[h]=l=p.deletedIds.pop()||++p.uuid:l=h),k[l]||(k[l]={},j||(k[l].toJSON=p.noop));if(typeof c=="object"||typeof c=="function")e?k[l]=p.extend(k[l],c):k[l].data=p.extend(k[l].data,c);return f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[p.camelCase(c)]=d),i?(g=f[c],g==null&&(g=f[p.camelCase(c)])):g=f,g},removeData:function(a,b,c){if(!p.acceptData(a))return;var d,e,f,g=a.nodeType,h=g?p.cache:a,i=g?a[p.expando]:p.expando;if(!h[i])return;if(b){d=c?h[i]:h[i].data;if(d){p.isArray(b)||(b in d?b=[b]:(b=p.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++)delete d[b[e]];if(!(c?K:p.isEmptyObject)(d))return}}if(!c){delete h[i].data;if(!K(h[i]))return}g?p.cleanData([a],!0):p.support.deleteExpando||h!=h.window?delete h[i]:h[i]=null},_data:function(a,b,c){return p.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&p.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),p.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length){k=p.data(i);if(i.nodeType===1&&!p._data(i,"parsedAttrs")){f=i.attributes;for(h=f.length;j<h;j++)g=f[j].name,g.indexOf("data-")===0&&(g=p.camelCase(g.substring(5)),J(i,g,k[g]));p._data(i,"parsedAttrs",!0)}}return k}return typeof a=="object"?this.each(function(){p.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",p.access(this,function(c){if(c===b)return k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=p.data(i,a),k=J(i,a,k)),k===b&&d[1]?this.data(d[0]):k;d[1]=c,this.each(function(){var b=p(this);b.triggerHandler("setData"+e,d),p.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){p.removeData(this,a)})}}),p.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=p._data(a,b),c&&(!d||p.isArray(c)?d=p._data(a,b,p.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.shift(),e=p._queueHooks(a,b),f=function(){p.dequeue(a,b)};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),delete e.stop,d.call(a,f,e)),!c.length&&e&&e.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return p._data(a,c)||p._data(a,c,{empty:p.Callbacks("once memory").add(function(){p.removeData(a,b+"queue",!0),p.removeData(a,c,!0)})})}}),p.fn.extend({queue:function(a,c){var d=2;return typeof a!="string"&&(c=a,a="fx",d--),arguments.length<d?p.queue(this[0],a):c===b?this:this.each(function(){var b=p.queue(this,a,c);p._queueHooks(this,a),a==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},delay:function(a,b){return a=p.fx?p.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=p.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};typeof a!="string"&&(c=a,a=b),a=a||"fx";while(h--)(d=p._data(g[h],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var L,M,N,O=/[\\t\\r\\n]/g,P=/\\r/g,Q=/^(?:button|input)$/i,R=/^(?:button|input|object|select|textarea)$/i,S=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,U=p.support.getSetAttribute;p.fn.extend({attr:function(a,b){return p.access(this,p.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})},prop:function(a,b){return p.access(this,p.prop,a,b,arguments.length>1)},removeProp:function(a){return a=p.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(p.isFunction(a))return this.each(function(b){p(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(s);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=p.trim(f)}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(p.isFunction(a))return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(s);for(h=0,i=this.length;h<i;h++){e=this[h];if(e.nodeType===1&&e.className){d=(" "+e.className+" ").replace(O," ");for(f=0,g=c.length;f<g;f++)while(d.indexOf(" "+c[f]+" ")>-1)d=d.replace(" "+c[f]+" "," ");e.className=a?p.trim(d):""}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=p(this),h=b,i=a.split(s);while(e=i[f++])h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&p._data(this,"__className__",this.className),this.className=this.className||a===!1?"":p._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(O," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f)return c=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(P,""):d==null?"":d);return}return e=p.isFunction(a),this.each(function(d){var f,g=p(this);if(this.nodeType!==1)return;e?f=a.call(this,d,g.val()):f=a,f==null?f="":typeof f=="number"?f+="":p.isArray(f)&&(f=p.map(f,function(a){return a==null?"":a+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,f,"value")===b)this.value=f})}}),p.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0)return null;c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(p.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!p.nodeName(e.parentNode,"optgroup"))){b=p(e).val();if(i)return b;g.push(b)}}return i&&!g.length&&h.length?p(h[f]).val():g},set:function(a,b){var c=p.makeArray(b);return p(a).find("option").each(function(){this.selected=p.inArray(p(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2)return;if(e&&p.isFunction(p.fn[c]))return p(a)[c](d);if(typeof a.getAttribute=="undefined")return p.prop(a,c,d);h=i!==1||!p.isXMLDoc(a),h&&(c=c.toLowerCase(),g=p.attrHooks[c]||(T.test(c)?M:L));if(d!==b){if(d===null){p.removeAttr(a,c);return}return g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d)}return g&&"get"in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.split(s);for(;g<d.length;g++)e=d[g],e&&(c=p.propFix[e]||e,f=T.test(e),f||p.attr(a,e,""),a.removeAttribute(U?e:c),f&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(Q.test(a.nodeName)&&a.parentNode)p.error("type property can\'t be changed");else if(!p.support.radioValue&&b==="radio"&&p.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return L&&p.nodeName(a,"button")?L.get(a,b):b in a?a.value:null},set:function(a,b,c){if(L&&p.nodeName(a,"button"))return L.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!a||h===3||h===8||h===2)return;return g=h!==1||!p.isXMLDoc(a),g&&(c=p.propFix[c]||c,f=p.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b}}}}),M={get:function(a,c){var d,e=p.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?p.removeAttr(a,c):(d=p.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},U||(N={name:!0,id:!0,coords:!0},L=p.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(N[c]?d.value!=="":d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=e.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},p.each(["width","height"],function(a,b){p.attrHooks[b]=p.extend(p.attrHooks[b],{set:function(a,c){if(c==="")return a.setAttribute(b,"auto"),c}})}),p.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false"),L.set(a,b,c)}}),p.support.hrefNormalized||p.each(["href","src","width","height"],function(a,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),p.support.style||(p.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),p.support.enctype||(p.propFix.enctype="encoding"),p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],{set:function(a,b){if(p.isArray(b))return a.checked=p.inArray(p(a).val(),b)>=0}})});var V=/^(?:textarea|input|select)$/i,W=/^([^\\.]*|)(?:\\.(.+)|)$/,X=/(?:^|\\s)hover(\\.\\S+|)\\b/,Y=/^key/,Z=/^(?:mouse|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=function(a){return p.event.special.hover?a:a.replace(X,"mouseenter$1 mouseleave$1")};p.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r;if(a.nodeType===3||a.nodeType===8||!c||!d||!(g=p._data(a)))return;d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=p.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof p!="undefined"&&(!a||p.event.triggered!==a.type)?p.event.dispatch.apply(h.elem,arguments):b},h.elem=a),c=p.trim(_(c)).split(" ");for(j=0;j<c.length;j++){k=W.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=p.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=p.event.special[l]||{},n=p.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1)a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),p.event.global[l]=!0}a=null},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,q,r=p.hasData(a)&&p._data(a);if(!r||!(m=r.events))return;b=p.trim(_(b||"")).split(" ");for(f=0;f<b.length;f++){g=W.exec(b[f])||[],h=i=g[1],j=g[2];if(!h){for(h in m)p.event.remove(a,h+b[f],c,d,!0);continue}n=p.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\\\.)"+j.split(".").sort().join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"):null;for(l=0;l<o.length;l++)q=o[l],(e||i===q.origType)&&(!c||c.guid===q.guid)&&(!j||j.test(q.namespace))&&(!d||d===q.selector||d==="**"&&q.selector)&&(o.splice(l--,1),q.selector&&o.delegateCount--,n.remove&&n.remove.call(a,q));o.length===0&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,r.handle)===!1)&&p.removeEvent(a,h,r.handle),delete m[h])}p.isEmptyObject(m)&&(delete r.handle,p.removeData(a,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,g){if(!f||f.nodeType!==3&&f.nodeType!==8){var h,i,j,k,l,m,n,o,q,r,s=c.type||c,t=[];if($.test(s+p.event.triggered))return;s.indexOf("!")>=0&&(s=s.slice(0,-1),i=!0),s.indexOf(".")>=0&&(t=s.split("."),s=t.shift(),t.sort());if((!f||p.event.customEvent[s])&&!p.event.global[s])return;c=typeof c=="object"?c[p.expando]?c:new p.Event(s,c):new p.Event(s),c.type=s,c.isTrigger=!0,c.exclusive=i,c.namespace=t.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\\\.)"+t.join("\\\\.(?:.*\\\\.|)")+"(\\\\.|$)"):null,m=s.indexOf(":")<0?"on"+s:"";if(!f){h=p.cache;for(j in h)h[j].events&&h[j].events[s]&&p.event.trigger(c,d,h[j].handle.elem,!0);return}c.result=b,c.target||(c.target=f),d=d!=null?p.makeArray(d):[],d.unshift(c),n=p.event.special[s]||{};if(n.trigger&&n.trigger.apply(f,d)===!1)return;q=[[f,n.bindType||s]];if(!g&&!n.noBubble&&!p.isWindow(f)){r=n.delegateType||s,k=$.test(r+s)?f:f.parentNode;for(l=f;k;k=k.parentNode)q.push([k,r]),l=k;l===(f.ownerDocument||e)&&q.push([l.defaultView||l.parentWindow||a,r])}for(j=0;j<q.length&&!c.isPropagationStopped();j++)k=q[j][0],c.type=q[j][1],o=(p._data(k,"events")||{})[c.type]&&p._data(k,"handle"),o&&o.apply(k,d),o=m&&k[m],o&&p.acceptData(k)&&o.apply(k,d)===!1&&c.preventDefault();return c.type=s,!g&&!c.isDefaultPrevented()&&(!n._default||n._default.apply(f.ownerDocument,d)===!1)&&(s!=="click"||!p.nodeName(f,"a"))&&p.acceptData(f)&&m&&f[s]&&(s!=="focus"&&s!=="blur"||c.target.offsetWidth!==0)&&!p.isWindow(f)&&(l=f[m],l&&(f[m]=null),p.event.triggered=s,f[s](),p.event.triggered=b,l&&(f[m]=l)),c.result}return},dispatch:function(c){c=p.event.fix(c||a.event);var d,e,f,g,h,i,j,k,l,m,n,o=(p._data(this,"events")||{})[c.type]||[],q=o.delegateCount,r=[].slice.call(arguments),s=!c.exclusive&&!c.namespace,t=p.event.special[c.type]||{},u=[];r[0]=c,c.delegateTarget=this;if(t.preDispatch&&t.preDispatch.call(this,c)===!1)return;if(q&&(!c.button||c.type!=="click")){g=p(this),g.context=this;for(f=c.target;f!=this;f=f.parentNode||this)if(f.disabled!==!0||c.type!=="click"){i={},k=[],g[0]=f;for(d=0;d<q;d++)l=o[d],m=l.selector,i[m]===b&&(i[m]=g.is(m)),i[m]&&k.push(l);k.length&&u.push({elem:f,matches:k})}}o.length>q&&u.push({elem:this,matches:o.slice(q)});for(d=0;d<u.length&&!c.isPropagationStopped();d++){j=u[d],c.currentTarget=j.elem;for(e=0;e<j.matches.length&&!c.isImmediatePropagationStopped();e++){l=j.matches[e];if(s||!c.namespace&&!l.namespace||c.namespace_re&&c.namespace_re.test(l.namespace))c.data=l.data,c.handleObj=l,h=((p.event.special[l.origType]||{}).handle||l.handler).apply(j.elem,r),h!==b&&(c.result=h,h===!1&&(c.preventDefault(),c.stopPropagation()))}}return t.postDispatch&&t.postDispatch.call(this,c),c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,f,g,h=c.button,i=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||e,f=d.documentElement,g=d.body,a.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?c.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[p.expando])return a;var b,c,d=a,f=p.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=p.Event(d);for(b=g.length;b;)c=g[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||e),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,d):a},special:{ready:{setup:p.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){p.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(e,null,b):p.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},p.event.handle=p.event.dispatch,p.removeEvent=e.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]=="undefined"&&(a[d]=null),a.detachEvent(d,c))},p.Event=function(a,b){if(this instanceof p.Event)a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?bb:ba):this.type=a,b&&p.extend(this,b),this.timeStamp=a&&a.timeStamp||p.now(),this[p.expando]=!0;else return new p.Event(a,b)},p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=bb;var a=this.originalEvent;if(!a)return;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=bb;var a=this.originalEvent;if(!a)return;a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()},isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj,g=f.selector;if(!e||e!==d&&!p.contains(d,e))a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b;return c}}}),p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form"))return!1;p.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=p.nodeName(c,"input")||p.nodeName(c,"button")?c.form:b;d&&!p._data(d,"_submit_attached")&&(p.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),p._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&p.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(p.nodeName(this,"form"))return!1;p.event.remove(this,"._submit")}}),p.support.changeBubbles||(p.event.special.change={setup:function(){if(V.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")p.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,a,!0)});return!1}p.event.add(this,"beforeactivate._change",function(a){var b=a.target;V.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&p.event.simulate("change",this.parentNode,a,!0)}),p._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return p.event.remove(this,"._change"),V.test(this.nodeName)}}),p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){c++===0&&e.addEventListener(a,d,!0)},teardown:function(){--c===0&&e.removeEventListener(a,d,!0)}}}),p.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=ba;else if(!e)return this;return f===1&&(g=e,e=function(a){return p().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=p.guid++)),this.each(function(){p.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,p(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if(typeof a=="object"){for(f in a)this.off(f,c,a[f]);return this}if(c===!1||typeof c=="function")d=c,c=b;return d===!1&&(d=ba),this.each(function(){p.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return p(this.context).on(a,this.selector,b,c),this},die:function(a,b){return p(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return p.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||p.guid++,d=0,e=function(c){var e=(p._data(this,"lastToggle"+a.guid)||0)%d;return p._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Y.test(b)&&(p.event.fixHooks[b]=p.event.keyHooks),Z.test(b)&&(p.event.fixHooks[b]=p.event.mouseHooks)}),function(a,b){function bd(a,b,c,d){var e=0,f=b.length;for(;e<f;e++)Z(a,b[e],c,d)}function be(a,b,c,d,e,f){var g,h=$.setFilters[b.toLowerCase()];return h||Z.error(b),(a||!(g=e))&&bd(a||"*",d,g=[],e),g.length>0?h(g,c,f):[]}function bf(a,c,d,e,f){var g,h,i,j,k,l,m,n,p=0,q=f.length,s=L.POS,t=new RegExp("^"+s.source+"(?!"+r+")","i"),u=function(){var a=1,c=arguments.length-2;for(;a<c;a++)arguments[a]===b&&(g[a]=b)};for(;p<q;p++){s.exec(""),a=f[p],j=[],i=0,k=e;while(g=s.exec(a)){n=s.lastIndex=g.index+g[0].length;if(n>i){m=a.slice(i,g.index),i=n,l=[c],B.test(m)&&(k&&(l=k),k=e);if(h=H.test(m))m=m.slice(0,-5).replace(B,"$&*");g.length>1&&g[0].replace(t,u),k=be(m,g[1],g[2],l,k,h)}}k?(j=j.concat(k),(m=a.slice(i))&&m!==")"?B.test(m)?bd(m,j,d,e):Z(m,c,d,e?e.concat(k):k):o.apply(d,j)):Z(a,c,d,e)}return q===1?d:Z.uniqueSort(d)}function bg(a,b,c){var d,e,f,g=[],i=0,j=D.exec(a),k=!j.pop()&&!j.pop(),l=k&&a.match(C)||[""],m=$.preFilter,n=$.filter,o=!c&&b!==h;for(;(e=l[i])!=null&&k;i++){g.push(d=[]),o&&(e=" "+e);while(e){k=!1;if(j=B.exec(e))e=e.slice(j[0].length),k=d.push({part:j.pop().replace(A," "),captures:j});for(f in n)(j=L[f].exec(e))&&(!m[f]||(j=m[f](j,b,c)))&&(e=e.slice(j.shift().length),k=d.push({part:f,captures:j}));if(!k)break}}return k||Z.error(a),g}function bh(a,b,e){var f=b.dir,g=m++;return a||(a=function(a){return a===e}),b.first?function(b,c){while(b=b[f])if(b.nodeType===1)return a(b,c)&&b}:function(b,e){var h,i=g+"."+d,j=i+"."+c;while(b=b[f])if(b.nodeType===1){if((h=b[q])===j)return b.sizset;if(typeof h=="string"&&h.indexOf(i)===0){if(b.sizset)return b}else{b[q]=j;if(a(b,e))return b.sizset=!0,b;b.sizset=!1}}}}function bi(a,b){return a?function(c,d){var e=b(c,d);return e&&a(e===!0?c:e,d)}:b}function bj(a,b,c){var d,e,f=0;for(;d=a[f];f++)$.relative[d.part]?e=bh(e,$.relative[d.part],b):(d.captures.push(b,c),e=bi(e,$.filter[d.part].apply(null,d.captures)));return e}function bk(a){return function(b,c){var d,e=0;for(;d=a[e];e++)if(d(b,c))return!0;return!1}}var c,d,e,f,g,h=a.document,i=h.documentElement,j="undefined",k=!1,l=!0,m=0,n=[].slice,o=[].push,q=("sizcache"+Math.random()).replace(".",""),r="[\\\\x20\\\\t\\\\r\\\\n\\\\f]",s="(?:\\\\\\\\.|[-\\\\w]|[^\\\\x00-\\\\xa0])+",t=s.replace("w","w#"),u="([*^$|!~]?=)",v="\\\\["+r+"*("+s+")"+r+"*(?:"+u+r+"*(?:([\'\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|("+t+")|)|)"+r+"*\\\\]",w=":("+s+")(?:\\\\((?:([\'\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\2|((?:[^,]|\\\\\\\\,|(?:,(?=[^\\\\[]*\\\\]))|(?:,(?=[^\\\\(]*\\\\))))*))\\\\)|)",x=":(nth|eq|gt|lt|first|last|even|odd)(?:\\\\((\\\\d*)\\\\)|)(?=[^-]|$)",y=r+"*([\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])"+r+"*",z="(?=[^\\\\x20\\\\t\\\\r\\\\n\\\\f])(?:\\\\\\\\.|"+v+"|"+w.replace(2,7)+"|[^\\\\\\\\(),])+",A=new RegExp("^"+r+"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)"+r+"+$","g"),B=new RegExp("^"+y),C=new RegExp(z+"?(?="+r+"*,|$)","g"),D=new RegExp("^(?:(?!,)(?:(?:^|,)"+r+"*"+z+")*?|"+r+"*(.*?))(\\\\)|$)"),E=new RegExp(z.slice(19,-6)+"\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])+|"+y,"g"),F=/^(?:#([\\w\\-]+)|(\\w+)|\\.([\\w\\-]+))$/,G=/[\\x20\\t\\r\\n\\f]*[+~]/,H=/:not\\($/,I=/h\\d/i,J=/input|select|textarea|button/i,K=/\\\\(?!\\\\)/g,L={ID:new RegExp("^#("+s+")"),CLASS:new RegExp("^\\\\.("+s+")"),NAME:new RegExp("^\\\\[name=[\'\\"]?("+s+")[\'\\"]?\\\\]"),TAG:new RegExp("^("+s.replace("[-","[-\\\\*")+")"),ATTR:new RegExp("^"+v),PSEUDO:new RegExp("^"+w),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\\\("+r+"*(even|odd|(([+-]|)(\\\\d*)n|)"+r+"*(?:([+-]|)"+r+"*(\\\\d+)|))"+r+"*\\\\)|)","i"),POS:new RegExp(x,"ig"),needsContext:new RegExp("^"+r+"*[>+~]|"+x,"i")},M={},N=[],O={},P=[],Q=function(a){return a.sizzleFilter=!0,a},R=function(a){return function(b){return b.nodeName.toLowerCase()==="input"&&b.type===a}},S=function(a){return function(b){var c=b.nodeName.toLowerCase();return(c==="input"||c==="button")&&b.type===a}},T=function(a){var b=!1,c=h.createElement("div");try{b=a(c)}catch(d){}return c=null,b},U=T(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return b!=="boolean"&&b!=="string"}),V=T(function(a){a.id=q+0,a.innerHTML="<a name=\'"+q+"\'></a><div name=\'"+q+"\'></div>",i.insertBefore(a,i.firstChild);var b=h.getElementsByName&&h.getElementsByName(q).length===2+h.getElementsByName(q+0).length;return g=!h.getElementById(q),i.removeChild(a),b}),W=T(function(a){return a.appendChild(h.createComment("")),a.getElementsByTagName("*").length===0}),X=T(function(a){return a.innerHTML="<a href=\'#\'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==j&&a.firstChild.getAttribute("href")==="#"}),Y=T(function(a){return a.innerHTML="<div class=\'hidden e\'></div><div class=\'hidden\'></div>",!a.getElementsByClassName||a.getElementsByClassName("e").length===0?!1:(a.lastChild.className="e",a.getElementsByClassName("e").length!==1)}),Z=function(a,b,c,d){c=c||[],b=b||h;var e,f,g,i,j=b.nodeType;if(j!==1&&j!==9)return[];if(!a||typeof a!="string")return c;g=ba(b);if(!g&&!d)if(e=F.exec(a))if(i=e[1]){if(j===9){f=b.getElementById(i);if(!f||!f.parentNode)return c;if(f.id===i)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(i))&&bb(b,f)&&f.id===i)return c.push(f),c}else{if(e[2])return o.apply(c,n.call(b.getElementsByTagName(a),0)),c;if((i=e[3])&&Y&&b.getElementsByClassName)return o.apply(c,n.call(b.getElementsByClassName(i),0)),c}return bm(a,b,c,d,g)},$=Z.selectors={cacheLength:50,match:L,order:["ID","TAG"],attrHandle:{},createPseudo:Q,find:{ID:g?function(a,b,c){if(typeof b.getElementById!==j&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==j&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==j&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:W?function(a,b){if(typeof b.getElementsByTagName!==j)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if(a==="*"){var d,e=[],f=0;for(;d=c[f];f++)d.nodeType===1&&e.push(d);return e}return c}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(K,""),a[3]=(a[4]||a[5]||"").replace(K,""),a[2]==="~="&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),a[1]==="nth"?(a[2]||Z.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*(a[2]==="even"||a[2]==="odd")),a[4]=+(a[6]+a[7]||a[2]==="odd")):a[2]&&Z.error(a[0]),a},PSEUDO:function(a){var b,c=a[4];return L.CHILD.test(a[0])?null:(c&&(b=D.exec(c))&&b.pop()&&(a[0]=a[0].slice(0,b[0].length-c.length-1),c=b[0].slice(0,-1)),a.splice(2,3,c||a[3]),a)}},filter:{ID:g?function(a){return a=a.replace(K,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(K,""),function(b){var c=typeof b.getAttributeNode!==j&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return a==="*"?function(){return!0}:(a=a.replace(K,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=M[a];return b||(b=M[a]=new RegExp("(^|"+r+")"+a+"("+r+"|$)"),N.push(a),N.length>$.cacheLength&&delete M[N.shift()]),function(a){return b.test(a.className||typeof a.getAttribute!==j&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){var e=Z.attr(d,a),f=e+"";if(e==null)return b==="!=";switch(b){case"=":return f===c;case"!=":return f!==c;case"^=":return c&&f.indexOf(c)===0;case"*=":return c&&f.indexOf(c)>-1;case"$=":return c&&f.substr(f.length-c.length)===c;case"~=":return(" "+f+" ").indexOf(c)>-1;case"|=":return f===c||f.substr(0,c.length+1)===c+"-"}}:function(b){return Z.attr(b,a)!=null}},CHILD:function(a,b,c,d){if(a==="nth"){var e=m++;return function(a){var b,f,g=0,h=a;if(c===1&&d===0)return!0;b=a.parentNode;if(b&&(b[q]!==e||!a.sizset)){for(h=b.firstChild;h;h=h.nextSibling)if(h.nodeType===1){h.sizset=++g;if(h===a)break}b[q]=e}return f=a.sizset-d,c===0?f===0:f%c===0&&f/c>=0}}return function(b){var c=b;switch(a){case"only":case"first":while(c=c.previousSibling)if(c.nodeType===1)return!1;if(a==="first")return!0;c=b;case"last":while(c=c.nextSibling)if(c.nodeType===1)return!1;return!0}}},PSEUDO:function(a,b,c,d){var e=$.pseudos[a]||$.pseudos[a.toLowerCase()];return e||Z.error("unsupported pseudo: "+a),e.sizzleFilter?e(b,c,d):e}},pseudos:{not:Q(function(a,b,c){var d=bl(a.replace(A,"$1"),b,c);return function(a){return!d(a)}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&!!a.checked||b==="option"&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!$.pseudos.empty(a)},empty:function(a){var b;a=a.firstChild;while(a){if(a.nodeName>"@"||(b=a.nodeType)===3||b===4)return!1;a=a.nextSibling}return!0},contains:Q(function(a){return function(b){return(b.textContent||b.innerText||bc(b)).indexOf(a)>-1}}),has:Q(function(a){return function(b){return Z(a,b).length>0}}),header:function(a){return I.test(a.nodeName)},text:function(a){var b,c;return a.nodeName.toLowerCase()==="input"&&(b=a.type)==="text"&&((c=a.getAttribute("type"))==null||c.toLowerCase()===b)},radio:R("radio"),checkbox:R("checkbox"),file:R("file"),password:R("password"),image:R("image"),submit:S("submit"),reset:S("reset"),button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&a.type==="button"||b==="button"},input:function(a){return J.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){var d=a.pop();return c?a:[d]},even:function(a,b,c){var d=[],e=c?1:0,f=a.length;for(;e<f;e=e+2)d.push(a[e]);return d},odd:function(a,b,c){var d=[],e=c?0:1,f=a.length;for(;e<f;e=e+2)d.push(a[e]);return d},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){var d=a.splice(+b,1);return c?a:d}}};$.setFilters.nth=$.setFilters.eq,$.filters=$.pseudos,X||($.attrHandle={href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}}),V&&($.order.push("NAME"),$.find.NAME=function(a,b){if(typeof b.getElementsByName!==j)return b.getElementsByName(a)}),Y&&($.order.splice(1,0,"CLASS"),$.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!==j&&!c)return b.getElementsByClassName(a)});try{n.call(i.childNodes,0)[0].nodeType}catch(_){n=function(a){var b,c=[];for(;b=this[a];a++)c.push(b);return c}}var ba=Z.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=="HTML":!1},bb=Z.contains=i.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:i.contains?function(a,b){var c=a.nodeType===9?a.documentElement:a,d=b.parentNode;return a===d||!!(d&&d.nodeType===1&&c.contains&&c.contains(d))}:function(a,b){while(b=b.parentNode)if(b===a)return!0;return!1},bc=Z.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(e===1||e===9||e===11){if(typeof a.textContent=="string")return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=bc(a)}else if(e===3||e===4)return a.nodeValue}else for(;b=a[d];d++)c+=bc(b);return c};Z.attr=function(a,b){var c,d=ba(a);return d||(b=b.toLowerCase()),$.attrHandle[b]?$.attrHandle[b](a):U||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?typeof a[b]=="boolean"?a[b]?b:null:c.specified?c.value:null:null)},Z.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},[0,0].sort(function(){return l=0}),i.compareDocumentPosition?e=function(a,b){return a===b?(k=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:(e=function(a,b){if(a===b)return k=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],g=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return f(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)g.unshift(j),j=j.parentNode;c=e.length,d=g.length;for(var l=0;l<c&&l<d;l++)if(e[l]!==g[l])return f(e[l],g[l]);return l===c?f(a,g[l],-1):f(e[l],b,1)},f=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),Z.uniqueSort=function(a){var b,c=1;if(e){k=l,a.sort(e);if(k)for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1)}return a};var bl=Z.compile=function(a,b,c){var d,e,f,g=O[a];if(g&&g.context===b)return g;e=bg(a,b,c);for(f=0;d=e[f];f++)e[f]=bj(d,b,c);return g=O[a]=bk(e),g.context=b,g.runs=g.dirruns=0,P.push(a),P.length>$.cacheLength&&delete O[P.shift()],g};Z.matches=function(a,b){return Z(a,null,null,b)},Z.matchesSelector=function(a,b){return Z(b,null,null,[a]).length>0};var bm=function(a,b,e,f,g){a=a.replace(A,"$1");var h,i,j,k,l,m,p,q,r,s=a.match(C),t=a.match(E),u=b.nodeType;if(L.POS.test(a))return bf(a,b,e,f,s);if(f)h=n.call(f,0);else if(s&&s.length===1){if(t.length>1&&u===9&&!g&&(s=L.ID.exec(t[0]))){b=$.find.ID(s[1],b,g)[0];if(!b)return e;a=a.slice(t.shift().length)}q=(s=G.exec(t[0]))&&!s.index&&b.parentNode||b,r=t.pop(),m=r.split(":not")[0];for(j=0,k=$.order.length;j<k;j++){p=$.order[j];if(s=L[p].exec(m)){h=$.find[p]((s[1]||"").replace(K,""),q,g);if(h==null)continue;m===r&&(a=a.slice(0,a.length-r.length)+m.replace(L[p],""),a||o.apply(e,n.call(h,0)));break}}}if(a){i=bl(a,b,g),d=i.dirruns++,h==null&&(h=$.find.TAG("*",G.test(a)&&b.parentNode||b));for(j=0;l=h[j];j++)c=i.runs++,i(l,b)&&e.push(l)}return e};h.querySelectorAll&&function(){var a,b=bm,c=/\'|\\\\/g,d=/\\=[\\x20\\t\\r\\n\\f]*([^\'"\\]]*)[\\x20\\t\\r\\n\\f]*\\]/g,e=[],f=[":active"],g=i.matchesSelector||i.mozMatchesSelector||i.webkitMatchesSelector||i.oMatchesSelector||i.msMatchesSelector;T(function(a){a.innerHTML="<select><option selected></option></select>",a.querySelectorAll("[selected]").length||e.push("\\\\["+r+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),T(function(a){a.innerHTML="<p test=\'\'></p>",a.querySelectorAll("[test^=\'\']").length&&e.push("[*^$]="+r+"*(?:\\"\\"|\'\')"),a.innerHTML="<input type=\'hidden\'>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=e.length&&new RegExp(e.join("|")),bm=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a)))if(d.nodeType===9)try{return o.apply(f,n.call(d.querySelectorAll(a),0)),f}catch(i){}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var j=d.getAttribute("id"),k=j||q,l=G.test(a)&&d.parentNode||d;j?k=k.replace(c,"\\\\$&"):d.setAttribute("id",k);try{return o.apply(f,n.call(l.querySelectorAll(a.replace(C,"[id=\'"+k+"\'] $&")),0)),f}catch(i){}finally{j||d.removeAttribute("id")}}return b(a,d,f,g,h)},g&&(T(function(b){a=g.call(b,"div");try{g.call(b,"[test!=\'\']:sizzle"),f.push($.match.PSEUDO)}catch(c){}}),f=new RegExp(f.join("|")),Z.matchesSelector=function(b,c){c=c.replace(d,"=\'$1\']");if(!ba(b)&&!f.test(c)&&(!e||!e.test(c)))try{var h=g.call(b,c);if(h||a||b.document&&b.document.nodeType!==11)return h}catch(i){}return Z(c,null,null,[b]).length>0})}(),Z.attr=p.attr,p.find=Z,p.expr=Z.selectors,p.expr[":"]=p.expr.pseudos,p.unique=Z.uniqueSort,p.text=Z.getText,p.isXMLDoc=Z.isXML,p.contains=Z.contains}(a);var bc=/Until$/,bd=/^(?:parents|prev(?:Until|All))/,be=/^.[^:#\\[\\.,]*$/,bf=p.expr.match.needsContext,bg={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if(typeof a!="string")return p(a).filter(function(){for(b=0,c=h.length;b<c;b++)if(p.contains(h[b],this))return!0});g=this.pushStack("","find",a);for(b=0,c=this.length;b<c;b++){d=g.length,p.find(a,this[b],g);if(b>0)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}}return g},has:function(a){var b,c=p(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(p.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(bj(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bj(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?bf.test(a)?p(a,this.context).index(this[0])>=0:p.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d=0,e=this.length,f=[],g=bf.test(a)||typeof a!="string"?p(a,b||this.context):0;for(;d<e;d++){c=this[d];while(c&&c.ownerDocument&&c!==b&&c.nodeType!==11){if(g?g.index(c)>-1:p.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}}return f=f.length>1?p.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?typeof a=="string"?p.inArray(this[0],p(a)):p.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?p(a,b):p.makeArray(a&&a.nodeType?[a]:a),d=p.merge(this.get(),c);return this.pushStack(bh(c[0])||bh(d[0])?d:p.unique(d))},addBack:function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}}),p.fn.andSelf=p.fn.addBack,p.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return bi(a,"nextSibling")},prev:function(a){return bi(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return p.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var e=p.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=p.filter(d,e)),e=this.length>1&&!bg[a]?p.unique(e):e,this.length>1&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,k.call(arguments).join(","))}}),p.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?p.find.matchesSelector(b[0],a)?[b[0]]:[]:p.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!p(f).is(d)))f.nodeType===1&&e.push(f),f=f[c];return e},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var bl="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bm=/ jQuery\\d+="(?:null|\\d+)"/g,bn=/^\\s+/,bo=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,bp=/<([\\w:]+)/,bq=/<tbody/i,br=/<|&#?\\w+;/,bs=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,bu=new RegExp("<(?:"+bl+")[\\\\s/>]","i"),bv=/^(?:checkbox|radio)$/,bw=/checked\\s*(?:[^=]|=\\s*.checked.)/i,bx=/\\/(java|ecma)script/i,by=/^\\s*<!(?:\\[CDATA\\[|\\-\\-)|[\\]\\-]{2}>\\s*$/g,bz={option:[1,"<select multiple=\'multiple\'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bA=bk(e),bB=bA.appendChild(e.createElement("div"));bz.optgroup=bz.option,bz.tbody=bz.tfoot=bz.colgroup=bz.caption=bz.thead,bz.th=bz.td,p.support.htmlSerialize||(bz._default=[1,"X<div>","</div>"]),p.fn.extend({text:function(a){return p.access(this,function(a){return a===b?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||e).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(p.isFunction(a))return this.each(function(b){p(this).wrapAll(a.call(this,b))});if(this[0]){var b=p(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(a,this),"before",this.selector)}},after:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(this,a),"after",this.selector)}},remove:function(a,b){var c,d=0;for(;(c=this[d])!=null;d++)if(!a||p.filter(a,[c]).length)!b&&c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),p.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){var a,b=0;for(;(a=this[b])!=null;b++){a.nodeType===1&&p.cleanData(a.getElementsByTagName("*"));while(a.firstChild)a.removeChild(a.firstChild)}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return p.clone(this,a,b)})},html:function(a){return p.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(bm,""):b;if(typeof a=="string"&&!bs.test(a)&&(p.support.htmlSerialize||!bu.test(a))&&(p.support.leadingWhitespace||!bn.test(a))&&!bz[(bp.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bo,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return bh(this[0])?this.length?this.pushStack(p(p.isFunction(a)?a():a),"replaceWith",a):this:p.isFunction(a)?this.each(function(b){var c=p(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=p(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;p(this).remove(),b?p(b).before(a):p(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!p.support.checkClone&&l>1&&typeof j=="string"&&bw.test(j))return this.each(function(){p(this).domManip(a,c,d)});if(p.isFunction(j))return this.each(function(e){var f=p(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){e=p.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,g.childNodes.length===1&&(g=f);if(f){c=c&&p.nodeName(f,"tr");for(h=e.cacheable||l-1;i<l;i++)d.call(c&&p.nodeName(this[i],"table")?bC(this[i],"tbody"):this[i],i===h?g:p.clone(g,!0,!0))}g=f=null,k.length&&p.each(k,function(a,b){b.src?p.ajax?p.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((b.text||b.textContent||b.innerHTML||"").replace(by,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),p.buildFragment=function(a,c,d){var f,g,h,i=a[0];return c=c||e,c=(c[0]||c).ownerDocument||c[0]||c,typeof c.createDocumentFragment=="undefined"&&(c=e),a.length===1&&typeof i=="string"&&i.length<512&&c===e&&i.charAt(0)==="<"&&!bt.test(i)&&(p.support.checkClone||!bw.test(i))&&(p.support.html5Clone||!bu.test(i))&&(g=!0,f=p.fragments[i],h=f!==b),f||(f=c.createDocumentFragment(),p.clean(a,c,f,d),g&&(p.fragments[i]=h&&f)),{fragment:f,cacheable:g}},p.fragments={},p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(c){var d,e=0,f=[],g=p(c),h=g.length,i=this.length===1&&this[0].parentNode;if((i==null||i&&i.nodeType===11&&i.childNodes.length===1)&&h===1)return g[b](this[0]),this;for(;e<h;e++)d=(e>0?this.clone(!0):this).get(),p(g[e])[b](d),f=f.concat(d);return this.pushStack(f,a,g.selector)}}),p.extend({clone:function(a,b,c){var d,e,f,g;p.support.html5Clone||p.isXMLDoc(a)||!bu.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(bB.innerHTML=a.outerHTML,bB.removeChild(g=bB.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!p.isXMLDoc(a)){bE(a,g),d=bF(a),e=bF(g);for(f=0;d[f];++f)e[f]&&bE(d[f],e[f])}if(b){bD(a,g);if(c){d=bF(a),e=bF(g);for(f=0;d[f];++f)bD(d[f],e[f])}}return d=e=null,g},clean:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s=0,t=[];if(!b||typeof b.createDocumentFragment=="undefined")b=e;for(g=b===e&&bA;(h=a[s])!=null;s++){typeof h=="number"&&(h+="");if(!h)continue;if(typeof h=="string")if(!br.test(h))h=b.createTextNode(h);else{g=g||bk(b),l=l||g.appendChild(b.createElement("div")),h=h.replace(bo,"<$1></$2>"),i=(bp.exec(h)||["",""])[1].toLowerCase(),j=bz[i]||bz._default,k=j[0],l.innerHTML=j[1]+h+j[2];while(k--)l=l.lastChild;if(!p.support.tbody){m=bq.test(h),n=i==="table"&&!m?l.firstChild&&l.firstChild.childNodes:j[1]==="<table>"&&!m?l.childNodes:[];for(f=n.length-1;f>=0;--f)p.nodeName(n[f],"tbody")&&!n[f].childNodes.length&&n[f].parentNode.removeChild(n[f])}!p.support.leadingWhitespace&&bn.test(h)&&l.insertBefore(b.createTextNode(bn.exec(h)[0]),l.firstChild),h=l.childNodes,l=g.lastChild}h.nodeType?t.push(h):t=p.merge(t,h)}l&&(g.removeChild(l),h=l=g=null);if(!p.support.appendChecked)for(s=0;(h=t[s])!=null;s++)p.nodeName(h,"input")?bG(h):typeof h.getElementsByTagName!="undefined"&&p.grep(h.getElementsByTagName("input"),bG);if(c){q=function(a){if(!a.type||bx.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(s=0;(h=t[s])!=null;s++)if(!p.nodeName(h,"script")||!q(h))c.appendChild(h),typeof h.getElementsByTagName!="undefined"&&(r=p.grep(p.merge([],h.getElementsByTagName("script")),q),t.splice.apply(t,[s+1,0].concat(r)),s+=r.length)}return t},cleanData:function(a,b){var c,d,e,f,g=0,h=p.expando,i=p.cache,j=p.support.deleteExpando,k=p.event.special;for(;(e=a[g])!=null;g++)if(b||p.acceptData(e)){d=e[h],c=d&&i[d];if(c){if(c.events)for(f in c.events)k[f]?p.event.remove(e,f):p.removeEvent(e,f,c.handle);i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,p.deletedIds.push(d))}}}}),function(){var a,b;p.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \\/]([\\w.]+)/.exec(a)||/(webkit)[ \\/]([\\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(a)||/(msie) ([\\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=p.uaMatch(g.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.webkit&&(b.safari=!0),p.browser=b,p.sub=function(){function a(b,c){return new a.fn.init(b,c)}p.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function c(c,d){return d&&d instanceof p&&!(d instanceof a)&&(d=a(d)),p.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(e);return a}}();var bH,bI,bJ,bK=/alpha\\([^)]*\\)/i,bL=/opacity=([^)]*)/,bM=/^(top|right|bottom|left)$/,bN=/^margin/,bO=new RegExp("^("+q+")(.*)$","i"),bP=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),bQ=new RegExp("^([-+])=("+q+")","i"),bR={},bS={position:"absolute",visibility:"hidden",display:"block"},bT={letterSpacing:0,fontWeight:400,lineHeight:1},bU=["Top","Right","Bottom","Left"],bV=["Webkit","O","Moz","ms"],bW=p.fn.toggle;p.fn.extend({css:function(a,c){return p.access(this,function(a,c,d){return d!==b?p.style(a,c,d):p.css(a,c)},a,c,arguments.length>1)},show:function(){return bZ(this,!0)},hide:function(){return bZ(this)},toggle:function(a,b){var c=typeof a=="boolean";return p.isFunction(a)&&p.isFunction(b)?bW.apply(this,arguments):this.each(function(){(c?a:bY(this))?p(this).show():p(this).hide()})}}),p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bH(a,"opacity");return c===""?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||!a.style)return;var f,g,h,i=p.camelCase(c),j=a.style;c=p.cssProps[i]||(p.cssProps[i]=bX(j,i)),h=p.cssHooks[c]||p.cssHooks[i];if(d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];g=typeof d,g==="string"&&(f=bQ.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(p.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d))return;g==="number"&&!p.cssNumber[i]&&(d+="px");if(!h||!("set"in h)||(d=h.set(a,d,e))!==b)try{j[c]=d}catch(k){}},css:function(a,c,d,e){var f,g,h,i=p.camelCase(c);return c=p.cssProps[i]||(p.cssProps[i]=bX(a.style,i)),h=p.cssHooks[c]||p.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,e)),f===b&&(f=bH(a,c)),f==="normal"&&c in bT&&(f=bT[c]),d||e!==b?(g=parseFloat(f),d||p.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];d=c.call(a);for(e in b)a.style[e]=f[e];return d}}),a.getComputedStyle?bH=function(a,b){var c,d,e,f,g=getComputedStyle(a,null),h=a.style;return g&&(c=g[b],c===""&&!p.contains(a.ownerDocument.documentElement,a)&&(c=p.style(a,b)),bP.test(c)&&bN.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=c,c=g.width,h.width=d,h.minWidth=e,h.maxWidth=f)),c}:e.documentElement.currentStyle&&(bH=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return e==null&&f&&f[b]&&(e=f[b]),bP.test(e)&&!bM.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),e===""?"auto":e}),p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth!==0||bH(a,"display")!=="none"?ca(a,b,d):p.swap(a,bS,function(){return ca(a,b,d)})},set:function(a,c,d){return b$(a,c,d?b_(a,b,d,p.support.boxSizing&&p.css(a,"boxSizing")==="border-box"):0)}}}),p.support.opacity||(p.cssHooks.opacity={get:function(a,b){return bL.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=p.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&p.trim(f.replace(bK,""))===""&&c.removeAttribute){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bK.test(f)?f.replace(bK,e):f+" "+e}}),p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(a,b){return p.swap(a,{display:"inline-block"},function(){if(b)return bH(a,"marginRight")})}}),!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(a,b){p.cssHooks[b]={get:function(a,c){if(c){var d=bH(a,b);return bP.test(d)?p(a).position()[b]+"px":d}}}})}),p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(a){return a.offsetWidth===0&&a.offsetHeight===0||!p.support.reliableHiddenOffsets&&(a.style&&a.style.display||bH(a,"display"))==="none"},p.expr.filters.visible=function(a){return!p.expr.filters.hidden(a)}),p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++)f[a+bU[d]+b]=e[d]||e[d-2]||e[0];return f}},bN.test(a)||(p.cssHooks[a+b].set=b$)});var cc=/%20/g,cd=/\\[\\]$/,ce=/\\r?\\n/g,cf=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,cg=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||cg.test(this.nodeName)||cf.test(this.type))}).map(function(a,b){var c=p(this).val();return c==null?null:p.isArray(c)?p.map(c,function(a,c){return{name:b.name,value:a.replace(ce,"\\r\\n")}}):{name:b.name,value:c.replace(ce,"\\r\\n")}}).get()}}),p.param=function(a,c){var d,e=[],f=function(a,b){b=p.isFunction(b)?b():b==null?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a))p.each(a,function(){f(this.name,this.value)});else for(d in a)ch(d,a[d],c,f);return e.join("&").replace(cc,"+")};var ci,cj,ck=/#.*$/,cl=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/mg,cm=/^(?:about|app|app\\-storage|.+\\-extension|file|res|widget):$/,cn=/^(?:GET|HEAD)$/,co=/^\\/\\//,cp=/\\?/,cq=/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,cr=/([?&])_=[^&]*/,cs=/^([\\w\\+\\.\\-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,ct=p.fn.load,cu={},cv={},cw=["*/"]+["*"];try{ci=f.href}catch(cx){ci=e.createElement("a"),ci.href="",ci=ci.href}cj=cs.exec(ci.toLowerCase())||[],p.fn.load=function(a,c,d){if(typeof a!="string"&&ct)return ct.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),p.isFunction(c)?(d=c,c=b):typeof c=="object"&&(f="POST"),p.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?p("<div>").append(a.replace(cq,"")).find(e):a)}),this},p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,a)}}),p.each(["get","post"],function(a,c){p[c]=function(a,d,e,f){return p.isFunction(d)&&(f=f||e,e=d,d=b),p.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),p.extend({getScript:function(a,c){return p.get(a,b,c,"script")},getJSON:function(a,b,c){return p.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?cA(a,p.ajaxSettings):(b=a,a=p.ajaxSettings),cA(a,b),a},ajaxSettings:{url:ci,isLocal:cm.test(cj[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":cw},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:cy(cu),ajaxTransport:cy(cv),ajax:function(a,c){function y(a,c,f,i){var k,s,t,u,w,y=c;if(v===2)return;v=2,h&&clearTimeout(h),g=b,e=i||"",x.readyState=a>0?4:0,f&&(u=cB(l,x,f));if(a>=200&&a<300||a===304)l.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(p.lastModified[d]=w),w=x.getResponseHeader("Etag"),w&&(p.etag[d]=w)),a===304?(y="notmodified",k=!0):(k=cC(l,u),y=k.state,s=k.data,t=k.error,k=!t);else{t=y;if(!y||a)y="error",a<0&&(a=0)}x.status=a,x.statusText=""+(c||y),k?o.resolveWith(m,[s,y,x]):o.rejectWith(m,[x,y,t]),x.statusCode(r),r=b,j&&n.trigger("ajax"+(k?"Success":"Error"),[x,l,k?s:t]),q.fireWith(m,[x,y]),j&&(n.trigger("ajaxComplete",[x,l]),--p.active||p.event.trigger("ajaxStop"))}typeof a=="object"&&(c=a,a=b),c=c||{};var d,e,f,g,h,i,j,k,l=p.ajaxSetup({},c),m=l.context||l,n=m!==l&&(m.nodeType||m instanceof p)?p(m):p.event,o=p.Deferred(),q=p.Callbacks("once memory"),r=l.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=u[c]=u[c]||a,t[a]=b}return this},getAllResponseHeaders:function(){return v===2?e:null},getResponseHeader:function(a){var c;if(v===2){if(!f){f={};while(c=cl.exec(e))f[c[1].toLowerCase()]=c[2]}c=f[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(l.mimeType=a),this},abort:function(a){return a=a||w,g&&g.abort(a),y(0,a),this}};o.promise(x),x.success=x.done,x.error=x.fail,x.complete=q.add,x.statusCode=function(a){if(a){var b;if(v<2)for(b in a)r[b]=[r[b],a[b]];else b=a[x.status],x.always(b)}return this},l.url=((a||l.url)+"").replace(ck,"").replace(co,cj[1]+"//"),l.dataTypes=p.trim(l.dataType||"*").toLowerCase().split(s),l.crossDomain==null&&(i=cs.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]==cj[1]&&i[2]==cj[2]&&(i[3]||(i[1]==="http:"?80:443))==(cj[3]||(cj[1]==="http:"?80:443)))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),cz(cu,l,c,x);if(v===2)return x;j=l.global,l.type=l.type.toUpperCase(),l.hasContent=!cn.test(l.type),j&&p.active++===0&&p.event.trigger("ajaxStart");if(!l.hasContent){l.data&&(l.url+=(cp.test(l.url)?"&":"?")+l.data,delete l.data),d=l.url;if(l.cache===!1){var z=p.now(),A=l.url.replace(cr,"$1_="+z);l.url=A+(A===l.url?(cp.test(l.url)?"&":"?")+"_="+z:"")}}(l.data&&l.hasContent&&l.contentType!==!1||c.contentType)&&x.setRequestHeader("Content-Type",l.contentType),l.ifModified&&(d=d||l.url,p.lastModified[d]&&x.setRequestHeader("If-Modified-Since",p.lastModified[d]),p.etag[d]&&x.setRequestHeader("If-None-Match",p.etag[d])),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+cw+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)x.setRequestHeader(k,l.headers[k]);if(!l.beforeSend||l.beforeSend.call(m,x,l)!==!1&&v!==2){w="abort";for(k in{success:1,error:1,complete:1})x[k](l[k]);g=cz(cv,l,c,x);if(!g)y(-1,"No Transport");else{x.readyState=1,j&&n.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){x.abort("timeout")},l.timeout));try{v=1,g.send(t,y)}catch(B){if(v<2)y(-1,B);else throw B}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var cD=[],cE=/\\?/,cF=/(=)\\?(?=&|$)|\\?\\?/,cG=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=cD.pop()||p.expando+"_"+cG++;return this[a]=!0,a}}),p.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&cF.test(j),m=k&&!l&&typeof i=="string"&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&cF.test(i);if(c.dataTypes[0]==="jsonp"||l||m)return f=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(cF,"$1"+f):m?c.data=i.replace(cF,"$1"+f):k&&(c.url+=(cE.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||p.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,cD.push(f)),h&&p.isFunction(g)&&g(h[0]),h=g=b}),"script"}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return p.globalEval(a),a}}}),p.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),p.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=e.head||e.getElementsByTagName("head")[0]||e.documentElement;return{send:function(f,g){c=e.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cH,cI=a.ActiveXObject?function(){for(var a in cH)cH[a](0,1)}:!1,cJ=0;p.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&cK()||cL()}:cK,function(a){p.extend(p.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(p.ajaxSettings.xhr()),p.support.ajax&&p.ajaxTransport(function(c){if(!c.crossDomain||p.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||i.readyState===4)){d=b,g&&(i.onreadystatechange=p.noop,cI&&delete cH[g]);if(e)i.readyState!==4&&i.abort();else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:h===1223&&(h=204)}}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?i.readyState===4?setTimeout(d,0):(g=++cJ,cI&&(cH||(cH={},p(a).unload(cI)),cH[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var cM,cN,cO=/^(?:toggle|show|hide)$/,cP=new RegExp("^(?:([-+])=|)("+q+")([a-z%]*)$","i"),cQ=/queueHooks$/,cR=[cX],cS={"*":[function(a,b){var c,d,e,f=this.createTween(a,b),g=cP.exec(b),h=f.cur(),i=+h||0,j=1;if(g){c=+g[2],d=g[3]||(p.cssNumber[a]?"":"px");if(d!=="px"&&i){i=p.css(f.elem,a,!0)||c||1;do e=j=j||".5",i=i/j,p.style(f.elem,a,i+d),j=f.cur()/h;while(j!==1&&j!==e)}f.unit=d,f.start=i,f.end=g[1]?i+(g[1]+1)*c:c}return f}]};p.Animation=p.extend(cV,{tweener:function(a,b){p.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");var c,d=0,e=a.length;for(;d<e;d++)c=a[d],cS[c]=cS[c]||[],cS[c].unshift(b)},prefilter:function(a,b){b?cR.unshift(a):cR.push(a)}}),p.Tween=cY,cY.prototype={constructor:cY,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(p.cssNumber[c]?"":"px")},cur:function(){var a=cY.propHooks[this.prop];return a&&a.get?a.get(this):cY.propHooks._default.get(this)},run:function(a){var b,c=cY.propHooks[this.prop];return this.pos=b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration),this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):cY.propHooks._default.set(this),this}},cY.prototype.init.prototype=cY.prototype,cY.propHooks={_default:{get:function(a){var b;return a.elem[a.prop]==null||!!a.elem.style&&a.elem.style[a.prop]!=null?(b=p.css(a.elem,a.prop,!1,""),!b||b==="auto"?0:b):a.elem[a.prop]},set:function(a){p.fx.step[a.prop]?p.fx.step[a.prop](a):a.elem.style&&(a.elem.style[p.cssProps[a.prop]]!=null||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},cY.propHooks.scrollTop=cY.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(d,e,f){return d==null||typeof d=="boolean"||!a&&p.isFunction(d)&&p.isFunction(e)?c.apply(this,arguments):this.animate(cZ(b,!0),d,e,f)}}),p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(bY).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=p.isEmptyObject(a),f=p.speed(b,c,d),g=function(){var b=cV(this,p.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=a!=null&&a+"queueHooks",f=p.timers,g=p._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cQ.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem===this&&(a==null||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&p.dequeue(this,a)})}}),p.each({slideDown:cZ("show"),slideUp:cZ("hide"),slideToggle:cZ("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),p.speed=function(a,b,c){var d=a&&typeof a=="object"?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";return d.old=d.complete,d.complete=function(){p.isFunction(d.old)&&d.old.call(this),d.queue&&p.dequeue(this,d.queue)},d},p.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},p.timers=[],p.fx=cY.prototype.init,p.fx.tick=function(){var a,b=p.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||p.fx.stop()},p.fx.timer=function(a){a()&&p.timers.push(a)&&!cN&&(cN=setInterval(p.fx.tick,p.fx.interval))},p.fx.interval=13,p.fx.stop=function(){clearInterval(cN),cN=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fx.step={},p.expr&&p.expr.filters&&(p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length});var c$=/^(?:body|html)$/i;p.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){p.offset.setOffset(this,a,b)});var c,d,e,f,g,h,i,j,k,l,m=this[0],n=m&&m.ownerDocument;if(!n)return;return(e=n.body)===m?p.offset.bodyOffset(m):(d=n.documentElement,p.contains(d,m)?(c=m.getBoundingClientRect(),f=c_(n),g=d.clientTop||e.clientTop||0,h=d.clientLeft||e.clientLeft||0,i=f.pageYOffset||d.scrollTop,j=f.pageXOffset||d.scrollLeft,k=c.top+i-g,l=c.left+j-h,{top:k,left:l}):{top:0,left:0})},p.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(p.css(a,"marginTop"))||0,c+=parseFloat(p.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=p.css(a,"position");d==="static"&&(a.style.position="relative");var e=p(a),f=e.offset(),g=p.css(a,"top"),h=p.css(a,"left"),i=(d==="absolute"||d==="fixed")&&p.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),p.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using"in b?b.using.call(a,j):e.css(j)}},p.fn.extend({position:function(){if(!this[0])return;var a=this[0],b=this.offsetParent(),c=this.offset(),d=c$.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(p.css(a,"marginTop"))||0,c.left-=parseFloat(p.css(a,"marginLeft"))||0,d.top+=parseFloat(p.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(p.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||e.body;while(a&&!c$.test(a.nodeName)&&p.css(a,"position")==="static")a=a.offsetParent;return a||e.body})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);p.fn[a]=function(e){return p.access(this,function(a,e,f){var g=c_(a);if(f===b)return g?c in g?g[c]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?p(g).scrollLeft():f,d?f:p(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}}),p.each({Height:"height",Width:"width"},function(a,c){p.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){p.fn[e]=function(e,f){var g=arguments.length&&(d||typeof e!="boolean"),h=d||(e===!0||f===!0?"margin":"border");return p.access(this,function(c,d,e){var f;return p.isWindow(c)?c.document.documentElement["client"+a]:c.nodeType===9?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?p.css(c,d,e,h):p.style(c,d,e,h)},c,g?e:b,g)}})}),a.jQuery=a.$=p, true&&__webpack_require__.amdO.jQuery&&!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function(){return p}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))})(window);\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/jquery-plugin/jquery.min.js?')},"./src/assets/js/katex/katex.min.js":function(module){eval('!function(e,t){ true?module.exports=t():0}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return Wn}});class r{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;let n,o,s="KaTeX parse error: "+e;const i=t&&t.loc;if(i&&i.start<=i.end){const e=i.lexer.input;n=i.start,o=i.end,n===e.length?s+=" at end of input: ":s+=" at position "+(n+1)+": ";const t=e.slice(n,o).replace(/[^]/g,"$&\\u0332");let r,a;r=n>15?"\\u2026"+e.slice(n-15,n):e.slice(0,n),a=o+15<e.length?e.slice(o,o+15)+"\\u2026":e.slice(o),s+=r+t+a}const a=new Error(s);return a.name="ParseError",a.__proto__=r.prototype,a.position=n,null!=n&&null!=o&&(a.length=o-n),a.rawMessage=e,a}}r.prototype.__proto__=Error.prototype;var n=r;const o=/([A-Z])/g,s={"&":"&amp;",">":"&gt;","<":"&lt;",\'"\':"&quot;","\'":"&#x27;"},i=/[&><"\']/g;const a=function(e){return"ordgroup"===e.type||"color"===e.type?1===e.body.length?a(e.body[0]):e:"font"===e.type?a(e.body):e};var l={contains:function(e,t){return-1!==e.indexOf(t)},deflt:function(e,t){return void 0===e?t:e},escape:function(e){return String(e).replace(i,(e=>s[e]))},hyphenate:function(e){return e.replace(o,"-$1").toLowerCase()},getBaseElem:a,isCharacterBox:function(e){const t=a(e);return"mathord"===t.type||"textord"===t.type||"atom"===t.type},protocolFromUrl:function(e){const t=/^[\\x00-\\x20]*([^\\\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?":"!==t[2]?null:/^[a-zA-Z][a-zA-Z0-9+\\-.]*$/.test(t[1])?t[1].toLowerCase():null:"_relative"}};const h={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\\\int and \\\\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format \'rgb\' or \'rrggbb\' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:e=>"#"+e},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form \'\\\\foo:expansion\' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(e,t)=>(t.push(e),t)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\\\sqrt` top lines, `{array}` vertical lines, `\\\\hline`, `\\\\hdashline`, `\\\\underline`, `\\\\overline`, and the borders of `\\\\fbox`, `\\\\boxed`, and `\\\\fcolorbox`.",processor:e=>Math.max(0,e),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\\\color behave like LaTeX\'s 2-argument \\\\textcolor, instead of LaTeX\'s one-argument \\\\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\\\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\\\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:e=>Math.max(0,e),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:e=>Math.max(0,e),cli:"-e, --max-expand <n>",cliProcessor:e=>"Infinity"===e?1/0:parseInt(e)},globalGroup:{type:"boolean",cli:!1}};function c(e){if(e.default)return e.default;const t=e.type,r=Array.isArray(t)?t[0]:t;if("string"!=typeof r)return r.enum[0];switch(r){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class m{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(const t in h)if(h.hasOwnProperty(t)){const r=h[t];this[t]=void 0!==e[t]?r.processor?r.processor(e[t]):e[t]:c(r)}}reportNonstrict(e,t,r){let o=this.strict;if("function"==typeof o&&(o=o(e,t,r)),o&&"ignore"!==o){if(!0===o||"error"===o)throw new n("LaTeX-incompatible input and strict mode is set to \'error\': "+t+" ["+e+"]",r);"warn"===o?"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to \'warn\': "+t+" ["+e+"]"):"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized \'"+o+"\': "+t+" ["+e+"]")}}useStrictBehavior(e,t,r){let n=this.strict;if("function"==typeof n)try{n=n(e,t,r)}catch(e){n="error"}return!(!n||"ignore"===n)&&(!0===n||"error"===n||("warn"===n?("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to \'warn\': "+t+" ["+e+"]"),!1):("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized \'"+n+"\': "+t+" ["+e+"]"),!1)))}isTrusted(e){if(e.url&&!e.protocol){const t=l.protocolFromUrl(e.url);if(null==t)return!1;e.protocol=t}const t="function"==typeof this.trust?this.trust(e):this.trust;return Boolean(t)}}class p{constructor(e,t,r){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=r}sup(){return u[d[this.id]]}sub(){return u[g[this.id]]}fracNum(){return u[f[this.id]]}fracDen(){return u[b[this.id]]}cramp(){return u[y[this.id]]}text(){return u[x[this.id]]}isTight(){return this.size>=2}}const u=[new p(0,0,!1),new p(1,0,!0),new p(2,1,!1),new p(3,1,!0),new p(4,2,!1),new p(5,2,!0),new p(6,3,!1),new p(7,3,!0)],d=[4,5,4,5,6,7,6,7],g=[5,5,5,5,7,7,7,7],f=[2,3,4,5,6,7,6,7],b=[3,3,5,5,7,7,7,7],y=[1,1,3,3,5,5,7,7],x=[0,1,2,3,2,3,2,3];var w={DISPLAY:u[0],TEXT:u[2],SCRIPT:u[4],SCRIPTSCRIPT:u[6]};const v=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];const k=[];function S(e){for(let t=0;t<k.length;t+=2)if(e>=k[t]&&e<=k[t+1])return!0;return!1}v.forEach((e=>e.blocks.forEach((e=>k.push(...e)))));const M=80,z={doubleleftarrow:"M262 157\\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\\nm8 0v40h399730v-40zm0 194v40h399730v-40z",doublerightarrow:"M399738 392l\\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z",leftarrow:"M400000 241H110l3-3c68.7-52.7 113.7-120\\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\\n l-3-3h399890zM100 241v40h399900v-40z",leftbrace:"M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z",leftbraceunder:"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z",leftgroup:"M400000 80\\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\\n 435 0h399565z",leftgroupunder:"M400000 262\\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\\n 435 219h399565z",leftharpoon:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z",leftharpoonplus:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\\nm0 0v40h400000v-40z",leftharpoondown:"M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z",leftharpoondownplus:"M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z",lefthook:"M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\\n 71.5 23h399859zM103 281v-40h399897v40z",leftlinesegment:"M40 281 V428 H0 V94 H40 V241 H400000 v40z\\nM40 281 V428 H0 V94 H40 V241 H400000 v40z",leftmapsto:"M40 281 V448H0V74H40V241H400000v40z\\nM40 281 V448H0V74H40V241H400000v40z",leftToFrom:"M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z",longequal:"M0 50 h400000 v40H0z m0 194h40000v40H0z\\nM0 50 h400000 v40H0z m0 194h40000v40H0z",midbrace:"M200428 334\\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z",midbraceunder:"M199572 214\\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z",oiintSize1:"M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z",oiintSize2:"M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\\nc0 110 84 276 504 276s502.4-166 502.4-276z",oiiintSize1:"M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z",oiiintSize2:"M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z",rightarrow:"M0 241v40h399891c-47.3 35.3-84 78-110 128\\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n 151.7 139 205zm0 0v40h399900v-40z",rightbrace:"M400000 542l\\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z",rightbraceunder:"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z",rightgroup:"M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\\n 3-1 3-3v-38c-76-158-257-219-435-219H0z",rightgroupunder:"M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z",rightharpoon:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\\n 69.2 92 94.5zm0 0v40h399900v-40z",rightharpoonplus:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z",rightharpoondown:"M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z",rightharpoondownplus:"M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\\nm0-194v40h400000v-40zm0 0v40h400000v-40z",righthook:"M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z",rightlinesegment:"M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z",rightToFrom:"M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z",twoheadleftarrow:"M0 167c68 40\\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z",twoheadrightarrow:"M400000 167\\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z",tilde1:"M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\\n-68.267.847-113-73.952-191-73.952z",tilde2:"M344 55.266c-142 0-300.638 81.316-311.5 86.418\\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z",tilde3:"M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\\n -338 0-409-156.573-744-156.573z",tilde4:"M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\\n -175.236-744-175.236z",vec:"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\\nc-16-25.333-24-45-24-59z",widehat1:"M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z",widehat2:"M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat3:"M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat4:"M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widecheck1:"M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z",widecheck2:"M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck3:"M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck4:"M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",baraboveleftarrow:"M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z",rightarrowabovebar:"M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z",baraboveshortleftharpoon:"M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z",rightharpoonaboveshortbar:"M0,241 l0,40c399126,0,399993,0,399993,0\\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z",shortbaraboveleftharpoon:"M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z",shortrightharpoonabovebar:"M53,241l0,40c398570,0,399437,0,399437,0\\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z"};class A{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return l.contains(this.classes,e)}toNode(){const e=document.createDocumentFragment();for(let t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){let e="";for(let t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){return this.children.map((e=>e.toText())).join("")}}var T={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}};const B={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},C={"\\xc5":"A","\\xd0":"D","\\xde":"o","\\xe5":"a","\\xf0":"d","\\xfe":"o","\\u0410":"A","\\u0411":"B","\\u0412":"B","\\u0413":"F","\\u0414":"A","\\u0415":"E","\\u0416":"K","\\u0417":"3","\\u0418":"N","\\u0419":"N","\\u041a":"K","\\u041b":"N","\\u041c":"M","\\u041d":"H","\\u041e":"O","\\u041f":"N","\\u0420":"P","\\u0421":"C","\\u0422":"T","\\u0423":"y","\\u0424":"O","\\u0425":"X","\\u0426":"U","\\u0427":"h","\\u0428":"W","\\u0429":"W","\\u042a":"B","\\u042b":"X","\\u042c":"B","\\u042d":"3","\\u042e":"X","\\u042f":"R","\\u0430":"a","\\u0431":"b","\\u0432":"a","\\u0433":"r","\\u0434":"y","\\u0435":"e","\\u0436":"m","\\u0437":"e","\\u0438":"n","\\u0439":"n","\\u043a":"n","\\u043b":"n","\\u043c":"m","\\u043d":"n","\\u043e":"o","\\u043f":"n","\\u0440":"p","\\u0441":"c","\\u0442":"o","\\u0443":"y","\\u0444":"b","\\u0445":"x","\\u0446":"n","\\u0447":"n","\\u0448":"w","\\u0449":"w","\\u044a":"a","\\u044b":"m","\\u044c":"a","\\u044d":"e","\\u044e":"m","\\u044f":"r"};function N(e,t,r){if(!T[t])throw new Error("Font metrics not found for font: "+t+".");let n=e.charCodeAt(0),o=T[t][n];if(!o&&e[0]in C&&(n=C[e[0]].charCodeAt(0),o=T[t][n]),o||"text"!==r||S(n)&&(o=T[t][77]),o)return{depth:o[0],height:o[1],italic:o[2],skew:o[3],width:o[4]}}const q={};const I=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],R=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],H=function(e,t){return t.size<2?e:I[e-1][t.size-1]};class O{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||O.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=R[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){const t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(const r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return new O(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:H(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:R[e-1]})}havingBaseStyle(e){e=e||this.style.text();const t=H(O.BASESIZE,e);return this.size===t&&this.textSize===O.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){let e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==O.BASESIZE?["sizing","reset-size"+this.size,"size"+O.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=function(e){let t;if(t=e>=5?0:e>=3?1:2,!q[t]){const e=q[t]={cssEmPerMu:B.quad[t]/18};for(const r in B)B.hasOwnProperty(r)&&(e[r]=B[r][t])}return q[t]}(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}O.BASESIZE=6;var E=O;const L={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:1.00375,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:1.00375},D={ex:!0,em:!0,mu:!0},V=function(e){return"string"!=typeof e&&(e=e.unit),e in L||e in D||"ex"===e},P=function(e,t){let r;if(e.unit in L)r=L[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if("mu"===e.unit)r=t.fontMetrics().cssEmPerMu;else{let o;if(o=t.style.isTight()?t.havingStyle(t.style.text()):t,"ex"===e.unit)r=o.fontMetrics().xHeight;else{if("em"!==e.unit)throw new n("Invalid unit: \'"+e.unit+"\'");r=o.fontMetrics().quad}o!==t&&(r*=o.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*r,t.maxSize)},F=function(e){return+e.toFixed(4)+"em"},G=function(e){return e.filter((e=>e)).join(" ")},U=function(e,t,r){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=r||{},t){t.style.isTight()&&this.classes.push("mtight");const e=t.getColor();e&&(this.style.color=e)}},Y=function(e){const t=document.createElement(e);t.className=G(this.classes);for(const e in this.style)this.style.hasOwnProperty(e)&&(t.style[e]=this.style[e]);for(const e in this.attributes)this.attributes.hasOwnProperty(e)&&t.setAttribute(e,this.attributes[e]);for(let e=0;e<this.children.length;e++)t.appendChild(this.children[e].toNode());return t},X=/[\\s"\'>/=\\x00-\\x1f]/,W=function(e){let t="<"+e;this.classes.length&&(t+=\' class="\'+l.escape(G(this.classes))+\'"\');let r="";for(const e in this.style)this.style.hasOwnProperty(e)&&(r+=l.hyphenate(e)+":"+this.style[e]+";");r&&(t+=\' style="\'+l.escape(r)+\'"\');for(const e in this.attributes)if(this.attributes.hasOwnProperty(e)){if(X.test(e))throw new n("Invalid attribute name \'"+e+"\'");t+=" "+e+\'="\'+l.escape(this.attributes[e])+\'"\'}t+=">";for(let e=0;e<this.children.length;e++)t+=this.children[e].toMarkup();return t+="</"+e+">",t};class _{constructor(e,t,r,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,U.call(this,e,r,n),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return l.contains(this.classes,e)}toNode(){return Y.call(this,"span")}toMarkup(){return W.call(this,"span")}}class j{constructor(e,t,r,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,U.call(this,t,n),this.children=r||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return l.contains(this.classes,e)}toNode(){return Y.call(this,"a")}toMarkup(){return W.call(this,"a")}}class ${constructor(e,t,r){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=r}hasClass(e){return l.contains(this.classes,e)}toNode(){const e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(const t in this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){let e=\'<img src="\'+l.escape(this.src)+\'" alt="\'+l.escape(this.alt)+\'"\',t="";for(const e in this.style)this.style.hasOwnProperty(e)&&(t+=l.hyphenate(e)+":"+this.style[e]+";");return t&&(e+=\' style="\'+l.escape(t)+\'"\'),e+="\'/>",e}}const Z={"\\xee":"\\u0131\\u0302","\\xef":"\\u0131\\u0308","\\xed":"\\u0131\\u0301","\\xec":"\\u0131\\u0300"};class K{constructor(e,t,r,n,o,s,i,a){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=r||0,this.italic=n||0,this.skew=o||0,this.width=s||0,this.classes=i||[],this.style=a||{},this.maxFontSize=0;const l=function(e){for(let t=0;t<v.length;t++){const r=v[t];for(let t=0;t<r.blocks.length;t++){const n=r.blocks[t];if(e>=n[0]&&e<=n[1])return r.name}}return null}(this.text.charCodeAt(0));l&&this.classes.push(l+"_fallback"),/[\\xee\\xef\\xed\\xec]/.test(this.text)&&(this.text=Z[this.text])}hasClass(e){return l.contains(this.classes,e)}toNode(){const e=document.createTextNode(this.text);let t=null;this.italic>0&&(t=document.createElement("span"),t.style.marginRight=F(this.italic)),this.classes.length>0&&(t=t||document.createElement("span"),t.className=G(this.classes));for(const e in this.style)this.style.hasOwnProperty(e)&&(t=t||document.createElement("span"),t.style[e]=this.style[e]);return t?(t.appendChild(e),t):e}toMarkup(){let e=!1,t="<span";this.classes.length&&(e=!0,t+=\' class="\',t+=l.escape(G(this.classes)),t+=\'"\');let r="";this.italic>0&&(r+="margin-right:"+this.italic+"em;");for(const e in this.style)this.style.hasOwnProperty(e)&&(r+=l.hyphenate(e)+":"+this.style[e]+";");r&&(e=!0,t+=\' style="\'+l.escape(r)+\'"\');const n=l.escape(this.text);return e?(t+=">",t+=n,t+="</span>",t):n}}class J{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);for(let t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){let e=\'<svg xmlns="http://www.w3.org/2000/svg"\';for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+\'="\'+l.escape(this.attributes[t])+\'"\');e+=">";for(let t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e+="</svg>",e}}class Q{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){const e=document.createElementNS("http://www.w3.org/2000/svg","path");return this.alternate?e.setAttribute("d",this.alternate):e.setAttribute("d",z[this.pathName]),e}toMarkup(){return this.alternate?\'<path d="\'+l.escape(this.alternate)+\'"/>\':\'<path d="\'+l.escape(z[this.pathName])+\'"/>\'}}class ee{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){const e=document.createElementNS("http://www.w3.org/2000/svg","line");for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);return e}toMarkup(){let e="<line";for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+\'="\'+l.escape(this.attributes[t])+\'"\');return e+="/>",e}}function te(e){if(e instanceof K)return e;throw new Error("Expected symbolNode but got "+String(e)+".")}const re={bin:1,close:1,inner:1,open:1,punct:1,rel:1},ne={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},oe={math:{},text:{}};var se=oe;function ie(e,t,r,n,o,s){oe[e][o]={font:t,group:r,replace:n},s&&n&&(oe[e][n]=oe[e][o])}const ae="math",le="text",he="main",ce="ams",me="accent-token",pe="bin",ue="close",de="inner",ge="mathord",fe="op-token",be="open",ye="punct",xe="rel",we="spacing",ve="textord";ie(ae,he,xe,"\\u2261","\\\\equiv",!0),ie(ae,he,xe,"\\u227a","\\\\prec",!0),ie(ae,he,xe,"\\u227b","\\\\succ",!0),ie(ae,he,xe,"\\u223c","\\\\sim",!0),ie(ae,he,xe,"\\u22a5","\\\\perp"),ie(ae,he,xe,"\\u2aaf","\\\\preceq",!0),ie(ae,he,xe,"\\u2ab0","\\\\succeq",!0),ie(ae,he,xe,"\\u2243","\\\\simeq",!0),ie(ae,he,xe,"\\u2223","\\\\mid",!0),ie(ae,he,xe,"\\u226a","\\\\ll",!0),ie(ae,he,xe,"\\u226b","\\\\gg",!0),ie(ae,he,xe,"\\u224d","\\\\asymp",!0),ie(ae,he,xe,"\\u2225","\\\\parallel"),ie(ae,he,xe,"\\u22c8","\\\\bowtie",!0),ie(ae,he,xe,"\\u2323","\\\\smile",!0),ie(ae,he,xe,"\\u2291","\\\\sqsubseteq",!0),ie(ae,he,xe,"\\u2292","\\\\sqsupseteq",!0),ie(ae,he,xe,"\\u2250","\\\\doteq",!0),ie(ae,he,xe,"\\u2322","\\\\frown",!0),ie(ae,he,xe,"\\u220b","\\\\ni",!0),ie(ae,he,xe,"\\u221d","\\\\propto",!0),ie(ae,he,xe,"\\u22a2","\\\\vdash",!0),ie(ae,he,xe,"\\u22a3","\\\\dashv",!0),ie(ae,he,xe,"\\u220b","\\\\owns"),ie(ae,he,ye,".","\\\\ldotp"),ie(ae,he,ye,"\\u22c5","\\\\cdotp"),ie(ae,he,ve,"#","\\\\#"),ie(le,he,ve,"#","\\\\#"),ie(ae,he,ve,"&","\\\\&"),ie(le,he,ve,"&","\\\\&"),ie(ae,he,ve,"\\u2135","\\\\aleph",!0),ie(ae,he,ve,"\\u2200","\\\\forall",!0),ie(ae,he,ve,"\\u210f","\\\\hbar",!0),ie(ae,he,ve,"\\u2203","\\\\exists",!0),ie(ae,he,ve,"\\u2207","\\\\nabla",!0),ie(ae,he,ve,"\\u266d","\\\\flat",!0),ie(ae,he,ve,"\\u2113","\\\\ell",!0),ie(ae,he,ve,"\\u266e","\\\\natural",!0),ie(ae,he,ve,"\\u2663","\\\\clubsuit",!0),ie(ae,he,ve,"\\u2118","\\\\wp",!0),ie(ae,he,ve,"\\u266f","\\\\sharp",!0),ie(ae,he,ve,"\\u2662","\\\\diamondsuit",!0),ie(ae,he,ve,"\\u211c","\\\\Re",!0),ie(ae,he,ve,"\\u2661","\\\\heartsuit",!0),ie(ae,he,ve,"\\u2111","\\\\Im",!0),ie(ae,he,ve,"\\u2660","\\\\spadesuit",!0),ie(ae,he,ve,"\\xa7","\\\\S",!0),ie(le,he,ve,"\\xa7","\\\\S"),ie(ae,he,ve,"\\xb6","\\\\P",!0),ie(le,he,ve,"\\xb6","\\\\P"),ie(ae,he,ve,"\\u2020","\\\\dag"),ie(le,he,ve,"\\u2020","\\\\dag"),ie(le,he,ve,"\\u2020","\\\\textdagger"),ie(ae,he,ve,"\\u2021","\\\\ddag"),ie(le,he,ve,"\\u2021","\\\\ddag"),ie(le,he,ve,"\\u2021","\\\\textdaggerdbl"),ie(ae,he,ue,"\\u23b1","\\\\rmoustache",!0),ie(ae,he,be,"\\u23b0","\\\\lmoustache",!0),ie(ae,he,ue,"\\u27ef","\\\\rgroup",!0),ie(ae,he,be,"\\u27ee","\\\\lgroup",!0),ie(ae,he,pe,"\\u2213","\\\\mp",!0),ie(ae,he,pe,"\\u2296","\\\\ominus",!0),ie(ae,he,pe,"\\u228e","\\\\uplus",!0),ie(ae,he,pe,"\\u2293","\\\\sqcap",!0),ie(ae,he,pe,"\\u2217","\\\\ast"),ie(ae,he,pe,"\\u2294","\\\\sqcup",!0),ie(ae,he,pe,"\\u25ef","\\\\bigcirc",!0),ie(ae,he,pe,"\\u2219","\\\\bullet",!0),ie(ae,he,pe,"\\u2021","\\\\ddagger"),ie(ae,he,pe,"\\u2240","\\\\wr",!0),ie(ae,he,pe,"\\u2a3f","\\\\amalg"),ie(ae,he,pe,"&","\\\\And"),ie(ae,he,xe,"\\u27f5","\\\\longleftarrow",!0),ie(ae,he,xe,"\\u21d0","\\\\Leftarrow",!0),ie(ae,he,xe,"\\u27f8","\\\\Longleftarrow",!0),ie(ae,he,xe,"\\u27f6","\\\\longrightarrow",!0),ie(ae,he,xe,"\\u21d2","\\\\Rightarrow",!0),ie(ae,he,xe,"\\u27f9","\\\\Longrightarrow",!0),ie(ae,he,xe,"\\u2194","\\\\leftrightarrow",!0),ie(ae,he,xe,"\\u27f7","\\\\longleftrightarrow",!0),ie(ae,he,xe,"\\u21d4","\\\\Leftrightarrow",!0),ie(ae,he,xe,"\\u27fa","\\\\Longleftrightarrow",!0),ie(ae,he,xe,"\\u21a6","\\\\mapsto",!0),ie(ae,he,xe,"\\u27fc","\\\\longmapsto",!0),ie(ae,he,xe,"\\u2197","\\\\nearrow",!0),ie(ae,he,xe,"\\u21a9","\\\\hookleftarrow",!0),ie(ae,he,xe,"\\u21aa","\\\\hookrightarrow",!0),ie(ae,he,xe,"\\u2198","\\\\searrow",!0),ie(ae,he,xe,"\\u21bc","\\\\leftharpoonup",!0),ie(ae,he,xe,"\\u21c0","\\\\rightharpoonup",!0),ie(ae,he,xe,"\\u2199","\\\\swarrow",!0),ie(ae,he,xe,"\\u21bd","\\\\leftharpoondown",!0),ie(ae,he,xe,"\\u21c1","\\\\rightharpoondown",!0),ie(ae,he,xe,"\\u2196","\\\\nwarrow",!0),ie(ae,he,xe,"\\u21cc","\\\\rightleftharpoons",!0),ie(ae,ce,xe,"\\u226e","\\\\nless",!0),ie(ae,ce,xe,"\\ue010","\\\\@nleqslant"),ie(ae,ce,xe,"\\ue011","\\\\@nleqq"),ie(ae,ce,xe,"\\u2a87","\\\\lneq",!0),ie(ae,ce,xe,"\\u2268","\\\\lneqq",!0),ie(ae,ce,xe,"\\ue00c","\\\\@lvertneqq"),ie(ae,ce,xe,"\\u22e6","\\\\lnsim",!0),ie(ae,ce,xe,"\\u2a89","\\\\lnapprox",!0),ie(ae,ce,xe,"\\u2280","\\\\nprec",!0),ie(ae,ce,xe,"\\u22e0","\\\\npreceq",!0),ie(ae,ce,xe,"\\u22e8","\\\\precnsim",!0),ie(ae,ce,xe,"\\u2ab9","\\\\precnapprox",!0),ie(ae,ce,xe,"\\u2241","\\\\nsim",!0),ie(ae,ce,xe,"\\ue006","\\\\@nshortmid"),ie(ae,ce,xe,"\\u2224","\\\\nmid",!0),ie(ae,ce,xe,"\\u22ac","\\\\nvdash",!0),ie(ae,ce,xe,"\\u22ad","\\\\nvDash",!0),ie(ae,ce,xe,"\\u22ea","\\\\ntriangleleft"),ie(ae,ce,xe,"\\u22ec","\\\\ntrianglelefteq",!0),ie(ae,ce,xe,"\\u228a","\\\\subsetneq",!0),ie(ae,ce,xe,"\\ue01a","\\\\@varsubsetneq"),ie(ae,ce,xe,"\\u2acb","\\\\subsetneqq",!0),ie(ae,ce,xe,"\\ue017","\\\\@varsubsetneqq"),ie(ae,ce,xe,"\\u226f","\\\\ngtr",!0),ie(ae,ce,xe,"\\ue00f","\\\\@ngeqslant"),ie(ae,ce,xe,"\\ue00e","\\\\@ngeqq"),ie(ae,ce,xe,"\\u2a88","\\\\gneq",!0),ie(ae,ce,xe,"\\u2269","\\\\gneqq",!0),ie(ae,ce,xe,"\\ue00d","\\\\@gvertneqq"),ie(ae,ce,xe,"\\u22e7","\\\\gnsim",!0),ie(ae,ce,xe,"\\u2a8a","\\\\gnapprox",!0),ie(ae,ce,xe,"\\u2281","\\\\nsucc",!0),ie(ae,ce,xe,"\\u22e1","\\\\nsucceq",!0),ie(ae,ce,xe,"\\u22e9","\\\\succnsim",!0),ie(ae,ce,xe,"\\u2aba","\\\\succnapprox",!0),ie(ae,ce,xe,"\\u2246","\\\\ncong",!0),ie(ae,ce,xe,"\\ue007","\\\\@nshortparallel"),ie(ae,ce,xe,"\\u2226","\\\\nparallel",!0),ie(ae,ce,xe,"\\u22af","\\\\nVDash",!0),ie(ae,ce,xe,"\\u22eb","\\\\ntriangleright"),ie(ae,ce,xe,"\\u22ed","\\\\ntrianglerighteq",!0),ie(ae,ce,xe,"\\ue018","\\\\@nsupseteqq"),ie(ae,ce,xe,"\\u228b","\\\\supsetneq",!0),ie(ae,ce,xe,"\\ue01b","\\\\@varsupsetneq"),ie(ae,ce,xe,"\\u2acc","\\\\supsetneqq",!0),ie(ae,ce,xe,"\\ue019","\\\\@varsupsetneqq"),ie(ae,ce,xe,"\\u22ae","\\\\nVdash",!0),ie(ae,ce,xe,"\\u2ab5","\\\\precneqq",!0),ie(ae,ce,xe,"\\u2ab6","\\\\succneqq",!0),ie(ae,ce,xe,"\\ue016","\\\\@nsubseteqq"),ie(ae,ce,pe,"\\u22b4","\\\\unlhd"),ie(ae,ce,pe,"\\u22b5","\\\\unrhd"),ie(ae,ce,xe,"\\u219a","\\\\nleftarrow",!0),ie(ae,ce,xe,"\\u219b","\\\\nrightarrow",!0),ie(ae,ce,xe,"\\u21cd","\\\\nLeftarrow",!0),ie(ae,ce,xe,"\\u21cf","\\\\nRightarrow",!0),ie(ae,ce,xe,"\\u21ae","\\\\nleftrightarrow",!0),ie(ae,ce,xe,"\\u21ce","\\\\nLeftrightarrow",!0),ie(ae,ce,xe,"\\u25b3","\\\\vartriangle"),ie(ae,ce,ve,"\\u210f","\\\\hslash"),ie(ae,ce,ve,"\\u25bd","\\\\triangledown"),ie(ae,ce,ve,"\\u25ca","\\\\lozenge"),ie(ae,ce,ve,"\\u24c8","\\\\circledS"),ie(ae,ce,ve,"\\xae","\\\\circledR"),ie(le,ce,ve,"\\xae","\\\\circledR"),ie(ae,ce,ve,"\\u2221","\\\\measuredangle",!0),ie(ae,ce,ve,"\\u2204","\\\\nexists"),ie(ae,ce,ve,"\\u2127","\\\\mho"),ie(ae,ce,ve,"\\u2132","\\\\Finv",!0),ie(ae,ce,ve,"\\u2141","\\\\Game",!0),ie(ae,ce,ve,"\\u2035","\\\\backprime"),ie(ae,ce,ve,"\\u25b2","\\\\blacktriangle"),ie(ae,ce,ve,"\\u25bc","\\\\blacktriangledown"),ie(ae,ce,ve,"\\u25a0","\\\\blacksquare"),ie(ae,ce,ve,"\\u29eb","\\\\blacklozenge"),ie(ae,ce,ve,"\\u2605","\\\\bigstar"),ie(ae,ce,ve,"\\u2222","\\\\sphericalangle",!0),ie(ae,ce,ve,"\\u2201","\\\\complement",!0),ie(ae,ce,ve,"\\xf0","\\\\eth",!0),ie(le,he,ve,"\\xf0","\\xf0"),ie(ae,ce,ve,"\\u2571","\\\\diagup"),ie(ae,ce,ve,"\\u2572","\\\\diagdown"),ie(ae,ce,ve,"\\u25a1","\\\\square"),ie(ae,ce,ve,"\\u25a1","\\\\Box"),ie(ae,ce,ve,"\\u25ca","\\\\Diamond"),ie(ae,ce,ve,"\\xa5","\\\\yen",!0),ie(le,ce,ve,"\\xa5","\\\\yen",!0),ie(ae,ce,ve,"\\u2713","\\\\checkmark",!0),ie(le,ce,ve,"\\u2713","\\\\checkmark"),ie(ae,ce,ve,"\\u2136","\\\\beth",!0),ie(ae,ce,ve,"\\u2138","\\\\daleth",!0),ie(ae,ce,ve,"\\u2137","\\\\gimel",!0),ie(ae,ce,ve,"\\u03dd","\\\\digamma",!0),ie(ae,ce,ve,"\\u03f0","\\\\varkappa"),ie(ae,ce,be,"\\u250c","\\\\@ulcorner",!0),ie(ae,ce,ue,"\\u2510","\\\\@urcorner",!0),ie(ae,ce,be,"\\u2514","\\\\@llcorner",!0),ie(ae,ce,ue,"\\u2518","\\\\@lrcorner",!0),ie(ae,ce,xe,"\\u2266","\\\\leqq",!0),ie(ae,ce,xe,"\\u2a7d","\\\\leqslant",!0),ie(ae,ce,xe,"\\u2a95","\\\\eqslantless",!0),ie(ae,ce,xe,"\\u2272","\\\\lesssim",!0),ie(ae,ce,xe,"\\u2a85","\\\\lessapprox",!0),ie(ae,ce,xe,"\\u224a","\\\\approxeq",!0),ie(ae,ce,pe,"\\u22d6","\\\\lessdot"),ie(ae,ce,xe,"\\u22d8","\\\\lll",!0),ie(ae,ce,xe,"\\u2276","\\\\lessgtr",!0),ie(ae,ce,xe,"\\u22da","\\\\lesseqgtr",!0),ie(ae,ce,xe,"\\u2a8b","\\\\lesseqqgtr",!0),ie(ae,ce,xe,"\\u2251","\\\\doteqdot"),ie(ae,ce,xe,"\\u2253","\\\\risingdotseq",!0),ie(ae,ce,xe,"\\u2252","\\\\fallingdotseq",!0),ie(ae,ce,xe,"\\u223d","\\\\backsim",!0),ie(ae,ce,xe,"\\u22cd","\\\\backsimeq",!0),ie(ae,ce,xe,"\\u2ac5","\\\\subseteqq",!0),ie(ae,ce,xe,"\\u22d0","\\\\Subset",!0),ie(ae,ce,xe,"\\u228f","\\\\sqsubset",!0),ie(ae,ce,xe,"\\u227c","\\\\preccurlyeq",!0),ie(ae,ce,xe,"\\u22de","\\\\curlyeqprec",!0),ie(ae,ce,xe,"\\u227e","\\\\precsim",!0),ie(ae,ce,xe,"\\u2ab7","\\\\precapprox",!0),ie(ae,ce,xe,"\\u22b2","\\\\vartriangleleft"),ie(ae,ce,xe,"\\u22b4","\\\\trianglelefteq"),ie(ae,ce,xe,"\\u22a8","\\\\vDash",!0),ie(ae,ce,xe,"\\u22aa","\\\\Vvdash",!0),ie(ae,ce,xe,"\\u2323","\\\\smallsmile"),ie(ae,ce,xe,"\\u2322","\\\\smallfrown"),ie(ae,ce,xe,"\\u224f","\\\\bumpeq",!0),ie(ae,ce,xe,"\\u224e","\\\\Bumpeq",!0),ie(ae,ce,xe,"\\u2267","\\\\geqq",!0),ie(ae,ce,xe,"\\u2a7e","\\\\geqslant",!0),ie(ae,ce,xe,"\\u2a96","\\\\eqslantgtr",!0),ie(ae,ce,xe,"\\u2273","\\\\gtrsim",!0),ie(ae,ce,xe,"\\u2a86","\\\\gtrapprox",!0),ie(ae,ce,pe,"\\u22d7","\\\\gtrdot"),ie(ae,ce,xe,"\\u22d9","\\\\ggg",!0),ie(ae,ce,xe,"\\u2277","\\\\gtrless",!0),ie(ae,ce,xe,"\\u22db","\\\\gtreqless",!0),ie(ae,ce,xe,"\\u2a8c","\\\\gtreqqless",!0),ie(ae,ce,xe,"\\u2256","\\\\eqcirc",!0),ie(ae,ce,xe,"\\u2257","\\\\circeq",!0),ie(ae,ce,xe,"\\u225c","\\\\triangleq",!0),ie(ae,ce,xe,"\\u223c","\\\\thicksim"),ie(ae,ce,xe,"\\u2248","\\\\thickapprox"),ie(ae,ce,xe,"\\u2ac6","\\\\supseteqq",!0),ie(ae,ce,xe,"\\u22d1","\\\\Supset",!0),ie(ae,ce,xe,"\\u2290","\\\\sqsupset",!0),ie(ae,ce,xe,"\\u227d","\\\\succcurlyeq",!0),ie(ae,ce,xe,"\\u22df","\\\\curlyeqsucc",!0),ie(ae,ce,xe,"\\u227f","\\\\succsim",!0),ie(ae,ce,xe,"\\u2ab8","\\\\succapprox",!0),ie(ae,ce,xe,"\\u22b3","\\\\vartriangleright"),ie(ae,ce,xe,"\\u22b5","\\\\trianglerighteq"),ie(ae,ce,xe,"\\u22a9","\\\\Vdash",!0),ie(ae,ce,xe,"\\u2223","\\\\shortmid"),ie(ae,ce,xe,"\\u2225","\\\\shortparallel"),ie(ae,ce,xe,"\\u226c","\\\\between",!0),ie(ae,ce,xe,"\\u22d4","\\\\pitchfork",!0),ie(ae,ce,xe,"\\u221d","\\\\varpropto"),ie(ae,ce,xe,"\\u25c0","\\\\blacktriangleleft"),ie(ae,ce,xe,"\\u2234","\\\\therefore",!0),ie(ae,ce,xe,"\\u220d","\\\\backepsilon"),ie(ae,ce,xe,"\\u25b6","\\\\blacktriangleright"),ie(ae,ce,xe,"\\u2235","\\\\because",!0),ie(ae,ce,xe,"\\u22d8","\\\\llless"),ie(ae,ce,xe,"\\u22d9","\\\\gggtr"),ie(ae,ce,pe,"\\u22b2","\\\\lhd"),ie(ae,ce,pe,"\\u22b3","\\\\rhd"),ie(ae,ce,xe,"\\u2242","\\\\eqsim",!0),ie(ae,he,xe,"\\u22c8","\\\\Join"),ie(ae,ce,xe,"\\u2251","\\\\Doteq",!0),ie(ae,ce,pe,"\\u2214","\\\\dotplus",!0),ie(ae,ce,pe,"\\u2216","\\\\smallsetminus"),ie(ae,ce,pe,"\\u22d2","\\\\Cap",!0),ie(ae,ce,pe,"\\u22d3","\\\\Cup",!0),ie(ae,ce,pe,"\\u2a5e","\\\\doublebarwedge",!0),ie(ae,ce,pe,"\\u229f","\\\\boxminus",!0),ie(ae,ce,pe,"\\u229e","\\\\boxplus",!0),ie(ae,ce,pe,"\\u22c7","\\\\divideontimes",!0),ie(ae,ce,pe,"\\u22c9","\\\\ltimes",!0),ie(ae,ce,pe,"\\u22ca","\\\\rtimes",!0),ie(ae,ce,pe,"\\u22cb","\\\\leftthreetimes",!0),ie(ae,ce,pe,"\\u22cc","\\\\rightthreetimes",!0),ie(ae,ce,pe,"\\u22cf","\\\\curlywedge",!0),ie(ae,ce,pe,"\\u22ce","\\\\curlyvee",!0),ie(ae,ce,pe,"\\u229d","\\\\circleddash",!0),ie(ae,ce,pe,"\\u229b","\\\\circledast",!0),ie(ae,ce,pe,"\\u22c5","\\\\centerdot"),ie(ae,ce,pe,"\\u22ba","\\\\intercal",!0),ie(ae,ce,pe,"\\u22d2","\\\\doublecap"),ie(ae,ce,pe,"\\u22d3","\\\\doublecup"),ie(ae,ce,pe,"\\u22a0","\\\\boxtimes",!0),ie(ae,ce,xe,"\\u21e2","\\\\dashrightarrow",!0),ie(ae,ce,xe,"\\u21e0","\\\\dashleftarrow",!0),ie(ae,ce,xe,"\\u21c7","\\\\leftleftarrows",!0),ie(ae,ce,xe,"\\u21c6","\\\\leftrightarrows",!0),ie(ae,ce,xe,"\\u21da","\\\\Lleftarrow",!0),ie(ae,ce,xe,"\\u219e","\\\\twoheadleftarrow",!0),ie(ae,ce,xe,"\\u21a2","\\\\leftarrowtail",!0),ie(ae,ce,xe,"\\u21ab","\\\\looparrowleft",!0),ie(ae,ce,xe,"\\u21cb","\\\\leftrightharpoons",!0),ie(ae,ce,xe,"\\u21b6","\\\\curvearrowleft",!0),ie(ae,ce,xe,"\\u21ba","\\\\circlearrowleft",!0),ie(ae,ce,xe,"\\u21b0","\\\\Lsh",!0),ie(ae,ce,xe,"\\u21c8","\\\\upuparrows",!0),ie(ae,ce,xe,"\\u21bf","\\\\upharpoonleft",!0),ie(ae,ce,xe,"\\u21c3","\\\\downharpoonleft",!0),ie(ae,he,xe,"\\u22b6","\\\\origof",!0),ie(ae,he,xe,"\\u22b7","\\\\imageof",!0),ie(ae,ce,xe,"\\u22b8","\\\\multimap",!0),ie(ae,ce,xe,"\\u21ad","\\\\leftrightsquigarrow",!0),ie(ae,ce,xe,"\\u21c9","\\\\rightrightarrows",!0),ie(ae,ce,xe,"\\u21c4","\\\\rightleftarrows",!0),ie(ae,ce,xe,"\\u21a0","\\\\twoheadrightarrow",!0),ie(ae,ce,xe,"\\u21a3","\\\\rightarrowtail",!0),ie(ae,ce,xe,"\\u21ac","\\\\looparrowright",!0),ie(ae,ce,xe,"\\u21b7","\\\\curvearrowright",!0),ie(ae,ce,xe,"\\u21bb","\\\\circlearrowright",!0),ie(ae,ce,xe,"\\u21b1","\\\\Rsh",!0),ie(ae,ce,xe,"\\u21ca","\\\\downdownarrows",!0),ie(ae,ce,xe,"\\u21be","\\\\upharpoonright",!0),ie(ae,ce,xe,"\\u21c2","\\\\downharpoonright",!0),ie(ae,ce,xe,"\\u21dd","\\\\rightsquigarrow",!0),ie(ae,ce,xe,"\\u21dd","\\\\leadsto"),ie(ae,ce,xe,"\\u21db","\\\\Rrightarrow",!0),ie(ae,ce,xe,"\\u21be","\\\\restriction"),ie(ae,he,ve,"\\u2018","`"),ie(ae,he,ve,"$","\\\\$"),ie(le,he,ve,"$","\\\\$"),ie(le,he,ve,"$","\\\\textdollar"),ie(ae,he,ve,"%","\\\\%"),ie(le,he,ve,"%","\\\\%"),ie(ae,he,ve,"_","\\\\_"),ie(le,he,ve,"_","\\\\_"),ie(le,he,ve,"_","\\\\textunderscore"),ie(ae,he,ve,"\\u2220","\\\\angle",!0),ie(ae,he,ve,"\\u221e","\\\\infty",!0),ie(ae,he,ve,"\\u2032","\\\\prime"),ie(ae,he,ve,"\\u25b3","\\\\triangle"),ie(ae,he,ve,"\\u0393","\\\\Gamma",!0),ie(ae,he,ve,"\\u0394","\\\\Delta",!0),ie(ae,he,ve,"\\u0398","\\\\Theta",!0),ie(ae,he,ve,"\\u039b","\\\\Lambda",!0),ie(ae,he,ve,"\\u039e","\\\\Xi",!0),ie(ae,he,ve,"\\u03a0","\\\\Pi",!0),ie(ae,he,ve,"\\u03a3","\\\\Sigma",!0),ie(ae,he,ve,"\\u03a5","\\\\Upsilon",!0),ie(ae,he,ve,"\\u03a6","\\\\Phi",!0),ie(ae,he,ve,"\\u03a8","\\\\Psi",!0),ie(ae,he,ve,"\\u03a9","\\\\Omega",!0),ie(ae,he,ve,"A","\\u0391"),ie(ae,he,ve,"B","\\u0392"),ie(ae,he,ve,"E","\\u0395"),ie(ae,he,ve,"Z","\\u0396"),ie(ae,he,ve,"H","\\u0397"),ie(ae,he,ve,"I","\\u0399"),ie(ae,he,ve,"K","\\u039a"),ie(ae,he,ve,"M","\\u039c"),ie(ae,he,ve,"N","\\u039d"),ie(ae,he,ve,"O","\\u039f"),ie(ae,he,ve,"P","\\u03a1"),ie(ae,he,ve,"T","\\u03a4"),ie(ae,he,ve,"X","\\u03a7"),ie(ae,he,ve,"\\xac","\\\\neg",!0),ie(ae,he,ve,"\\xac","\\\\lnot"),ie(ae,he,ve,"\\u22a4","\\\\top"),ie(ae,he,ve,"\\u22a5","\\\\bot"),ie(ae,he,ve,"\\u2205","\\\\emptyset"),ie(ae,ce,ve,"\\u2205","\\\\varnothing"),ie(ae,he,ge,"\\u03b1","\\\\alpha",!0),ie(ae,he,ge,"\\u03b2","\\\\beta",!0),ie(ae,he,ge,"\\u03b3","\\\\gamma",!0),ie(ae,he,ge,"\\u03b4","\\\\delta",!0),ie(ae,he,ge,"\\u03f5","\\\\epsilon",!0),ie(ae,he,ge,"\\u03b6","\\\\zeta",!0),ie(ae,he,ge,"\\u03b7","\\\\eta",!0),ie(ae,he,ge,"\\u03b8","\\\\theta",!0),ie(ae,he,ge,"\\u03b9","\\\\iota",!0),ie(ae,he,ge,"\\u03ba","\\\\kappa",!0),ie(ae,he,ge,"\\u03bb","\\\\lambda",!0),ie(ae,he,ge,"\\u03bc","\\\\mu",!0),ie(ae,he,ge,"\\u03bd","\\\\nu",!0),ie(ae,he,ge,"\\u03be","\\\\xi",!0),ie(ae,he,ge,"\\u03bf","\\\\omicron",!0),ie(ae,he,ge,"\\u03c0","\\\\pi",!0),ie(ae,he,ge,"\\u03c1","\\\\rho",!0),ie(ae,he,ge,"\\u03c3","\\\\sigma",!0),ie(ae,he,ge,"\\u03c4","\\\\tau",!0),ie(ae,he,ge,"\\u03c5","\\\\upsilon",!0),ie(ae,he,ge,"\\u03d5","\\\\phi",!0),ie(ae,he,ge,"\\u03c7","\\\\chi",!0),ie(ae,he,ge,"\\u03c8","\\\\psi",!0),ie(ae,he,ge,"\\u03c9","\\\\omega",!0),ie(ae,he,ge,"\\u03b5","\\\\varepsilon",!0),ie(ae,he,ge,"\\u03d1","\\\\vartheta",!0),ie(ae,he,ge,"\\u03d6","\\\\varpi",!0),ie(ae,he,ge,"\\u03f1","\\\\varrho",!0),ie(ae,he,ge,"\\u03c2","\\\\varsigma",!0),ie(ae,he,ge,"\\u03c6","\\\\varphi",!0),ie(ae,he,pe,"\\u2217","*",!0),ie(ae,he,pe,"+","+"),ie(ae,he,pe,"\\u2212","-",!0),ie(ae,he,pe,"\\u22c5","\\\\cdot",!0),ie(ae,he,pe,"\\u2218","\\\\circ",!0),ie(ae,he,pe,"\\xf7","\\\\div",!0),ie(ae,he,pe,"\\xb1","\\\\pm",!0),ie(ae,he,pe,"\\xd7","\\\\times",!0),ie(ae,he,pe,"\\u2229","\\\\cap",!0),ie(ae,he,pe,"\\u222a","\\\\cup",!0),ie(ae,he,pe,"\\u2216","\\\\setminus",!0),ie(ae,he,pe,"\\u2227","\\\\land"),ie(ae,he,pe,"\\u2228","\\\\lor"),ie(ae,he,pe,"\\u2227","\\\\wedge",!0),ie(ae,he,pe,"\\u2228","\\\\vee",!0),ie(ae,he,ve,"\\u221a","\\\\surd"),ie(ae,he,be,"\\u27e8","\\\\langle",!0),ie(ae,he,be,"\\u2223","\\\\lvert"),ie(ae,he,be,"\\u2225","\\\\lVert"),ie(ae,he,ue,"?","?"),ie(ae,he,ue,"!","!"),ie(ae,he,ue,"\\u27e9","\\\\rangle",!0),ie(ae,he,ue,"\\u2223","\\\\rvert"),ie(ae,he,ue,"\\u2225","\\\\rVert"),ie(ae,he,xe,"=","="),ie(ae,he,xe,":",":"),ie(ae,he,xe,"\\u2248","\\\\approx",!0),ie(ae,he,xe,"\\u2245","\\\\cong",!0),ie(ae,he,xe,"\\u2265","\\\\ge"),ie(ae,he,xe,"\\u2265","\\\\geq",!0),ie(ae,he,xe,"\\u2190","\\\\gets"),ie(ae,he,xe,">","\\\\gt",!0),ie(ae,he,xe,"\\u2208","\\\\in",!0),ie(ae,he,xe,"\\ue020","\\\\@not"),ie(ae,he,xe,"\\u2282","\\\\subset",!0),ie(ae,he,xe,"\\u2283","\\\\supset",!0),ie(ae,he,xe,"\\u2286","\\\\subseteq",!0),ie(ae,he,xe,"\\u2287","\\\\supseteq",!0),ie(ae,ce,xe,"\\u2288","\\\\nsubseteq",!0),ie(ae,ce,xe,"\\u2289","\\\\nsupseteq",!0),ie(ae,he,xe,"\\u22a8","\\\\models"),ie(ae,he,xe,"\\u2190","\\\\leftarrow",!0),ie(ae,he,xe,"\\u2264","\\\\le"),ie(ae,he,xe,"\\u2264","\\\\leq",!0),ie(ae,he,xe,"<","\\\\lt",!0),ie(ae,he,xe,"\\u2192","\\\\rightarrow",!0),ie(ae,he,xe,"\\u2192","\\\\to"),ie(ae,ce,xe,"\\u2271","\\\\ngeq",!0),ie(ae,ce,xe,"\\u2270","\\\\nleq",!0),ie(ae,he,we,"\\xa0","\\\\ "),ie(ae,he,we,"\\xa0","\\\\space"),ie(ae,he,we,"\\xa0","\\\\nobreakspace"),ie(le,he,we,"\\xa0","\\\\ "),ie(le,he,we,"\\xa0"," "),ie(le,he,we,"\\xa0","\\\\space"),ie(le,he,we,"\\xa0","\\\\nobreakspace"),ie(ae,he,we,null,"\\\\nobreak"),ie(ae,he,we,null,"\\\\allowbreak"),ie(ae,he,ye,",",","),ie(ae,he,ye,";",";"),ie(ae,ce,pe,"\\u22bc","\\\\barwedge",!0),ie(ae,ce,pe,"\\u22bb","\\\\veebar",!0),ie(ae,he,pe,"\\u2299","\\\\odot",!0),ie(ae,he,pe,"\\u2295","\\\\oplus",!0),ie(ae,he,pe,"\\u2297","\\\\otimes",!0),ie(ae,he,ve,"\\u2202","\\\\partial",!0),ie(ae,he,pe,"\\u2298","\\\\oslash",!0),ie(ae,ce,pe,"\\u229a","\\\\circledcirc",!0),ie(ae,ce,pe,"\\u22a1","\\\\boxdot",!0),ie(ae,he,pe,"\\u25b3","\\\\bigtriangleup"),ie(ae,he,pe,"\\u25bd","\\\\bigtriangledown"),ie(ae,he,pe,"\\u2020","\\\\dagger"),ie(ae,he,pe,"\\u22c4","\\\\diamond"),ie(ae,he,pe,"\\u22c6","\\\\star"),ie(ae,he,pe,"\\u25c3","\\\\triangleleft"),ie(ae,he,pe,"\\u25b9","\\\\triangleright"),ie(ae,he,be,"{","\\\\{"),ie(le,he,ve,"{","\\\\{"),ie(le,he,ve,"{","\\\\textbraceleft"),ie(ae,he,ue,"}","\\\\}"),ie(le,he,ve,"}","\\\\}"),ie(le,he,ve,"}","\\\\textbraceright"),ie(ae,he,be,"{","\\\\lbrace"),ie(ae,he,ue,"}","\\\\rbrace"),ie(ae,he,be,"[","\\\\lbrack",!0),ie(le,he,ve,"[","\\\\lbrack",!0),ie(ae,he,ue,"]","\\\\rbrack",!0),ie(le,he,ve,"]","\\\\rbrack",!0),ie(ae,he,be,"(","\\\\lparen",!0),ie(ae,he,ue,")","\\\\rparen",!0),ie(le,he,ve,"<","\\\\textless",!0),ie(le,he,ve,">","\\\\textgreater",!0),ie(ae,he,be,"\\u230a","\\\\lfloor",!0),ie(ae,he,ue,"\\u230b","\\\\rfloor",!0),ie(ae,he,be,"\\u2308","\\\\lceil",!0),ie(ae,he,ue,"\\u2309","\\\\rceil",!0),ie(ae,he,ve,"\\\\","\\\\backslash"),ie(ae,he,ve,"\\u2223","|"),ie(ae,he,ve,"\\u2223","\\\\vert"),ie(le,he,ve,"|","\\\\textbar",!0),ie(ae,he,ve,"\\u2225","\\\\|"),ie(ae,he,ve,"\\u2225","\\\\Vert"),ie(le,he,ve,"\\u2225","\\\\textbardbl"),ie(le,he,ve,"~","\\\\textasciitilde"),ie(le,he,ve,"\\\\","\\\\textbackslash"),ie(le,he,ve,"^","\\\\textasciicircum"),ie(ae,he,xe,"\\u2191","\\\\uparrow",!0),ie(ae,he,xe,"\\u21d1","\\\\Uparrow",!0),ie(ae,he,xe,"\\u2193","\\\\downarrow",!0),ie(ae,he,xe,"\\u21d3","\\\\Downarrow",!0),ie(ae,he,xe,"\\u2195","\\\\updownarrow",!0),ie(ae,he,xe,"\\u21d5","\\\\Updownarrow",!0),ie(ae,he,fe,"\\u2210","\\\\coprod"),ie(ae,he,fe,"\\u22c1","\\\\bigvee"),ie(ae,he,fe,"\\u22c0","\\\\bigwedge"),ie(ae,he,fe,"\\u2a04","\\\\biguplus"),ie(ae,he,fe,"\\u22c2","\\\\bigcap"),ie(ae,he,fe,"\\u22c3","\\\\bigcup"),ie(ae,he,fe,"\\u222b","\\\\int"),ie(ae,he,fe,"\\u222b","\\\\intop"),ie(ae,he,fe,"\\u222c","\\\\iint"),ie(ae,he,fe,"\\u222d","\\\\iiint"),ie(ae,he,fe,"\\u220f","\\\\prod"),ie(ae,he,fe,"\\u2211","\\\\sum"),ie(ae,he,fe,"\\u2a02","\\\\bigotimes"),ie(ae,he,fe,"\\u2a01","\\\\bigoplus"),ie(ae,he,fe,"\\u2a00","\\\\bigodot"),ie(ae,he,fe,"\\u222e","\\\\oint"),ie(ae,he,fe,"\\u222f","\\\\oiint"),ie(ae,he,fe,"\\u2230","\\\\oiiint"),ie(ae,he,fe,"\\u2a06","\\\\bigsqcup"),ie(ae,he,fe,"\\u222b","\\\\smallint"),ie(le,he,de,"\\u2026","\\\\textellipsis"),ie(ae,he,de,"\\u2026","\\\\mathellipsis"),ie(le,he,de,"\\u2026","\\\\ldots",!0),ie(ae,he,de,"\\u2026","\\\\ldots",!0),ie(ae,he,de,"\\u22ef","\\\\@cdots",!0),ie(ae,he,de,"\\u22f1","\\\\ddots",!0),ie(ae,he,ve,"\\u22ee","\\\\varvdots"),ie(le,he,ve,"\\u22ee","\\\\varvdots"),ie(ae,he,me,"\\u02ca","\\\\acute"),ie(ae,he,me,"\\u02cb","\\\\grave"),ie(ae,he,me,"\\xa8","\\\\ddot"),ie(ae,he,me,"~","\\\\tilde"),ie(ae,he,me,"\\u02c9","\\\\bar"),ie(ae,he,me,"\\u02d8","\\\\breve"),ie(ae,he,me,"\\u02c7","\\\\check"),ie(ae,he,me,"^","\\\\hat"),ie(ae,he,me,"\\u20d7","\\\\vec"),ie(ae,he,me,"\\u02d9","\\\\dot"),ie(ae,he,me,"\\u02da","\\\\mathring"),ie(ae,he,ge,"\\ue131","\\\\@imath"),ie(ae,he,ge,"\\ue237","\\\\@jmath"),ie(ae,he,ve,"\\u0131","\\u0131"),ie(ae,he,ve,"\\u0237","\\u0237"),ie(le,he,ve,"\\u0131","\\\\i",!0),ie(le,he,ve,"\\u0237","\\\\j",!0),ie(le,he,ve,"\\xdf","\\\\ss",!0),ie(le,he,ve,"\\xe6","\\\\ae",!0),ie(le,he,ve,"\\u0153","\\\\oe",!0),ie(le,he,ve,"\\xf8","\\\\o",!0),ie(le,he,ve,"\\xc6","\\\\AE",!0),ie(le,he,ve,"\\u0152","\\\\OE",!0),ie(le,he,ve,"\\xd8","\\\\O",!0),ie(le,he,me,"\\u02ca","\\\\\'"),ie(le,he,me,"\\u02cb","\\\\`"),ie(le,he,me,"\\u02c6","\\\\^"),ie(le,he,me,"\\u02dc","\\\\~"),ie(le,he,me,"\\u02c9","\\\\="),ie(le,he,me,"\\u02d8","\\\\u"),ie(le,he,me,"\\u02d9","\\\\."),ie(le,he,me,"\\xb8","\\\\c"),ie(le,he,me,"\\u02da","\\\\r"),ie(le,he,me,"\\u02c7","\\\\v"),ie(le,he,me,"\\xa8",\'\\\\"\'),ie(le,he,me,"\\u02dd","\\\\H"),ie(le,he,me,"\\u25ef","\\\\textcircled");const ke={"--":!0,"---":!0,"``":!0,"\'\'":!0};ie(le,he,ve,"\\u2013","--",!0),ie(le,he,ve,"\\u2013","\\\\textendash"),ie(le,he,ve,"\\u2014","---",!0),ie(le,he,ve,"\\u2014","\\\\textemdash"),ie(le,he,ve,"\\u2018","`",!0),ie(le,he,ve,"\\u2018","\\\\textquoteleft"),ie(le,he,ve,"\\u2019","\'",!0),ie(le,he,ve,"\\u2019","\\\\textquoteright"),ie(le,he,ve,"\\u201c","``",!0),ie(le,he,ve,"\\u201c","\\\\textquotedblleft"),ie(le,he,ve,"\\u201d","\'\'",!0),ie(le,he,ve,"\\u201d","\\\\textquotedblright"),ie(ae,he,ve,"\\xb0","\\\\degree",!0),ie(le,he,ve,"\\xb0","\\\\degree"),ie(le,he,ve,"\\xb0","\\\\textdegree",!0),ie(ae,he,ve,"\\xa3","\\\\pounds"),ie(ae,he,ve,"\\xa3","\\\\mathsterling",!0),ie(le,he,ve,"\\xa3","\\\\pounds"),ie(le,he,ve,"\\xa3","\\\\textsterling",!0),ie(ae,ce,ve,"\\u2720","\\\\maltese"),ie(le,ce,ve,"\\u2720","\\\\maltese");const Se=\'0123456789/@."\';for(let e=0;e<14;e++){const t=Se.charAt(e);ie(ae,he,ve,t,t)}const Me=\'0123456789!@*()-=+";:?/.,\';for(let e=0;e<25;e++){const t=Me.charAt(e);ie(le,he,ve,t,t)}const ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let e=0;e<52;e++){const t=ze.charAt(e);ie(ae,he,ge,t,t),ie(le,he,ve,t,t)}ie(ae,ce,ve,"C","\\u2102"),ie(le,ce,ve,"C","\\u2102"),ie(ae,ce,ve,"H","\\u210d"),ie(le,ce,ve,"H","\\u210d"),ie(ae,ce,ve,"N","\\u2115"),ie(le,ce,ve,"N","\\u2115"),ie(ae,ce,ve,"P","\\u2119"),ie(le,ce,ve,"P","\\u2119"),ie(ae,ce,ve,"Q","\\u211a"),ie(le,ce,ve,"Q","\\u211a"),ie(ae,ce,ve,"R","\\u211d"),ie(le,ce,ve,"R","\\u211d"),ie(ae,ce,ve,"Z","\\u2124"),ie(le,ce,ve,"Z","\\u2124"),ie(ae,he,ge,"h","\\u210e"),ie(le,he,ge,"h","\\u210e");let Ae="";for(let e=0;e<52;e++){const t=ze.charAt(e);Ae=String.fromCharCode(55349,56320+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56372+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56424+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56580+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56684+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56736+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56788+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56840+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56944+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),e<26&&(Ae=String.fromCharCode(55349,56632+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,56476+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae))}Ae=String.fromCharCode(55349,56668),ie(ae,he,ge,"k",Ae),ie(le,he,ve,"k",Ae);for(let e=0;e<10;e++){const t=e.toString();Ae=String.fromCharCode(55349,57294+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,57314+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,57324+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae),Ae=String.fromCharCode(55349,57334+e),ie(ae,he,ge,t,Ae),ie(le,he,ve,t,Ae)}const Te="\\xd0\\xde\\xfe";for(let e=0;e<3;e++){const t=Te.charAt(e);ie(ae,he,ge,t,t),ie(le,he,ve,t,t)}const Be=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],Ce=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Ne=function(e,t,r){return se[r][e]&&se[r][e].replace&&(e=se[r][e].replace),{value:e,metrics:N(e,t,r)}},qe=function(e,t,r,n,o){const s=Ne(e,t,r),i=s.metrics;let a;if(e=s.value,i){let t=i.italic;("text"===r||n&&"mathit"===n.font)&&(t=0),a=new K(e,i.height,i.depth,t,i.skew,i.width,o)}else"undefined"!=typeof console&&console.warn("No character metrics for \'"+e+"\' in style \'"+t+"\' and mode \'"+r+"\'"),a=new K(e,0,0,0,0,0,o);if(n){a.maxFontSize=n.sizeMultiplier,n.style.isTight()&&a.classes.push("mtight");const e=n.getColor();e&&(a.style.color=e)}return a},Ie=(e,t)=>{if(G(e.classes)!==G(t.classes)||e.skew!==t.skew||e.maxFontSize!==t.maxFontSize)return!1;if(1===e.classes.length){const t=e.classes[0];if("mbin"===t||"mord"===t)return!1}for(const r in e.style)if(e.style.hasOwnProperty(r)&&e.style[r]!==t.style[r])return!1;for(const r in t.style)if(t.style.hasOwnProperty(r)&&e.style[r]!==t.style[r])return!1;return!0},Re=function(e){let t=0,r=0,n=0;for(let o=0;o<e.children.length;o++){const s=e.children[o];s.height>t&&(t=s.height),s.depth>r&&(r=s.depth),s.maxFontSize>n&&(n=s.maxFontSize)}e.height=t,e.depth=r,e.maxFontSize=n},He=function(e,t,r,n){const o=new _(e,t,r,n);return Re(o),o},Oe=(e,t,r,n)=>new _(e,t,r,n),Ee=function(e){const t=new A(e);return Re(t),t},Le=function(e,t,r){let n,o="";switch(e){case"amsrm":o="AMS";break;case"textrm":o="Main";break;case"textsf":o="SansSerif";break;case"texttt":o="Typewriter";break;default:o=e}return n="textbf"===t&&"textit"===r?"BoldItalic":"textbf"===t?"Bold":"textit"===t?"Italic":"Regular",o+"-"+n},De={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},Ve={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]};var Pe={fontMap:De,makeSymbol:qe,mathsym:function(e,t,r,n){return void 0===n&&(n=[]),"boldsymbol"===r.font&&Ne(e,"Main-Bold",t).metrics?qe(e,"Main-Bold",t,r,n.concat(["mathbf"])):"\\\\"===e||"main"===se[t][e].font?qe(e,"Main-Regular",t,r,n):qe(e,"AMS-Regular",t,r,n.concat(["amsrm"]))},makeSpan:He,makeSvgSpan:Oe,makeLineSpan:function(e,t,r){const n=He([e],[],t);return n.height=Math.max(r||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),n.style.borderBottomWidth=F(n.height),n.maxFontSize=1,n},makeAnchor:function(e,t,r,n){const o=new j(e,t,r,n);return Re(o),o},makeFragment:Ee,wrapFragment:function(e,t){return e instanceof A?He([],[e],t):e},makeVList:function(e,t){const{children:r,depth:n}=function(e){if("individualShift"===e.positionType){const t=e.children,r=[t[0]],n=-t[0].shift-t[0].elem.depth;let o=n;for(let e=1;e<t.length;e++){const n=-t[e].shift-o-t[e].elem.depth,s=n-(t[e-1].elem.height+t[e-1].elem.depth);o+=n,r.push({type:"kern",size:s}),r.push(t[e])}return{children:r,depth:n}}let t;if("top"===e.positionType){let r=e.positionData;for(let t=0;t<e.children.length;t++){const n=e.children[t];r-="kern"===n.type?n.size:n.elem.height+n.elem.depth}t=r}else if("bottom"===e.positionType)t=-e.positionData;else{const r=e.children[0];if("elem"!==r.type)throw new Error(\'First child must have type "elem".\');if("shift"===e.positionType)t=-r.elem.depth-e.positionData;else{if("firstBaseline"!==e.positionType)throw new Error("Invalid positionType "+e.positionType+".");t=-r.elem.depth}}return{children:e.children,depth:t}}(e);let o=0;for(let e=0;e<r.length;e++){const t=r[e];if("elem"===t.type){const e=t.elem;o=Math.max(o,e.maxFontSize,e.height)}}o+=2;const s=He(["pstrut"],[]);s.style.height=F(o);const i=[];let a=n,l=n,h=n;for(let e=0;e<r.length;e++){const t=r[e];if("kern"===t.type)h+=t.size;else{const e=t.elem,r=t.wrapperClasses||[],n=t.wrapperStyle||{},a=He(r,[s,e],void 0,n);a.style.top=F(-o-h-e.depth),t.marginLeft&&(a.style.marginLeft=t.marginLeft),t.marginRight&&(a.style.marginRight=t.marginRight),i.push(a),h+=e.height+e.depth}a=Math.min(a,h),l=Math.max(l,h)}const c=He(["vlist"],i);let m;if(c.style.height=F(l),a<0){const e=He([],[]),t=He(["vlist"],[e]);t.style.height=F(-a);const r=He(["vlist-s"],[new K("\\u200b")]);m=[He(["vlist-r"],[c,r]),He(["vlist-r"],[t])]}else m=[He(["vlist-r"],[c])];const p=He(["vlist-t"],m);return 2===m.length&&p.classes.push("vlist-t2"),p.height=l,p.depth=-a,p},makeOrd:function(e,t,r){const o=e.mode,s=e.text,i=["mord"],a="math"===o||"text"===o&&t.font,l=a?t.font:t.fontFamily;let h="",c="";if(55349===s.charCodeAt(0)&&([h,c]=function(e,t){const r=1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536,o="math"===t?0:1;if(119808<=r&&r<120484){const e=Math.floor((r-119808)/26);return[Be[e][2],Be[e][o]]}if(120782<=r&&r<=120831){const e=Math.floor((r-120782)/10);return[Ce[e][2],Ce[e][o]]}if(120485===r||120486===r)return[Be[0][2],Be[0][o]];if(120486<r&&r<120782)return["",""];throw new n("Unsupported character: "+e)}(s,o)),h.length>0)return qe(s,h,o,t,i.concat(c));if(l){let e,n;if("boldsymbol"===l){const t=function(e,t,r,n,o){return"textord"!==o&&Ne(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}}(s,o,0,0,r);e=t.fontName,n=[t.fontClass]}else a?(e=De[l].fontName,n=[l]):(e=Le(l,t.fontWeight,t.fontShape),n=[l,t.fontWeight,t.fontShape]);if(Ne(s,e,o).metrics)return qe(s,e,o,t,i.concat(n));if(ke.hasOwnProperty(s)&&"Typewriter"===e.slice(0,10)){const r=[];for(let a=0;a<s.length;a++)r.push(qe(s[a],e,o,t,i.concat(n)));return Ee(r)}}if("mathord"===r)return qe(s,"Math-Italic",o,t,i.concat(["mathnormal"]));if("textord"===r){const e=se[o][s]&&se[o][s].font;if("ams"===e){const e=Le("amsrm",t.fontWeight,t.fontShape);return qe(s,e,o,t,i.concat("amsrm",t.fontWeight,t.fontShape))}if("main"!==e&&e){const r=Le(e,t.fontWeight,t.fontShape);return qe(s,r,o,t,i.concat(r,t.fontWeight,t.fontShape))}{const e=Le("textrm",t.fontWeight,t.fontShape);return qe(s,e,o,t,i.concat(t.fontWeight,t.fontShape))}}throw new Error("unexpected type: "+r+" in makeOrd")},makeGlue:(e,t)=>{const r=He(["mspace"],[],t),n=P(e,t);return r.style.marginRight=F(n),r},staticSvg:function(e,t){const[r,n,o]=Ve[e],s=new Q(r),i=new J([s],{width:F(n),height:F(o),style:"width:"+F(n),viewBox:"0 0 "+1e3*n+" "+1e3*o,preserveAspectRatio:"xMinYMin"}),a=Oe(["overlay"],[i],t);return a.height=o,a.style.height=F(o),a.style.width=F(n),a},svgData:Ve,tryCombineChars:e=>{for(let t=0;t<e.length-1;t++){const r=e[t],n=e[t+1];r instanceof K&&n instanceof K&&Ie(r,n)&&(r.text+=n.text,r.height=Math.max(r.height,n.height),r.depth=Math.max(r.depth,n.depth),r.italic=n.italic,e.splice(t+1,1),t--)}return e}};const Fe={number:3,unit:"mu"},Ge={number:4,unit:"mu"},Ue={number:5,unit:"mu"},Ye={mord:{mop:Fe,mbin:Ge,mrel:Ue,minner:Fe},mop:{mord:Fe,mop:Fe,mrel:Ue,minner:Fe},mbin:{mord:Ge,mop:Ge,mopen:Ge,minner:Ge},mrel:{mord:Ue,mop:Ue,mopen:Ue,minner:Ue},mopen:{},mclose:{mop:Fe,mbin:Ge,mrel:Ue,minner:Fe},mpunct:{mord:Fe,mop:Fe,mrel:Ue,mopen:Fe,mclose:Fe,mpunct:Fe,minner:Fe},minner:{mord:Fe,mop:Fe,mbin:Ge,mrel:Ue,mopen:Fe,mpunct:Fe,minner:Fe}},Xe={mord:{mop:Fe},mop:{mord:Fe,mop:Fe},mbin:{},mrel:{},mopen:{},mclose:{mop:Fe},mpunct:{},minner:{mop:Fe}},We={},_e={},je={};function $e(e){let{type:t,names:r,props:n,handler:o,htmlBuilder:s,mathmlBuilder:i}=e;const a={type:t,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:void 0===n.allowedInMath||n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:o};for(let e=0;e<r.length;++e)We[r[e]]=a;t&&(s&&(_e[t]=s),i&&(je[t]=i))}function Ze(e){let{type:t,htmlBuilder:r,mathmlBuilder:n}=e;$e({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:r,mathmlBuilder:n})}const Ke=function(e){return"ordgroup"===e.type&&1===e.body.length?e.body[0]:e},Je=function(e){return"ordgroup"===e.type?e.body:[e]},Qe=Pe.makeSpan,et=["leftmost","mbin","mopen","mrel","mop","mpunct"],tt=["rightmost","mrel","mclose","mpunct"],rt={display:w.DISPLAY,text:w.TEXT,script:w.SCRIPT,scriptscript:w.SCRIPTSCRIPT},nt={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},ot=function(e,t,r,n){void 0===n&&(n=[null,null]);const o=[];for(let r=0;r<e.length;r++){const n=ct(e[r],t);if(n instanceof A){const e=n.children;o.push(...e)}else o.push(n)}if(Pe.tryCombineChars(o),!r)return o;let s=t;if(1===e.length){const r=e[0];"sizing"===r.type?s=t.havingSize(r.size):"styling"===r.type&&(s=t.havingStyle(rt[r.style]))}const i=Qe([n[0]||"leftmost"],[],t),a=Qe([n[1]||"rightmost"],[],t),h="root"===r;return st(o,((e,t)=>{const r=t.classes[0],n=e.classes[0];"mbin"===r&&l.contains(tt,n)?t.classes[0]="mord":"mbin"===n&&l.contains(et,r)&&(e.classes[0]="mord")}),{node:i},a,h),st(o,((e,t)=>{const r=lt(t),n=lt(e),o=r&&n?e.hasClass("mtight")?Xe[r][n]:Ye[r][n]:null;if(o)return Pe.makeGlue(o,s)}),{node:i},a,h),o},st=function(e,t,r,n,o){n&&e.push(n);let s=0;for(;s<e.length;s++){const n=e[s],i=it(n);if(i){st(i.children,t,r,null,o);continue}const a=!n.hasClass("mspace");if(a){const o=t(n,r.node);o&&(r.insertAfter?r.insertAfter(o):(e.unshift(o),s++))}a?r.node=n:o&&n.hasClass("newline")&&(r.node=Qe(["leftmost"])),r.insertAfter=(t=>r=>{e.splice(t+1,0,r),s++})(s)}n&&e.pop()},it=function(e){return e instanceof A||e instanceof j||e instanceof _&&e.hasClass("enclosing")?e:null},at=function(e,t){const r=it(e);if(r){const e=r.children;if(e.length){if("right"===t)return at(e[e.length-1],"right");if("left"===t)return at(e[0],"left")}}return e},lt=function(e,t){return e?(t&&(e=at(e,t)),nt[e.classes[0]]||null):null},ht=function(e,t){const r=["nulldelimiter"].concat(e.baseSizingClasses());return Qe(t.concat(r))},ct=function(e,t,r){if(!e)return Qe();if(_e[e.type]){let n=_e[e.type](e,t);if(r&&t.size!==r.size){n=Qe(t.sizingClasses(r),[n],t);const e=t.sizeMultiplier/r.sizeMultiplier;n.height*=e,n.depth*=e}return n}throw new n("Got group of unknown type: \'"+e.type+"\'")};function mt(e,t){const r=Qe(["base"],e,t),n=Qe(["strut"]);return n.style.height=F(r.height+r.depth),r.depth&&(n.style.verticalAlign=F(-r.depth)),r.children.unshift(n),r}function pt(e,t){let r=null;1===e.length&&"tag"===e[0].type&&(r=e[0].tag,e=e[0].body);const n=ot(e,t,"root");let o;2===n.length&&n[1].hasClass("tag")&&(o=n.pop());const s=[];let i,a=[];for(let e=0;e<n.length;e++)if(a.push(n[e]),n[e].hasClass("mbin")||n[e].hasClass("mrel")||n[e].hasClass("allowbreak")){let r=!1;for(;e<n.length-1&&n[e+1].hasClass("mspace")&&!n[e+1].hasClass("newline");)e++,a.push(n[e]),n[e].hasClass("nobreak")&&(r=!0);r||(s.push(mt(a,t)),a=[])}else n[e].hasClass("newline")&&(a.pop(),a.length>0&&(s.push(mt(a,t)),a=[]),s.push(n[e]));a.length>0&&s.push(mt(a,t)),r?(i=mt(ot(r,t,!0)),i.classes=["tag"],s.push(i)):o&&s.push(o);const l=Qe(["katex-html"],s);if(l.setAttribute("aria-hidden","true"),i){const e=i.children[0];e.style.height=F(l.height+l.depth),l.depth&&(e.style.verticalAlign=F(-l.depth))}return l}function ut(e){return new A(e)}class dt{constructor(e,t,r){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=r||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){const e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=G(this.classes));for(let t=0;t<this.children.length;t++)if(this.children[t]instanceof gt&&this.children[t+1]instanceof gt){let r=this.children[t].toText()+this.children[++t].toText();for(;this.children[t+1]instanceof gt;)r+=this.children[++t].toText();e.appendChild(new gt(r).toNode())}else e.appendChild(this.children[t].toNode());return e}toMarkup(){let e="<"+this.type;for(const t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+\'="\',e+=l.escape(this.attributes[t]),e+=\'"\');this.classes.length>0&&(e+=\' class ="\'+l.escape(G(this.classes))+\'"\'),e+=">";for(let t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map((e=>e.toText())).join("")}}class gt{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return l.escape(this.toText())}toText(){return this.text}}var ft={MathNode:dt,TextNode:gt,SpaceNode:class{constructor(e){this.width=void 0,this.character=void 0,this.width=e,this.character=e>=.05555&&e<=.05556?"\\u200a":e>=.1666&&e<=.1667?"\\u2009":e>=.2222&&e<=.2223?"\\u2005":e>=.2777&&e<=.2778?"\\u2005\\u200a":e>=-.05556&&e<=-.05555?"\\u200a\\u2063":e>=-.1667&&e<=-.1666?"\\u2009\\u2063":e>=-.2223&&e<=-.2222?"\\u205f\\u2063":e>=-.2778&&e<=-.2777?"\\u2005\\u2063":null}toNode(){if(this.character)return document.createTextNode(this.character);{const e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",F(this.width)),e}}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":\'<mspace width="\'+F(this.width)+\'"/>\'}toText(){return this.character?this.character:" "}},newDocumentFragment:ut};const bt=function(e,t,r){return!se[t][e]||!se[t][e].replace||55349===e.charCodeAt(0)||ke.hasOwnProperty(e)&&r&&(r.fontFamily&&"tt"===r.fontFamily.slice(4,6)||r.font&&"tt"===r.font.slice(4,6))||(e=se[t][e].replace),new ft.TextNode(e)},yt=function(e){return 1===e.length?e[0]:new ft.MathNode("mrow",e)},xt=function(e,t){if("texttt"===t.fontFamily)return"monospace";if("textsf"===t.fontFamily)return"textit"===t.fontShape&&"textbf"===t.fontWeight?"sans-serif-bold-italic":"textit"===t.fontShape?"sans-serif-italic":"textbf"===t.fontWeight?"bold-sans-serif":"sans-serif";if("textit"===t.fontShape&&"textbf"===t.fontWeight)return"bold-italic";if("textit"===t.fontShape)return"italic";if("textbf"===t.fontWeight)return"bold";const r=t.font;if(!r||"mathnormal"===r)return null;const n=e.mode;if("mathit"===r)return"italic";if("boldsymbol"===r)return"textord"===e.type?"bold":"bold-italic";if("mathbf"===r)return"bold";if("mathbb"===r)return"double-struck";if("mathsfit"===r)return"sans-serif-italic";if("mathfrak"===r)return"fraktur";if("mathscr"===r||"mathcal"===r)return"script";if("mathsf"===r)return"sans-serif";if("mathtt"===r)return"monospace";let o=e.text;if(l.contains(["\\\\imath","\\\\jmath"],o))return null;se[n][o]&&se[n][o].replace&&(o=se[n][o].replace);return N(o,Pe.fontMap[r].fontName,n)?Pe.fontMap[r].variant:null};function wt(e){if(!e)return!1;if("mi"===e.type&&1===e.children.length){const t=e.children[0];return t instanceof gt&&"."===t.text}if("mo"===e.type&&1===e.children.length&&"true"===e.getAttribute("separator")&&"0em"===e.getAttribute("lspace")&&"0em"===e.getAttribute("rspace")){const t=e.children[0];return t instanceof gt&&","===t.text}return!1}const vt=function(e,t,r){if(1===e.length){const n=St(e[0],t);return r&&n instanceof dt&&"mo"===n.type&&(n.setAttribute("lspace","0em"),n.setAttribute("rspace","0em")),[n]}const n=[];let o;for(let r=0;r<e.length;r++){const s=St(e[r],t);if(s instanceof dt&&o instanceof dt){if("mtext"===s.type&&"mtext"===o.type&&s.getAttribute("mathvariant")===o.getAttribute("mathvariant")){o.children.push(...s.children);continue}if("mn"===s.type&&"mn"===o.type){o.children.push(...s.children);continue}if(wt(s)&&"mn"===o.type){o.children.push(...s.children);continue}if("mn"===s.type&&wt(o))s.children=[...o.children,...s.children],n.pop();else if(("msup"===s.type||"msub"===s.type)&&s.children.length>=1&&("mn"===o.type||wt(o))){const e=s.children[0];e instanceof dt&&"mn"===e.type&&(e.children=[...o.children,...e.children],n.pop())}else if("mi"===o.type&&1===o.children.length){const e=o.children[0];if(e instanceof gt&&"\\u0338"===e.text&&("mo"===s.type||"mi"===s.type||"mn"===s.type)){const e=s.children[0];e instanceof gt&&e.text.length>0&&(e.text=e.text.slice(0,1)+"\\u0338"+e.text.slice(1),n.pop())}}}n.push(s),o=s}return n},kt=function(e,t,r){return yt(vt(e,t,r))},St=function(e,t){if(!e)return new ft.MathNode("mrow");if(je[e.type]){return je[e.type](e,t)}throw new n("Got group of unknown type: \'"+e.type+"\'")};function Mt(e,t,r,n,o){const s=vt(e,r);let i;i=1===s.length&&s[0]instanceof dt&&l.contains(["mrow","mtable"],s[0].type)?s[0]:new ft.MathNode("mrow",s);const a=new ft.MathNode("annotation",[new ft.TextNode(t)]);a.setAttribute("encoding","application/x-tex");const h=new ft.MathNode("semantics",[i,a]),c=new ft.MathNode("math",[h]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&c.setAttribute("display","block");const m=o?"katex":"katex-mathml";return Pe.makeSpan([m],[c])}const zt=function(e){return new E({style:e.displayMode?w.DISPLAY:w.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},At=function(e,t){if(t.displayMode){const r=["katex-display"];t.leqno&&r.push("leqno"),t.fleqn&&r.push("fleqn"),e=Pe.makeSpan(r,[e])}return e},Tt=function(e,t,r){const n=zt(r);let o;if("mathml"===r.output)return Mt(e,t,n,r.displayMode,!0);if("html"===r.output){const t=pt(e,n);o=Pe.makeSpan(["katex"],[t])}else{const s=Mt(e,t,n,r.displayMode,!1),i=pt(e,n);o=Pe.makeSpan(["katex"],[s,i])}return At(o,r)};const Bt={widehat:"^",widecheck:"\\u02c7",widetilde:"~",utilde:"~",overleftarrow:"\\u2190",underleftarrow:"\\u2190",xleftarrow:"\\u2190",overrightarrow:"\\u2192",underrightarrow:"\\u2192",xrightarrow:"\\u2192",underbrace:"\\u23df",overbrace:"\\u23de",overgroup:"\\u23e0",undergroup:"\\u23e1",overleftrightarrow:"\\u2194",underleftrightarrow:"\\u2194",xleftrightarrow:"\\u2194",Overrightarrow:"\\u21d2",xRightarrow:"\\u21d2",overleftharpoon:"\\u21bc",xleftharpoonup:"\\u21bc",overrightharpoon:"\\u21c0",xrightharpoonup:"\\u21c0",xLeftarrow:"\\u21d0",xLeftrightarrow:"\\u21d4",xhookleftarrow:"\\u21a9",xhookrightarrow:"\\u21aa",xmapsto:"\\u21a6",xrightharpoondown:"\\u21c1",xleftharpoondown:"\\u21bd",xrightleftharpoons:"\\u21cc",xleftrightharpoons:"\\u21cb",xtwoheadleftarrow:"\\u219e",xtwoheadrightarrow:"\\u21a0",xlongequal:"=",xtofrom:"\\u21c4",xrightleftarrows:"\\u21c4",xrightequilibrium:"\\u21cc",xleftequilibrium:"\\u21cb","\\\\cdrightarrow":"\\u2192","\\\\cdleftarrow":"\\u2190","\\\\cdlongequal":"="},Ct={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]};var Nt=function(e,t,r,n,o){let s;const i=e.height+e.depth+r+n;if(/fbox|color|angl/.test(t)){if(s=Pe.makeSpan(["stretchy",t],[],o),"fbox"===t){const e=o.color&&o.getColor();e&&(s.style.borderColor=e)}}else{const e=[];/^[bx]cancel$/.test(t)&&e.push(new ee({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&e.push(new ee({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));const r=new J(e,{width:"100%",height:F(i)});s=Pe.makeSvgSpan([],[r],o)}return s.height=i,s.style.height=F(i),s},qt=function(e){const t=new ft.MathNode("mo",[new ft.TextNode(Bt[e.replace(/^\\\\/,"")])]);return t.setAttribute("stretchy","true"),t},It=function(e,t){const{span:r,minWidth:n,height:o}=function(){let r=4e5;const n=e.label.slice(1);if(l.contains(["widehat","widecheck","widetilde","utilde"],n)){const s="ordgroup"===(o=e.base).type?o.body.length:1;let i,a,l;if(s>5)"widehat"===n||"widecheck"===n?(i=420,r=2364,l=.42,a=n+"4"):(i=312,r=2340,l=.34,a="tilde4");else{const e=[1,1,2,2,3,3][s];"widehat"===n||"widecheck"===n?(r=[0,1062,2364,2364,2364][e],i=[0,239,300,360,420][e],l=[0,.24,.3,.3,.36,.42][e],a=n+e):(r=[0,600,1033,2339,2340][e],i=[0,260,286,306,312][e],l=[0,.26,.286,.3,.306,.34][e],a="tilde"+e)}const h=new Q(a),c=new J([h],{width:"100%",height:F(l),viewBox:"0 0 "+r+" "+i,preserveAspectRatio:"none"});return{span:Pe.makeSvgSpan([],[c],t),minWidth:0,height:l}}{const e=[],o=Ct[n],[s,i,a]=o,l=a/1e3,h=s.length;let c,m;if(1===h){c=["hide-tail"],m=[o[3]]}else if(2===h)c=["halfarrow-left","halfarrow-right"],m=["xMinYMin","xMaxYMin"];else{if(3!==h)throw new Error("Correct katexImagesData or update code here to support\\n                    "+h+" children.");c=["brace-left","brace-center","brace-right"],m=["xMinYMin","xMidYMin","xMaxYMin"]}for(let n=0;n<h;n++){const o=new Q(s[n]),p=new J([o],{width:"400em",height:F(l),viewBox:"0 0 "+r+" "+a,preserveAspectRatio:m[n]+" slice"}),u=Pe.makeSvgSpan([c[n]],[p],t);if(1===h)return{span:u,minWidth:i,height:l};u.style.height=F(l),e.push(u)}return{span:Pe.makeSpan(["stretchy"],e,t),minWidth:i,height:l}}var o}();return r.height=o,r.style.height=F(o),n>0&&(r.style.minWidth=F(n)),r};function Rt(e,t){if(!e||e.type!==t)throw new Error("Expected node of type "+t+", but got "+(e?"node of type "+e.type:String(e)));return e}function Ht(e){const t=Ot(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?"node of type "+e.type:String(e)));return t}function Ot(e){return e&&("atom"===e.type||ne.hasOwnProperty(e.type))?e:null}const Et=(e,t)=>{let r,n,o;e&&"supsub"===e.type?(n=Rt(e.base,"accent"),r=n.base,e.base=r,o=function(e){if(e instanceof _)return e;throw new Error("Expected span<HtmlDomNode> but got "+String(e)+".")}(ct(e,t)),e.base=n):(n=Rt(e,"accent"),r=n.base);const s=ct(r,t.havingCrampedStyle());let i=0;if(n.isShifty&&l.isCharacterBox(r)){const e=l.getBaseElem(r);i=te(ct(e,t.havingCrampedStyle())).skew}const a="\\\\c"===n.label;let h,c=a?s.height+s.depth:Math.min(s.height,t.fontMetrics().xHeight);if(n.isStretchy)h=It(n,t),h=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"elem",elem:h,wrapperClasses:["svg-align"],wrapperStyle:i>0?{width:"calc(100% - "+F(2*i)+")",marginLeft:F(2*i)}:void 0}]},t);else{let e,r;"\\\\vec"===n.label?(e=Pe.staticSvg("vec",t),r=Pe.svgData.vec[1]):(e=Pe.makeOrd({mode:n.mode,text:n.label},t,"textord"),e=te(e),e.italic=0,r=e.width,a&&(c+=e.depth)),h=Pe.makeSpan(["accent-body"],[e]);const o="\\\\textcircled"===n.label;o&&(h.classes.push("accent-full"),c=s.height);let l=i;o||(l-=r/2),h.style.left=F(l),"\\\\textcircled"===n.label&&(h.style.top=".2em"),h=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"kern",size:-c},{type:"elem",elem:h}]},t)}const m=Pe.makeSpan(["mord","accent"],[h],t);return o?(o.children[0]=m,o.height=Math.max(m.height,o.height),o.classes[0]="mord",o):m},Lt=(e,t)=>{const r=e.isStretchy?qt(e.label):new ft.MathNode("mo",[bt(e.label,e.mode)]),n=new ft.MathNode("mover",[St(e.base,t),r]);return n.setAttribute("accent","true"),n},Dt=new RegExp(["\\\\acute","\\\\grave","\\\\ddot","\\\\tilde","\\\\bar","\\\\breve","\\\\check","\\\\hat","\\\\vec","\\\\dot","\\\\mathring"].map((e=>"\\\\"+e)).join("|"));$e({type:"accent",names:["\\\\acute","\\\\grave","\\\\ddot","\\\\tilde","\\\\bar","\\\\breve","\\\\check","\\\\hat","\\\\vec","\\\\dot","\\\\mathring","\\\\widecheck","\\\\widehat","\\\\widetilde","\\\\overrightarrow","\\\\overleftarrow","\\\\Overrightarrow","\\\\overleftrightarrow","\\\\overgroup","\\\\overlinesegment","\\\\overleftharpoon","\\\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{const r=Ke(t[0]),n=!Dt.test(e.funcName),o=!n||"\\\\widehat"===e.funcName||"\\\\widetilde"===e.funcName||"\\\\widecheck"===e.funcName;return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,isShifty:o,base:r}},htmlBuilder:Et,mathmlBuilder:Lt}),$e({type:"accent",names:["\\\\\'","\\\\`","\\\\^","\\\\~","\\\\=","\\\\u","\\\\.",\'\\\\"\',"\\\\c","\\\\r","\\\\H","\\\\v","\\\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{const r=t[0];let n=e.parser.mode;return"math"===n&&(e.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX\'s accent "+e.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:e.funcName,isStretchy:!1,isShifty:!0,base:r}},htmlBuilder:Et,mathmlBuilder:Lt}),$e({type:"accentUnder",names:["\\\\underleftarrow","\\\\underrightarrow","\\\\underleftrightarrow","\\\\undergroup","\\\\underlinesegment","\\\\utilde"],props:{numArgs:1},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0];return{type:"accentUnder",mode:r.mode,label:n,base:o}},htmlBuilder:(e,t)=>{const r=ct(e.base,t),n=It(e,t),o="\\\\utilde"===e.label?.12:0,s=Pe.makeVList({positionType:"top",positionData:r.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:o},{type:"elem",elem:r}]},t);return Pe.makeSpan(["mord","accentunder"],[s],t)},mathmlBuilder:(e,t)=>{const r=qt(e.label),n=new ft.MathNode("munder",[St(e.base,t),r]);return n.setAttribute("accentunder","true"),n}});const Vt=e=>{const t=new ft.MathNode("mpadded",e?[e]:[]);return t.setAttribute("width","+0.6em"),t.setAttribute("lspace","0.3em"),t};$e({type:"xArrow",names:["\\\\xleftarrow","\\\\xrightarrow","\\\\xLeftarrow","\\\\xRightarrow","\\\\xleftrightarrow","\\\\xLeftrightarrow","\\\\xhookleftarrow","\\\\xhookrightarrow","\\\\xmapsto","\\\\xrightharpoondown","\\\\xrightharpoonup","\\\\xleftharpoondown","\\\\xleftharpoonup","\\\\xrightleftharpoons","\\\\xleftrightharpoons","\\\\xlongequal","\\\\xtwoheadrightarrow","\\\\xtwoheadleftarrow","\\\\xtofrom","\\\\xrightleftarrows","\\\\xrightequilibrium","\\\\xleftequilibrium","\\\\\\\\cdrightarrow","\\\\\\\\cdleftarrow","\\\\\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){let{parser:n,funcName:o}=e;return{type:"xArrow",mode:n.mode,label:o,body:t[0],below:r[0]}},htmlBuilder(e,t){const r=t.style;let n=t.havingStyle(r.sup());const o=Pe.wrapFragment(ct(e.body,n,t),t),s="\\\\x"===e.label.slice(0,2)?"x":"cd";let i;o.classes.push(s+"-arrow-pad"),e.below&&(n=t.havingStyle(r.sub()),i=Pe.wrapFragment(ct(e.below,n,t),t),i.classes.push(s+"-arrow-pad"));const a=It(e,t),l=-t.fontMetrics().axisHeight+.5*a.height;let h,c=-t.fontMetrics().axisHeight-.5*a.height-.111;if((o.depth>.25||"\\\\xleftequilibrium"===e.label)&&(c-=o.depth),i){const e=-t.fontMetrics().axisHeight+i.height+.5*a.height+.111;h=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:o,shift:c},{type:"elem",elem:a,shift:l},{type:"elem",elem:i,shift:e}]},t)}else h=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:o,shift:c},{type:"elem",elem:a,shift:l}]},t);return h.children[0].children[0].children[1].classes.push("svg-align"),Pe.makeSpan(["mrel","x-arrow"],[h],t)},mathmlBuilder(e,t){const r=qt(e.label);let n;if(r.setAttribute("minsize","x"===e.label.charAt(0)?"1.75em":"3.0em"),e.body){const o=Vt(St(e.body,t));if(e.below){const s=Vt(St(e.below,t));n=new ft.MathNode("munderover",[r,s,o])}else n=new ft.MathNode("mover",[r,o])}else if(e.below){const o=Vt(St(e.below,t));n=new ft.MathNode("munder",[r,o])}else n=Vt(),n=new ft.MathNode("mover",[r,n]);return n}});const Pt=Pe.makeSpan;function Ft(e,t){const r=ot(e.body,t,!0);return Pt([e.mclass],r,t)}function Gt(e,t){let r;const n=vt(e.body,t);return"minner"===e.mclass?r=new ft.MathNode("mpadded",n):"mord"===e.mclass?e.isCharacterBox?(r=n[0],r.type="mi"):r=new ft.MathNode("mi",n):(e.isCharacterBox?(r=n[0],r.type="mo"):r=new ft.MathNode("mo",n),"mbin"===e.mclass?(r.attributes.lspace="0.22em",r.attributes.rspace="0.22em"):"mpunct"===e.mclass?(r.attributes.lspace="0em",r.attributes.rspace="0.17em"):"mopen"===e.mclass||"mclose"===e.mclass?(r.attributes.lspace="0em",r.attributes.rspace="0em"):"minner"===e.mclass&&(r.attributes.lspace="0.0556em",r.attributes.width="+0.1111em")),r}$e({type:"mclass",names:["\\\\mathord","\\\\mathbin","\\\\mathrel","\\\\mathopen","\\\\mathclose","\\\\mathpunct","\\\\mathinner"],props:{numArgs:1,primitive:!0},handler(e,t){let{parser:r,funcName:n}=e;const o=t[0];return{type:"mclass",mode:r.mode,mclass:"m"+n.slice(5),body:Je(o),isCharacterBox:l.isCharacterBox(o)}},htmlBuilder:Ft,mathmlBuilder:Gt});const Ut=e=>{const t="ordgroup"===e.type&&e.body.length?e.body[0]:e;return"atom"!==t.type||"bin"!==t.family&&"rel"!==t.family?"mord":"m"+t.family};$e({type:"mclass",names:["\\\\@binrel"],props:{numArgs:2},handler(e,t){let{parser:r}=e;return{type:"mclass",mode:r.mode,mclass:Ut(t[0]),body:Je(t[1]),isCharacterBox:l.isCharacterBox(t[1])}}}),$e({type:"mclass",names:["\\\\stackrel","\\\\overset","\\\\underset"],props:{numArgs:2},handler(e,t){let{parser:r,funcName:n}=e;const o=t[1],s=t[0];let i;i="\\\\stackrel"!==n?Ut(o):"mrel";const a={type:"op",mode:o.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:"\\\\stackrel"!==n,body:Je(o)},h={type:"supsub",mode:s.mode,base:a,sup:"\\\\underset"===n?null:s,sub:"\\\\underset"===n?s:null};return{type:"mclass",mode:r.mode,mclass:i,body:[h],isCharacterBox:l.isCharacterBox(h)}},htmlBuilder:Ft,mathmlBuilder:Gt}),$e({type:"pmb",names:["\\\\pmb"],props:{numArgs:1,allowedInText:!0},handler(e,t){let{parser:r}=e;return{type:"pmb",mode:r.mode,mclass:Ut(t[0]),body:Je(t[0])}},htmlBuilder(e,t){const r=ot(e.body,t,!0),n=Pe.makeSpan([e.mclass],r,t);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(e,t){const r=vt(e.body,t),n=new ft.MathNode("mstyle",r);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});const Yt={">":"\\\\\\\\cdrightarrow","<":"\\\\\\\\cdleftarrow","=":"\\\\\\\\cdlongequal",A:"\\\\uparrow",V:"\\\\downarrow","|":"\\\\Vert",".":"no arrow"},Xt=e=>"textord"===e.type&&"@"===e.text;function Wt(e,t,r){const n=Yt[e];switch(n){case"\\\\\\\\cdrightarrow":case"\\\\\\\\cdleftarrow":return r.callFunction(n,[t[0]],[t[1]]);case"\\\\uparrow":case"\\\\downarrow":{const e={type:"atom",text:n,mode:"math",family:"rel"},o={type:"ordgroup",mode:"math",body:[r.callFunction("\\\\\\\\cdleft",[t[0]],[]),r.callFunction("\\\\Big",[e],[]),r.callFunction("\\\\\\\\cdright",[t[1]],[])]};return r.callFunction("\\\\\\\\cdparent",[o],[])}case"\\\\\\\\cdlongequal":return r.callFunction("\\\\\\\\cdlongequal",[],[]);case"\\\\Vert":{const e={type:"textord",text:"\\\\Vert",mode:"math"};return r.callFunction("\\\\Big",[e],[])}default:return{type:"textord",text:" ",mode:"math"}}}$e({type:"cdlabel",names:["\\\\\\\\cdleft","\\\\\\\\cdright"],props:{numArgs:1},handler(e,t){let{parser:r,funcName:n}=e;return{type:"cdlabel",mode:r.mode,side:n.slice(4),label:t[0]}},htmlBuilder(e,t){const r=t.havingStyle(t.style.sup()),n=Pe.wrapFragment(ct(e.label,r,t),t);return n.classes.push("cd-label-"+e.side),n.style.bottom=F(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(e,t){let r=new ft.MathNode("mrow",[St(e.label,t)]);return r=new ft.MathNode("mpadded",[r]),r.setAttribute("width","0"),"left"===e.side&&r.setAttribute("lspace","-1width"),r.setAttribute("voffset","0.7em"),r=new ft.MathNode("mstyle",[r]),r.setAttribute("displaystyle","false"),r.setAttribute("scriptlevel","1"),r}}),$e({type:"cdlabelparent",names:["\\\\\\\\cdparent"],props:{numArgs:1},handler(e,t){let{parser:r}=e;return{type:"cdlabelparent",mode:r.mode,fragment:t[0]}},htmlBuilder(e,t){const r=Pe.wrapFragment(ct(e.fragment,t),t);return r.classes.push("cd-vert-arrow"),r},mathmlBuilder(e,t){return new ft.MathNode("mrow",[St(e.fragment,t)])}}),$e({type:"textord",names:["\\\\@char"],props:{numArgs:1,allowedInText:!0},handler(e,t){let{parser:r}=e;const o=Rt(t[0],"ordgroup").body;let s="";for(let e=0;e<o.length;e++){s+=Rt(o[e],"textord").text}let i,a=parseInt(s);if(isNaN(a))throw new n("\\\\@char has non-numeric argument "+s);if(a<0||a>=1114111)throw new n("\\\\@char with invalid code point "+s);return a<=65535?i=String.fromCharCode(a):(a-=65536,i=String.fromCharCode(55296+(a>>10),56320+(1023&a))),{type:"textord",mode:r.mode,text:i}}});const _t=(e,t)=>{const r=ot(e.body,t.withColor(e.color),!1);return Pe.makeFragment(r)},jt=(e,t)=>{const r=vt(e.body,t.withColor(e.color)),n=new ft.MathNode("mstyle",r);return n.setAttribute("mathcolor",e.color),n};$e({type:"color",names:["\\\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(e,t){let{parser:r}=e;const n=Rt(t[0],"color-token").color,o=t[1];return{type:"color",mode:r.mode,color:n,body:Je(o)}},htmlBuilder:_t,mathmlBuilder:jt}),$e({type:"color",names:["\\\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(e,t){let{parser:r,breakOnTokenText:n}=e;const o=Rt(t[0],"color-token").color;r.gullet.macros.set("\\\\current@color",o);const s=r.parseExpression(!0,n);return{type:"color",mode:r.mode,color:o,body:s}},htmlBuilder:_t,mathmlBuilder:jt}),$e({type:"cr",names:["\\\\\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(e,t,r){let{parser:n}=e;const o="["===n.gullet.future().text?n.parseSizeGroup(!0):null,s=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\\\\\ or \\\\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:s,size:o&&Rt(o,"size").value}},htmlBuilder(e,t){const r=Pe.makeSpan(["mspace"],[],t);return e.newLine&&(r.classes.push("newline"),e.size&&(r.style.marginTop=F(P(e.size,t)))),r},mathmlBuilder(e,t){const r=new ft.MathNode("mspace");return e.newLine&&(r.setAttribute("linebreak","newline"),e.size&&r.setAttribute("height",F(P(e.size,t)))),r}});const $t={"\\\\global":"\\\\global","\\\\long":"\\\\\\\\globallong","\\\\\\\\globallong":"\\\\\\\\globallong","\\\\def":"\\\\gdef","\\\\gdef":"\\\\gdef","\\\\edef":"\\\\xdef","\\\\xdef":"\\\\xdef","\\\\let":"\\\\\\\\globallet","\\\\futurelet":"\\\\\\\\globalfuture"},Zt=e=>{const t=e.text;if(/^(?:[\\\\{}$&#^_]|EOF)$/.test(t))throw new n("Expected a control sequence",e);return t},Kt=(e,t,r,n)=>{let o=e.gullet.macros.get(r.text);null==o&&(r.noexpand=!0,o={tokens:[r],numArgs:0,unexpandable:!e.gullet.isExpandable(r.text)}),e.gullet.macros.set(t,o,n)};$e({type:"internal",names:["\\\\global","\\\\long","\\\\\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(e){let{parser:t,funcName:r}=e;t.consumeSpaces();const o=t.fetch();if($t[o.text])return"\\\\global"!==r&&"\\\\\\\\globallong"!==r||(o.text=$t[o.text]),Rt(t.parseFunction(),"internal");throw new n("Invalid token after macro prefix",o)}}),$e({type:"internal",names:["\\\\def","\\\\gdef","\\\\edef","\\\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){let{parser:t,funcName:r}=e,o=t.gullet.popToken();const s=o.text;if(/^(?:[\\\\{}$&#^_]|EOF)$/.test(s))throw new n("Expected a control sequence",o);let i,a=0;const l=[[]];for(;"{"!==t.gullet.future().text;)if(o=t.gullet.popToken(),"#"===o.text){if("{"===t.gullet.future().text){i=t.gullet.future(),l[a].push("{");break}if(o=t.gullet.popToken(),!/^[1-9]$/.test(o.text))throw new n(\'Invalid argument number "\'+o.text+\'"\');if(parseInt(o.text)!==a+1)throw new n(\'Argument number "\'+o.text+\'" out of order\');a++,l.push([])}else{if("EOF"===o.text)throw new n("Expected a macro definition");l[a].push(o.text)}let{tokens:h}=t.gullet.consumeArg();return i&&h.unshift(i),"\\\\edef"!==r&&"\\\\xdef"!==r||(h=t.gullet.expandTokens(h),h.reverse()),t.gullet.macros.set(s,{tokens:h,numArgs:a,delimiters:l},r===$t[r]),{type:"internal",mode:t.mode}}}),$e({type:"internal",names:["\\\\let","\\\\\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){let{parser:t,funcName:r}=e;const n=Zt(t.gullet.popToken());t.gullet.consumeSpaces();const o=(e=>{let t=e.gullet.popToken();return"="===t.text&&(t=e.gullet.popToken()," "===t.text&&(t=e.gullet.popToken())),t})(t);return Kt(t,n,o,"\\\\\\\\globallet"===r),{type:"internal",mode:t.mode}}}),$e({type:"internal",names:["\\\\futurelet","\\\\\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){let{parser:t,funcName:r}=e;const n=Zt(t.gullet.popToken()),o=t.gullet.popToken(),s=t.gullet.popToken();return Kt(t,n,s,"\\\\\\\\globalfuture"===r),t.gullet.pushToken(s),t.gullet.pushToken(o),{type:"internal",mode:t.mode}}});const Jt=function(e,t,r){const n=N(se.math[e]&&se.math[e].replace||e,t,r);if(!n)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return n},Qt=function(e,t,r,n){const o=r.havingBaseStyle(t),s=Pe.makeSpan(n.concat(o.sizingClasses(r)),[e],r),i=o.sizeMultiplier/r.sizeMultiplier;return s.height*=i,s.depth*=i,s.maxFontSize=o.sizeMultiplier,s},er=function(e,t,r){const n=t.havingBaseStyle(r),o=(1-t.sizeMultiplier/n.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=F(o),e.height-=o,e.depth+=o},tr=function(e,t,r,n,o,s){const i=function(e,t,r,n){return Pe.makeSymbol(e,"Size"+t+"-Regular",r,n)}(e,t,o,n),a=Qt(Pe.makeSpan(["delimsizing","size"+t],[i],n),w.TEXT,n,s);return r&&er(a,n,w.TEXT),a},rr=function(e,t,r){let n;n="Size1-Regular"===t?"delim-size1":"delim-size4";return{type:"elem",elem:Pe.makeSpan(["delimsizinginner",n],[Pe.makeSpan([],[Pe.makeSymbol(e,t,r)])])}},nr=function(e,t,r){const n=T["Size4-Regular"][e.charCodeAt(0)]?T["Size4-Regular"][e.charCodeAt(0)][4]:T["Size1-Regular"][e.charCodeAt(0)][4],o=new Q("inner",function(e,t){switch(e){case"\\u239c":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"\\u2223":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"\\u2225":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145zM367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z";case"\\u239f":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"\\u23a2":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"\\u23a5":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"\\u23aa":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"\\u23d0":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"\\u2016":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257zM478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z";default:return""}}(e,Math.round(1e3*t))),s=new J([o],{width:F(n),height:F(t),style:"width:"+F(n),viewBox:"0 0 "+1e3*n+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),i=Pe.makeSvgSpan([],[s],r);return i.height=t,i.style.height=F(t),i.style.width=F(n),{type:"elem",elem:i}},or={type:"kern",size:-.008},sr=["|","\\\\lvert","\\\\rvert","\\\\vert"],ir=["\\\\|","\\\\lVert","\\\\rVert","\\\\Vert"],ar=function(e,t,r,n,o,s){let i,a,h,c,m="",p=0;i=h=c=e,a=null;let u="Size1-Regular";"\\\\uparrow"===e?h=c="\\u23d0":"\\\\Uparrow"===e?h=c="\\u2016":"\\\\downarrow"===e?i=h="\\u23d0":"\\\\Downarrow"===e?i=h="\\u2016":"\\\\updownarrow"===e?(i="\\\\uparrow",h="\\u23d0",c="\\\\downarrow"):"\\\\Updownarrow"===e?(i="\\\\Uparrow",h="\\u2016",c="\\\\Downarrow"):l.contains(sr,e)?(h="\\u2223",m="vert",p=333):l.contains(ir,e)?(h="\\u2225",m="doublevert",p=556):"["===e||"\\\\lbrack"===e?(i="\\u23a1",h="\\u23a2",c="\\u23a3",u="Size4-Regular",m="lbrack",p=667):"]"===e||"\\\\rbrack"===e?(i="\\u23a4",h="\\u23a5",c="\\u23a6",u="Size4-Regular",m="rbrack",p=667):"\\\\lfloor"===e||"\\u230a"===e?(h=i="\\u23a2",c="\\u23a3",u="Size4-Regular",m="lfloor",p=667):"\\\\lceil"===e||"\\u2308"===e?(i="\\u23a1",h=c="\\u23a2",u="Size4-Regular",m="lceil",p=667):"\\\\rfloor"===e||"\\u230b"===e?(h=i="\\u23a5",c="\\u23a6",u="Size4-Regular",m="rfloor",p=667):"\\\\rceil"===e||"\\u2309"===e?(i="\\u23a4",h=c="\\u23a5",u="Size4-Regular",m="rceil",p=667):"("===e||"\\\\lparen"===e?(i="\\u239b",h="\\u239c",c="\\u239d",u="Size4-Regular",m="lparen",p=875):")"===e||"\\\\rparen"===e?(i="\\u239e",h="\\u239f",c="\\u23a0",u="Size4-Regular",m="rparen",p=875):"\\\\{"===e||"\\\\lbrace"===e?(i="\\u23a7",a="\\u23a8",c="\\u23a9",h="\\u23aa",u="Size4-Regular"):"\\\\}"===e||"\\\\rbrace"===e?(i="\\u23ab",a="\\u23ac",c="\\u23ad",h="\\u23aa",u="Size4-Regular"):"\\\\lgroup"===e||"\\u27ee"===e?(i="\\u23a7",c="\\u23a9",h="\\u23aa",u="Size4-Regular"):"\\\\rgroup"===e||"\\u27ef"===e?(i="\\u23ab",c="\\u23ad",h="\\u23aa",u="Size4-Regular"):"\\\\lmoustache"===e||"\\u23b0"===e?(i="\\u23a7",c="\\u23ad",h="\\u23aa",u="Size4-Regular"):"\\\\rmoustache"!==e&&"\\u23b1"!==e||(i="\\u23ab",c="\\u23a9",h="\\u23aa",u="Size4-Regular");const d=Jt(i,u,o),g=d.height+d.depth,f=Jt(h,u,o),b=f.height+f.depth,y=Jt(c,u,o),x=y.height+y.depth;let v=0,k=1;if(null!==a){const e=Jt(a,u,o);v=e.height+e.depth,k=2}const S=g+x+v,M=S+Math.max(0,Math.ceil((t-S)/(k*b)))*k*b;let z=n.fontMetrics().axisHeight;r&&(z*=n.sizeMultiplier);const A=M/2-z,T=[];if(m.length>0){const e=M-g-x,t=Math.round(1e3*M),r=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v1759 h347 v-84\\nH403z M403 1759 V0 H319 V1759 v"+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v1759 H0 v84 H347z\\nM347 1759 V0 H263 V1759 v"+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z\\nM367 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v"+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+" v1715 h263 v84 H319z\\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+" v1799 H0 v-84 H319z\\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v602 h84z\\nM403 1759 V0 H319 V1759 v"+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v602 h84z\\nM347 1759 V0 h-84 V1759 v"+t+" v602 h84z";case"lparen":return"M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\\n-36,557 l0,"+(t+84)+"c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\\nl0,-"+(t+92)+"c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z";case"rparen":return"M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,"+(t+9)+"\\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\\nl0,-"+(t+144)+"c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z";default:throw new Error("Unknown stretchy delimiter.")}}(m,Math.round(1e3*e)),o=new Q(m,r),s=(p/1e3).toFixed(3)+"em",i=(t/1e3).toFixed(3)+"em",a=new J([o],{width:s,height:i,viewBox:"0 0 "+p+" "+t}),l=Pe.makeSvgSpan([],[a],n);l.height=t/1e3,l.style.width=s,l.style.height=i,T.push({type:"elem",elem:l})}else{if(T.push(rr(c,u,o)),T.push(or),null===a){const e=M-g-x+.016;T.push(nr(h,e,n))}else{const e=(M-g-x-v)/2+.016;T.push(nr(h,e,n)),T.push(or),T.push(rr(a,u,o)),T.push(or),T.push(nr(h,e,n))}T.push(or),T.push(rr(i,u,o))}const B=n.havingBaseStyle(w.TEXT),C=Pe.makeVList({positionType:"bottom",positionData:A,children:T},B);return Qt(Pe.makeSpan(["delimsizing","mult"],[C],B),w.TEXT,n,s)},lr=.08,hr=function(e,t,r,n,o){const s=function(e,t,r){t*=1e3;let n="";switch(e){case"sqrtMain":n=function(e,t){return"M95,"+(622+e+t)+"\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl"+e/2.075+" -"+e+"\\nc5.3,-9.3,12,-14,20,-14\\nH400000v"+(40+e)+"H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM"+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,M);break;case"sqrtSize1":n=function(e,t){return"M263,"+(601+e+t)+"c0.7,0,18,39.7,52,119\\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\\nc340,-704.7,510.7,-1060.3,512,-1067\\nl"+e/2.084+" -"+e+"\\nc4.7,-7.3,11,-11,19,-11\\nH40000v"+(40+e)+"H1012.3\\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,M);break;case"sqrtSize2":n=function(e,t){return"M983 "+(10+e+t)+"\\nl"+e/3.13+" -"+e+"\\nc4,-6.7,10,-10,18,-10 H400000v"+(40+e)+"\\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,M);break;case"sqrtSize3":n=function(e,t){return"M424,"+(2398+e+t)+"\\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\\nl"+e/4.223+" -"+e+"c4,-6.7,10,-10,18,-10 H400000\\nv"+(40+e)+"H1014.6\\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\\nc-2,6,-10,9,-24,9\\nc-8,0,-12,-0.7,-12,-2z M"+(1001+e)+" "+t+"\\nh400000v"+(40+e)+"h-400000z"}(t,M);break;case"sqrtSize4":n=function(e,t){return"M473,"+(2713+e+t)+"\\nc339.3,-1799.3,509.3,-2700,510,-2702 l"+e/5.298+" -"+e+"\\nc3.3,-7.3,9.3,-11,18,-11 H400000v"+(40+e)+"H1017.7\\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\\n606zM"+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"}(t,M);break;case"sqrtTall":n=function(e,t,r){return"M702 "+(e+t)+"H400000"+(40+e)+"\\nH742v"+(r-54-t-e)+"l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\\n219 661 l218 661zM702 "+t+"H400000v"+(40+e)+"H742z"}(t,M,r)}return n}(e,n,r),i=new Q(e,s),a=new J([i],{width:"400em",height:F(t),viewBox:"0 0 400000 "+r,preserveAspectRatio:"xMinYMin slice"});return Pe.makeSvgSpan(["hide-tail"],[a],o)},cr=["(","\\\\lparen",")","\\\\rparen","[","\\\\lbrack","]","\\\\rbrack","\\\\{","\\\\lbrace","\\\\}","\\\\rbrace","\\\\lfloor","\\\\rfloor","\\u230a","\\u230b","\\\\lceil","\\\\rceil","\\u2308","\\u2309","\\\\surd"],mr=["\\\\uparrow","\\\\downarrow","\\\\updownarrow","\\\\Uparrow","\\\\Downarrow","\\\\Updownarrow","|","\\\\|","\\\\vert","\\\\Vert","\\\\lvert","\\\\rvert","\\\\lVert","\\\\rVert","\\\\lgroup","\\\\rgroup","\\u27ee","\\u27ef","\\\\lmoustache","\\\\rmoustache","\\u23b0","\\u23b1"],pr=["<",">","\\\\langle","\\\\rangle","/","\\\\backslash","\\\\lt","\\\\gt"],ur=[0,1.2,1.8,2.4,3],dr=[{type:"small",style:w.SCRIPTSCRIPT},{type:"small",style:w.SCRIPT},{type:"small",style:w.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],gr=[{type:"small",style:w.SCRIPTSCRIPT},{type:"small",style:w.SCRIPT},{type:"small",style:w.TEXT},{type:"stack"}],fr=[{type:"small",style:w.SCRIPTSCRIPT},{type:"small",style:w.SCRIPT},{type:"small",style:w.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],br=function(e){if("small"===e.type)return"Main-Regular";if("large"===e.type)return"Size"+e.size+"-Regular";if("stack"===e.type)return"Size4-Regular";throw new Error("Add support for delim type \'"+e.type+"\' here.")},yr=function(e,t,r,n){for(let o=Math.min(2,3-n.style.size);o<r.length&&"stack"!==r[o].type;o++){const s=Jt(e,br(r[o]),"math");let i=s.height+s.depth;if("small"===r[o].type){i*=n.havingBaseStyle(r[o].style).sizeMultiplier}if(i>t)return r[o]}return r[r.length-1]},xr=function(e,t,r,n,o,s){let i;"<"===e||"\\\\lt"===e||"\\u27e8"===e?e="\\\\langle":">"!==e&&"\\\\gt"!==e&&"\\u27e9"!==e||(e="\\\\rangle"),i=l.contains(pr,e)?dr:l.contains(cr,e)?fr:gr;const a=yr(e,t,i,n);return"small"===a.type?function(e,t,r,n,o,s){const i=Pe.makeSymbol(e,"Main-Regular",o,n),a=Qt(i,t,n,s);return r&&er(a,n,t),a}(e,a.style,r,n,o,s):"large"===a.type?tr(e,a.size,r,n,o,s):ar(e,t,r,n,o,s)};var wr={sqrtImage:function(e,t){const r=t.havingBaseSizing(),n=yr("\\\\surd",e*r.sizeMultiplier,fr,r);let o=r.sizeMultiplier;const s=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness);let i,a,l=0,h=0,c=0;return"small"===n.type?(c=1e3+1e3*s+80,e<1?o=1:e<1.4&&(o=.7),l=(1+s+lr)/o,h=(1+s)/o,i=hr("sqrtMain",l,c,s,t),i.style.minWidth="0.853em",a=.833/o):"large"===n.type?(c=1080*ur[n.size],h=(ur[n.size]+s)/o,l=(ur[n.size]+s+lr)/o,i=hr("sqrtSize"+n.size,l,c,s,t),i.style.minWidth="1.02em",a=1/o):(l=e+s+lr,h=e+s,c=Math.floor(1e3*e+s)+80,i=hr("sqrtTall",l,c,s,t),i.style.minWidth="0.742em",a=1.056),i.height=h,i.style.height=F(l),{span:i,advanceWidth:a,ruleWidth:(t.fontMetrics().sqrtRuleThickness+s)*o}},sizedDelim:function(e,t,r,o,s){if("<"===e||"\\\\lt"===e||"\\u27e8"===e?e="\\\\langle":">"!==e&&"\\\\gt"!==e&&"\\u27e9"!==e||(e="\\\\rangle"),l.contains(cr,e)||l.contains(pr,e))return tr(e,t,!1,r,o,s);if(l.contains(mr,e))return ar(e,ur[t],!1,r,o,s);throw new n("Illegal delimiter: \'"+e+"\'")},sizeToMaxHeight:ur,customSizedDelim:xr,leftRightDelim:function(e,t,r,n,o,s){const i=n.fontMetrics().axisHeight*n.sizeMultiplier,a=5/n.fontMetrics().ptPerEm,l=Math.max(t-i,r+i),h=Math.max(l/500*901,2*l-a);return xr(e,h,!0,n,o,s)}};const vr={"\\\\bigl":{mclass:"mopen",size:1},"\\\\Bigl":{mclass:"mopen",size:2},"\\\\biggl":{mclass:"mopen",size:3},"\\\\Biggl":{mclass:"mopen",size:4},"\\\\bigr":{mclass:"mclose",size:1},"\\\\Bigr":{mclass:"mclose",size:2},"\\\\biggr":{mclass:"mclose",size:3},"\\\\Biggr":{mclass:"mclose",size:4},"\\\\bigm":{mclass:"mrel",size:1},"\\\\Bigm":{mclass:"mrel",size:2},"\\\\biggm":{mclass:"mrel",size:3},"\\\\Biggm":{mclass:"mrel",size:4},"\\\\big":{mclass:"mord",size:1},"\\\\Big":{mclass:"mord",size:2},"\\\\bigg":{mclass:"mord",size:3},"\\\\Bigg":{mclass:"mord",size:4}},kr=["(","\\\\lparen",")","\\\\rparen","[","\\\\lbrack","]","\\\\rbrack","\\\\{","\\\\lbrace","\\\\}","\\\\rbrace","\\\\lfloor","\\\\rfloor","\\u230a","\\u230b","\\\\lceil","\\\\rceil","\\u2308","\\u2309","<",">","\\\\langle","\\u27e8","\\\\rangle","\\u27e9","\\\\lt","\\\\gt","\\\\lvert","\\\\rvert","\\\\lVert","\\\\rVert","\\\\lgroup","\\\\rgroup","\\u27ee","\\u27ef","\\\\lmoustache","\\\\rmoustache","\\u23b0","\\u23b1","/","\\\\backslash","|","\\\\vert","\\\\|","\\\\Vert","\\\\uparrow","\\\\Uparrow","\\\\downarrow","\\\\Downarrow","\\\\updownarrow","\\\\Updownarrow","."];function Sr(e,t){const r=Ot(e);if(r&&l.contains(kr,r.text))return r;throw new n(r?"Invalid delimiter \'"+r.text+"\' after \'"+t.funcName+"\'":"Invalid delimiter type \'"+e.type+"\'",e)}function Mr(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn\'t fully parsed.")}$e({type:"delimsizing",names:["\\\\bigl","\\\\Bigl","\\\\biggl","\\\\Biggl","\\\\bigr","\\\\Bigr","\\\\biggr","\\\\Biggr","\\\\bigm","\\\\Bigm","\\\\biggm","\\\\Biggm","\\\\big","\\\\Big","\\\\bigg","\\\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=Sr(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:vr[e.funcName].size,mclass:vr[e.funcName].mclass,delim:r.text}},htmlBuilder:(e,t)=>"."===e.delim?Pe.makeSpan([e.mclass]):wr.sizedDelim(e.delim,e.size,t,e.mode,[e.mclass]),mathmlBuilder:e=>{const t=[];"."!==e.delim&&t.push(bt(e.delim,e.mode));const r=new ft.MathNode("mo",t);"mopen"===e.mclass||"mclose"===e.mclass?r.setAttribute("fence","true"):r.setAttribute("fence","false"),r.setAttribute("stretchy","true");const n=F(wr.sizeToMaxHeight[e.size]);return r.setAttribute("minsize",n),r.setAttribute("maxsize",n),r}}),$e({type:"leftright-right",names:["\\\\right"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{const r=e.parser.gullet.macros.get("\\\\current@color");if(r&&"string"!=typeof r)throw new n("\\\\current@color set to non-string in \\\\right");return{type:"leftright-right",mode:e.parser.mode,delim:Sr(t[0],e).text,color:r}}}),$e({type:"leftright",names:["\\\\left"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{const r=Sr(t[0],e),n=e.parser;++n.leftrightDepth;const o=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\\\right",!1);const s=Rt(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:o,left:r.text,right:s.delim,rightColor:s.color}},htmlBuilder:(e,t)=>{Mr(e);const r=ot(e.body,t,!0,["mopen","mclose"]);let n,o,s=0,i=0,a=!1;for(let e=0;e<r.length;e++)r[e].isMiddle?a=!0:(s=Math.max(r[e].height,s),i=Math.max(r[e].depth,i));if(s*=t.sizeMultiplier,i*=t.sizeMultiplier,n="."===e.left?ht(t,["mopen"]):wr.leftRightDelim(e.left,s,i,t,e.mode,["mopen"]),r.unshift(n),a)for(let t=1;t<r.length;t++){const n=r[t].isMiddle;n&&(r[t]=wr.leftRightDelim(n.delim,s,i,n.options,e.mode,[]))}if("."===e.right)o=ht(t,["mclose"]);else{const r=e.rightColor?t.withColor(e.rightColor):t;o=wr.leftRightDelim(e.right,s,i,r,e.mode,["mclose"])}return r.push(o),Pe.makeSpan(["minner"],r,t)},mathmlBuilder:(e,t)=>{Mr(e);const r=vt(e.body,t);if("."!==e.left){const t=new ft.MathNode("mo",[bt(e.left,e.mode)]);t.setAttribute("fence","true"),r.unshift(t)}if("."!==e.right){const t=new ft.MathNode("mo",[bt(e.right,e.mode)]);t.setAttribute("fence","true"),e.rightColor&&t.setAttribute("mathcolor",e.rightColor),r.push(t)}return yt(r)}}),$e({type:"middle",names:["\\\\middle"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{const r=Sr(t[0],e);if(!e.parser.leftrightDepth)throw new n("\\\\middle without preceding \\\\left",r);return{type:"middle",mode:e.parser.mode,delim:r.text}},htmlBuilder:(e,t)=>{let r;if("."===e.delim)r=ht(t,[]);else{r=wr.sizedDelim(e.delim,1,t,e.mode,[]);const n={delim:e.delim,options:t};r.isMiddle=n}return r},mathmlBuilder:(e,t)=>{const r="\\\\vert"===e.delim||"|"===e.delim?bt("|","text"):bt(e.delim,e.mode),n=new ft.MathNode("mo",[r]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});const zr=(e,t)=>{const r=Pe.wrapFragment(ct(e.body,t),t),n=e.label.slice(1);let o,s=t.sizeMultiplier,i=0;const a=l.isCharacterBox(e.body);if("sout"===n)o=Pe.makeSpan(["stretchy","sout"]),o.height=t.fontMetrics().defaultRuleThickness/s,i=-.5*t.fontMetrics().xHeight;else if("phase"===n){const e=P({number:.6,unit:"pt"},t),n=P({number:.35,unit:"ex"},t);s/=t.havingBaseSizing().sizeMultiplier;const a=r.height+r.depth+e+n;r.style.paddingLeft=F(a/2+e);const l=Math.floor(1e3*a*s),c="M400000 "+(h=l)+" H0 L"+h/2+" 0 l65 45 L145 "+(h-80)+" H400000z",m=new J([new Q("phase",c)],{width:"400em",height:F(l/1e3),viewBox:"0 0 400000 "+l,preserveAspectRatio:"xMinYMin slice"});o=Pe.makeSvgSpan(["hide-tail"],[m],t),o.style.height=F(a),i=r.depth+e+n}else{/cancel/.test(n)?a||r.classes.push("cancel-pad"):"angl"===n?r.classes.push("anglpad"):r.classes.push("boxpad");let s=0,l=0,h=0;/box/.test(n)?(h=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),s=t.fontMetrics().fboxsep+("colorbox"===n?0:h),l=s):"angl"===n?(h=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness),s=4*h,l=Math.max(0,.25-r.depth)):(s=a?.2:0,l=s),o=Nt(r,n,s,l,t),/fbox|boxed|fcolorbox/.test(n)?(o.style.borderStyle="solid",o.style.borderWidth=F(h)):"angl"===n&&.049!==h&&(o.style.borderTopWidth=F(h),o.style.borderRightWidth=F(h)),i=r.depth+l,e.backgroundColor&&(o.style.backgroundColor=e.backgroundColor,e.borderColor&&(o.style.borderColor=e.borderColor))}var h;let c;if(e.backgroundColor)c=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:o,shift:i},{type:"elem",elem:r,shift:0}]},t);else{const e=/cancel|phase/.test(n)?["svg-align"]:[];c=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:0},{type:"elem",elem:o,shift:i,wrapperClasses:e}]},t)}return/cancel/.test(n)&&(c.height=r.height,c.depth=r.depth),/cancel/.test(n)&&!a?Pe.makeSpan(["mord","cancel-lap"],[c],t):Pe.makeSpan(["mord"],[c],t)},Ar=(e,t)=>{let r=0;const n=new ft.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[St(e.body,t)]);switch(e.label){case"\\\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\\\phase":n.setAttribute("notation","phasorangle");break;case"\\\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\\\fbox":n.setAttribute("notation","box");break;case"\\\\angl":n.setAttribute("notation","actuarial");break;case"\\\\fcolorbox":case"\\\\colorbox":if(r=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*r+"pt"),n.setAttribute("height","+"+2*r+"pt"),n.setAttribute("lspace",r+"pt"),n.setAttribute("voffset",r+"pt"),"\\\\fcolorbox"===e.label){const r=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);n.setAttribute("style","border: "+r+"em solid "+String(e.borderColor))}break;case"\\\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike")}return e.backgroundColor&&n.setAttribute("mathbackground",e.backgroundColor),n};$e({type:"enclose",names:["\\\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(e,t,r){let{parser:n,funcName:o}=e;const s=Rt(t[0],"color-token").color,i=t[1];return{type:"enclose",mode:n.mode,label:o,backgroundColor:s,body:i}},htmlBuilder:zr,mathmlBuilder:Ar}),$e({type:"enclose",names:["\\\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(e,t,r){let{parser:n,funcName:o}=e;const s=Rt(t[0],"color-token").color,i=Rt(t[1],"color-token").color,a=t[2];return{type:"enclose",mode:n.mode,label:o,backgroundColor:i,borderColor:s,body:a}},htmlBuilder:zr,mathmlBuilder:Ar}),$e({type:"enclose",names:["\\\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(e,t){let{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\\\fbox",body:t[0]}}}),$e({type:"enclose",names:["\\\\cancel","\\\\bcancel","\\\\xcancel","\\\\sout","\\\\phase"],props:{numArgs:1},handler(e,t){let{parser:r,funcName:n}=e;const o=t[0];return{type:"enclose",mode:r.mode,label:n,body:o}},htmlBuilder:zr,mathmlBuilder:Ar}),$e({type:"enclose",names:["\\\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(e,t){let{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\\\angl",body:t[0]}}});const Tr={};function Br(e){let{type:t,names:r,props:n,handler:o,htmlBuilder:s,mathmlBuilder:i}=e;const a={type:t,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:o};for(let e=0;e<r.length;++e)Tr[r[e]]=a;s&&(_e[t]=s),i&&(je[t]=i)}const Cr={};function Nr(e,t){Cr[e]=t}class qr{constructor(e,t,r){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=r}static range(e,t){return t?e&&e.loc&&t.loc&&e.loc.lexer===t.loc.lexer?new qr(e.loc.lexer,e.loc.start,t.loc.end):null:e&&e.loc}}class Ir{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new Ir(t,qr.range(this,e))}}function Rr(e){const t=[];e.consumeSpaces();let r=e.fetch().text;for("\\\\relax"===r&&(e.consume(),e.consumeSpaces(),r=e.fetch().text);"\\\\hline"===r||"\\\\hdashline"===r;)e.consume(),t.push("\\\\hdashline"===r),e.consumeSpaces(),r=e.fetch().text;return t}const Hr=e=>{if(!e.parser.settings.displayMode)throw new n("{"+e.envName+"} can be used only in display mode.")};function Or(e){if(-1===e.indexOf("ed"))return-1===e.indexOf("*")}function Er(e,t,r){let{hskipBeforeAndAfter:o,addJot:s,cols:i,arraystretch:a,colSeparationType:l,autoTag:h,singleRow:c,emptySingleRow:m,maxNumCols:p,leqno:u}=t;if(e.gullet.beginGroup(),c||e.gullet.macros.set("\\\\cr","\\\\\\\\\\\\relax"),!a){const t=e.gullet.expandMacroAsText("\\\\arraystretch");if(null==t)a=1;else if(a=parseFloat(t),!a||a<0)throw new n("Invalid \\\\arraystretch: "+t)}e.gullet.beginGroup();let d=[];const g=[d],f=[],b=[],y=null!=h?[]:void 0;function x(){h&&e.gullet.macros.set("\\\\@eqnsw","1",!0)}function w(){y&&(e.gullet.macros.get("\\\\df@tag")?(y.push(e.subparse([new Ir("\\\\df@tag")])),e.gullet.macros.set("\\\\df@tag",void 0,!0)):y.push(Boolean(h)&&"1"===e.gullet.macros.get("\\\\@eqnsw")))}for(x(),b.push(Rr(e));;){let t=e.parseExpression(!1,c?"\\\\end":"\\\\\\\\");e.gullet.endGroup(),e.gullet.beginGroup(),t={type:"ordgroup",mode:e.mode,body:t},r&&(t={type:"styling",mode:e.mode,style:r,body:[t]}),d.push(t);const o=e.fetch().text;if("&"===o){if(p&&d.length===p){if(c||l)throw new n("Too many tab characters: &",e.nextToken);e.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}e.consume()}else{if("\\\\end"===o){w(),1===d.length&&"styling"===t.type&&0===t.body[0].body.length&&(g.length>1||!m)&&g.pop(),b.length<g.length+1&&b.push([]);break}if("\\\\\\\\"!==o)throw new n("Expected & or \\\\\\\\ or \\\\cr or \\\\end",e.nextToken);{let t;e.consume()," "!==e.gullet.future().text&&(t=e.parseSizeGroup(!0)),f.push(t?t.value:null),w(),b.push(Rr(e)),d=[],g.push(d),x()}}}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:e.mode,addJot:s,arraystretch:a,body:g,cols:i,rowGaps:f,hskipBeforeAndAfter:o,hLinesBeforeRow:b,colSeparationType:l,tags:y,leqno:u}}function Lr(e){return"d"===e.slice(0,1)?"display":"text"}const Dr=function(e,t){let r,o;const s=e.body.length,i=e.hLinesBeforeRow;let a=0,h=new Array(s);const c=[],m=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),p=1/t.fontMetrics().ptPerEm;let u=5*p;if(e.colSeparationType&&"small"===e.colSeparationType){u=t.havingStyle(w.SCRIPT).sizeMultiplier/t.sizeMultiplier*.2778}const d="CD"===e.colSeparationType?P({number:3,unit:"ex"},t):12*p,g=3*p,f=e.arraystretch*d,b=.7*f,y=.3*f;let x=0;function v(e){for(let t=0;t<e.length;++t)t>0&&(x+=.25),c.push({pos:x,isDashed:e[t]})}for(v(i[0]),r=0;r<e.body.length;++r){const n=e.body[r];let s=b,l=y;a<n.length&&(a=n.length);const c=new Array(n.length);for(o=0;o<n.length;++o){const e=ct(n[o],t);l<e.depth&&(l=e.depth),s<e.height&&(s=e.height),c[o]=e}const m=e.rowGaps[r];let p=0;m&&(p=P(m,t),p>0&&(p+=y,l<p&&(l=p),p=0)),e.addJot&&(l+=g),c.height=s,c.depth=l,x+=s,c.pos=x,x+=l+p,h[r]=c,v(i[r+1])}const k=x/2+t.fontMetrics().axisHeight,S=e.cols||[],M=[];let z,A;const T=[];if(e.tags&&e.tags.some((e=>e)))for(r=0;r<s;++r){const n=h[r],o=n.pos-k,s=e.tags[r];let i;i=!0===s?Pe.makeSpan(["eqn-num"],[],t):!1===s?Pe.makeSpan([],[],t):Pe.makeSpan([],ot(s,t,!0),t),i.depth=n.depth,i.height=n.height,T.push({type:"elem",elem:i,shift:o})}for(o=0,A=0;o<a||A<S.length;++o,++A){let i,c=S[A]||{},p=!0;for(;"separator"===c.type;){if(p||(z=Pe.makeSpan(["arraycolsep"],[]),z.style.width=F(t.fontMetrics().doubleRuleSep),M.push(z)),"|"!==c.separator&&":"!==c.separator)throw new n("Invalid separator type: "+c.separator);{const e="|"===c.separator?"solid":"dashed",r=Pe.makeSpan(["vertical-separator"],[],t);r.style.height=F(x),r.style.borderRightWidth=F(m),r.style.borderRightStyle=e,r.style.margin="0 "+F(-m/2);const n=x-k;n&&(r.style.verticalAlign=F(-n)),M.push(r)}A++,c=S[A]||{},p=!1}if(o>=a)continue;(o>0||e.hskipBeforeAndAfter)&&(i=l.deflt(c.pregap,u),0!==i&&(z=Pe.makeSpan(["arraycolsep"],[]),z.style.width=F(i),M.push(z)));let d=[];for(r=0;r<s;++r){const e=h[r],t=e[o];if(!t)continue;const n=e.pos-k;t.depth=e.depth,t.height=e.height,d.push({type:"elem",elem:t,shift:n})}d=Pe.makeVList({positionType:"individualShift",children:d},t),d=Pe.makeSpan(["col-align-"+(c.align||"c")],[d]),M.push(d),(o<a-1||e.hskipBeforeAndAfter)&&(i=l.deflt(c.postgap,u),0!==i&&(z=Pe.makeSpan(["arraycolsep"],[]),z.style.width=F(i),M.push(z)))}if(h=Pe.makeSpan(["mtable"],M),c.length>0){const e=Pe.makeLineSpan("hline",t,m),r=Pe.makeLineSpan("hdashline",t,m),n=[{type:"elem",elem:h,shift:0}];for(;c.length>0;){const t=c.pop(),o=t.pos-k;t.isDashed?n.push({type:"elem",elem:r,shift:o}):n.push({type:"elem",elem:e,shift:o})}h=Pe.makeVList({positionType:"individualShift",children:n},t)}if(0===T.length)return Pe.makeSpan(["mord"],[h],t);{let e=Pe.makeVList({positionType:"individualShift",children:T},t);return e=Pe.makeSpan(["tag"],[e],t),Pe.makeFragment([h,e])}},Vr={c:"center ",l:"left ",r:"right "},Pr=function(e,t){const r=[],n=new ft.MathNode("mtd",[],["mtr-glue"]),o=new ft.MathNode("mtd",[],["mml-eqn-num"]);for(let s=0;s<e.body.length;s++){const i=e.body[s],a=[];for(let e=0;e<i.length;e++)a.push(new ft.MathNode("mtd",[St(i[e],t)]));e.tags&&e.tags[s]&&(a.unshift(n),a.push(n),e.leqno?a.unshift(o):a.push(o)),r.push(new ft.MathNode("mtr",a))}let s=new ft.MathNode("mtable",r);const i=.5===e.arraystretch?.1:.16+e.arraystretch-1+(e.addJot?.09:0);s.setAttribute("rowspacing",F(i));let a="",l="";if(e.cols&&e.cols.length>0){const t=e.cols;let r="",n=!1,o=0,i=t.length;"separator"===t[0].type&&(a+="top ",o=1),"separator"===t[t.length-1].type&&(a+="bottom ",i-=1);for(let e=o;e<i;e++)"align"===t[e].type?(l+=Vr[t[e].align],n&&(r+="none "),n=!0):"separator"===t[e].type&&n&&(r+="|"===t[e].separator?"solid ":"dashed ",n=!1);s.setAttribute("columnalign",l.trim()),/[sd]/.test(r)&&s.setAttribute("columnlines",r.trim())}if("align"===e.colSeparationType){const t=e.cols||[];let r="";for(let e=1;e<t.length;e++)r+=e%2?"0em ":"1em ";s.setAttribute("columnspacing",r.trim())}else"alignat"===e.colSeparationType||"gather"===e.colSeparationType?s.setAttribute("columnspacing","0em"):"small"===e.colSeparationType?s.setAttribute("columnspacing","0.2778em"):"CD"===e.colSeparationType?s.setAttribute("columnspacing","0.5em"):s.setAttribute("columnspacing","1em");let h="";const c=e.hLinesBeforeRow;a+=c[0].length>0?"left ":"",a+=c[c.length-1].length>0?"right ":"";for(let e=1;e<c.length-1;e++)h+=0===c[e].length?"none ":c[e][0]?"dashed ":"solid ";return/[sd]/.test(h)&&s.setAttribute("rowlines",h.trim()),""!==a&&(s=new ft.MathNode("menclose",[s]),s.setAttribute("notation",a.trim())),e.arraystretch&&e.arraystretch<1&&(s=new ft.MathNode("mstyle",[s]),s.setAttribute("scriptlevel","1")),s},Fr=function(e,t){-1===e.envName.indexOf("ed")&&Hr(e);const r=[],o=e.envName.indexOf("at")>-1?"alignat":"align",s="split"===e.envName,i=Er(e.parser,{cols:r,addJot:!0,autoTag:s?void 0:Or(e.envName),emptySingleRow:!0,colSeparationType:o,maxNumCols:s?2:void 0,leqno:e.parser.settings.leqno},"display");let a,l=0;const h={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&"ordgroup"===t[0].type){let e="";for(let r=0;r<t[0].body.length;r++){e+=Rt(t[0].body[r],"textord").text}a=Number(e),l=2*a}const c=!l;i.body.forEach((function(e){for(let t=1;t<e.length;t+=2){const r=Rt(e[t],"styling");Rt(r.body[0],"ordgroup").body.unshift(h)}if(c)l<e.length&&(l=e.length);else{const t=e.length/2;if(a<t)throw new n("Too many math in a row: expected "+a+", but got "+t,e[0])}}));for(let e=0;e<l;++e){let t="r",n=0;e%2==1?t="l":e>0&&c&&(n=1),r[e]={type:"align",align:t,pregap:n,postgap:0}}return i.colSeparationType=c?"align":"alignat",i};Br({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){const r=(Ot(t[0])?[t[0]]:Rt(t[0],"ordgroup").body).map((function(e){const t=Ht(e).text;if(-1!=="lcr".indexOf(t))return{type:"align",align:t};if("|"===t)return{type:"separator",separator:"|"};if(":"===t)return{type:"separator",separator:":"};throw new n("Unknown column alignment: "+t,e)})),o={cols:r,hskipBeforeAndAfter:!0,maxNumCols:r.length};return Er(e.parser,o,Lr(e.envName))},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){const t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\\\{","\\\\}"],vmatrix:["|","|"],Vmatrix:["\\\\Vert","\\\\Vert"]}[e.envName.replace("*","")];let r="c";const o={hskipBeforeAndAfter:!1,cols:[{type:"align",align:r}]};if("*"===e.envName.charAt(e.envName.length-1)){const t=e.parser;if(t.consumeSpaces(),"["===t.fetch().text){if(t.consume(),t.consumeSpaces(),r=t.fetch().text,-1==="lcr".indexOf(r))throw new n("Expected l or c or r",t.nextToken);t.consume(),t.consumeSpaces(),t.expect("]"),t.consume(),o.cols=[{type:"align",align:r}]}}const s=Er(e.parser,o,Lr(e.envName)),i=Math.max(0,...s.body.map((e=>e.length)));return s.cols=new Array(i).fill({type:"align",align:r}),t?{type:"leftright",mode:e.mode,body:[s],left:t[0],right:t[1],rightColor:void 0}:s},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){const t=Er(e.parser,{arraystretch:.5},"script");return t.colSeparationType="small",t},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){const r=(Ot(t[0])?[t[0]]:Rt(t[0],"ordgroup").body).map((function(e){const t=Ht(e).text;if(-1!=="lc".indexOf(t))return{type:"align",align:t};throw new n("Unknown column alignment: "+t,e)}));if(r.length>1)throw new n("{subarray} can contain only one column");let o={cols:r,hskipBeforeAndAfter:!1,arraystretch:.5};if(o=Er(e.parser,o,"script"),o.body.length>0&&o.body[0].length>1)throw new n("{subarray} can contain only one column");return o},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){const t=Er(e.parser,{arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},Lr(e.envName));return{type:"leftright",mode:e.mode,body:[t],left:e.envName.indexOf("r")>-1?".":"\\\\{",right:e.envName.indexOf("r")>-1?"\\\\}":".",rightColor:void 0}},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:Fr,htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){l.contains(["gather","gather*"],e.envName)&&Hr(e);const t={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:Or(e.envName),emptySingleRow:!0,leqno:e.parser.settings.leqno};return Er(e.parser,t,"display")},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:Fr,htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){Hr(e);const t={autoTag:Or(e.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:e.parser.settings.leqno};return Er(e.parser,t,"display")},htmlBuilder:Dr,mathmlBuilder:Pr}),Br({type:"array",names:["CD"],props:{numArgs:0},handler(e){return Hr(e),function(e){const t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\\\cr","\\\\\\\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();const r=e.fetch().text;if("&"!==r&&"\\\\\\\\"!==r){if("\\\\end"===r){0===t[t.length-1].length&&t.pop();break}throw new n("Expected \\\\\\\\ or \\\\cr or \\\\end",e.nextToken)}e.consume()}let r=[];const o=[r];for(let a=0;a<t.length;a++){const l=t[a];let h={type:"styling",body:[],mode:"math",style:"display"};for(let t=0;t<l.length;t++)if(Xt(l[t])){r.push(h),t+=1;const o=Ht(l[t]).text,a=new Array(2);if(a[0]={type:"ordgroup",mode:"math",body:[]},a[1]={type:"ordgroup",mode:"math",body:[]},"=|.".indexOf(o)>-1);else{if(!("<>AV".indexOf(o)>-1))throw new n(\'Expected one of "<>AV=|." after @\',l[t]);for(let e=0;e<2;e++){let r=!0;for(let h=t+1;h<l.length;h++){if(i=o,("mathord"===(s=l[h]).type||"atom"===s.type)&&s.text===i){r=!1,t=h;break}if(Xt(l[h]))throw new n("Missing a "+o+" character to complete a CD arrow.",l[h]);a[e].body.push(l[h])}if(r)throw new n("Missing a "+o+" character to complete a CD arrow.",l[t])}}const c={type:"styling",body:[Wt(o,a,e)],mode:"math",style:"display"};r.push(c),h={type:"styling",body:[],mode:"math",style:"display"}}else h.body.push(l[t]);a%2==0?r.push(h):r.shift(),r=[],o.push(r)}var s,i;return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:"math",body:o,arraystretch:1,addJot:!0,rowGaps:[null],cols:new Array(o[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25}),colSeparationType:"CD",hLinesBeforeRow:new Array(o.length+1).fill([])}}(e.parser)},htmlBuilder:Dr,mathmlBuilder:Pr}),Nr("\\\\nonumber","\\\\gdef\\\\@eqnsw{0}"),Nr("\\\\notag","\\\\nonumber"),$e({type:"text",names:["\\\\hline","\\\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new n(e.funcName+" valid only within array environment")}});var Gr=Tr;$e({type:"environment",names:["\\\\begin","\\\\end"],props:{numArgs:1,argTypes:["text"]},handler(e,t){let{parser:r,funcName:o}=e;const s=t[0];if("ordgroup"!==s.type)throw new n("Invalid environment name",s);let i="";for(let e=0;e<s.body.length;++e)i+=Rt(s.body[e],"textord").text;if("\\\\begin"===o){if(!Gr.hasOwnProperty(i))throw new n("No such environment: "+i,s);const e=Gr[i],{args:t,optArgs:o}=r.parseArguments("\\\\begin{"+i+"}",e),a={mode:r.mode,envName:i,parser:r},l=e.handler(a,t,o);r.expect("\\\\end",!1);const h=r.nextToken,c=Rt(r.parseFunction(),"environment");if(c.name!==i)throw new n("Mismatch: \\\\begin{"+i+"} matched by \\\\end{"+c.name+"}",h);return l}return{type:"environment",mode:r.mode,name:i,nameGroup:s}}});const Ur=(e,t)=>{const r=e.font,n=t.withFont(r);return ct(e.body,n)},Yr=(e,t)=>{const r=e.font,n=t.withFont(r);return St(e.body,n)},Xr={"\\\\Bbb":"\\\\mathbb","\\\\bold":"\\\\mathbf","\\\\frak":"\\\\mathfrak","\\\\bm":"\\\\boldsymbol"};$e({type:"font",names:["\\\\mathrm","\\\\mathit","\\\\mathbf","\\\\mathnormal","\\\\mathsfit","\\\\mathbb","\\\\mathcal","\\\\mathfrak","\\\\mathscr","\\\\mathsf","\\\\mathtt","\\\\Bbb","\\\\bold","\\\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=Ke(t[0]);let s=n;return s in Xr&&(s=Xr[s]),{type:"font",mode:r.mode,font:s.slice(1),body:o}},htmlBuilder:Ur,mathmlBuilder:Yr}),$e({type:"mclass",names:["\\\\boldsymbol","\\\\bm"],props:{numArgs:1},handler:(e,t)=>{let{parser:r}=e;const n=t[0],o=l.isCharacterBox(n);return{type:"mclass",mode:r.mode,mclass:Ut(n),body:[{type:"font",mode:r.mode,font:"boldsymbol",body:n}],isCharacterBox:o}}}),$e({type:"font",names:["\\\\rm","\\\\sf","\\\\tt","\\\\bf","\\\\it","\\\\cal"],props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{let{parser:r,funcName:n,breakOnTokenText:o}=e;const{mode:s}=r,i=r.parseExpression(!0,o);return{type:"font",mode:s,font:"math"+n.slice(1),body:{type:"ordgroup",mode:r.mode,body:i}}},htmlBuilder:Ur,mathmlBuilder:Yr});const Wr=(e,t)=>{let r=t;return"display"===e?r=r.id>=w.SCRIPT.id?r.text():w.DISPLAY:"text"===e&&r.size===w.DISPLAY.size?r=w.TEXT:"script"===e?r=w.SCRIPT:"scriptscript"===e&&(r=w.SCRIPTSCRIPT),r},_r=(e,t)=>{const r=Wr(e.size,t.style),n=r.fracNum(),o=r.fracDen();let s;s=t.havingStyle(n);const i=ct(e.numer,s,t);if(e.continued){const e=8.5/t.fontMetrics().ptPerEm,r=3.5/t.fontMetrics().ptPerEm;i.height=i.height<e?e:i.height,i.depth=i.depth<r?r:i.depth}s=t.havingStyle(o);const a=ct(e.denom,s,t);let l,h,c,m,p,u,d,g,f,b;if(e.hasBarLine?(e.barSize?(h=P(e.barSize,t),l=Pe.makeLineSpan("frac-line",t,h)):l=Pe.makeLineSpan("frac-line",t),h=l.height,c=l.height):(l=null,h=0,c=t.fontMetrics().defaultRuleThickness),r.size===w.DISPLAY.size||"display"===e.size?(m=t.fontMetrics().num1,p=h>0?3*c:7*c,u=t.fontMetrics().denom1):(h>0?(m=t.fontMetrics().num2,p=c):(m=t.fontMetrics().num3,p=3*c),u=t.fontMetrics().denom2),l){const e=t.fontMetrics().axisHeight;m-i.depth-(e+.5*h)<p&&(m+=p-(m-i.depth-(e+.5*h))),e-.5*h-(a.height-u)<p&&(u+=p-(e-.5*h-(a.height-u)));const r=-(e-.5*h);d=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:u},{type:"elem",elem:l,shift:r},{type:"elem",elem:i,shift:-m}]},t)}else{const e=m-i.depth-(a.height-u);e<p&&(m+=.5*(p-e),u+=.5*(p-e)),d=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:u},{type:"elem",elem:i,shift:-m}]},t)}return s=t.havingStyle(r),d.height*=s.sizeMultiplier/t.sizeMultiplier,d.depth*=s.sizeMultiplier/t.sizeMultiplier,g=r.size===w.DISPLAY.size?t.fontMetrics().delim1:r.size===w.SCRIPTSCRIPT.size?t.havingStyle(w.SCRIPT).fontMetrics().delim2:t.fontMetrics().delim2,f=null==e.leftDelim?ht(t,["mopen"]):wr.customSizedDelim(e.leftDelim,g,!0,t.havingStyle(r),e.mode,["mopen"]),b=e.continued?Pe.makeSpan([]):null==e.rightDelim?ht(t,["mclose"]):wr.customSizedDelim(e.rightDelim,g,!0,t.havingStyle(r),e.mode,["mclose"]),Pe.makeSpan(["mord"].concat(s.sizingClasses(t)),[f,Pe.makeSpan(["mfrac"],[d]),b],t)},jr=(e,t)=>{let r=new ft.MathNode("mfrac",[St(e.numer,t),St(e.denom,t)]);if(e.hasBarLine){if(e.barSize){const n=P(e.barSize,t);r.setAttribute("linethickness",F(n))}}else r.setAttribute("linethickness","0px");const n=Wr(e.size,t.style);if(n.size!==t.style.size){r=new ft.MathNode("mstyle",[r]);const e=n.size===w.DISPLAY.size?"true":"false";r.setAttribute("displaystyle",e),r.setAttribute("scriptlevel","0")}if(null!=e.leftDelim||null!=e.rightDelim){const t=[];if(null!=e.leftDelim){const r=new ft.MathNode("mo",[new ft.TextNode(e.leftDelim.replace("\\\\",""))]);r.setAttribute("fence","true"),t.push(r)}if(t.push(r),null!=e.rightDelim){const r=new ft.MathNode("mo",[new ft.TextNode(e.rightDelim.replace("\\\\",""))]);r.setAttribute("fence","true"),t.push(r)}return yt(t)}return r};$e({type:"genfrac",names:["\\\\dfrac","\\\\frac","\\\\tfrac","\\\\dbinom","\\\\binom","\\\\tbinom","\\\\\\\\atopfrac","\\\\\\\\bracefrac","\\\\\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0],s=t[1];let i,a=null,l=null,h="auto";switch(n){case"\\\\dfrac":case"\\\\frac":case"\\\\tfrac":i=!0;break;case"\\\\\\\\atopfrac":i=!1;break;case"\\\\dbinom":case"\\\\binom":case"\\\\tbinom":i=!1,a="(",l=")";break;case"\\\\\\\\bracefrac":i=!1,a="\\\\{",l="\\\\}";break;case"\\\\\\\\brackfrac":i=!1,a="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(n){case"\\\\dfrac":case"\\\\dbinom":h="display";break;case"\\\\tfrac":case"\\\\tbinom":h="text"}return{type:"genfrac",mode:r.mode,continued:!1,numer:o,denom:s,hasBarLine:i,leftDelim:a,rightDelim:l,size:h,barSize:null}},htmlBuilder:_r,mathmlBuilder:jr}),$e({type:"genfrac",names:["\\\\cfrac"],props:{numArgs:2},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0],s=t[1];return{type:"genfrac",mode:r.mode,continued:!0,numer:o,denom:s,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),$e({type:"infix",names:["\\\\over","\\\\choose","\\\\atop","\\\\brace","\\\\brack"],props:{numArgs:0,infix:!0},handler(e){let t,{parser:r,funcName:n,token:o}=e;switch(n){case"\\\\over":t="\\\\frac";break;case"\\\\choose":t="\\\\binom";break;case"\\\\atop":t="\\\\\\\\atopfrac";break;case"\\\\brace":t="\\\\\\\\bracefrac";break;case"\\\\brack":t="\\\\\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:r.mode,replaceWith:t,token:o}}});const $r=["display","text","script","scriptscript"],Zr=function(e){let t=null;return e.length>0&&(t=e,t="."===t?null:t),t};$e({type:"genfrac",names:["\\\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(e,t){let{parser:r}=e;const n=t[4],o=t[5],s=Ke(t[0]),i="atom"===s.type&&"open"===s.family?Zr(s.text):null,a=Ke(t[1]),l="atom"===a.type&&"close"===a.family?Zr(a.text):null,h=Rt(t[2],"size");let c,m=null;h.isBlank?c=!0:(m=h.value,c=m.number>0);let p="auto",u=t[3];if("ordgroup"===u.type){if(u.body.length>0){const e=Rt(u.body[0],"textord");p=$r[Number(e.text)]}}else u=Rt(u,"textord"),p=$r[Number(u.text)];return{type:"genfrac",mode:r.mode,numer:n,denom:o,continued:!1,hasBarLine:c,barSize:m,leftDelim:i,rightDelim:l,size:p}},htmlBuilder:_r,mathmlBuilder:jr}),$e({type:"infix",names:["\\\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(e,t){let{parser:r,funcName:n,token:o}=e;return{type:"infix",mode:r.mode,replaceWith:"\\\\\\\\abovefrac",size:Rt(t[0],"size").value,token:o}}}),$e({type:"genfrac",names:["\\\\\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0],s=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e}(Rt(t[1],"infix").size),i=t[2],a=s.number>0;return{type:"genfrac",mode:r.mode,numer:o,denom:i,continued:!1,hasBarLine:a,barSize:s,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:_r,mathmlBuilder:jr});const Kr=(e,t)=>{const r=t.style;let n,o;"supsub"===e.type?(n=e.sup?ct(e.sup,t.havingStyle(r.sup()),t):ct(e.sub,t.havingStyle(r.sub()),t),o=Rt(e.base,"horizBrace")):o=Rt(e,"horizBrace");const s=ct(o.base,t.havingBaseStyle(w.DISPLAY)),i=It(o,t);let a;if(o.isOver?(a=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"kern",size:.1},{type:"elem",elem:i}]},t),a.children[0].children[0].children[1].classes.push("svg-align")):(a=Pe.makeVList({positionType:"bottom",positionData:s.depth+.1+i.height,children:[{type:"elem",elem:i},{type:"kern",size:.1},{type:"elem",elem:s}]},t),a.children[0].children[0].children[0].classes.push("svg-align")),n){const e=Pe.makeSpan(["mord",o.isOver?"mover":"munder"],[a],t);a=o.isOver?Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:e},{type:"kern",size:.2},{type:"elem",elem:n}]},t):Pe.makeVList({positionType:"bottom",positionData:e.depth+.2+n.height+n.depth,children:[{type:"elem",elem:n},{type:"kern",size:.2},{type:"elem",elem:e}]},t)}return Pe.makeSpan(["mord",o.isOver?"mover":"munder"],[a],t)};$e({type:"horizBrace",names:["\\\\overbrace","\\\\underbrace"],props:{numArgs:1},handler(e,t){let{parser:r,funcName:n}=e;return{type:"horizBrace",mode:r.mode,label:n,isOver:/^\\\\over/.test(n),base:t[0]}},htmlBuilder:Kr,mathmlBuilder:(e,t)=>{const r=qt(e.label);return new ft.MathNode(e.isOver?"mover":"munder",[St(e.base,t),r])}}),$e({type:"href",names:["\\\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;const n=t[1],o=Rt(t[0],"url").url;return r.settings.isTrusted({command:"\\\\href",url:o})?{type:"href",mode:r.mode,href:o,body:Je(n)}:r.formatUnsupportedCmd("\\\\href")},htmlBuilder:(e,t)=>{const r=ot(e.body,t,!1);return Pe.makeAnchor(e.href,[],r,t)},mathmlBuilder:(e,t)=>{let r=kt(e.body,t);return r instanceof dt||(r=new dt("mrow",[r])),r.setAttribute("href",e.href),r}}),$e({type:"href",names:["\\\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;const n=Rt(t[0],"url").url;if(!r.settings.isTrusted({command:"\\\\url",url:n}))return r.formatUnsupportedCmd("\\\\url");const o=[];for(let e=0;e<n.length;e++){let t=n[e];"~"===t&&(t="\\\\textasciitilde"),o.push({type:"textord",mode:"text",text:t})}const s={type:"text",mode:r.mode,font:"\\\\texttt",body:o};return{type:"href",mode:r.mode,href:n,body:Je(s)}}}),$e({type:"hbox",names:["\\\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(e,t){let{parser:r}=e;return{type:"hbox",mode:r.mode,body:Je(t[0])}},htmlBuilder(e,t){const r=ot(e.body,t,!1);return Pe.makeFragment(r)},mathmlBuilder(e,t){return new ft.MathNode("mrow",vt(e.body,t))}}),$e({type:"html",names:["\\\\htmlClass","\\\\htmlId","\\\\htmlStyle","\\\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(e,t)=>{let{parser:r,funcName:o,token:s}=e;const i=Rt(t[0],"raw").string,a=t[1];let l;r.settings.strict&&r.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");const h={};switch(o){case"\\\\htmlClass":h.class=i,l={command:"\\\\htmlClass",class:i};break;case"\\\\htmlId":h.id=i,l={command:"\\\\htmlId",id:i};break;case"\\\\htmlStyle":h.style=i,l={command:"\\\\htmlStyle",style:i};break;case"\\\\htmlData":{const e=i.split(",");for(let t=0;t<e.length;t++){const r=e[t].split("=");if(2!==r.length)throw new n("Error parsing key-value for \\\\htmlData");h["data-"+r[0].trim()]=r[1].trim()}l={command:"\\\\htmlData",attributes:h};break}default:throw new Error("Unrecognized html command")}return r.settings.isTrusted(l)?{type:"html",mode:r.mode,attributes:h,body:Je(a)}:r.formatUnsupportedCmd(o)},htmlBuilder:(e,t)=>{const r=ot(e.body,t,!1),n=["enclosing"];e.attributes.class&&n.push(...e.attributes.class.trim().split(/\\s+/));const o=Pe.makeSpan(n,r,t);for(const t in e.attributes)"class"!==t&&e.attributes.hasOwnProperty(t)&&o.setAttribute(t,e.attributes[t]);return o},mathmlBuilder:(e,t)=>kt(e.body,t)}),$e({type:"htmlmathml",names:["\\\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;return{type:"htmlmathml",mode:r.mode,html:Je(t[0]),mathml:Je(t[1])}},htmlBuilder:(e,t)=>{const r=ot(e.html,t,!1);return Pe.makeFragment(r)},mathmlBuilder:(e,t)=>kt(e.mathml,t)});const Jr=function(e){if(/^[-+]? *(\\d+(\\.\\d*)?|\\.\\d+)$/.test(e))return{number:+e,unit:"bp"};{const t=/([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(e);if(!t)throw new n("Invalid size: \'"+e+"\' in \\\\includegraphics");const r={number:+(t[1]+t[2]),unit:t[3]};if(!V(r))throw new n("Invalid unit: \'"+r.unit+"\' in \\\\includegraphics.");return r}};$e({type:"includegraphics",names:["\\\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(e,t,r)=>{let{parser:o}=e,s={number:0,unit:"em"},i={number:.9,unit:"em"},a={number:0,unit:"em"},l="";if(r[0]){const e=Rt(r[0],"raw").string.split(",");for(let t=0;t<e.length;t++){const r=e[t].split("=");if(2===r.length){const e=r[1].trim();switch(r[0].trim()){case"alt":l=e;break;case"width":s=Jr(e);break;case"height":i=Jr(e);break;case"totalheight":a=Jr(e);break;default:throw new n("Invalid key: \'"+r[0]+"\' in \\\\includegraphics.")}}}}const h=Rt(t[0],"url").url;return""===l&&(l=h,l=l.replace(/^.*[\\\\/]/,""),l=l.substring(0,l.lastIndexOf("."))),o.settings.isTrusted({command:"\\\\includegraphics",url:h})?{type:"includegraphics",mode:o.mode,alt:l,width:s,height:i,totalheight:a,src:h}:o.formatUnsupportedCmd("\\\\includegraphics")},htmlBuilder:(e,t)=>{const r=P(e.height,t);let n=0;e.totalheight.number>0&&(n=P(e.totalheight,t)-r);let o=0;e.width.number>0&&(o=P(e.width,t));const s={height:F(r+n)};o>0&&(s.width=F(o)),n>0&&(s.verticalAlign=F(-n));const i=new $(e.src,e.alt,s);return i.height=r,i.depth=n,i},mathmlBuilder:(e,t)=>{const r=new ft.MathNode("mglyph",[]);r.setAttribute("alt",e.alt);const n=P(e.height,t);let o=0;if(e.totalheight.number>0&&(o=P(e.totalheight,t)-n,r.setAttribute("valign",F(-o))),r.setAttribute("height",F(n+o)),e.width.number>0){const n=P(e.width,t);r.setAttribute("width",F(n))}return r.setAttribute("src",e.src),r}}),$e({type:"kern",names:["\\\\kern","\\\\mkern","\\\\hskip","\\\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(e,t){let{parser:r,funcName:n}=e;const o=Rt(t[0],"size");if(r.settings.strict){const e="m"===n[1],t="mu"===o.value.unit;e?(t||r.settings.reportNonstrict("mathVsTextUnits","LaTeX\'s "+n+" supports only mu units, not "+o.value.unit+" units"),"math"!==r.mode&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX\'s "+n+" works only in math mode")):t&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX\'s "+n+" doesn\'t support mu units")}return{type:"kern",mode:r.mode,dimension:o.value}},htmlBuilder(e,t){return Pe.makeGlue(e.dimension,t)},mathmlBuilder(e,t){const r=P(e.dimension,t);return new ft.SpaceNode(r)}}),$e({type:"lap",names:["\\\\mathllap","\\\\mathrlap","\\\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0];return{type:"lap",mode:r.mode,alignment:n.slice(5),body:o}},htmlBuilder:(e,t)=>{let r;"clap"===e.alignment?(r=Pe.makeSpan([],[ct(e.body,t)]),r=Pe.makeSpan(["inner"],[r],t)):r=Pe.makeSpan(["inner"],[ct(e.body,t)]);const n=Pe.makeSpan(["fix"],[]);let o=Pe.makeSpan([e.alignment],[r,n],t);const s=Pe.makeSpan(["strut"]);return s.style.height=F(o.height+o.depth),o.depth&&(s.style.verticalAlign=F(-o.depth)),o.children.unshift(s),o=Pe.makeSpan(["thinbox"],[o],t),Pe.makeSpan(["mord","vbox"],[o],t)},mathmlBuilder:(e,t)=>{const r=new ft.MathNode("mpadded",[St(e.body,t)]);if("rlap"!==e.alignment){const t="llap"===e.alignment?"-1":"-0.5";r.setAttribute("lspace",t+"width")}return r.setAttribute("width","0px"),r}}),$e({type:"styling",names:["\\\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){let{funcName:r,parser:n}=e;const o=n.mode;n.switchMode("math");const s="\\\\("===r?"\\\\)":"$",i=n.parseExpression(!1,s);return n.expect(s),n.switchMode(o),{type:"styling",mode:n.mode,style:"text",body:i}}}),$e({type:"text",names:["\\\\)","\\\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new n("Mismatched "+e.funcName)}});const Qr=(e,t)=>{switch(t.style.size){case w.DISPLAY.size:return e.display;case w.TEXT.size:return e.text;case w.SCRIPT.size:return e.script;case w.SCRIPTSCRIPT.size:return e.scriptscript;default:return e.text}};$e({type:"mathchoice",names:["\\\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(e,t)=>{let{parser:r}=e;return{type:"mathchoice",mode:r.mode,display:Je(t[0]),text:Je(t[1]),script:Je(t[2]),scriptscript:Je(t[3])}},htmlBuilder:(e,t)=>{const r=Qr(e,t),n=ot(r,t,!1);return Pe.makeFragment(n)},mathmlBuilder:(e,t)=>{const r=Qr(e,t);return kt(r,t)}});const en=(e,t,r,n,o,s,i)=>{e=Pe.makeSpan([],[e]);const a=r&&l.isCharacterBox(r);let h,c,m;if(t){const e=ct(t,n.havingStyle(o.sup()),n);c={elem:e,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-e.depth)}}if(r){const e=ct(r,n.havingStyle(o.sub()),n);h={elem:e,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-e.height)}}if(c&&h){const t=n.fontMetrics().bigOpSpacing5+h.elem.height+h.elem.depth+h.kern+e.depth+i;m=Pe.makeVList({positionType:"bottom",positionData:t,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:F(-s)},{type:"kern",size:h.kern},{type:"elem",elem:e},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:F(s)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(h){const t=e.height-i;m=Pe.makeVList({positionType:"top",positionData:t,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:F(-s)},{type:"kern",size:h.kern},{type:"elem",elem:e}]},n)}else{if(!c)return e;{const t=e.depth+i;m=Pe.makeVList({positionType:"bottom",positionData:t,children:[{type:"elem",elem:e},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:F(s)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}}const p=[m];if(h&&0!==s&&!a){const e=Pe.makeSpan(["mspace"],[],n);e.style.marginRight=F(s),p.unshift(e)}return Pe.makeSpan(["mop","op-limits"],p,n)},tn=["\\\\smallint"],rn=(e,t)=>{let r,n,o,s=!1;"supsub"===e.type?(r=e.sup,n=e.sub,o=Rt(e.base,"op"),s=!0):o=Rt(e,"op");const i=t.style;let a,h=!1;if(i.size===w.DISPLAY.size&&o.symbol&&!l.contains(tn,o.name)&&(h=!0),o.symbol){const e=h?"Size2-Regular":"Size1-Regular";let r="";if("\\\\oiint"!==o.name&&"\\\\oiiint"!==o.name||(r=o.name.slice(1),o.name="oiint"===r?"\\\\iint":"\\\\iiint"),a=Pe.makeSymbol(o.name,e,"math",t,["mop","op-symbol",h?"large-op":"small-op"]),r.length>0){const e=a.italic,n=Pe.staticSvg(r+"Size"+(h?"2":"1"),t);a=Pe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:0},{type:"elem",elem:n,shift:h?.08:0}]},t),o.name="\\\\"+r,a.classes.unshift("mop"),a.italic=e}}else if(o.body){const e=ot(o.body,t,!0);1===e.length&&e[0]instanceof K?(a=e[0],a.classes[0]="mop"):a=Pe.makeSpan(["mop"],e,t)}else{const e=[];for(let r=1;r<o.name.length;r++)e.push(Pe.mathsym(o.name[r],o.mode,t));a=Pe.makeSpan(["mop"],e,t)}let c=0,m=0;return(a instanceof K||"\\\\oiint"===o.name||"\\\\oiiint"===o.name)&&!o.suppressBaseShift&&(c=(a.height-a.depth)/2-t.fontMetrics().axisHeight,m=a.italic),s?en(a,r,n,t,i,m,c):(c&&(a.style.position="relative",a.style.top=F(c)),a)},nn=(e,t)=>{let r;if(e.symbol)r=new dt("mo",[bt(e.name,e.mode)]),l.contains(tn,e.name)&&r.setAttribute("largeop","false");else if(e.body)r=new dt("mo",vt(e.body,t));else{r=new dt("mi",[new gt(e.name.slice(1))]);const t=new dt("mo",[bt("\\u2061","text")]);r=e.parentIsSupSub?new dt("mrow",[r,t]):ut([r,t])}return r},on={"\\u220f":"\\\\prod","\\u2210":"\\\\coprod","\\u2211":"\\\\sum","\\u22c0":"\\\\bigwedge","\\u22c1":"\\\\bigvee","\\u22c2":"\\\\bigcap","\\u22c3":"\\\\bigcup","\\u2a00":"\\\\bigodot","\\u2a01":"\\\\bigoplus","\\u2a02":"\\\\bigotimes","\\u2a04":"\\\\biguplus","\\u2a06":"\\\\bigsqcup"};$e({type:"op",names:["\\\\coprod","\\\\bigvee","\\\\bigwedge","\\\\biguplus","\\\\bigcap","\\\\bigcup","\\\\intop","\\\\prod","\\\\sum","\\\\bigotimes","\\\\bigoplus","\\\\bigodot","\\\\bigsqcup","\\\\smallint","\\u220f","\\u2210","\\u2211","\\u22c0","\\u22c1","\\u22c2","\\u22c3","\\u2a00","\\u2a01","\\u2a02","\\u2a04","\\u2a06"],props:{numArgs:0},handler:(e,t)=>{let{parser:r,funcName:n}=e,o=n;return 1===o.length&&(o=on[o]),{type:"op",mode:r.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:o}},htmlBuilder:rn,mathmlBuilder:nn}),$e({type:"op",names:["\\\\mathop"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{let{parser:r}=e;const n=t[0];return{type:"op",mode:r.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Je(n)}},htmlBuilder:rn,mathmlBuilder:nn});const sn={"\\u222b":"\\\\int","\\u222c":"\\\\iint","\\u222d":"\\\\iiint","\\u222e":"\\\\oint","\\u222f":"\\\\oiint","\\u2230":"\\\\oiiint"};$e({type:"op",names:["\\\\arcsin","\\\\arccos","\\\\arctan","\\\\arctg","\\\\arcctg","\\\\arg","\\\\ch","\\\\cos","\\\\cosec","\\\\cosh","\\\\cot","\\\\cotg","\\\\coth","\\\\csc","\\\\ctg","\\\\cth","\\\\deg","\\\\dim","\\\\exp","\\\\hom","\\\\ker","\\\\lg","\\\\ln","\\\\log","\\\\sec","\\\\sin","\\\\sinh","\\\\sh","\\\\tan","\\\\tanh","\\\\tg","\\\\th"],props:{numArgs:0},handler(e){let{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:rn,mathmlBuilder:nn}),$e({type:"op",names:["\\\\det","\\\\gcd","\\\\inf","\\\\lim","\\\\max","\\\\min","\\\\Pr","\\\\sup"],props:{numArgs:0},handler(e){let{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:rn,mathmlBuilder:nn}),$e({type:"op",names:["\\\\int","\\\\iint","\\\\iiint","\\\\oint","\\\\oiint","\\\\oiiint","\\u222b","\\u222c","\\u222d","\\u222e","\\u222f","\\u2230"],props:{numArgs:0},handler(e){let{parser:t,funcName:r}=e,n=r;return 1===n.length&&(n=sn[n]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:rn,mathmlBuilder:nn});const an=(e,t)=>{let r,n,o,s,i=!1;if("supsub"===e.type?(r=e.sup,n=e.sub,o=Rt(e.base,"operatorname"),i=!0):o=Rt(e,"operatorname"),o.body.length>0){const e=o.body.map((e=>{const t=e.text;return"string"==typeof t?{type:"textord",mode:e.mode,text:t}:e})),r=ot(e,t.withFont("mathrm"),!0);for(let e=0;e<r.length;e++){const t=r[e];t instanceof K&&(t.text=t.text.replace(/\\u2212/,"-").replace(/\\u2217/,"*"))}s=Pe.makeSpan(["mop"],r,t)}else s=Pe.makeSpan(["mop"],[],t);return i?en(s,r,n,t,t.style,0,0):s};function ln(e,t,r){const n=ot(e,t,!1),o=t.sizeMultiplier/r.sizeMultiplier;for(let e=0;e<n.length;e++){const s=n[e].classes.indexOf("sizing");s<0?Array.prototype.push.apply(n[e].classes,t.sizingClasses(r)):n[e].classes[s+1]==="reset-size"+t.size&&(n[e].classes[s+1]="reset-size"+r.size),n[e].height*=o,n[e].depth*=o}return Pe.makeFragment(n)}$e({type:"operatorname",names:["\\\\operatorname@","\\\\operatornamewithlimits"],props:{numArgs:1},handler:(e,t)=>{let{parser:r,funcName:n}=e;const o=t[0];return{type:"operatorname",mode:r.mode,body:Je(o),alwaysHandleSupSub:"\\\\operatornamewithlimits"===n,limits:!1,parentIsSupSub:!1}},htmlBuilder:an,mathmlBuilder:(e,t)=>{let r=vt(e.body,t.withFont("mathrm")),n=!0;for(let e=0;e<r.length;e++){const t=r[e];if(t instanceof ft.SpaceNode);else if(t instanceof ft.MathNode)switch(t.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{const e=t.children[0];1===t.children.length&&e instanceof ft.TextNode?e.text=e.text.replace(/\\u2212/,"-").replace(/\\u2217/,"*"):n=!1;break}default:n=!1}else n=!1}if(n){const e=r.map((e=>e.toText())).join("");r=[new ft.TextNode(e)]}const o=new ft.MathNode("mi",r);o.setAttribute("mathvariant","normal");const s=new ft.MathNode("mo",[bt("\\u2061","text")]);return e.parentIsSupSub?new ft.MathNode("mrow",[o,s]):ft.newDocumentFragment([o,s])}}),Nr("\\\\operatorname","\\\\@ifstar\\\\operatornamewithlimits\\\\operatorname@"),Ze({type:"ordgroup",htmlBuilder(e,t){return e.semisimple?Pe.makeFragment(ot(e.body,t,!1)):Pe.makeSpan(["mord"],ot(e.body,t,!0),t)},mathmlBuilder(e,t){return kt(e.body,t,!0)}}),$e({type:"overline",names:["\\\\overline"],props:{numArgs:1},handler(e,t){let{parser:r}=e;const n=t[0];return{type:"overline",mode:r.mode,body:n}},htmlBuilder(e,t){const r=ct(e.body,t.havingCrampedStyle()),n=Pe.makeLineSpan("overline-line",t),o=t.fontMetrics().defaultRuleThickness,s=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"kern",size:3*o},{type:"elem",elem:n},{type:"kern",size:o}]},t);return Pe.makeSpan(["mord","overline"],[s],t)},mathmlBuilder(e,t){const r=new ft.MathNode("mo",[new ft.TextNode("\\u203e")]);r.setAttribute("stretchy","true");const n=new ft.MathNode("mover",[St(e.body,t),r]);return n.setAttribute("accent","true"),n}}),$e({type:"phantom",names:["\\\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;const n=t[0];return{type:"phantom",mode:r.mode,body:Je(n)}},htmlBuilder:(e,t)=>{const r=ot(e.body,t.withPhantom(),!1);return Pe.makeFragment(r)},mathmlBuilder:(e,t)=>{const r=vt(e.body,t);return new ft.MathNode("mphantom",r)}}),$e({type:"hphantom",names:["\\\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;const n=t[0];return{type:"hphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{let r=Pe.makeSpan([],[ct(e.body,t.withPhantom())]);if(r.height=0,r.depth=0,r.children)for(let e=0;e<r.children.length;e++)r.children[e].height=0,r.children[e].depth=0;return r=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t),Pe.makeSpan(["mord"],[r],t)},mathmlBuilder:(e,t)=>{const r=vt(Je(e.body),t),n=new ft.MathNode("mphantom",r),o=new ft.MathNode("mpadded",[n]);return o.setAttribute("height","0px"),o.setAttribute("depth","0px"),o}}),$e({type:"vphantom",names:["\\\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{let{parser:r}=e;const n=t[0];return{type:"vphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{const r=Pe.makeSpan(["inner"],[ct(e.body,t.withPhantom())]),n=Pe.makeSpan(["fix"],[]);return Pe.makeSpan(["mord","rlap"],[r,n],t)},mathmlBuilder:(e,t)=>{const r=vt(Je(e.body),t),n=new ft.MathNode("mphantom",r),o=new ft.MathNode("mpadded",[n]);return o.setAttribute("width","0px"),o}}),$e({type:"raisebox",names:["\\\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(e,t){let{parser:r}=e;const n=Rt(t[0],"size").value,o=t[1];return{type:"raisebox",mode:r.mode,dy:n,body:o}},htmlBuilder(e,t){const r=ct(e.body,t),n=P(e.dy,t);return Pe.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:r}]},t)},mathmlBuilder(e,t){const r=new ft.MathNode("mpadded",[St(e.body,t)]),n=e.dy.number+e.dy.unit;return r.setAttribute("voffset",n),r}}),$e({type:"internal",names:["\\\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(e){let{parser:t}=e;return{type:"internal",mode:t.mode}}}),$e({type:"rule",names:["\\\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(e,t,r){let{parser:n}=e;const o=r[0],s=Rt(t[0],"size"),i=Rt(t[1],"size");return{type:"rule",mode:n.mode,shift:o&&Rt(o,"size").value,width:s.value,height:i.value}},htmlBuilder(e,t){const r=Pe.makeSpan(["mord","rule"],[],t),n=P(e.width,t),o=P(e.height,t),s=e.shift?P(e.shift,t):0;return r.style.borderRightWidth=F(n),r.style.borderTopWidth=F(o),r.style.bottom=F(s),r.width=n,r.height=o+s,r.depth=-s,r.maxFontSize=1.125*o*t.sizeMultiplier,r},mathmlBuilder(e,t){const r=P(e.width,t),n=P(e.height,t),o=e.shift?P(e.shift,t):0,s=t.color&&t.getColor()||"black",i=new ft.MathNode("mspace");i.setAttribute("mathbackground",s),i.setAttribute("width",F(r)),i.setAttribute("height",F(n));const a=new ft.MathNode("mpadded",[i]);return o>=0?a.setAttribute("height",F(o)):(a.setAttribute("height",F(o)),a.setAttribute("depth",F(-o))),a.setAttribute("voffset",F(o)),a}});const hn=["\\\\tiny","\\\\sixptsize","\\\\scriptsize","\\\\footnotesize","\\\\small","\\\\normalsize","\\\\large","\\\\Large","\\\\LARGE","\\\\huge","\\\\Huge"];$e({type:"sizing",names:hn,props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{let{breakOnTokenText:r,funcName:n,parser:o}=e;const s=o.parseExpression(!1,r);return{type:"sizing",mode:o.mode,size:hn.indexOf(n)+1,body:s}},htmlBuilder:(e,t)=>{const r=t.havingSize(e.size);return ln(e.body,r,t)},mathmlBuilder:(e,t)=>{const r=t.havingSize(e.size),n=vt(e.body,r),o=new ft.MathNode("mstyle",n);return o.setAttribute("mathsize",F(r.sizeMultiplier)),o}}),$e({type:"smash",names:["\\\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(e,t,r)=>{let{parser:n}=e,o=!1,s=!1;const i=r[0]&&Rt(r[0],"ordgroup");if(i){let e="";for(let t=0;t<i.body.length;++t){if(e=i.body[t].text,"t"===e)o=!0;else{if("b"!==e){o=!1,s=!1;break}s=!0}}}else o=!0,s=!0;const a=t[0];return{type:"smash",mode:n.mode,body:a,smashHeight:o,smashDepth:s}},htmlBuilder:(e,t)=>{const r=Pe.makeSpan([],[ct(e.body,t)]);if(!e.smashHeight&&!e.smashDepth)return r;if(e.smashHeight&&(r.height=0,r.children))for(let e=0;e<r.children.length;e++)r.children[e].height=0;if(e.smashDepth&&(r.depth=0,r.children))for(let e=0;e<r.children.length;e++)r.children[e].depth=0;const n=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t);return Pe.makeSpan(["mord"],[n],t)},mathmlBuilder:(e,t)=>{const r=new ft.MathNode("mpadded",[St(e.body,t)]);return e.smashHeight&&r.setAttribute("height","0px"),e.smashDepth&&r.setAttribute("depth","0px"),r}}),$e({type:"sqrt",names:["\\\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){let{parser:n}=e;const o=r[0],s=t[0];return{type:"sqrt",mode:n.mode,body:s,index:o}},htmlBuilder(e,t){let r=ct(e.body,t.havingCrampedStyle());0===r.height&&(r.height=t.fontMetrics().xHeight),r=Pe.wrapFragment(r,t);const n=t.fontMetrics().defaultRuleThickness;let o=n;t.style.id<w.TEXT.id&&(o=t.fontMetrics().xHeight);let s=n+o/4;const i=r.height+r.depth+s+n,{span:a,ruleWidth:l,advanceWidth:h}=wr.sqrtImage(i,t),c=a.height-l;c>r.height+r.depth+s&&(s=(s+c-r.height-r.depth)/2);const m=a.height-r.height-s-l;r.style.paddingLeft=F(h);const p=Pe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r,wrapperClasses:["svg-align"]},{type:"kern",size:-(r.height+m)},{type:"elem",elem:a},{type:"kern",size:l}]},t);if(e.index){const r=t.havingStyle(w.SCRIPTSCRIPT),n=ct(e.index,r,t),o=.6*(p.height-p.depth),s=Pe.makeVList({positionType:"shift",positionData:-o,children:[{type:"elem",elem:n}]},t),i=Pe.makeSpan(["root"],[s]);return Pe.makeSpan(["mord","sqrt"],[i,p],t)}return Pe.makeSpan(["mord","sqrt"],[p],t)},mathmlBuilder(e,t){const{body:r,index:n}=e;return n?new ft.MathNode("mroot",[St(r,t),St(n,t)]):new ft.MathNode("msqrt",[St(r,t)])}});const cn={display:w.DISPLAY,text:w.TEXT,script:w.SCRIPT,scriptscript:w.SCRIPTSCRIPT};$e({type:"styling",names:["\\\\displaystyle","\\\\textstyle","\\\\scriptstyle","\\\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e,t){let{breakOnTokenText:r,funcName:n,parser:o}=e;const s=o.parseExpression(!0,r),i=n.slice(1,n.length-5);return{type:"styling",mode:o.mode,style:i,body:s}},htmlBuilder(e,t){const r=cn[e.style],n=t.havingStyle(r).withFont("");return ln(e.body,n,t)},mathmlBuilder(e,t){const r=cn[e.style],n=t.havingStyle(r),o=vt(e.body,n),s=new ft.MathNode("mstyle",o),i={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]}[e.style];return s.setAttribute("scriptlevel",i[0]),s.setAttribute("displaystyle",i[1]),s}});Ze({type:"supsub",htmlBuilder(e,t){const r=function(e,t){const r=e.base;if(r)return"op"===r.type?r.limits&&(t.style.size===w.DISPLAY.size||r.alwaysHandleSupSub)?rn:null:"operatorname"===r.type?r.alwaysHandleSupSub&&(t.style.size===w.DISPLAY.size||r.limits)?an:null:"accent"===r.type?l.isCharacterBox(r.base)?Et:null:"horizBrace"===r.type&&!e.sub===r.isOver?Kr:null;return null}(e,t);if(r)return r(e,t);const{base:n,sup:o,sub:s}=e,i=ct(n,t);let a,h;const c=t.fontMetrics();let m=0,p=0;const u=n&&l.isCharacterBox(n);if(o){const e=t.havingStyle(t.style.sup());a=ct(o,e,t),u||(m=i.height-e.fontMetrics().supDrop*e.sizeMultiplier/t.sizeMultiplier)}if(s){const e=t.havingStyle(t.style.sub());h=ct(s,e,t),u||(p=i.depth+e.fontMetrics().subDrop*e.sizeMultiplier/t.sizeMultiplier)}let d;d=t.style===w.DISPLAY?c.sup1:t.style.cramped?c.sup3:c.sup2;const g=t.sizeMultiplier,f=F(.5/c.ptPerEm/g);let b,y=null;if(h){const t=e.base&&"op"===e.base.type&&e.base.name&&("\\\\oiint"===e.base.name||"\\\\oiiint"===e.base.name);(i instanceof K||t)&&(y=F(-i.italic))}if(a&&h){m=Math.max(m,d,a.depth+.25*c.xHeight),p=Math.max(p,c.sub2);const e=4*c.defaultRuleThickness;if(m-a.depth-(h.height-p)<e){p=e-(m-a.depth)+h.height;const t=.8*c.xHeight-(m-a.depth);t>0&&(m+=t,p-=t)}const r=[{type:"elem",elem:h,shift:p,marginRight:f,marginLeft:y},{type:"elem",elem:a,shift:-m,marginRight:f}];b=Pe.makeVList({positionType:"individualShift",children:r},t)}else if(h){p=Math.max(p,c.sub1,h.height-.8*c.xHeight);const e=[{type:"elem",elem:h,marginLeft:y,marginRight:f}];b=Pe.makeVList({positionType:"shift",positionData:p,children:e},t)}else{if(!a)throw new Error("supsub must have either sup or sub.");m=Math.max(m,d,a.depth+.25*c.xHeight),b=Pe.makeVList({positionType:"shift",positionData:-m,children:[{type:"elem",elem:a,marginRight:f}]},t)}const x=lt(i,"right")||"mord";return Pe.makeSpan([x],[i,Pe.makeSpan(["msupsub"],[b])],t)},mathmlBuilder(e,t){let r,n,o=!1;e.base&&"horizBrace"===e.base.type&&(n=!!e.sup,n===e.base.isOver&&(o=!0,r=e.base.isOver)),!e.base||"op"!==e.base.type&&"operatorname"!==e.base.type||(e.base.parentIsSupSub=!0);const s=[St(e.base,t)];let i;if(e.sub&&s.push(St(e.sub,t)),e.sup&&s.push(St(e.sup,t)),o)i=r?"mover":"munder";else if(e.sub)if(e.sup){const r=e.base;i=r&&"op"===r.type&&r.limits&&t.style===w.DISPLAY||r&&"operatorname"===r.type&&r.alwaysHandleSupSub&&(t.style===w.DISPLAY||r.limits)?"munderover":"msubsup"}else{const r=e.base;i=r&&"op"===r.type&&r.limits&&(t.style===w.DISPLAY||r.alwaysHandleSupSub)||r&&"operatorname"===r.type&&r.alwaysHandleSupSub&&(r.limits||t.style===w.DISPLAY)?"munder":"msub"}else{const r=e.base;i=r&&"op"===r.type&&r.limits&&(t.style===w.DISPLAY||r.alwaysHandleSupSub)||r&&"operatorname"===r.type&&r.alwaysHandleSupSub&&(r.limits||t.style===w.DISPLAY)?"mover":"msup"}return new ft.MathNode(i,s)}}),Ze({type:"atom",htmlBuilder(e,t){return Pe.mathsym(e.text,e.mode,t,["m"+e.family])},mathmlBuilder(e,t){const r=new ft.MathNode("mo",[bt(e.text,e.mode)]);if("bin"===e.family){const n=xt(e,t);"bold-italic"===n&&r.setAttribute("mathvariant",n)}else"punct"===e.family?r.setAttribute("separator","true"):"open"!==e.family&&"close"!==e.family||r.setAttribute("stretchy","false");return r}});const mn={mi:"italic",mn:"normal",mtext:"normal"};Ze({type:"mathord",htmlBuilder(e,t){return Pe.makeOrd(e,t,"mathord")},mathmlBuilder(e,t){const r=new ft.MathNode("mi",[bt(e.text,e.mode,t)]),n=xt(e,t)||"italic";return n!==mn[r.type]&&r.setAttribute("mathvariant",n),r}}),Ze({type:"textord",htmlBuilder(e,t){return Pe.makeOrd(e,t,"textord")},mathmlBuilder(e,t){const r=bt(e.text,e.mode,t),n=xt(e,t)||"normal";let o;return o="text"===e.mode?new ft.MathNode("mtext",[r]):/[0-9]/.test(e.text)?new ft.MathNode("mn",[r]):"\\\\prime"===e.text?new ft.MathNode("mo",[r]):new ft.MathNode("mi",[r]),n!==mn[o.type]&&o.setAttribute("mathvariant",n),o}});const pn={"\\\\nobreak":"nobreak","\\\\allowbreak":"allowbreak"},un={" ":{},"\\\\ ":{},"~":{className:"nobreak"},"\\\\space":{},"\\\\nobreakspace":{className:"nobreak"}};Ze({type:"spacing",htmlBuilder(e,t){if(un.hasOwnProperty(e.text)){const r=un[e.text].className||"";if("text"===e.mode){const n=Pe.makeOrd(e,t,"textord");return n.classes.push(r),n}return Pe.makeSpan(["mspace",r],[Pe.mathsym(e.text,e.mode,t)],t)}if(pn.hasOwnProperty(e.text))return Pe.makeSpan(["mspace",pn[e.text]],[],t);throw new n(\'Unknown type of space "\'+e.text+\'"\')},mathmlBuilder(e,t){let r;if(!un.hasOwnProperty(e.text)){if(pn.hasOwnProperty(e.text))return new ft.MathNode("mspace");throw new n(\'Unknown type of space "\'+e.text+\'"\')}return r=new ft.MathNode("mtext",[new ft.TextNode("\\xa0")]),r}});const dn=()=>{const e=new ft.MathNode("mtd",[]);return e.setAttribute("width","50%"),e};Ze({type:"tag",mathmlBuilder(e,t){const r=new ft.MathNode("mtable",[new ft.MathNode("mtr",[dn(),new ft.MathNode("mtd",[kt(e.body,t)]),dn(),new ft.MathNode("mtd",[kt(e.tag,t)])])]);return r.setAttribute("width","100%"),r}});const gn={"\\\\text":void 0,"\\\\textrm":"textrm","\\\\textsf":"textsf","\\\\texttt":"texttt","\\\\textnormal":"textrm"},fn={"\\\\textbf":"textbf","\\\\textmd":"textmd"},bn={"\\\\textit":"textit","\\\\textup":"textup"},yn=(e,t)=>{const r=e.font;return r?gn[r]?t.withTextFontFamily(gn[r]):fn[r]?t.withTextFontWeight(fn[r]):"\\\\emph"===r?"textit"===t.fontShape?t.withTextFontShape("textup"):t.withTextFontShape("textit"):t.withTextFontShape(bn[r]):t};$e({type:"text",names:["\\\\text","\\\\textrm","\\\\textsf","\\\\texttt","\\\\textnormal","\\\\textbf","\\\\textmd","\\\\textit","\\\\textup","\\\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(e,t){let{parser:r,funcName:n}=e;const o=t[0];return{type:"text",mode:r.mode,body:Je(o),font:n}},htmlBuilder(e,t){const r=yn(e,t),n=ot(e.body,r,!0);return Pe.makeSpan(["mord","text"],n,r)},mathmlBuilder(e,t){const r=yn(e,t);return kt(e.body,r)}}),$e({type:"underline",names:["\\\\underline"],props:{numArgs:1,allowedInText:!0},handler(e,t){let{parser:r}=e;return{type:"underline",mode:r.mode,body:t[0]}},htmlBuilder(e,t){const r=ct(e.body,t),n=Pe.makeLineSpan("underline-line",t),o=t.fontMetrics().defaultRuleThickness,s=Pe.makeVList({positionType:"top",positionData:r.height,children:[{type:"kern",size:o},{type:"elem",elem:n},{type:"kern",size:3*o},{type:"elem",elem:r}]},t);return Pe.makeSpan(["mord","underline"],[s],t)},mathmlBuilder(e,t){const r=new ft.MathNode("mo",[new ft.TextNode("\\u203e")]);r.setAttribute("stretchy","true");const n=new ft.MathNode("munder",[St(e.body,t),r]);return n.setAttribute("accentunder","true"),n}}),$e({type:"vcenter",names:["\\\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(e,t){let{parser:r}=e;return{type:"vcenter",mode:r.mode,body:t[0]}},htmlBuilder(e,t){const r=ct(e.body,t),n=t.fontMetrics().axisHeight,o=.5*(r.height-n-(r.depth+n));return Pe.makeVList({positionType:"shift",positionData:o,children:[{type:"elem",elem:r}]},t)},mathmlBuilder(e,t){return new ft.MathNode("mpadded",[St(e.body,t)],["vcenter"])}}),$e({type:"verb",names:["\\\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,r){throw new n("\\\\verb ended by end of line instead of matching delimiter")},htmlBuilder(e,t){const r=xn(e),n=[],o=t.havingStyle(t.style.text());for(let t=0;t<r.length;t++){let s=r[t];"~"===s&&(s="\\\\textasciitilde"),n.push(Pe.makeSymbol(s,"Typewriter-Regular",e.mode,o,["mord","texttt"]))}return Pe.makeSpan(["mord","text"].concat(o.sizingClasses(t)),Pe.tryCombineChars(n),o)},mathmlBuilder(e,t){const r=new ft.TextNode(xn(e)),n=new ft.MathNode("mtext",[r]);return n.setAttribute("mathvariant","monospace"),n}});const xn=e=>e.body.replace(/ /g,e.star?"\\u2423":"\\xa0");var wn=We;const vn="[ \\r\\n\\t]",kn="(\\\\\\\\[a-zA-Z@]+)"+vn+"*",Sn="[\\u0300-\\u036f]",Mn=new RegExp(Sn+"+$"),zn="("+vn+"+)|\\\\\\\\(\\n|[ \\r\\t]+\\n?)[ \\r\\t]*|([!-\\\\[\\\\]-\\u2027\\u202a-\\ud7ff\\uf900-\\uffff]"+Sn+"*|[\\ud800-\\udbff][\\udc00-\\udfff]"+Sn+"*|\\\\\\\\verb\\\\*([^]).*?\\\\4|\\\\\\\\verb([^*a-zA-Z]).*?\\\\5|"+kn+"|\\\\\\\\[^\\ud800-\\udfff])";class An{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(zn,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){const e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new Ir("EOF",new qr(this,t,t));const r=this.tokenRegex.exec(e);if(null===r||r.index!==t)throw new n("Unexpected character: \'"+e[t]+"\'",new Ir(e[t],new qr(this,t,t+1)));const o=r[6]||r[3]||(r[2]?"\\\\ ":" ");if(14===this.catcodes[o]){const t=e.indexOf("\\n",this.tokenRegex.lastIndex);return-1===t?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=t+1,this.lex()}return new Ir(o,new qr(this,t,this.tokenRegex.lastIndex))}}class Tn{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(0===this.undefStack.length)throw new n("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");const e=this.undefStack.pop();for(const t in e)e.hasOwnProperty(t)&&(null==e[t]?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,r){if(void 0===r&&(r=!1),r){for(let t=0;t<this.undefStack.length;t++)delete this.undefStack[t][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{const t=this.undefStack[this.undefStack.length-1];t&&!t.hasOwnProperty(e)&&(t[e]=this.current[e])}null==t?delete this.current[e]:this.current[e]=t}}var Bn=Cr;Nr("\\\\noexpand",(function(e){const t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}})),Nr("\\\\expandafter",(function(e){const t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}})),Nr("\\\\@firstoftwo",(function(e){return{tokens:e.consumeArgs(2)[0],numArgs:0}})),Nr("\\\\@secondoftwo",(function(e){return{tokens:e.consumeArgs(2)[1],numArgs:0}})),Nr("\\\\@ifnextchar",(function(e){const t=e.consumeArgs(3);e.consumeSpaces();const r=e.future();return 1===t[0].length&&t[0][0].text===r.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}})),Nr("\\\\@ifstar","\\\\@ifnextchar *{\\\\@firstoftwo{#1}}"),Nr("\\\\TextOrMath",(function(e){const t=e.consumeArgs(2);return"text"===e.mode?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}}));const Cn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};Nr("\\\\char",(function(e){let t,r=e.popToken(),o="";if("\'"===r.text)t=8,r=e.popToken();else if(\'"\'===r.text)t=16,r=e.popToken();else if("`"===r.text)if(r=e.popToken(),"\\\\"===r.text[0])o=r.text.charCodeAt(1);else{if("EOF"===r.text)throw new n("\\\\char` missing argument");o=r.text.charCodeAt(0)}else t=10;if(t){if(o=Cn[r.text],null==o||o>=t)throw new n("Invalid base-"+t+" digit "+r.text);let s;for(;null!=(s=Cn[e.future().text])&&s<t;)o*=t,o+=s,e.popToken()}return"\\\\@char{"+o+"}"}));const Nn=(e,t,r,o)=>{let s=e.consumeArg().tokens;if(1!==s.length)throw new n("\\\\newcommand\'s first argument must be a macro name");const i=s[0].text,a=e.isDefined(i);if(a&&!t)throw new n("\\\\newcommand{"+i+"} attempting to redefine "+i+"; use \\\\renewcommand");if(!a&&!r)throw new n("\\\\renewcommand{"+i+"} when command "+i+" does not yet exist; use \\\\newcommand");let l=0;if(s=e.consumeArg().tokens,1===s.length&&"["===s[0].text){let t="",r=e.expandNextToken();for(;"]"!==r.text&&"EOF"!==r.text;)t+=r.text,r=e.expandNextToken();if(!t.match(/^\\s*[0-9]+\\s*$/))throw new n("Invalid number of arguments: "+t);l=parseInt(t),s=e.consumeArg().tokens}return a&&o||e.macros.set(i,{tokens:s,numArgs:l}),""};Nr("\\\\newcommand",(e=>Nn(e,!1,!0,!1))),Nr("\\\\renewcommand",(e=>Nn(e,!0,!1,!1))),Nr("\\\\providecommand",(e=>Nn(e,!0,!0,!0))),Nr("\\\\message",(e=>{const t=e.consumeArgs(1)[0];return console.log(t.reverse().map((e=>e.text)).join("")),""})),Nr("\\\\errmessage",(e=>{const t=e.consumeArgs(1)[0];return console.error(t.reverse().map((e=>e.text)).join("")),""})),Nr("\\\\show",(e=>{const t=e.popToken(),r=t.text;return console.log(t,e.macros.get(r),wn[r],se.math[r],se.text[r]),""})),Nr("\\\\bgroup","{"),Nr("\\\\egroup","}"),Nr("~","\\\\nobreakspace"),Nr("\\\\lq","`"),Nr("\\\\rq","\'"),Nr("\\\\aa","\\\\r a"),Nr("\\\\AA","\\\\r A"),Nr("\\\\textcopyright","\\\\html@mathml{\\\\textcircled{c}}{\\\\char`\\xa9}"),Nr("\\\\copyright","\\\\TextOrMath{\\\\textcopyright}{\\\\text{\\\\textcopyright}}"),Nr("\\\\textregistered","\\\\html@mathml{\\\\textcircled{\\\\scriptsize R}}{\\\\char`\\xae}"),Nr("\\u212c","\\\\mathscr{B}"),Nr("\\u2130","\\\\mathscr{E}"),Nr("\\u2131","\\\\mathscr{F}"),Nr("\\u210b","\\\\mathscr{H}"),Nr("\\u2110","\\\\mathscr{I}"),Nr("\\u2112","\\\\mathscr{L}"),Nr("\\u2133","\\\\mathscr{M}"),Nr("\\u211b","\\\\mathscr{R}"),Nr("\\u212d","\\\\mathfrak{C}"),Nr("\\u210c","\\\\mathfrak{H}"),Nr("\\u2128","\\\\mathfrak{Z}"),Nr("\\\\Bbbk","\\\\Bbb{k}"),Nr("\\xb7","\\\\cdotp"),Nr("\\\\llap","\\\\mathllap{\\\\textrm{#1}}"),Nr("\\\\rlap","\\\\mathrlap{\\\\textrm{#1}}"),Nr("\\\\clap","\\\\mathclap{\\\\textrm{#1}}"),Nr("\\\\mathstrut","\\\\vphantom{(}"),Nr("\\\\underbar","\\\\underline{\\\\text{#1}}"),Nr("\\\\not",\'\\\\html@mathml{\\\\mathrel{\\\\mathrlap\\\\@not}}{\\\\char"338}\'),Nr("\\\\neq","\\\\html@mathml{\\\\mathrel{\\\\not=}}{\\\\mathrel{\\\\char`\\u2260}}"),Nr("\\\\ne","\\\\neq"),Nr("\\u2260","\\\\neq"),Nr("\\\\notin","\\\\html@mathml{\\\\mathrel{{\\\\in}\\\\mathllap{/\\\\mskip1mu}}}{\\\\mathrel{\\\\char`\\u2209}}"),Nr("\\u2209","\\\\notin"),Nr("\\u2258","\\\\html@mathml{\\\\mathrel{=\\\\kern{-1em}\\\\raisebox{0.4em}{$\\\\scriptsize\\\\frown$}}}{\\\\mathrel{\\\\char`\\u2258}}"),Nr("\\u2259","\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\wedge}{=}}{\\\\mathrel{\\\\char`\\u2258}}"),Nr("\\u225a","\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\vee}{=}}{\\\\mathrel{\\\\char`\\u225a}}"),Nr("\\u225b","\\\\html@mathml{\\\\stackrel{\\\\scriptsize\\\\star}{=}}{\\\\mathrel{\\\\char`\\u225b}}"),Nr("\\u225d","\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{def}}{=}}{\\\\mathrel{\\\\char`\\u225d}}"),Nr("\\u225e","\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{m}}{=}}{\\\\mathrel{\\\\char`\\u225e}}"),Nr("\\u225f","\\\\html@mathml{\\\\stackrel{\\\\tiny?}{=}}{\\\\mathrel{\\\\char`\\u225f}}"),Nr("\\u27c2","\\\\perp"),Nr("\\u203c","\\\\mathclose{!\\\\mkern-0.8mu!}"),Nr("\\u220c","\\\\notni"),Nr("\\u231c","\\\\ulcorner"),Nr("\\u231d","\\\\urcorner"),Nr("\\u231e","\\\\llcorner"),Nr("\\u231f","\\\\lrcorner"),Nr("\\xa9","\\\\copyright"),Nr("\\xae","\\\\textregistered"),Nr("\\ufe0f","\\\\textregistered"),Nr("\\\\ulcorner",\'\\\\html@mathml{\\\\@ulcorner}{\\\\mathop{\\\\char"231c}}\'),Nr("\\\\urcorner",\'\\\\html@mathml{\\\\@urcorner}{\\\\mathop{\\\\char"231d}}\'),Nr("\\\\llcorner",\'\\\\html@mathml{\\\\@llcorner}{\\\\mathop{\\\\char"231e}}\'),Nr("\\\\lrcorner",\'\\\\html@mathml{\\\\@lrcorner}{\\\\mathop{\\\\char"231f}}\'),Nr("\\\\vdots","{\\\\varvdots\\\\rule{0pt}{15pt}}"),Nr("\\u22ee","\\\\vdots"),Nr("\\\\varGamma","\\\\mathit{\\\\Gamma}"),Nr("\\\\varDelta","\\\\mathit{\\\\Delta}"),Nr("\\\\varTheta","\\\\mathit{\\\\Theta}"),Nr("\\\\varLambda","\\\\mathit{\\\\Lambda}"),Nr("\\\\varXi","\\\\mathit{\\\\Xi}"),Nr("\\\\varPi","\\\\mathit{\\\\Pi}"),Nr("\\\\varSigma","\\\\mathit{\\\\Sigma}"),Nr("\\\\varUpsilon","\\\\mathit{\\\\Upsilon}"),Nr("\\\\varPhi","\\\\mathit{\\\\Phi}"),Nr("\\\\varPsi","\\\\mathit{\\\\Psi}"),Nr("\\\\varOmega","\\\\mathit{\\\\Omega}"),Nr("\\\\substack","\\\\begin{subarray}{c}#1\\\\end{subarray}"),Nr("\\\\colon","\\\\nobreak\\\\mskip2mu\\\\mathpunct{}\\\\mathchoice{\\\\mkern-3mu}{\\\\mkern-3mu}{}{}{:}\\\\mskip6mu\\\\relax"),Nr("\\\\boxed","\\\\fbox{$\\\\displaystyle{#1}$}"),Nr("\\\\iff","\\\\DOTSB\\\\;\\\\Longleftrightarrow\\\\;"),Nr("\\\\implies","\\\\DOTSB\\\\;\\\\Longrightarrow\\\\;"),Nr("\\\\impliedby","\\\\DOTSB\\\\;\\\\Longleftarrow\\\\;"),Nr("\\\\dddot","{\\\\overset{\\\\raisebox{-0.1ex}{\\\\normalsize ...}}{#1}}"),Nr("\\\\ddddot","{\\\\overset{\\\\raisebox{-0.1ex}{\\\\normalsize ....}}{#1}}");const qn={",":"\\\\dotsc","\\\\not":"\\\\dotsb","+":"\\\\dotsb","=":"\\\\dotsb","<":"\\\\dotsb",">":"\\\\dotsb","-":"\\\\dotsb","*":"\\\\dotsb",":":"\\\\dotsb","\\\\DOTSB":"\\\\dotsb","\\\\coprod":"\\\\dotsb","\\\\bigvee":"\\\\dotsb","\\\\bigwedge":"\\\\dotsb","\\\\biguplus":"\\\\dotsb","\\\\bigcap":"\\\\dotsb","\\\\bigcup":"\\\\dotsb","\\\\prod":"\\\\dotsb","\\\\sum":"\\\\dotsb","\\\\bigotimes":"\\\\dotsb","\\\\bigoplus":"\\\\dotsb","\\\\bigodot":"\\\\dotsb","\\\\bigsqcup":"\\\\dotsb","\\\\And":"\\\\dotsb","\\\\longrightarrow":"\\\\dotsb","\\\\Longrightarrow":"\\\\dotsb","\\\\longleftarrow":"\\\\dotsb","\\\\Longleftarrow":"\\\\dotsb","\\\\longleftrightarrow":"\\\\dotsb","\\\\Longleftrightarrow":"\\\\dotsb","\\\\mapsto":"\\\\dotsb","\\\\longmapsto":"\\\\dotsb","\\\\hookrightarrow":"\\\\dotsb","\\\\doteq":"\\\\dotsb","\\\\mathbin":"\\\\dotsb","\\\\mathrel":"\\\\dotsb","\\\\relbar":"\\\\dotsb","\\\\Relbar":"\\\\dotsb","\\\\xrightarrow":"\\\\dotsb","\\\\xleftarrow":"\\\\dotsb","\\\\DOTSI":"\\\\dotsi","\\\\int":"\\\\dotsi","\\\\oint":"\\\\dotsi","\\\\iint":"\\\\dotsi","\\\\iiint":"\\\\dotsi","\\\\iiiint":"\\\\dotsi","\\\\idotsint":"\\\\dotsi","\\\\DOTSX":"\\\\dotsx"};Nr("\\\\dots",(function(e){let t="\\\\dotso";const r=e.expandAfterFuture().text;return r in qn?t=qn[r]:("\\\\not"===r.slice(0,4)||r in se.math&&l.contains(["bin","rel"],se.math[r].group))&&(t="\\\\dotsb"),t}));const In={")":!0,"]":!0,"\\\\rbrack":!0,"\\\\}":!0,"\\\\rbrace":!0,"\\\\rangle":!0,"\\\\rceil":!0,"\\\\rfloor":!0,"\\\\rgroup":!0,"\\\\rmoustache":!0,"\\\\right":!0,"\\\\bigr":!0,"\\\\biggr":!0,"\\\\Bigr":!0,"\\\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};Nr("\\\\dotso",(function(e){return e.future().text in In?"\\\\ldots\\\\,":"\\\\ldots"})),Nr("\\\\dotsc",(function(e){const t=e.future().text;return t in In&&","!==t?"\\\\ldots\\\\,":"\\\\ldots"})),Nr("\\\\cdots",(function(e){return e.future().text in In?"\\\\@cdots\\\\,":"\\\\@cdots"})),Nr("\\\\dotsb","\\\\cdots"),Nr("\\\\dotsm","\\\\cdots"),Nr("\\\\dotsi","\\\\!\\\\cdots"),Nr("\\\\dotsx","\\\\ldots\\\\,"),Nr("\\\\DOTSI","\\\\relax"),Nr("\\\\DOTSB","\\\\relax"),Nr("\\\\DOTSX","\\\\relax"),Nr("\\\\tmspace","\\\\TextOrMath{\\\\kern#1#3}{\\\\mskip#1#2}\\\\relax"),Nr("\\\\,","\\\\tmspace+{3mu}{.1667em}"),Nr("\\\\thinspace","\\\\,"),Nr("\\\\>","\\\\mskip{4mu}"),Nr("\\\\:","\\\\tmspace+{4mu}{.2222em}"),Nr("\\\\medspace","\\\\:"),Nr("\\\\;","\\\\tmspace+{5mu}{.2777em}"),Nr("\\\\thickspace","\\\\;"),Nr("\\\\!","\\\\tmspace-{3mu}{.1667em}"),Nr("\\\\negthinspace","\\\\!"),Nr("\\\\negmedspace","\\\\tmspace-{4mu}{.2222em}"),Nr("\\\\negthickspace","\\\\tmspace-{5mu}{.277em}"),Nr("\\\\enspace","\\\\kern.5em "),Nr("\\\\enskip","\\\\hskip.5em\\\\relax"),Nr("\\\\quad","\\\\hskip1em\\\\relax"),Nr("\\\\qquad","\\\\hskip2em\\\\relax"),Nr("\\\\tag","\\\\@ifstar\\\\tag@literal\\\\tag@paren"),Nr("\\\\tag@paren","\\\\tag@literal{({#1})}"),Nr("\\\\tag@literal",(e=>{if(e.macros.get("\\\\df@tag"))throw new n("Multiple \\\\tag");return"\\\\gdef\\\\df@tag{\\\\text{#1}}"})),Nr("\\\\bmod","\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}\\\\mathbin{\\\\rm mod}\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}"),Nr("\\\\pod","\\\\allowbreak\\\\mathchoice{\\\\mkern18mu}{\\\\mkern8mu}{\\\\mkern8mu}{\\\\mkern8mu}(#1)"),Nr("\\\\pmod","\\\\pod{{\\\\rm mod}\\\\mkern6mu#1}"),Nr("\\\\mod","\\\\allowbreak\\\\mathchoice{\\\\mkern18mu}{\\\\mkern12mu}{\\\\mkern12mu}{\\\\mkern12mu}{\\\\rm mod}\\\\,\\\\,#1"),Nr("\\\\newline","\\\\\\\\\\\\relax"),Nr("\\\\TeX","\\\\textrm{\\\\html@mathml{T\\\\kern-.1667em\\\\raisebox{-.5ex}{E}\\\\kern-.125emX}{TeX}}");const Rn=F(T["Main-Regular"]["T".charCodeAt(0)][1]-.7*T["Main-Regular"]["A".charCodeAt(0)][1]);Nr("\\\\LaTeX","\\\\textrm{\\\\html@mathml{L\\\\kern-.36em\\\\raisebox{"+Rn+"}{\\\\scriptstyle A}\\\\kern-.15em\\\\TeX}{LaTeX}}"),Nr("\\\\KaTeX","\\\\textrm{\\\\html@mathml{K\\\\kern-.17em\\\\raisebox{"+Rn+"}{\\\\scriptstyle A}\\\\kern-.15em\\\\TeX}{KaTeX}}"),Nr("\\\\hspace","\\\\@ifstar\\\\@hspacer\\\\@hspace"),Nr("\\\\@hspace","\\\\hskip #1\\\\relax"),Nr("\\\\@hspacer","\\\\rule{0pt}{0pt}\\\\hskip #1\\\\relax"),Nr("\\\\ordinarycolon",":"),Nr("\\\\vcentcolon","\\\\mathrel{\\\\mathop\\\\ordinarycolon}"),Nr("\\\\dblcolon",\'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-.9mu}\\\\vcentcolon}}{\\\\mathop{\\\\char"2237}}\'),Nr("\\\\coloneqq",\'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}=}}{\\\\mathop{\\\\char"2254}}\'),Nr("\\\\Coloneqq",\'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}=}}{\\\\mathop{\\\\char"2237\\\\char"3d}}\'),Nr("\\\\coloneq",\'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}{\\\\mathop{\\\\char"3a\\\\char"2212}}\'),Nr("\\\\Coloneq",\'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}{\\\\mathop{\\\\char"2237\\\\char"2212}}\'),Nr("\\\\eqqcolon",\'\\\\html@mathml{\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}{\\\\mathop{\\\\char"2255}}\'),Nr("\\\\Eqqcolon",\'\\\\html@mathml{\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}{\\\\mathop{\\\\char"3d\\\\char"2237}}\'),Nr("\\\\eqcolon",\'\\\\html@mathml{\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}{\\\\mathop{\\\\char"2239}}\'),Nr("\\\\Eqcolon",\'\\\\html@mathml{\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}{\\\\mathop{\\\\char"2212\\\\char"2237}}\'),Nr("\\\\colonapprox",\'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}{\\\\mathop{\\\\char"3a\\\\char"2248}}\'),Nr("\\\\Colonapprox",\'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}{\\\\mathop{\\\\char"2237\\\\char"2248}}\'),Nr("\\\\colonsim",\'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}{\\\\mathop{\\\\char"3a\\\\char"223c}}\'),Nr("\\\\Colonsim",\'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}{\\\\mathop{\\\\char"2237\\\\char"223c}}\'),Nr("\\u2237","\\\\dblcolon"),Nr("\\u2239","\\\\eqcolon"),Nr("\\u2254","\\\\coloneqq"),Nr("\\u2255","\\\\eqqcolon"),Nr("\\u2a74","\\\\Coloneqq"),Nr("\\\\ratio","\\\\vcentcolon"),Nr("\\\\coloncolon","\\\\dblcolon"),Nr("\\\\colonequals","\\\\coloneqq"),Nr("\\\\coloncolonequals","\\\\Coloneqq"),Nr("\\\\equalscolon","\\\\eqqcolon"),Nr("\\\\equalscoloncolon","\\\\Eqqcolon"),Nr("\\\\colonminus","\\\\coloneq"),Nr("\\\\coloncolonminus","\\\\Coloneq"),Nr("\\\\minuscolon","\\\\eqcolon"),Nr("\\\\minuscoloncolon","\\\\Eqcolon"),Nr("\\\\coloncolonapprox","\\\\Colonapprox"),Nr("\\\\coloncolonsim","\\\\Colonsim"),Nr("\\\\simcolon","\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}"),Nr("\\\\simcoloncolon","\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}"),Nr("\\\\approxcolon","\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}"),Nr("\\\\approxcoloncolon","\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}"),Nr("\\\\notni","\\\\html@mathml{\\\\not\\\\ni}{\\\\mathrel{\\\\char`\\u220c}}"),Nr("\\\\limsup","\\\\DOTSB\\\\operatorname*{lim\\\\,sup}"),Nr("\\\\liminf","\\\\DOTSB\\\\operatorname*{lim\\\\,inf}"),Nr("\\\\injlim","\\\\DOTSB\\\\operatorname*{inj\\\\,lim}"),Nr("\\\\projlim","\\\\DOTSB\\\\operatorname*{proj\\\\,lim}"),Nr("\\\\varlimsup","\\\\DOTSB\\\\operatorname*{\\\\overline{lim}}"),Nr("\\\\varliminf","\\\\DOTSB\\\\operatorname*{\\\\underline{lim}}"),Nr("\\\\varinjlim","\\\\DOTSB\\\\operatorname*{\\\\underrightarrow{lim}}"),Nr("\\\\varprojlim","\\\\DOTSB\\\\operatorname*{\\\\underleftarrow{lim}}"),Nr("\\\\gvertneqq","\\\\html@mathml{\\\\@gvertneqq}{\\u2269}"),Nr("\\\\lvertneqq","\\\\html@mathml{\\\\@lvertneqq}{\\u2268}"),Nr("\\\\ngeqq","\\\\html@mathml{\\\\@ngeqq}{\\u2271}"),Nr("\\\\ngeqslant","\\\\html@mathml{\\\\@ngeqslant}{\\u2271}"),Nr("\\\\nleqq","\\\\html@mathml{\\\\@nleqq}{\\u2270}"),Nr("\\\\nleqslant","\\\\html@mathml{\\\\@nleqslant}{\\u2270}"),Nr("\\\\nshortmid","\\\\html@mathml{\\\\@nshortmid}{\\u2224}"),Nr("\\\\nshortparallel","\\\\html@mathml{\\\\@nshortparallel}{\\u2226}"),Nr("\\\\nsubseteqq","\\\\html@mathml{\\\\@nsubseteqq}{\\u2288}"),Nr("\\\\nsupseteqq","\\\\html@mathml{\\\\@nsupseteqq}{\\u2289}"),Nr("\\\\varsubsetneq","\\\\html@mathml{\\\\@varsubsetneq}{\\u228a}"),Nr("\\\\varsubsetneqq","\\\\html@mathml{\\\\@varsubsetneqq}{\\u2acb}"),Nr("\\\\varsupsetneq","\\\\html@mathml{\\\\@varsupsetneq}{\\u228b}"),Nr("\\\\varsupsetneqq","\\\\html@mathml{\\\\@varsupsetneqq}{\\u2acc}"),Nr("\\\\imath","\\\\html@mathml{\\\\@imath}{\\u0131}"),Nr("\\\\jmath","\\\\html@mathml{\\\\@jmath}{\\u0237}"),Nr("\\\\llbracket","\\\\html@mathml{\\\\mathopen{[\\\\mkern-3.2mu[}}{\\\\mathopen{\\\\char`\\u27e6}}"),Nr("\\\\rrbracket","\\\\html@mathml{\\\\mathclose{]\\\\mkern-3.2mu]}}{\\\\mathclose{\\\\char`\\u27e7}}"),Nr("\\u27e6","\\\\llbracket"),Nr("\\u27e7","\\\\rrbracket"),Nr("\\\\lBrace","\\\\html@mathml{\\\\mathopen{\\\\{\\\\mkern-3.2mu[}}{\\\\mathopen{\\\\char`\\u2983}}"),Nr("\\\\rBrace","\\\\html@mathml{\\\\mathclose{]\\\\mkern-3.2mu\\\\}}}{\\\\mathclose{\\\\char`\\u2984}}"),Nr("\\u2983","\\\\lBrace"),Nr("\\u2984","\\\\rBrace"),Nr("\\\\minuso","\\\\mathbin{\\\\html@mathml{{\\\\mathrlap{\\\\mathchoice{\\\\kern{0.145em}}{\\\\kern{0.145em}}{\\\\kern{0.1015em}}{\\\\kern{0.0725em}}\\\\circ}{-}}}{\\\\char`\\u29b5}}"),Nr("\\u29b5","\\\\minuso"),Nr("\\\\darr","\\\\downarrow"),Nr("\\\\dArr","\\\\Downarrow"),Nr("\\\\Darr","\\\\Downarrow"),Nr("\\\\lang","\\\\langle"),Nr("\\\\rang","\\\\rangle"),Nr("\\\\uarr","\\\\uparrow"),Nr("\\\\uArr","\\\\Uparrow"),Nr("\\\\Uarr","\\\\Uparrow"),Nr("\\\\N","\\\\mathbb{N}"),Nr("\\\\R","\\\\mathbb{R}"),Nr("\\\\Z","\\\\mathbb{Z}"),Nr("\\\\alef","\\\\aleph"),Nr("\\\\alefsym","\\\\aleph"),Nr("\\\\Alpha","\\\\mathrm{A}"),Nr("\\\\Beta","\\\\mathrm{B}"),Nr("\\\\bull","\\\\bullet"),Nr("\\\\Chi","\\\\mathrm{X}"),Nr("\\\\clubs","\\\\clubsuit"),Nr("\\\\cnums","\\\\mathbb{C}"),Nr("\\\\Complex","\\\\mathbb{C}"),Nr("\\\\Dagger","\\\\ddagger"),Nr("\\\\diamonds","\\\\diamondsuit"),Nr("\\\\empty","\\\\emptyset"),Nr("\\\\Epsilon","\\\\mathrm{E}"),Nr("\\\\Eta","\\\\mathrm{H}"),Nr("\\\\exist","\\\\exists"),Nr("\\\\harr","\\\\leftrightarrow"),Nr("\\\\hArr","\\\\Leftrightarrow"),Nr("\\\\Harr","\\\\Leftrightarrow"),Nr("\\\\hearts","\\\\heartsuit"),Nr("\\\\image","\\\\Im"),Nr("\\\\infin","\\\\infty"),Nr("\\\\Iota","\\\\mathrm{I}"),Nr("\\\\isin","\\\\in"),Nr("\\\\Kappa","\\\\mathrm{K}"),Nr("\\\\larr","\\\\leftarrow"),Nr("\\\\lArr","\\\\Leftarrow"),Nr("\\\\Larr","\\\\Leftarrow"),Nr("\\\\lrarr","\\\\leftrightarrow"),Nr("\\\\lrArr","\\\\Leftrightarrow"),Nr("\\\\Lrarr","\\\\Leftrightarrow"),Nr("\\\\Mu","\\\\mathrm{M}"),Nr("\\\\natnums","\\\\mathbb{N}"),Nr("\\\\Nu","\\\\mathrm{N}"),Nr("\\\\Omicron","\\\\mathrm{O}"),Nr("\\\\plusmn","\\\\pm"),Nr("\\\\rarr","\\\\rightarrow"),Nr("\\\\rArr","\\\\Rightarrow"),Nr("\\\\Rarr","\\\\Rightarrow"),Nr("\\\\real","\\\\Re"),Nr("\\\\reals","\\\\mathbb{R}"),Nr("\\\\Reals","\\\\mathbb{R}"),Nr("\\\\Rho","\\\\mathrm{P}"),Nr("\\\\sdot","\\\\cdot"),Nr("\\\\sect","\\\\S"),Nr("\\\\spades","\\\\spadesuit"),Nr("\\\\sub","\\\\subset"),Nr("\\\\sube","\\\\subseteq"),Nr("\\\\supe","\\\\supseteq"),Nr("\\\\Tau","\\\\mathrm{T}"),Nr("\\\\thetasym","\\\\vartheta"),Nr("\\\\weierp","\\\\wp"),Nr("\\\\Zeta","\\\\mathrm{Z}"),Nr("\\\\argmin","\\\\DOTSB\\\\operatorname*{arg\\\\,min}"),Nr("\\\\argmax","\\\\DOTSB\\\\operatorname*{arg\\\\,max}"),Nr("\\\\plim","\\\\DOTSB\\\\mathop{\\\\operatorname{plim}}\\\\limits"),Nr("\\\\bra","\\\\mathinner{\\\\langle{#1}|}"),Nr("\\\\ket","\\\\mathinner{|{#1}\\\\rangle}"),Nr("\\\\braket","\\\\mathinner{\\\\langle{#1}\\\\rangle}"),Nr("\\\\Bra","\\\\left\\\\langle#1\\\\right|"),Nr("\\\\Ket","\\\\left|#1\\\\right\\\\rangle");const Hn=e=>t=>{const r=t.consumeArg().tokens,n=t.consumeArg().tokens,o=t.consumeArg().tokens,s=t.consumeArg().tokens,i=t.macros.get("|"),a=t.macros.get("\\\\|");t.macros.beginGroup();const l=t=>r=>{e&&(r.macros.set("|",i),o.length&&r.macros.set("\\\\|",a));let s=t;if(!t&&o.length){"|"===r.future().text&&(r.popToken(),s=!0)}return{tokens:s?o:n,numArgs:0}};t.macros.set("|",l(!1)),o.length&&t.macros.set("\\\\|",l(!0));const h=t.consumeArg().tokens,c=t.expandTokens([...s,...h,...r]);return t.macros.endGroup(),{tokens:c.reverse(),numArgs:0}};Nr("\\\\bra@ket",Hn(!1)),Nr("\\\\bra@set",Hn(!0)),Nr("\\\\Braket","\\\\bra@ket{\\\\left\\\\langle}{\\\\,\\\\middle\\\\vert\\\\,}{\\\\,\\\\middle\\\\vert\\\\,}{\\\\right\\\\rangle}"),Nr("\\\\Set","\\\\bra@set{\\\\left\\\\{\\\\:}{\\\\;\\\\middle\\\\vert\\\\;}{\\\\;\\\\middle\\\\Vert\\\\;}{\\\\:\\\\right\\\\}}"),Nr("\\\\set","\\\\bra@set{\\\\{\\\\,}{\\\\mid}{}{\\\\,\\\\}}"),Nr("\\\\angln","{\\\\angl n}"),Nr("\\\\blue","\\\\textcolor{##6495ed}{#1}"),Nr("\\\\orange","\\\\textcolor{##ffa500}{#1}"),Nr("\\\\pink","\\\\textcolor{##ff00af}{#1}"),Nr("\\\\red","\\\\textcolor{##df0030}{#1}"),Nr("\\\\green","\\\\textcolor{##28ae7b}{#1}"),Nr("\\\\gray","\\\\textcolor{gray}{#1}"),Nr("\\\\purple","\\\\textcolor{##9d38bd}{#1}"),Nr("\\\\blueA","\\\\textcolor{##ccfaff}{#1}"),Nr("\\\\blueB","\\\\textcolor{##80f6ff}{#1}"),Nr("\\\\blueC","\\\\textcolor{##63d9ea}{#1}"),Nr("\\\\blueD","\\\\textcolor{##11accd}{#1}"),Nr("\\\\blueE","\\\\textcolor{##0c7f99}{#1}"),Nr("\\\\tealA","\\\\textcolor{##94fff5}{#1}"),Nr("\\\\tealB","\\\\textcolor{##26edd5}{#1}"),Nr("\\\\tealC","\\\\textcolor{##01d1c1}{#1}"),Nr("\\\\tealD","\\\\textcolor{##01a995}{#1}"),Nr("\\\\tealE","\\\\textcolor{##208170}{#1}"),Nr("\\\\greenA","\\\\textcolor{##b6ffb0}{#1}"),Nr("\\\\greenB","\\\\textcolor{##8af281}{#1}"),Nr("\\\\greenC","\\\\textcolor{##74cf70}{#1}"),Nr("\\\\greenD","\\\\textcolor{##1fab54}{#1}"),Nr("\\\\greenE","\\\\textcolor{##0d923f}{#1}"),Nr("\\\\goldA","\\\\textcolor{##ffd0a9}{#1}"),Nr("\\\\goldB","\\\\textcolor{##ffbb71}{#1}"),Nr("\\\\goldC","\\\\textcolor{##ff9c39}{#1}"),Nr("\\\\goldD","\\\\textcolor{##e07d10}{#1}"),Nr("\\\\goldE","\\\\textcolor{##a75a05}{#1}"),Nr("\\\\redA","\\\\textcolor{##fca9a9}{#1}"),Nr("\\\\redB","\\\\textcolor{##ff8482}{#1}"),Nr("\\\\redC","\\\\textcolor{##f9685d}{#1}"),Nr("\\\\redD","\\\\textcolor{##e84d39}{#1}"),Nr("\\\\redE","\\\\textcolor{##bc2612}{#1}"),Nr("\\\\maroonA","\\\\textcolor{##ffbde0}{#1}"),Nr("\\\\maroonB","\\\\textcolor{##ff92c6}{#1}"),Nr("\\\\maroonC","\\\\textcolor{##ed5fa6}{#1}"),Nr("\\\\maroonD","\\\\textcolor{##ca337c}{#1}"),Nr("\\\\maroonE","\\\\textcolor{##9e034e}{#1}"),Nr("\\\\purpleA","\\\\textcolor{##ddd7ff}{#1}"),Nr("\\\\purpleB","\\\\textcolor{##c6b9fc}{#1}"),Nr("\\\\purpleC","\\\\textcolor{##aa87ff}{#1}"),Nr("\\\\purpleD","\\\\textcolor{##7854ab}{#1}"),Nr("\\\\purpleE","\\\\textcolor{##543b78}{#1}"),Nr("\\\\mintA","\\\\textcolor{##f5f9e8}{#1}"),Nr("\\\\mintB","\\\\textcolor{##edf2df}{#1}"),Nr("\\\\mintC","\\\\textcolor{##e0e5cc}{#1}"),Nr("\\\\grayA","\\\\textcolor{##f6f7f7}{#1}"),Nr("\\\\grayB","\\\\textcolor{##f0f1f2}{#1}"),Nr("\\\\grayC","\\\\textcolor{##e3e5e6}{#1}"),Nr("\\\\grayD","\\\\textcolor{##d6d8da}{#1}"),Nr("\\\\grayE","\\\\textcolor{##babec2}{#1}"),Nr("\\\\grayF","\\\\textcolor{##888d93}{#1}"),Nr("\\\\grayG","\\\\textcolor{##626569}{#1}"),Nr("\\\\grayH","\\\\textcolor{##3b3e40}{#1}"),Nr("\\\\grayI","\\\\textcolor{##21242c}{#1}"),Nr("\\\\kaBlue","\\\\textcolor{##314453}{#1}"),Nr("\\\\kaGreen","\\\\textcolor{##71B307}{#1}");const On={"^":!0,_:!0,"\\\\limits":!0,"\\\\nolimits":!0};class En{constructor(e,t,r){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new Tn(Bn,t.macros),this.mode=r,this.stack=[]}feed(e){this.lexer=new An(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return 0===this.stack.length&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){let t,r,n;if(e){if(this.consumeSpaces(),"["!==this.future().text)return null;t=this.popToken(),({tokens:n,end:r}=this.consumeArg(["]"]))}else({tokens:n,start:t,end:r}=this.consumeArg());return this.pushToken(new Ir("EOF",r.loc)),this.pushTokens(n),t.range(r,"")}consumeSpaces(){for(;;){if(" "!==this.future().text)break;this.stack.pop()}}consumeArg(e){const t=[],r=e&&e.length>0;r||this.consumeSpaces();const o=this.future();let s,i=0,a=0;do{if(s=this.popToken(),t.push(s),"{"===s.text)++i;else if("}"===s.text){if(--i,-1===i)throw new n("Extra }",s)}else if("EOF"===s.text)throw new n("Unexpected end of input in a macro argument, expected \'"+(e&&r?e[a]:"}")+"\'",s);if(e&&r)if((0===i||1===i&&"{"===e[a])&&s.text===e[a]){if(++a,a===e.length){t.splice(-a,a);break}}else a=0}while(0!==i||r);return"{"===o.text&&"}"===t[t.length-1].text&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:o,end:s}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new n("The length of delimiters doesn\'t match the number of args!");const r=t[0];for(let e=0;e<r.length;e++){const t=this.popToken();if(r[e]!==t.text)throw new n("Use of the macro doesn\'t match its definition",t)}}const r=[];for(let n=0;n<e;n++)r.push(this.consumeArg(t&&t[n+1]).tokens);return r}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new n("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){const t=this.popToken(),r=t.text,o=t.noexpand?null:this._getExpansion(r);if(null==o||e&&o.unexpandable){if(e&&null==o&&"\\\\"===r[0]&&!this.isDefined(r))throw new n("Undefined control sequence: "+r);return this.pushToken(t),!1}this.countExpansion(1);let s=o.tokens;const i=this.consumeArgs(o.numArgs,o.delimiters);if(o.numArgs){s=s.slice();for(let e=s.length-1;e>=0;--e){let t=s[e];if("#"===t.text){if(0===e)throw new n("Incomplete placeholder at end of macro body",t);if(t=s[--e],"#"===t.text)s.splice(e+1,1);else{if(!/^[1-9]$/.test(t.text))throw new n("Not a valid argument number",t);s.splice(e,2,...i[+t.text-1])}}}}return this.pushTokens(s),s.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(!1===this.expandOnce()){const e=this.stack.pop();return e.treatAsRelax&&(e.text="\\\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new Ir(e)]):void 0}expandTokens(e){const t=[],r=this.stack.length;for(this.pushTokens(e);this.stack.length>r;)if(!1===this.expandOnce(!0)){const e=this.stack.pop();e.treatAsRelax&&(e.noexpand=!1,e.treatAsRelax=!1),t.push(e)}return this.countExpansion(t.length),t}expandMacroAsText(e){const t=this.expandMacro(e);return t?t.map((e=>e.text)).join(""):t}_getExpansion(e){const t=this.macros.get(e);if(null==t)return t;if(1===e.length){const t=this.lexer.catcodes[e];if(null!=t&&13!==t)return}const r="function"==typeof t?t(this):t;if("string"==typeof r){let e=0;if(-1!==r.indexOf("#")){const t=r.replace(/##/g,"");for(;-1!==t.indexOf("#"+(e+1));)++e}const t=new An(r,this.settings),n=[];let o=t.lex();for(;"EOF"!==o.text;)n.push(o),o=t.lex();n.reverse();return{tokens:n,numArgs:e}}return r}isDefined(e){return this.macros.has(e)||wn.hasOwnProperty(e)||se.math.hasOwnProperty(e)||se.text.hasOwnProperty(e)||On.hasOwnProperty(e)}isExpandable(e){const t=this.macros.get(e);return null!=t?"string"==typeof t||"function"==typeof t||!t.unexpandable:wn.hasOwnProperty(e)&&!wn[e].primitive}}const Ln=/^[\\u208a\\u208b\\u208c\\u208d\\u208e\\u2080\\u2081\\u2082\\u2083\\u2084\\u2085\\u2086\\u2087\\u2088\\u2089\\u2090\\u2091\\u2095\\u1d62\\u2c7c\\u2096\\u2097\\u2098\\u2099\\u2092\\u209a\\u1d63\\u209b\\u209c\\u1d64\\u1d65\\u2093\\u1d66\\u1d67\\u1d68\\u1d69\\u1d6a]/,Dn=Object.freeze({"\\u208a":"+","\\u208b":"-","\\u208c":"=","\\u208d":"(","\\u208e":")","\\u2080":"0","\\u2081":"1","\\u2082":"2","\\u2083":"3","\\u2084":"4","\\u2085":"5","\\u2086":"6","\\u2087":"7","\\u2088":"8","\\u2089":"9","\\u2090":"a","\\u2091":"e","\\u2095":"h","\\u1d62":"i","\\u2c7c":"j","\\u2096":"k","\\u2097":"l","\\u2098":"m","\\u2099":"n","\\u2092":"o","\\u209a":"p","\\u1d63":"r","\\u209b":"s","\\u209c":"t","\\u1d64":"u","\\u1d65":"v","\\u2093":"x","\\u1d66":"\\u03b2","\\u1d67":"\\u03b3","\\u1d68":"\\u03c1","\\u1d69":"\\u03d5","\\u1d6a":"\\u03c7","\\u207a":"+","\\u207b":"-","\\u207c":"=","\\u207d":"(","\\u207e":")","\\u2070":"0","\\xb9":"1","\\xb2":"2","\\xb3":"3","\\u2074":"4","\\u2075":"5","\\u2076":"6","\\u2077":"7","\\u2078":"8","\\u2079":"9","\\u1d2c":"A","\\u1d2e":"B","\\u1d30":"D","\\u1d31":"E","\\u1d33":"G","\\u1d34":"H","\\u1d35":"I","\\u1d36":"J","\\u1d37":"K","\\u1d38":"L","\\u1d39":"M","\\u1d3a":"N","\\u1d3c":"O","\\u1d3e":"P","\\u1d3f":"R","\\u1d40":"T","\\u1d41":"U","\\u2c7d":"V","\\u1d42":"W","\\u1d43":"a","\\u1d47":"b","\\u1d9c":"c","\\u1d48":"d","\\u1d49":"e","\\u1da0":"f","\\u1d4d":"g","\\u02b0":"h","\\u2071":"i","\\u02b2":"j","\\u1d4f":"k","\\u02e1":"l","\\u1d50":"m","\\u207f":"n","\\u1d52":"o","\\u1d56":"p","\\u02b3":"r","\\u02e2":"s","\\u1d57":"t","\\u1d58":"u","\\u1d5b":"v","\\u02b7":"w","\\u02e3":"x","\\u02b8":"y","\\u1dbb":"z","\\u1d5d":"\\u03b2","\\u1d5e":"\\u03b3","\\u1d5f":"\\u03b4","\\u1d60":"\\u03d5","\\u1d61":"\\u03c7","\\u1dbf":"\\u03b8"}),Vn={"\\u0301":{text:"\\\\\'",math:"\\\\acute"},"\\u0300":{text:"\\\\`",math:"\\\\grave"},"\\u0308":{text:\'\\\\"\',math:"\\\\ddot"},"\\u0303":{text:"\\\\~",math:"\\\\tilde"},"\\u0304":{text:"\\\\=",math:"\\\\bar"},"\\u0306":{text:"\\\\u",math:"\\\\breve"},"\\u030c":{text:"\\\\v",math:"\\\\check"},"\\u0302":{text:"\\\\^",math:"\\\\hat"},"\\u0307":{text:"\\\\.",math:"\\\\dot"},"\\u030a":{text:"\\\\r",math:"\\\\mathring"},"\\u030b":{text:"\\\\H"},"\\u0327":{text:"\\\\c"}},Pn={"\\xe1":"a\\u0301","\\xe0":"a\\u0300","\\xe4":"a\\u0308","\\u01df":"a\\u0308\\u0304","\\xe3":"a\\u0303","\\u0101":"a\\u0304","\\u0103":"a\\u0306","\\u1eaf":"a\\u0306\\u0301","\\u1eb1":"a\\u0306\\u0300","\\u1eb5":"a\\u0306\\u0303","\\u01ce":"a\\u030c","\\xe2":"a\\u0302","\\u1ea5":"a\\u0302\\u0301","\\u1ea7":"a\\u0302\\u0300","\\u1eab":"a\\u0302\\u0303","\\u0227":"a\\u0307","\\u01e1":"a\\u0307\\u0304","\\xe5":"a\\u030a","\\u01fb":"a\\u030a\\u0301","\\u1e03":"b\\u0307","\\u0107":"c\\u0301","\\u1e09":"c\\u0327\\u0301","\\u010d":"c\\u030c","\\u0109":"c\\u0302","\\u010b":"c\\u0307","\\xe7":"c\\u0327","\\u010f":"d\\u030c","\\u1e0b":"d\\u0307","\\u1e11":"d\\u0327","\\xe9":"e\\u0301","\\xe8":"e\\u0300","\\xeb":"e\\u0308","\\u1ebd":"e\\u0303","\\u0113":"e\\u0304","\\u1e17":"e\\u0304\\u0301","\\u1e15":"e\\u0304\\u0300","\\u0115":"e\\u0306","\\u1e1d":"e\\u0327\\u0306","\\u011b":"e\\u030c","\\xea":"e\\u0302","\\u1ebf":"e\\u0302\\u0301","\\u1ec1":"e\\u0302\\u0300","\\u1ec5":"e\\u0302\\u0303","\\u0117":"e\\u0307","\\u0229":"e\\u0327","\\u1e1f":"f\\u0307","\\u01f5":"g\\u0301","\\u1e21":"g\\u0304","\\u011f":"g\\u0306","\\u01e7":"g\\u030c","\\u011d":"g\\u0302","\\u0121":"g\\u0307","\\u0123":"g\\u0327","\\u1e27":"h\\u0308","\\u021f":"h\\u030c","\\u0125":"h\\u0302","\\u1e23":"h\\u0307","\\u1e29":"h\\u0327","\\xed":"i\\u0301","\\xec":"i\\u0300","\\xef":"i\\u0308","\\u1e2f":"i\\u0308\\u0301","\\u0129":"i\\u0303","\\u012b":"i\\u0304","\\u012d":"i\\u0306","\\u01d0":"i\\u030c","\\xee":"i\\u0302","\\u01f0":"j\\u030c","\\u0135":"j\\u0302","\\u1e31":"k\\u0301","\\u01e9":"k\\u030c","\\u0137":"k\\u0327","\\u013a":"l\\u0301","\\u013e":"l\\u030c","\\u013c":"l\\u0327","\\u1e3f":"m\\u0301","\\u1e41":"m\\u0307","\\u0144":"n\\u0301","\\u01f9":"n\\u0300","\\xf1":"n\\u0303","\\u0148":"n\\u030c","\\u1e45":"n\\u0307","\\u0146":"n\\u0327","\\xf3":"o\\u0301","\\xf2":"o\\u0300","\\xf6":"o\\u0308","\\u022b":"o\\u0308\\u0304","\\xf5":"o\\u0303","\\u1e4d":"o\\u0303\\u0301","\\u1e4f":"o\\u0303\\u0308","\\u022d":"o\\u0303\\u0304","\\u014d":"o\\u0304","\\u1e53":"o\\u0304\\u0301","\\u1e51":"o\\u0304\\u0300","\\u014f":"o\\u0306","\\u01d2":"o\\u030c","\\xf4":"o\\u0302","\\u1ed1":"o\\u0302\\u0301","\\u1ed3":"o\\u0302\\u0300","\\u1ed7":"o\\u0302\\u0303","\\u022f":"o\\u0307","\\u0231":"o\\u0307\\u0304","\\u0151":"o\\u030b","\\u1e55":"p\\u0301","\\u1e57":"p\\u0307","\\u0155":"r\\u0301","\\u0159":"r\\u030c","\\u1e59":"r\\u0307","\\u0157":"r\\u0327","\\u015b":"s\\u0301","\\u1e65":"s\\u0301\\u0307","\\u0161":"s\\u030c","\\u1e67":"s\\u030c\\u0307","\\u015d":"s\\u0302","\\u1e61":"s\\u0307","\\u015f":"s\\u0327","\\u1e97":"t\\u0308","\\u0165":"t\\u030c","\\u1e6b":"t\\u0307","\\u0163":"t\\u0327","\\xfa":"u\\u0301","\\xf9":"u\\u0300","\\xfc":"u\\u0308","\\u01d8":"u\\u0308\\u0301","\\u01dc":"u\\u0308\\u0300","\\u01d6":"u\\u0308\\u0304","\\u01da":"u\\u0308\\u030c","\\u0169":"u\\u0303","\\u1e79":"u\\u0303\\u0301","\\u016b":"u\\u0304","\\u1e7b":"u\\u0304\\u0308","\\u016d":"u\\u0306","\\u01d4":"u\\u030c","\\xfb":"u\\u0302","\\u016f":"u\\u030a","\\u0171":"u\\u030b","\\u1e7d":"v\\u0303","\\u1e83":"w\\u0301","\\u1e81":"w\\u0300","\\u1e85":"w\\u0308","\\u0175":"w\\u0302","\\u1e87":"w\\u0307","\\u1e98":"w\\u030a","\\u1e8d":"x\\u0308","\\u1e8b":"x\\u0307","\\xfd":"y\\u0301","\\u1ef3":"y\\u0300","\\xff":"y\\u0308","\\u1ef9":"y\\u0303","\\u0233":"y\\u0304","\\u0177":"y\\u0302","\\u1e8f":"y\\u0307","\\u1e99":"y\\u030a","\\u017a":"z\\u0301","\\u017e":"z\\u030c","\\u1e91":"z\\u0302","\\u017c":"z\\u0307","\\xc1":"A\\u0301","\\xc0":"A\\u0300","\\xc4":"A\\u0308","\\u01de":"A\\u0308\\u0304","\\xc3":"A\\u0303","\\u0100":"A\\u0304","\\u0102":"A\\u0306","\\u1eae":"A\\u0306\\u0301","\\u1eb0":"A\\u0306\\u0300","\\u1eb4":"A\\u0306\\u0303","\\u01cd":"A\\u030c","\\xc2":"A\\u0302","\\u1ea4":"A\\u0302\\u0301","\\u1ea6":"A\\u0302\\u0300","\\u1eaa":"A\\u0302\\u0303","\\u0226":"A\\u0307","\\u01e0":"A\\u0307\\u0304","\\xc5":"A\\u030a","\\u01fa":"A\\u030a\\u0301","\\u1e02":"B\\u0307","\\u0106":"C\\u0301","\\u1e08":"C\\u0327\\u0301","\\u010c":"C\\u030c","\\u0108":"C\\u0302","\\u010a":"C\\u0307","\\xc7":"C\\u0327","\\u010e":"D\\u030c","\\u1e0a":"D\\u0307","\\u1e10":"D\\u0327","\\xc9":"E\\u0301","\\xc8":"E\\u0300","\\xcb":"E\\u0308","\\u1ebc":"E\\u0303","\\u0112":"E\\u0304","\\u1e16":"E\\u0304\\u0301","\\u1e14":"E\\u0304\\u0300","\\u0114":"E\\u0306","\\u1e1c":"E\\u0327\\u0306","\\u011a":"E\\u030c","\\xca":"E\\u0302","\\u1ebe":"E\\u0302\\u0301","\\u1ec0":"E\\u0302\\u0300","\\u1ec4":"E\\u0302\\u0303","\\u0116":"E\\u0307","\\u0228":"E\\u0327","\\u1e1e":"F\\u0307","\\u01f4":"G\\u0301","\\u1e20":"G\\u0304","\\u011e":"G\\u0306","\\u01e6":"G\\u030c","\\u011c":"G\\u0302","\\u0120":"G\\u0307","\\u0122":"G\\u0327","\\u1e26":"H\\u0308","\\u021e":"H\\u030c","\\u0124":"H\\u0302","\\u1e22":"H\\u0307","\\u1e28":"H\\u0327","\\xcd":"I\\u0301","\\xcc":"I\\u0300","\\xcf":"I\\u0308","\\u1e2e":"I\\u0308\\u0301","\\u0128":"I\\u0303","\\u012a":"I\\u0304","\\u012c":"I\\u0306","\\u01cf":"I\\u030c","\\xce":"I\\u0302","\\u0130":"I\\u0307","\\u0134":"J\\u0302","\\u1e30":"K\\u0301","\\u01e8":"K\\u030c","\\u0136":"K\\u0327","\\u0139":"L\\u0301","\\u013d":"L\\u030c","\\u013b":"L\\u0327","\\u1e3e":"M\\u0301","\\u1e40":"M\\u0307","\\u0143":"N\\u0301","\\u01f8":"N\\u0300","\\xd1":"N\\u0303","\\u0147":"N\\u030c","\\u1e44":"N\\u0307","\\u0145":"N\\u0327","\\xd3":"O\\u0301","\\xd2":"O\\u0300","\\xd6":"O\\u0308","\\u022a":"O\\u0308\\u0304","\\xd5":"O\\u0303","\\u1e4c":"O\\u0303\\u0301","\\u1e4e":"O\\u0303\\u0308","\\u022c":"O\\u0303\\u0304","\\u014c":"O\\u0304","\\u1e52":"O\\u0304\\u0301","\\u1e50":"O\\u0304\\u0300","\\u014e":"O\\u0306","\\u01d1":"O\\u030c","\\xd4":"O\\u0302","\\u1ed0":"O\\u0302\\u0301","\\u1ed2":"O\\u0302\\u0300","\\u1ed6":"O\\u0302\\u0303","\\u022e":"O\\u0307","\\u0230":"O\\u0307\\u0304","\\u0150":"O\\u030b","\\u1e54":"P\\u0301","\\u1e56":"P\\u0307","\\u0154":"R\\u0301","\\u0158":"R\\u030c","\\u1e58":"R\\u0307","\\u0156":"R\\u0327","\\u015a":"S\\u0301","\\u1e64":"S\\u0301\\u0307","\\u0160":"S\\u030c","\\u1e66":"S\\u030c\\u0307","\\u015c":"S\\u0302","\\u1e60":"S\\u0307","\\u015e":"S\\u0327","\\u0164":"T\\u030c","\\u1e6a":"T\\u0307","\\u0162":"T\\u0327","\\xda":"U\\u0301","\\xd9":"U\\u0300","\\xdc":"U\\u0308","\\u01d7":"U\\u0308\\u0301","\\u01db":"U\\u0308\\u0300","\\u01d5":"U\\u0308\\u0304","\\u01d9":"U\\u0308\\u030c","\\u0168":"U\\u0303","\\u1e78":"U\\u0303\\u0301","\\u016a":"U\\u0304","\\u1e7a":"U\\u0304\\u0308","\\u016c":"U\\u0306","\\u01d3":"U\\u030c","\\xdb":"U\\u0302","\\u016e":"U\\u030a","\\u0170":"U\\u030b","\\u1e7c":"V\\u0303","\\u1e82":"W\\u0301","\\u1e80":"W\\u0300","\\u1e84":"W\\u0308","\\u0174":"W\\u0302","\\u1e86":"W\\u0307","\\u1e8c":"X\\u0308","\\u1e8a":"X\\u0307","\\xdd":"Y\\u0301","\\u1ef2":"Y\\u0300","\\u0178":"Y\\u0308","\\u1ef8":"Y\\u0303","\\u0232":"Y\\u0304","\\u0176":"Y\\u0302","\\u1e8e":"Y\\u0307","\\u0179":"Z\\u0301","\\u017d":"Z\\u030c","\\u1e90":"Z\\u0302","\\u017b":"Z\\u0307","\\u03ac":"\\u03b1\\u0301","\\u1f70":"\\u03b1\\u0300","\\u1fb1":"\\u03b1\\u0304","\\u1fb0":"\\u03b1\\u0306","\\u03ad":"\\u03b5\\u0301","\\u1f72":"\\u03b5\\u0300","\\u03ae":"\\u03b7\\u0301","\\u1f74":"\\u03b7\\u0300","\\u03af":"\\u03b9\\u0301","\\u1f76":"\\u03b9\\u0300","\\u03ca":"\\u03b9\\u0308","\\u0390":"\\u03b9\\u0308\\u0301","\\u1fd2":"\\u03b9\\u0308\\u0300","\\u1fd1":"\\u03b9\\u0304","\\u1fd0":"\\u03b9\\u0306","\\u03cc":"\\u03bf\\u0301","\\u1f78":"\\u03bf\\u0300","\\u03cd":"\\u03c5\\u0301","\\u1f7a":"\\u03c5\\u0300","\\u03cb":"\\u03c5\\u0308","\\u03b0":"\\u03c5\\u0308\\u0301","\\u1fe2":"\\u03c5\\u0308\\u0300","\\u1fe1":"\\u03c5\\u0304","\\u1fe0":"\\u03c5\\u0306","\\u03ce":"\\u03c9\\u0301","\\u1f7c":"\\u03c9\\u0300","\\u038e":"\\u03a5\\u0301","\\u1fea":"\\u03a5\\u0300","\\u03ab":"\\u03a5\\u0308","\\u1fe9":"\\u03a5\\u0304","\\u1fe8":"\\u03a5\\u0306","\\u038f":"\\u03a9\\u0301","\\u1ffa":"\\u03a9\\u0300"};class Fn{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new En(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(void 0===t&&(t=!0),this.fetch().text!==e)throw new n("Expected \'"+e+"\', got \'"+this.fetch().text+"\'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return null==this.nextToken&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\\\color","\\\\textcolor");try{const e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){const t=this.nextToken;this.consume(),this.gullet.pushToken(new Ir("}")),this.gullet.pushTokens(e);const r=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,r}parseExpression(e,t){const r=[];for(;;){"math"===this.mode&&this.consumeSpaces();const n=this.fetch();if(-1!==Fn.endOfExpression.indexOf(n.text))break;if(t&&n.text===t)break;if(e&&wn[n.text]&&wn[n.text].infix)break;const o=this.parseAtom(t);if(!o)break;"internal"!==o.type&&r.push(o)}return"text"===this.mode&&this.formLigatures(r),this.handleInfixNodes(r)}handleInfixNodes(e){let t,r=-1;for(let o=0;o<e.length;o++)if("infix"===e[o].type){if(-1!==r)throw new n("only one infix operator per group",e[o].token);r=o,t=e[o].replaceWith}if(-1!==r&&t){let n,o;const s=e.slice(0,r),i=e.slice(r+1);let a;return n=1===s.length&&"ordgroup"===s[0].type?s[0]:{type:"ordgroup",mode:this.mode,body:s},o=1===i.length&&"ordgroup"===i[0].type?i[0]:{type:"ordgroup",mode:this.mode,body:i},a="\\\\\\\\abovefrac"===t?this.callFunction(t,[n,e[r],o],[]):this.callFunction(t,[n,o],[]),[a]}return e}handleSupSubscript(e){const t=this.fetch(),r=t.text;let o;this.consume(),this.consumeSpaces();do{var s;o=this.parseGroup(e)}while("internal"===(null==(s=o)?void 0:s.type));if(!o)throw new n("Expected group after \'"+r+"\'",t);return o}formatUnsupportedCmd(e){const t=[];for(let r=0;r<e.length;r++)t.push({type:"textord",mode:"text",text:e[r]});const r={type:"text",mode:this.mode,body:t};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[r]}}parseAtom(e){const t=this.parseGroup("atom",e);if("internal"===(null==t?void 0:t.type))return t;if("text"===this.mode)return t;let r,o;for(;;){this.consumeSpaces();const e=this.fetch();if("\\\\limits"===e.text||"\\\\nolimits"===e.text){if(t&&"op"===t.type){const r="\\\\limits"===e.text;t.limits=r,t.alwaysHandleSupSub=!0}else{if(!t||"operatorname"!==t.type)throw new n("Limit controls must follow a math operator",e);t.alwaysHandleSupSub&&(t.limits="\\\\limits"===e.text)}this.consume()}else if("^"===e.text){if(r)throw new n("Double superscript",e);r=this.handleSupSubscript("superscript")}else if("_"===e.text){if(o)throw new n("Double subscript",e);o=this.handleSupSubscript("subscript")}else if("\'"===e.text){if(r)throw new n("Double superscript",e);const t={type:"textord",mode:this.mode,text:"\\\\prime"},o=[t];for(this.consume();"\'"===this.fetch().text;)o.push(t),this.consume();"^"===this.fetch().text&&o.push(this.handleSupSubscript("superscript")),r={type:"ordgroup",mode:this.mode,body:o}}else{if(!Dn[e.text])break;{const t=Ln.test(e.text),n=[];for(n.push(new Ir(Dn[e.text])),this.consume();;){const e=this.fetch().text;if(!Dn[e])break;if(Ln.test(e)!==t)break;n.unshift(new Ir(Dn[e])),this.consume()}const s=this.subparse(n);t?o={type:"ordgroup",mode:"math",body:s}:r={type:"ordgroup",mode:"math",body:s}}}}return r||o?{type:"supsub",mode:this.mode,base:t,sup:r,sub:o}:t}parseFunction(e,t){const r=this.fetch(),o=r.text,s=wn[o];if(!s)return null;if(this.consume(),t&&"atom"!==t&&!s.allowedInArgument)throw new n("Got function \'"+o+"\' with no arguments"+(t?" as "+t:""),r);if("text"===this.mode&&!s.allowedInText)throw new n("Can\'t use function \'"+o+"\' in text mode",r);if("math"===this.mode&&!1===s.allowedInMath)throw new n("Can\'t use function \'"+o+"\' in math mode",r);const{args:i,optArgs:a}=this.parseArguments(o,s);return this.callFunction(o,i,a,r,e)}callFunction(e,t,r,o,s){const i={funcName:e,parser:this,token:o,breakOnTokenText:s},a=wn[e];if(a&&a.handler)return a.handler(i,t,r);throw new n("No function handler for "+e)}parseArguments(e,t){const r=t.numArgs+t.numOptionalArgs;if(0===r)return{args:[],optArgs:[]};const o=[],s=[];for(let i=0;i<r;i++){let r=t.argTypes&&t.argTypes[i];const a=i<t.numOptionalArgs;(t.primitive&&null==r||"sqrt"===t.type&&1===i&&null==s[0])&&(r="primitive");const l=this.parseGroupOfType("argument to \'"+e+"\'",r,a);if(a)s.push(l);else{if(null==l)throw new n("Null argument, please report this as a bug");o.push(l)}}return{args:o,optArgs:s}}parseGroupOfType(e,t,r){switch(t){case"color":return this.parseColorGroup(r);case"size":return this.parseSizeGroup(r);case"url":return this.parseUrlGroup(r);case"math":case"text":return this.parseArgumentGroup(r,t);case"hbox":{const e=this.parseArgumentGroup(r,"text");return null!=e?{type:"styling",mode:e.mode,body:[e],style:"text"}:null}case"raw":{const e=this.parseStringGroup("raw",r);return null!=e?{type:"raw",mode:"text",string:e.text}:null}case"primitive":{if(r)throw new n("A primitive argument cannot be optional");const t=this.parseGroup(e);if(null==t)throw new n("Expected group as "+e,this.fetch());return t}case"original":case null:case void 0:return this.parseArgumentGroup(r);default:throw new n("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;" "===this.fetch().text;)this.consume()}parseStringGroup(e,t){const r=this.gullet.scanArgument(t);if(null==r)return null;let n,o="";for(;"EOF"!==(n=this.fetch()).text;)o+=n.text,this.consume();return this.consume(),r.text=o,r}parseRegexGroup(e,t){const r=this.fetch();let o,s=r,i="";for(;"EOF"!==(o=this.fetch()).text&&e.test(i+o.text);)s=o,i+=s.text,this.consume();if(""===i)throw new n("Invalid "+t+": \'"+r.text+"\'",r);return r.range(s,i)}parseColorGroup(e){const t=this.parseStringGroup("color",e);if(null==t)return null;const r=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!r)throw new n("Invalid color: \'"+t.text+"\'",t);let o=r[0];return/^[0-9a-f]{6}$/i.test(o)&&(o="#"+o),{type:"color-token",mode:this.mode,color:o}}parseSizeGroup(e){let t,r=!1;if(this.gullet.consumeSpaces(),t=e||"{"===this.gullet.future().text?this.parseStringGroup("size",e):this.parseRegexGroup(/^[-+]? *(?:$|\\d+|\\d+\\.\\d*|\\.\\d*) *[a-z]{0,2} *$/,"size"),!t)return null;e||0!==t.text.length||(t.text="0pt",r=!0);const o=/([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(t.text);if(!o)throw new n("Invalid size: \'"+t.text+"\'",t);const s={number:+(o[1]+o[2]),unit:o[3]};if(!V(s))throw new n("Invalid unit: \'"+s.unit+"\'",t);return{type:"size",mode:this.mode,value:s,isBlank:r}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);const t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),null==t)return null;const r=t.text.replace(/\\\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:r}}parseArgumentGroup(e,t){const r=this.gullet.scanArgument(e);if(null==r)return null;const n=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();const o=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();const s={type:"ordgroup",mode:this.mode,loc:r.loc,body:o};return t&&this.switchMode(n),s}parseGroup(e,t){const r=this.fetch(),o=r.text;let s;if("{"===o||"\\\\begingroup"===o){this.consume();const e="{"===o?"}":"\\\\endgroup";this.gullet.beginGroup();const t=this.parseExpression(!1,e),n=this.fetch();this.expect(e),this.gullet.endGroup(),s={type:"ordgroup",mode:this.mode,loc:qr.range(r,n),body:t,semisimple:"\\\\begingroup"===o||void 0}}else if(s=this.parseFunction(t,e)||this.parseSymbol(),null==s&&"\\\\"===o[0]&&!On.hasOwnProperty(o)){if(this.settings.throwOnError)throw new n("Undefined control sequence: "+o,r);s=this.formatUnsupportedCmd(o),this.consume()}return s}formLigatures(e){let t=e.length-1;for(let r=0;r<t;++r){const n=e[r],o=n.text;"-"===o&&"-"===e[r+1].text&&(r+1<t&&"-"===e[r+2].text?(e.splice(r,3,{type:"textord",mode:"text",loc:qr.range(n,e[r+2]),text:"---"}),t-=2):(e.splice(r,2,{type:"textord",mode:"text",loc:qr.range(n,e[r+1]),text:"--"}),t-=1)),"\'"!==o&&"`"!==o||e[r+1].text!==o||(e.splice(r,2,{type:"textord",mode:"text",loc:qr.range(n,e[r+1]),text:o+o}),t-=1)}}parseSymbol(){const e=this.fetch();let t=e.text;if(/^\\\\verb[^a-zA-Z]/.test(t)){this.consume();let e=t.slice(5);const r="*"===e.charAt(0);if(r&&(e=e.slice(1)),e.length<2||e.charAt(0)!==e.slice(-1))throw new n("\\\\verb assertion failed --\\n                    please report what input caused this bug");return e=e.slice(1,-1),{type:"verb",mode:"text",body:e,star:r}}Pn.hasOwnProperty(t[0])&&!se[this.mode][t[0]]&&(this.settings.strict&&"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",\'Accented Unicode text character "\'+t[0]+\'" used in math mode\',e),t=Pn[t[0]]+t.slice(1));const r=Mn.exec(t);let o;if(r&&(t=t.substring(0,r.index),"i"===t?t="\\u0131":"j"===t&&(t="\\u0237")),se[this.mode][t]){this.settings.strict&&"math"===this.mode&&Te.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",\'Latin-1/Unicode text character "\'+t[0]+\'" used in math mode\',e);const r=se[this.mode][t].group,n=qr.range(e);let s;if(re.hasOwnProperty(r)){const e=r;s={type:"atom",mode:this.mode,family:e,loc:n,text:t}}else s={type:r,mode:this.mode,loc:n,text:t};o=s}else{if(!(t.charCodeAt(0)>=128))return null;this.settings.strict&&(S(t.charCodeAt(0))?"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",\'Unicode text character "\'+t[0]+\'" used in math mode\',e):this.settings.reportNonstrict("unknownSymbol",\'Unrecognized Unicode character "\'+t[0]+\'" (\'+t.charCodeAt(0)+")",e)),o={type:"textord",mode:"text",loc:qr.range(e),text:t}}if(this.consume(),r)for(let t=0;t<r[0].length;t++){const s=r[0][t];if(!Vn[s])throw new n("Unknown accent \' "+s+"\'",e);const i=Vn[s][this.mode]||Vn[s].text;if(!i)throw new n("Accent "+s+" unsupported in "+this.mode+" mode",e);o={type:"accent",mode:this.mode,loc:qr.range(e),label:i,isStretchy:!1,isShifty:!0,base:o}}return o}}Fn.endOfExpression=["}","\\\\endgroup","\\\\end","\\\\right","&"];var Gn=function(e,t){if(!("string"==typeof e||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");const r=new Fn(e,t);delete r.gullet.macros.current["\\\\df@tag"];let o=r.parse();if(delete r.gullet.macros.current["\\\\current@color"],delete r.gullet.macros.current["\\\\color"],r.gullet.macros.get("\\\\df@tag")){if(!t.displayMode)throw new n("\\\\tag works only in display equations");o=[{type:"tag",mode:"text",body:o,tag:r.subparse([new Ir("\\\\df@tag")])}]}return o};let Un=function(e,t,r){t.textContent="";const n=Xn(e,r).toNode();t.appendChild(n)};"undefined"!=typeof document&&"CSS1Compat"!==document.compatMode&&("undefined"!=typeof console&&console.warn("Warning: KaTeX doesn\'t work in quirks mode. Make sure your website has a suitable doctype."),Un=function(){throw new n("KaTeX doesn\'t work in quirks mode.")});const Yn=function(e,t,r){if(r.throwOnError||!(e instanceof n))throw e;const o=Pe.makeSpan(["katex-error"],[new K(t)]);return o.setAttribute("title",e.toString()),o.setAttribute("style","color:"+r.errorColor),o},Xn=function(e,t){const r=new m(t);try{const t=Gn(e,r);return Tt(t,e,r)}catch(t){return Yn(t,e,r)}};var Wn={version:"0.16.22",render:Un,renderToString:function(e,t){return Xn(e,t).toMarkup()},ParseError:n,SETTINGS_SCHEMA:h,__parse:function(e,t){const r=new m(t);return Gn(e,r)},__renderToDomTree:Xn,__renderToHTMLTree:function(e,t){const r=new m(t);try{return function(e,t,r){const n=pt(e,zt(r)),o=Pe.makeSpan(["katex"],[n]);return At(o,r)}(Gn(e,r),0,r)}catch(t){return Yn(t,e,r)}},__setFontMetrics:function(e,t){T[e]=t},__defineSymbol:ie,__defineFunction:$e,__defineMacro:Nr,__domTree:{Span:_,Anchor:j,SymbolNode:K,SvgNode:J,PathNode:Q,LineNode:ee}};return t=t.default}()}));\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/katex/katex.min.js?')},"./src/assets/js/katex/mhchem.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _katex_min__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./katex.min */ \"./src/assets/js/katex/katex.min.js\");\n/* harmony import */ var _katex_min__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_katex_min__WEBPACK_IMPORTED_MODULE_0__);\n/* eslint-disable */\r\n/* -*- Mode: JavaScript; indent-tabs-mode:nil; js-indent-level: 2 -*- */\r\n/* vim: set ts=2 et sw=2 tw=80: */\r\n\r\n/*************************************************************\r\n *\r\n *  KaTeX mhchem.js\r\n *\r\n *  This file implements a KaTeX version of mhchem version 3.3.0.\r\n *  It is adapted from MathJax/extensions/TeX/mhchem.js\r\n *  It differs from the MathJax version as follows:\r\n *    1. The interface is changed so that it can be called from KaTeX, not MathJax.\r\n *    2. \\rlap and \\llap are replaced with \\mathrlap and \\mathllap.\r\n *    3. Four lines of code are edited in order to use \\raisebox instead of \\raise.\r\n *    4. The reaction arrow code is simplified. All reaction arrows are rendered\r\n *       using KaTeX extensible arrows instead of building non-extensible arrows.\r\n *    5. \\tripledash vertical alignment is slightly adjusted.\r\n *\r\n *    This code, as other KaTeX code, is released under the MIT license.\r\n * \r\n * /*************************************************************\r\n *\r\n *  MathJax/extensions/TeX/mhchem.js\r\n *\r\n *  Implements the \\ce command for handling chemical formulas\r\n *  from the mhchem LaTeX package.\r\n *\r\n *  ---------------------------------------------------------------------\r\n *\r\n *  Copyright (c) 2011-2015 The MathJax Consortium\r\n *  Copyright (c) 2015-2018 Martin Hensel\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *  See the License for the specific language governing permissions and\r\n *  limitations under the License.\r\n */\r\n\r\n//\r\n// Coding Style\r\n//   - use '' for identifiers that can by minified/uglified\r\n//   - use \"\" for strings that need to stay untouched\r\n\r\n// version: \"3.3.0\" for MathJax and KaTeX\r\n\r\n\r\n// Add \\ce, \\pu, and \\tripledash to the KaTeX macros.\r\n\r\n\r\n\r\n_katex_min__WEBPACK_IMPORTED_MODULE_0___default().__defineMacro(\"\\\\ce\", function(context) {\r\n  return chemParse(context.consumeArgs(1)[0], \"ce\")\r\n});\r\n\r\n_katex_min__WEBPACK_IMPORTED_MODULE_0___default().__defineMacro(\"\\\\pu\", function(context) {\r\n  return chemParse(context.consumeArgs(1)[0], \"pu\");\r\n});\r\n\r\n//  Needed for \\bond for the ~ forms\r\n//  Raise by 2.56mu, not 2mu. We're raising a hyphen-minus, U+002D, not \r\n//  a mathematical minus, U+2212. So we need that extra 0.56.\r\n_katex_min__WEBPACK_IMPORTED_MODULE_0___default().__defineMacro(\"\\\\tripledash\", \"{\\\\vphantom{-}\\\\raisebox{2.56mu}{$\\\\mkern2mu\"\r\n+ \"\\\\tiny\\\\text{-}\\\\mkern1mu\\\\text{-}\\\\mkern1mu\\\\text{-}\\\\mkern2mu$}}\");\r\n\r\n  //\r\n  //  This is the main function for handing the \\ce and \\pu commands.\r\n  //  It takes the argument to \\ce or \\pu and returns the corresponding TeX string.\r\n  //\r\n\r\n  var chemParse = function (tokens, stateMachine) {\r\n    // Recreate the argument string from KaTeX's array of tokens.\r\n    var str = \"\";\r\n    var expectedLoc = tokens.length && tokens[tokens.length - 1].loc.start\r\n    for (var i = tokens.length - 1; i >= 0; i--) {\r\n      if(tokens[i].loc.start > expectedLoc) {\r\n        // context.consumeArgs has eaten a space.\r\n        str += \" \";\r\n        expectedLoc = tokens[i].loc.start;\r\n      }\r\n      str += tokens[i].text;\r\n      expectedLoc += tokens[i].text.length;\r\n    }\r\n    var tex = texify.go(mhchemParser.go(str, stateMachine));\r\n    return tex;\r\n  };\r\n\r\n  //\r\n  // Core parser for mhchem syntax  (recursive)\r\n  //\r\n  /** @type {MhchemParser} */\r\n  var mhchemParser = {\r\n    //\r\n    // Parses mchem \\ce syntax\r\n    //\r\n    // Call like\r\n    //   go(\"H2O\");\r\n    //\r\n    go: function (input, stateMachine) {\r\n      if (!input) { return []; }\r\n      if (stateMachine === undefined) { stateMachine = 'ce'; }\r\n      var state = '0';\r\n\r\n      //\r\n      // String buffers for parsing:\r\n      //\r\n      // buffer.a == amount\r\n      // buffer.o == element\r\n      // buffer.b == left-side superscript\r\n      // buffer.p == left-side subscript\r\n      // buffer.q == right-side subscript\r\n      // buffer.d == right-side superscript\r\n      //\r\n      // buffer.r == arrow\r\n      // buffer.rdt == arrow, script above, type\r\n      // buffer.rd == arrow, script above, content\r\n      // buffer.rqt == arrow, script below, type\r\n      // buffer.rq == arrow, script below, content\r\n      //\r\n      // buffer.text_\r\n      // buffer.rm\r\n      // etc.\r\n      //\r\n      // buffer.parenthesisLevel == int, starting at 0\r\n      // buffer.sb == bool, space before\r\n      // buffer.beginsWithBond == bool\r\n      //\r\n      // These letters are also used as state names.\r\n      //\r\n      // Other states:\r\n      // 0 == begin of main part (arrow/operator unlikely)\r\n      // 1 == next entity\r\n      // 2 == next entity (arrow/operator unlikely)\r\n      // 3 == next atom\r\n      // c == macro\r\n      //\r\n      /** @type {Buffer} */\r\n      var buffer = {};\r\n      buffer['parenthesisLevel'] = 0;\r\n\r\n      input = input.replace(/\\n/g, \" \");\r\n      input = input.replace(/[\\u2212\\u2013\\u2014\\u2010]/g, \"-\");\r\n      input = input.replace(/[\\u2026]/g, \"...\");\r\n\r\n      //\r\n      // Looks through mhchemParser.transitions, to execute a matching action\r\n      // (recursive)\r\n      //\r\n      var lastInput;\r\n      var watchdog = 10;\r\n      /** @type {ParserOutput[]} */\r\n      var output = [];\r\n      while (true) {\r\n        if (lastInput !== input) {\r\n          watchdog = 10;\r\n          lastInput = input;\r\n        } else {\r\n          watchdog--;\r\n        }\r\n        //\r\n        // Find actions in transition table\r\n        //\r\n        var machine = mhchemParser.stateMachines[stateMachine];\r\n        var t = machine.transitions[state] || machine.transitions['*'];\r\n        iterateTransitions:\r\n        for (var i=0; i<t.length; i++) {\r\n          var matches = mhchemParser.patterns.match_(t[i].pattern, input);\r\n          if (matches) {\r\n            //\r\n            // Execute actions\r\n            //\r\n            var task = t[i].task;\r\n            for (var iA=0; iA<task.action_.length; iA++) {\r\n              var o;\r\n              //\r\n              // Find and execute action\r\n              //\r\n              if (machine.actions[task.action_[iA].type_]) {\r\n                o = machine.actions[task.action_[iA].type_](buffer, matches.match_, task.action_[iA].option);\r\n              } else if (mhchemParser.actions[task.action_[iA].type_]) {\r\n                o = mhchemParser.actions[task.action_[iA].type_](buffer, matches.match_, task.action_[iA].option);\r\n              } else {\r\n                throw [\"MhchemBugA\", \"mhchem bug A. Please report. (\" + task.action_[iA].type_ + \")\"];  // Trying to use non-existing action\r\n              }\r\n              //\r\n              // Add output\r\n              //\r\n              mhchemParser.concatArray(output, o);\r\n            }\r\n            //\r\n            // Set next state,\r\n            // Shorten input,\r\n            // Continue with next character\r\n            //   (= apply only one transition per position)\r\n            //\r\n            state = task.nextState || state;\r\n            if (input.length > 0) {\r\n              if (!task.revisit) {\r\n                input = matches.remainder;\r\n              }\r\n              if (!task.toContinue) {\r\n                break iterateTransitions;\r\n              }\r\n            } else {\r\n              return output;\r\n            }\r\n          }\r\n        }\r\n        //\r\n        // Prevent infinite loop\r\n        //\r\n        if (watchdog <= 0) {\r\n          throw [\"MhchemBugU\", \"mhchem bug U. Please report.\"];  // Unexpected character\r\n        }\r\n      }\r\n    },\r\n    concatArray: function (a, b) {\r\n      if (b) {\r\n        if (Array.isArray(b)) {\r\n          for (var iB=0; iB<b.length; iB++) {\r\n            a.push(b[iB]);\r\n          }\r\n        } else {\r\n          a.push(b);\r\n        }\r\n      }\r\n    },\r\n\r\n    patterns: {\r\n      //\r\n      // Matching patterns\r\n      // either regexps or function that return null or {match_:\"a\", remainder:\"bc\"}\r\n      //\r\n      patterns: {\r\n        // property names must not look like integers (\"2\") for correct property traversal order, later on\r\n        'empty': /^$/,\r\n        'else': /^./,\r\n        'else2': /^./,\r\n        'space': /^\\s/,\r\n        'space A': /^\\s(?=[A-Z\\\\$])/,\r\n        'space$': /^\\s$/,\r\n        'a-z': /^[a-z]/,\r\n        'x': /^x/,\r\n        'x$': /^x$/,\r\n        'i$': /^i$/,\r\n        'letters': /^(?:[a-zA-Z\\u03B1-\\u03C9\\u0391-\\u03A9?@]|(?:\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\\s+|\\{\\}|(?![a-zA-Z]))))+/,\r\n        '\\\\greek': /^\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\\s+|\\{\\}|(?![a-zA-Z]))/,\r\n        'one lowercase latin letter $': /^(?:([a-z])(?:$|[^a-zA-Z]))$/,\r\n        '$one lowercase latin letter$ $': /^\\$(?:([a-z])(?:$|[^a-zA-Z]))\\$$/,\r\n        'one lowercase greek letter $': /^(?:\\$?[\\u03B1-\\u03C9]\\$?|\\$?\\\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\\s*\\$?)(?:\\s+|\\{\\}|(?![a-zA-Z]))$/,\r\n        'digits': /^[0-9]+/,\r\n        '-9.,9': /^[+\\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))/,\r\n        '-9.,9 no missing 0': /^[+\\-]?[0-9]+(?:[.,][0-9]+)?/,\r\n        '(-)(9.,9)(e)(99)': function (input) {\r\n          var m = input.match(/^(\\+\\-|\\+\\/\\-|\\+|\\-|\\\\pm\\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))?(\\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+))\\))?(?:([eE]|\\s*(\\*|x|\\\\times|\\u00D7)\\s*10\\^)([+\\-]?[0-9]+|\\{[+\\-]?[0-9]+\\}))?/);\r\n          if (m && m[0]) {\r\n            return { match_: m.splice(1), remainder: input.substr(m[0].length) };\r\n          }\r\n          return null;\r\n        },\r\n        '(-)(9)^(-9)': function (input) {\r\n          var m = input.match(/^(\\+\\-|\\+\\/\\-|\\+|\\-|\\\\pm\\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\\.[0-9]+)?)\\^([+\\-]?[0-9]+|\\{[+\\-]?[0-9]+\\})/);\r\n          if (m && m[0]) {\r\n            return { match_: m.splice(1), remainder: input.substr(m[0].length) };\r\n          }\r\n          return null;\r\n        },\r\n        'state of aggregation $': function (input) {  // ... or crystal system\r\n          var a = mhchemParser.patterns.findObserveGroups(input, \"\", /^\\([a-z]{1,3}(?=[\\),])/, \")\", \"\");  // (aq), (aq,$\\infty$), (aq, sat)\r\n          if (a  &&  a.remainder.match(/^($|[\\s,;\\)\\]\\}])/)) { return a; }  //  AND end of 'phrase'\r\n          var m = input.match(/^(?:\\((?:\\\\ca\\s?)?\\$[amothc]\\$\\))/);  // OR crystal system ($o$) (\\ca$c$)\r\n          if (m) {\r\n            return { match_: m[0], remainder: input.substr(m[0].length) };\r\n          }\r\n          return null;\r\n        },\r\n        '_{(state of aggregation)}$': /^_\\{(\\([a-z]{1,3}\\))\\}/,\r\n        '{[(': /^(?:\\\\\\{|\\[|\\()/,\r\n        ')]}': /^(?:\\)|\\]|\\\\\\})/,\r\n        ', ': /^[,;]\\s*/,\r\n        ',': /^[,;]/,\r\n        '.': /^[.]/,\r\n        '. ': /^([.\\u22C5\\u00B7\\u2022])\\s*/,\r\n        '...': /^\\.\\.\\.(?=$|[^.])/,\r\n        '* ': /^([*])\\s*/,\r\n        '^{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"^{\", \"\", \"\", \"}\"); },\r\n        '^($...$)': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"^\", \"$\", \"$\", \"\"); },\r\n        '^a': /^\\^([0-9]+|[^\\\\_])/,\r\n        '^\\\\x{}{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"^\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\", \"\", \"{\", \"}\", \"\", true); },\r\n        '^\\\\x{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"^\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\"); },\r\n        '^\\\\x': /^\\^(\\\\[a-zA-Z]+)\\s*/,\r\n        '^(-1)': /^\\^(-?\\d+)/,\r\n        '\\'': /^'/,\r\n        '_{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"_{\", \"\", \"\", \"}\"); },\r\n        '_($...$)': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"_\", \"$\", \"$\", \"\"); },\r\n        '_9': /^_([+\\-]?[0-9]+|[^\\\\])/,\r\n        '_\\\\x{}{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"_\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\", \"\", \"{\", \"}\", \"\", true); },\r\n        '_\\\\x{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"_\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\"); },\r\n        '_\\\\x': /^_(\\\\[a-zA-Z]+)\\s*/,\r\n        '^_': /^(?:\\^(?=_)|\\_(?=\\^)|[\\^_]$)/,\r\n        '{}': /^\\{\\}/,\r\n        '{...}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\", \"{\", \"}\", \"\"); },\r\n        '{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"{\", \"\", \"\", \"}\"); },\r\n        '$...$': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\", \"$\", \"$\", \"\"); },\r\n        '${(...)}$': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"${\", \"\", \"\", \"}$\"); },\r\n        '$(...)$': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"$\", \"\", \"\", \"$\"); },\r\n        '=<>': /^[=<>]/,\r\n        '#': /^[#\\u2261]/,\r\n        '+': /^\\+/,\r\n        '-$': /^-(?=[\\s_},;\\]/]|$|\\([a-z]+\\))/,  // -space -, -; -] -/ -$ -state-of-aggregation\r\n        '-9': /^-(?=[0-9])/,\r\n        '- orbital overlap': /^-(?=(?:[spd]|sp)(?:$|[\\s,;\\)\\]\\}]))/,\r\n        '-': /^-/,\r\n        'pm-operator': /^(?:\\\\pm|\\$\\\\pm\\$|\\+-|\\+\\/-)/,\r\n        'operator': /^(?:\\+|(?:[\\-=<>]|<<|>>|\\\\approx|\\$\\\\approx\\$)(?=\\s|$|-?[0-9]))/,\r\n        'arrowUpDown': /^(?:v|\\(v\\)|\\^|\\(\\^\\))(?=$|[\\s,;\\)\\]\\}])/,\r\n        '\\\\bond{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\bond{\", \"\", \"\", \"}\"); },\r\n        '->': /^(?:<->|<--\x3e|->|<-|<=>>|<<=>|<=>|[\\u2192\\u27F6\\u21CC])/,\r\n        'CMT': /^[CMT](?=\\[)/,\r\n        '[(...)]': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"[\", \"\", \"\", \"]\"); },\r\n        '1st-level escape': /^(&|\\\\\\\\|\\\\hline)\\s*/,\r\n        '\\\\,': /^(?:\\\\[,\\ ;:])/,  // \\\\x - but output no space before\r\n        '\\\\x{}{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\", \"\", \"{\", \"}\", \"\", true); },\r\n        '\\\\x{}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\", /^\\\\[a-zA-Z]+\\{/, \"}\", \"\"); },\r\n        '\\\\ca': /^\\\\ca(?:\\s+|(?![a-zA-Z]))/,\r\n        '\\\\x': /^(?:\\\\[a-zA-Z]+\\s*|\\\\[_&{}%])/,\r\n        'orbital': /^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/,  // only those with numbers in front, because the others will be formatted correctly anyway\r\n        'others': /^[\\/~|]/,\r\n        '\\\\frac{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\frac{\", \"\", \"\", \"}\", \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\overset{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\overset{\", \"\", \"\", \"}\", \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\underset{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\underset{\", \"\", \"\", \"}\", \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\underbrace{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\underbrace{\", \"\", \"\", \"}_\", \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\color{(...)}0': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\color{\", \"\", \"\", \"}\"); },\r\n        '\\\\color{(...)}{(...)}1': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\color{\", \"\", \"\", \"}\", \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\color(...){(...)}2': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\color\", \"\\\\\", \"\", /^(?=\\{)/, \"{\", \"\", \"\", \"}\"); },\r\n        '\\\\ce{(...)}': function (input) { return mhchemParser.patterns.findObserveGroups(input, \"\\\\ce{\", \"\", \"\", \"}\"); },\r\n        'oxidation$': /^(?:[+-][IVX]+|\\\\pm\\s*0|\\$\\\\pm\\$\\s*0)$/,\r\n        'd-oxidation$': /^(?:[+-]?\\s?[IVX]+|\\\\pm\\s*0|\\$\\\\pm\\$\\s*0)$/,  // 0 could be oxidation or charge\r\n        'roman numeral': /^[IVX]+/,\r\n        '1/2$': /^[+\\-]?(?:[0-9]+|\\$[a-z]\\$|[a-z])\\/[0-9]+(?:\\$[a-z]\\$|[a-z])?$/,\r\n        'amount': function (input) {\r\n          var match;\r\n          // e.g. 2, 0.5, 1/2, -2, n/2, +;  $a$ could be added later in parsing\r\n          match = input.match(/^(?:(?:(?:\\([+\\-]?[0-9]+\\/[0-9]+\\)|[+\\-]?(?:[0-9]+|\\$[a-z]\\$|[a-z])\\/[0-9]+|[+\\-]?[0-9]+[.,][0-9]+|[+\\-]?\\.[0-9]+|[+\\-]?[0-9]+)(?:[a-z](?=\\s*[A-Z]))?)|[+\\-]?[a-z](?=\\s*[A-Z])|\\+(?!\\s))/);\r\n          if (match) {\r\n            return { match_: match[0], remainder: input.substr(match[0].length) };\r\n          }\r\n          var a = mhchemParser.patterns.findObserveGroups(input, \"\", \"$\", \"$\", \"\");\r\n          if (a) {  // e.g. $2n-1$, $-$\r\n            match = a.match_.match(/^\\$(?:\\(?[+\\-]?(?:[0-9]*[a-z]?[+\\-])?[0-9]*[a-z](?:[+\\-][0-9]*[a-z]?)?\\)?|\\+|-)\\$$/);\r\n            if (match) {\r\n              return { match_: match[0], remainder: input.substr(match[0].length) };\r\n            }\r\n          }\r\n          return null;\r\n        },\r\n        'amount2': function (input) { return this['amount'](input); },\r\n        '(KV letters),': /^(?:[A-Z][a-z]{0,2}|i)(?=,)/,\r\n        'formula$': function (input) {\r\n          if (input.match(/^\\([a-z]+\\)$/)) { return null; }  // state of aggregation = no formula\r\n          var match = input.match(/^(?:[a-z]|(?:[0-9\\ \\+\\-\\,\\.\\(\\)]+[a-z])+[0-9\\ \\+\\-\\,\\.\\(\\)]*|(?:[a-z][0-9\\ \\+\\-\\,\\.\\(\\)]+)+[a-z]?)$/);\r\n          if (match) {\r\n            return { match_: match[0], remainder: input.substr(match[0].length) };\r\n          }\r\n          return null;\r\n        },\r\n        'uprightEntities': /^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,\r\n        '/': /^\\s*(\\/)\\s*/,\r\n        '//': /^\\s*(\\/\\/)\\s*/,\r\n        '*': /^\\s*[*.]\\s*/\r\n      },\r\n      findObserveGroups: function (input, begExcl, begIncl, endIncl, endExcl, beg2Excl, beg2Incl, end2Incl, end2Excl, combine) {\r\n        /** @type {{(input: string, pattern: string | RegExp): string | string[] | null;}} */\r\n        var _match = function (input, pattern) {\r\n          if (typeof pattern === \"string\") {\r\n            if (input.indexOf(pattern) !== 0) { return null; }\r\n            return pattern;\r\n          } else {\r\n            var match = input.match(pattern);\r\n            if (!match) { return null; }\r\n            return match[0];\r\n          }\r\n        };\r\n        /** @type {{(input: string, i: number, endChars: string | RegExp): {endMatchBegin: number, endMatchEnd: number} | null;}} */\r\n        var _findObserveGroups = function (input, i, endChars) {\r\n          var braces = 0;\r\n          while (i < input.length) {\r\n            var a = input.charAt(i);\r\n            var match = _match(input.substr(i), endChars);\r\n            if (match !== null  &&  braces === 0) {\r\n              return { endMatchBegin: i, endMatchEnd: i + match.length };\r\n            } else if (a === \"{\") {\r\n              braces++;\r\n            } else if (a === \"}\") {\r\n              if (braces === 0) {\r\n                throw [\"ExtraCloseMissingOpen\", \"Extra close brace or missing open brace\"];\r\n              } else {\r\n                braces--;\r\n              }\r\n            }\r\n            i++;\r\n          }\r\n          if (braces > 0) {\r\n            return null;\r\n          }\r\n          return null;\r\n        };\r\n        var match = _match(input, begExcl);\r\n        if (match === null) { return null; }\r\n        input = input.substr(match.length);\r\n        match = _match(input, begIncl);\r\n        if (match === null) { return null; }\r\n        var e = _findObserveGroups(input, match.length, endIncl || endExcl);\r\n        if (e === null) { return null; }\r\n        var match1 = input.substring(0, (endIncl ? e.endMatchEnd : e.endMatchBegin));\r\n        if (!(beg2Excl || beg2Incl)) {\r\n          return {\r\n            match_: match1,\r\n            remainder: input.substr(e.endMatchEnd)\r\n          };\r\n        } else {\r\n          var group2 = this.findObserveGroups(input.substr(e.endMatchEnd), beg2Excl, beg2Incl, end2Incl, end2Excl);\r\n          if (group2 === null) { return null; }\r\n          /** @type {string[]} */\r\n          var matchRet = [match1, group2.match_];\r\n          return {\r\n            match_: (combine ? matchRet.join(\"\") : matchRet),\r\n            remainder: group2.remainder\r\n          };\r\n        }\r\n      },\r\n\r\n      //\r\n      // Matching function\r\n      // e.g. match(\"a\", input) will look for the regexp called \"a\" and see if it matches\r\n      // returns null or {match_:\"a\", remainder:\"bc\"}\r\n      //\r\n      match_: function (m, input) {\r\n        var pattern = mhchemParser.patterns.patterns[m];\r\n        if (pattern === undefined) {\r\n          throw [\"MhchemBugP\", \"mhchem bug P. Please report. (\" + m + \")\"];  // Trying to use non-existing pattern\r\n        } else if (typeof pattern === \"function\") {\r\n          return mhchemParser.patterns.patterns[m](input);  // cannot use cached var pattern here, because some pattern functions need this===mhchemParser\r\n        } else {  // RegExp\r\n          var match = input.match(pattern);\r\n          if (match) {\r\n            var mm;\r\n            if (match[2]) {\r\n              mm = [ match[1], match[2] ];\r\n            } else if (match[1]) {\r\n              mm = match[1];\r\n            } else {\r\n              mm = match[0];\r\n            }\r\n            return { match_: mm, remainder: input.substr(match[0].length) };\r\n          }\r\n          return null;\r\n        }\r\n      }\r\n    },\r\n\r\n    //\r\n    // Generic state machine actions\r\n    //\r\n    actions: {\r\n      'a=': function (buffer, m) { buffer.a = (buffer.a || \"\") + m; },\r\n      'b=': function (buffer, m) { buffer.b = (buffer.b || \"\") + m; },\r\n      'p=': function (buffer, m) { buffer.p = (buffer.p || \"\") + m; },\r\n      'o=': function (buffer, m) { buffer.o = (buffer.o || \"\") + m; },\r\n      'q=': function (buffer, m) { buffer.q = (buffer.q || \"\") + m; },\r\n      'd=': function (buffer, m) { buffer.d = (buffer.d || \"\") + m; },\r\n      'rm=': function (buffer, m) { buffer.rm = (buffer.rm || \"\") + m; },\r\n      'text=': function (buffer, m) { buffer.text_ = (buffer.text_ || \"\") + m; },\r\n      'insert': function (buffer, m, a) { return { type_: a }; },\r\n      'insert+p1': function (buffer, m, a) { return { type_: a, p1: m }; },\r\n      'insert+p1+p2': function (buffer, m, a) { return { type_: a, p1: m[0], p2: m[1] }; },\r\n      'copy': function (buffer, m) { return m; },\r\n      'rm': function (buffer, m) { return { type_: 'rm', p1: m || \"\"}; },\r\n      'text': function (buffer, m) { return mhchemParser.go(m, 'text'); },\r\n      '{text}': function (buffer, m) {\r\n        var ret = [ \"{\" ];\r\n        mhchemParser.concatArray(ret, mhchemParser.go(m, 'text'));\r\n        ret.push(\"}\");\r\n        return ret;\r\n      },\r\n      'tex-math': function (buffer, m) { return mhchemParser.go(m, 'tex-math'); },\r\n      'tex-math tight': function (buffer, m) { return mhchemParser.go(m, 'tex-math tight'); },\r\n      'bond': function (buffer, m, k) { return { type_: 'bond', kind_: k || m }; },\r\n      'color0-output': function (buffer, m) { return { type_: 'color0', color: m[0] }; },\r\n      'ce': function (buffer, m) { return mhchemParser.go(m); },\r\n      '1/2': function (buffer, m) {\r\n        /** @type {ParserOutput[]} */\r\n        var ret = [];\r\n        if (m.match(/^[+\\-]/)) {\r\n          ret.push(m.substr(0, 1));\r\n          m = m.substr(1);\r\n        }\r\n        var n = m.match(/^([0-9]+|\\$[a-z]\\$|[a-z])\\/([0-9]+)(\\$[a-z]\\$|[a-z])?$/);\r\n        n[1] = n[1].replace(/\\$/g, \"\");\r\n        ret.push({ type_: 'frac', p1: n[1], p2: n[2] });\r\n        if (n[3]) {\r\n          n[3] = n[3].replace(/\\$/g, \"\");\r\n          ret.push({ type_: 'tex-math', p1: n[3] });\r\n        }\r\n        return ret;\r\n      },\r\n      '9,9': function (buffer, m) { return mhchemParser.go(m, '9,9'); }\r\n    },\r\n    //\r\n    // createTransitions\r\n    // convert  { 'letter': { 'state': { action_: 'output' } } }  to  { 'state' => [ { pattern: 'letter', task: { action_: [{type_: 'output'}] } } ] }\r\n    // with expansion of 'a|b' to 'a' and 'b' (at 2 places)\r\n    //\r\n    createTransitions: function (o) {\r\n      var pattern, state;\r\n      /** @type {string[]} */\r\n      var stateArray;\r\n      var i;\r\n      //\r\n      // 1. Collect all states\r\n      //\r\n      /** @type {Transitions} */\r\n      var transitions = {};\r\n      for (pattern in o) {\r\n        for (state in o[pattern]) {\r\n          stateArray = state.split(\"|\");\r\n          o[pattern][state].stateArray = stateArray;\r\n          for (i=0; i<stateArray.length; i++) {\r\n            transitions[stateArray[i]] = [];\r\n          }\r\n        }\r\n      }\r\n      //\r\n      // 2. Fill states\r\n      //\r\n      for (pattern in o) {\r\n        for (state in o[pattern]) {\r\n          stateArray = o[pattern][state].stateArray || [];\r\n          for (i=0; i<stateArray.length; i++) {\r\n            //\r\n            // 2a. Normalize actions into array:  'text=' ==> [{type_:'text='}]\r\n            // (Note to myself: Resolving the function here would be problematic. It would need .bind (for *this*) and currying (for *option*).)\r\n            //\r\n            /** @type {any} */\r\n            var p = o[pattern][state];\r\n            if (p.action_) {\r\n              p.action_ = [].concat(p.action_);\r\n              for (var k=0; k<p.action_.length; k++) {\r\n                if (typeof p.action_[k] === \"string\") {\r\n                  p.action_[k] = { type_: p.action_[k] };\r\n                }\r\n              }\r\n            } else {\r\n              p.action_ = [];\r\n            }\r\n            //\r\n            // 2.b Multi-insert\r\n            //\r\n            var patternArray = pattern.split(\"|\");\r\n            for (var j=0; j<patternArray.length; j++) {\r\n              if (stateArray[i] === '*') {  // insert into all\r\n                for (var t in transitions) {\r\n                  transitions[t].push({ pattern: patternArray[j], task: p });\r\n                }\r\n              } else {\r\n                transitions[stateArray[i]].push({ pattern: patternArray[j], task: p });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return transitions;\r\n    },\r\n    stateMachines: {}\r\n  };\r\n\r\n  //\r\n  // Definition of state machines\r\n  //\r\n  mhchemParser.stateMachines = {\r\n    //\r\n    // \\ce state machines\r\n    //\r\n    //#region ce\r\n    'ce': {  // main parser\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        'else':  {\r\n          '0|1|2': { action_: 'beginsWithBond=false', revisit: true, toContinue: true } },\r\n        'oxidation$': {\r\n          '0': { action_: 'oxidation-output' } },\r\n        'CMT': {\r\n          'r': { action_: 'rdt=', nextState: 'rt' },\r\n          'rd': { action_: 'rqt=', nextState: 'rdt' } },\r\n        'arrowUpDown': {\r\n          '0|1|2|as': { action_: [ 'sb=false', 'output', 'operator' ], nextState: '1' } },\r\n        'uprightEntities': {\r\n          '0|1|2': { action_: [ 'o=', 'output' ], nextState: '1' } },\r\n        'orbital': {\r\n          '0|1|2|3': { action_: 'o=', nextState: 'o' } },\r\n        '->': {\r\n          '0|1|2|3': { action_: 'r=', nextState: 'r' },\r\n          'a|as': { action_: [ 'output', 'r=' ], nextState: 'r' },\r\n          '*': { action_: [ 'output', 'r=' ], nextState: 'r' } },\r\n        '+': {\r\n          'o': { action_: 'd= kv',  nextState: 'd' },\r\n          'd|D': { action_: 'd=', nextState: 'd' },\r\n          'q': { action_: 'd=',  nextState: 'qd' },\r\n          'qd|qD': { action_: 'd=', nextState: 'qd' },\r\n          'dq': { action_: [ 'output', 'd=' ], nextState: 'd' },\r\n          '3': { action_: [ 'sb=false', 'output', 'operator' ], nextState: '0' } },\r\n        'amount': {\r\n          '0|2': { action_: 'a=', nextState: 'a' } },\r\n        'pm-operator': {\r\n          '0|1|2|a|as': { action_: [ 'sb=false', 'output', { type_: 'operator', option: '\\\\pm' } ], nextState: '0' } },\r\n        'operator': {\r\n          '0|1|2|a|as': { action_: [ 'sb=false', 'output', 'operator' ], nextState: '0' } },\r\n        '-$': {\r\n          'o|q': { action_: [ 'charge or bond', 'output' ],  nextState: 'qd' },\r\n          'd': { action_: 'd=', nextState: 'd' },\r\n          'D': { action_: [ 'output', { type_: 'bond', option: \"-\" } ], nextState: '3' },\r\n          'q': { action_: 'd=',  nextState: 'qd' },\r\n          'qd': { action_: 'd=', nextState: 'qd' },\r\n          'qD|dq': { action_: [ 'output', { type_: 'bond', option: \"-\" } ], nextState: '3' } },\r\n        '-9': {\r\n          '3|o': { action_: [ 'output', { type_: 'insert', option: 'hyphen' } ], nextState: '3' } },\r\n        '- orbital overlap': {\r\n          'o': { action_: [ 'output', { type_: 'insert', option: 'hyphen' } ], nextState: '2' },\r\n          'd': { action_: [ 'output', { type_: 'insert', option: 'hyphen' } ], nextState: '2' } },\r\n        '-': {\r\n          '0|1|2': { action_: [ { type_: 'output', option: 1 }, 'beginsWithBond=true', { type_: 'bond', option: \"-\" } ], nextState: '3' },\r\n          '3': { action_: { type_: 'bond', option: \"-\" } },\r\n          'a': { action_: [ 'output', { type_: 'insert', option: 'hyphen' } ], nextState: '2' },\r\n          'as': { action_: [ { type_: 'output', option: 2 }, { type_: 'bond', option: \"-\" } ], nextState: '3' },\r\n          'b': { action_: 'b=' },\r\n          'o': { action_: { type_: '- after o/d', option: false }, nextState: '2' },\r\n          'q': { action_: { type_: '- after o/d', option: false }, nextState: '2' },\r\n          'd|qd|dq': { action_: { type_: '- after o/d', option: true }, nextState: '2' },\r\n          'D|qD|p': { action_: [ 'output', { type_: 'bond', option: \"-\" } ], nextState: '3' } },\r\n        'amount2': {\r\n          '1|3': { action_: 'a=', nextState: 'a' } },\r\n        'letters': {\r\n          '0|1|2|3|a|as|b|p|bp|o': { action_: 'o=', nextState: 'o' },\r\n          'q|dq': { action_: ['output', 'o='], nextState: 'o' },\r\n          'd|D|qd|qD': { action_: 'o after d', nextState: 'o' } },\r\n        'digits': {\r\n          'o': { action_: 'q=', nextState: 'q' },\r\n          'd|D': { action_: 'q=', nextState: 'dq' },\r\n          'q': { action_: [ 'output', 'o=' ], nextState: 'o' },\r\n          'a': { action_: 'o=', nextState: 'o' } },\r\n        'space A': {\r\n          'b|p|bp': {} },\r\n        'space': {\r\n          'a': { nextState: 'as' },\r\n          '0': { action_: 'sb=false' },\r\n          '1|2': { action_: 'sb=true' },\r\n          'r|rt|rd|rdt|rdq': { action_: 'output', nextState: '0' },\r\n          '*': { action_: [ 'output', 'sb=true' ], nextState: '1'} },\r\n        '1st-level escape': {\r\n          '1|2': { action_: [ 'output', { type_: 'insert+p1', option: '1st-level escape' } ] },\r\n          '*': { action_: [ 'output', { type_: 'insert+p1', option: '1st-level escape' } ], nextState: '0' } },\r\n        '[(...)]': {\r\n          'r|rt': { action_: 'rd=', nextState: 'rd' },\r\n          'rd|rdt': { action_: 'rq=', nextState: 'rdq' } },\r\n        '...': {\r\n          'o|d|D|dq|qd|qD': { action_: [ 'output', { type_: 'bond', option: \"...\" } ], nextState: '3' },\r\n          '*': { action_: [ { type_: 'output', option: 1 }, { type_: 'insert', option: 'ellipsis' } ], nextState: '1' } },\r\n        '. |* ': {\r\n          '*': { action_: [ 'output', { type_: 'insert', option: 'addition compound' } ], nextState: '1' } },\r\n        'state of aggregation $': {\r\n          '*': { action_: [ 'output', 'state of aggregation' ], nextState: '1' } },\r\n        '{[(': {\r\n          'a|as|o': { action_: [ 'o=', 'output', 'parenthesisLevel++' ], nextState: '2' },\r\n          '0|1|2|3': { action_: [ 'o=', 'output', 'parenthesisLevel++' ], nextState: '2' },\r\n          '*': { action_: [ 'output', 'o=', 'output', 'parenthesisLevel++' ], nextState: '2' } },\r\n        ')]}': {\r\n          '0|1|2|3|b|p|bp|o': { action_: [ 'o=', 'parenthesisLevel--' ], nextState: 'o' },\r\n          'a|as|d|D|q|qd|qD|dq': { action_: [ 'output', 'o=', 'parenthesisLevel--' ], nextState: 'o' } },\r\n        ', ': {\r\n          '*': { action_: [ 'output', 'comma' ], nextState: '0' } },\r\n        '^_': {  // ^ and _ without a sensible argument\r\n          '*': { } },\r\n        '^{(...)}|^($...$)': {\r\n          '0|1|2|as': { action_: 'b=', nextState: 'b' },\r\n          'p': { action_: 'b=', nextState: 'bp' },\r\n          '3|o': { action_: 'd= kv', nextState: 'D' },\r\n          'q': { action_: 'd=', nextState: 'qD' },\r\n          'd|D|qd|qD|dq': { action_: [ 'output', 'd=' ], nextState: 'D' } },\r\n        '^a|^\\\\x{}{}|^\\\\x{}|^\\\\x|\\'': {\r\n          '0|1|2|as': { action_: 'b=', nextState: 'b' },\r\n          'p': { action_: 'b=', nextState: 'bp' },\r\n          '3|o': { action_: 'd= kv', nextState: 'd' },\r\n          'q': { action_: 'd=', nextState: 'qd' },\r\n          'd|qd|D|qD': { action_: 'd=' },\r\n          'dq': { action_: [ 'output', 'd=' ], nextState: 'd' } },\r\n        '_{(state of aggregation)}$': {\r\n          'd|D|q|qd|qD|dq': { action_: [ 'output', 'q=' ], nextState: 'q' } },\r\n        '_{(...)}|_($...$)|_9|_\\\\x{}{}|_\\\\x{}|_\\\\x': {\r\n          '0|1|2|as': { action_: 'p=', nextState: 'p' },\r\n          'b': { action_: 'p=', nextState: 'bp' },\r\n          '3|o': { action_: 'q=', nextState: 'q' },\r\n          'd|D': { action_: 'q=', nextState: 'dq' },\r\n          'q|qd|qD|dq': { action_: [ 'output', 'q=' ], nextState: 'q' } },\r\n        '=<>': {\r\n          '0|1|2|3|a|as|o|q|d|D|qd|qD|dq': { action_: [ { type_: 'output', option: 2 }, 'bond' ], nextState: '3' } },\r\n        '#': {\r\n          '0|1|2|3|a|as|o': { action_: [ { type_: 'output', option: 2 }, { type_: 'bond', option: \"#\" } ], nextState: '3' } },\r\n        '{}': {\r\n          '*': { action_: { type_: 'output', option: 1 },  nextState: '1' } },\r\n        '{...}': {\r\n          '0|1|2|3|a|as|b|p|bp': { action_: 'o=', nextState: 'o' },\r\n          'o|d|D|q|qd|qD|dq': { action_: [ 'output', 'o=' ], nextState: 'o' } },\r\n        '$...$': {\r\n          'a': { action_: 'a=' },  // 2$n$\r\n          '0|1|2|3|as|b|p|bp|o': { action_: 'o=', nextState: 'o' },  // not 'amount'\r\n          'as|o': { action_: 'o=' },\r\n          'q|d|D|qd|qD|dq': { action_: [ 'output', 'o=' ], nextState: 'o' } },\r\n        '\\\\bond{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'bond' ], nextState: \"3\" } },\r\n        '\\\\frac{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 1 }, 'frac-output' ], nextState: '3' } },\r\n        '\\\\overset{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'overset-output' ], nextState: '3' } },\r\n        '\\\\underset{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'underset-output' ], nextState: '3' } },\r\n        '\\\\underbrace{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'underbrace-output' ], nextState: '3' } },\r\n        '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'color-output' ], nextState: '3' } },\r\n        '\\\\color{(...)}0': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'color0-output' ] } },\r\n        '\\\\ce{(...)}': {\r\n          '*': { action_: [ { type_: 'output', option: 2 }, 'ce' ], nextState: '3' } },\r\n        '\\\\,': {\r\n          '*': { action_: [ { type_: 'output', option: 1 }, 'copy' ], nextState: '1' } },\r\n        '\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '0|1|2|3|a|as|b|p|bp|o|c0': { action_: [ 'o=', 'output' ], nextState: '3' },\r\n          '*': { action_: ['output', 'o=', 'output' ], nextState: '3' } },\r\n        'others': {\r\n          '*': { action_: [ { type_: 'output', option: 1 }, 'copy' ], nextState: '3' } },\r\n        'else2': {\r\n          'a': { action_: 'a to o', nextState: 'o', revisit: true },\r\n          'as': { action_: [ 'output', 'sb=true' ], nextState: '1', revisit: true },\r\n          'r|rt|rd|rdt|rdq': { action_: [ 'output' ], nextState: '0', revisit: true },\r\n          '*': { action_: [ 'output', 'copy' ], nextState: '3' } }\r\n      }),\r\n      actions: {\r\n        'o after d': function (buffer, m) {\r\n          var ret;\r\n          if ((buffer.d || \"\").match(/^[0-9]+$/)) {\r\n            var tmp = buffer.d;\r\n            buffer.d = undefined;\r\n            ret = this['output'](buffer);\r\n            buffer.b = tmp;\r\n          } else {\r\n            ret = this['output'](buffer);\r\n          }\r\n          mhchemParser.actions['o='](buffer, m);\r\n          return ret;\r\n        },\r\n        'd= kv': function (buffer, m) {\r\n          buffer.d = m;\r\n          buffer.dType = 'kv';\r\n        },\r\n        'charge or bond': function (buffer, m) {\r\n          if (buffer['beginsWithBond']) {\r\n            /** @type {ParserOutput[]} */\r\n            var ret = [];\r\n            mhchemParser.concatArray(ret, this['output'](buffer));\r\n            mhchemParser.concatArray(ret, mhchemParser.actions['bond'](buffer, m, \"-\"));\r\n            return ret;\r\n          } else {\r\n            buffer.d = m;\r\n          }\r\n        },\r\n        '- after o/d': function (buffer, m, isAfterD) {\r\n          var c1 = mhchemParser.patterns.match_('orbital', buffer.o || \"\");\r\n          var c2 = mhchemParser.patterns.match_('one lowercase greek letter $', buffer.o || \"\");\r\n          var c3 = mhchemParser.patterns.match_('one lowercase latin letter $', buffer.o || \"\");\r\n          var c4 = mhchemParser.patterns.match_('$one lowercase latin letter$ $', buffer.o || \"\");\r\n          var hyphenFollows =  m===\"-\" && ( c1 && c1.remainder===\"\"  ||  c2  ||  c3  ||  c4 );\r\n          if (hyphenFollows && !buffer.a && !buffer.b && !buffer.p && !buffer.d && !buffer.q && !c1 && c3) {\r\n            buffer.o = '$' + buffer.o + '$';\r\n          }\r\n          /** @type {ParserOutput[]} */\r\n          var ret = [];\r\n          if (hyphenFollows) {\r\n            mhchemParser.concatArray(ret, this['output'](buffer));\r\n            ret.push({ type_: 'hyphen' });\r\n          } else {\r\n            c1 = mhchemParser.patterns.match_('digits', buffer.d || \"\");\r\n            if (isAfterD && c1 && c1.remainder==='') {\r\n              mhchemParser.concatArray(ret, mhchemParser.actions['d='](buffer, m));\r\n              mhchemParser.concatArray(ret, this['output'](buffer));\r\n            } else {\r\n              mhchemParser.concatArray(ret, this['output'](buffer));\r\n              mhchemParser.concatArray(ret, mhchemParser.actions['bond'](buffer, m, \"-\"));\r\n            }\r\n          }\r\n          return ret;\r\n        },\r\n        'a to o': function (buffer) {\r\n          buffer.o = buffer.a;\r\n          buffer.a = undefined;\r\n        },\r\n        'sb=true': function (buffer) { buffer.sb = true; },\r\n        'sb=false': function (buffer) { buffer.sb = false; },\r\n        'beginsWithBond=true': function (buffer) { buffer['beginsWithBond'] = true; },\r\n        'beginsWithBond=false': function (buffer) { buffer['beginsWithBond'] = false; },\r\n        'parenthesisLevel++': function (buffer) { buffer['parenthesisLevel']++; },\r\n        'parenthesisLevel--': function (buffer) { buffer['parenthesisLevel']--; },\r\n        'state of aggregation': function (buffer, m) {\r\n          return { type_: 'state of aggregation', p1: mhchemParser.go(m, 'o') };\r\n        },\r\n        'comma': function (buffer, m) {\r\n          var a = m.replace(/\\s*$/, '');\r\n          var withSpace = (a !== m);\r\n          if (withSpace  &&  buffer['parenthesisLevel'] === 0) {\r\n            return { type_: 'comma enumeration L', p1: a };\r\n          } else {\r\n            return { type_: 'comma enumeration M', p1: a };\r\n          }\r\n        },\r\n        'output': function (buffer, m, entityFollows) {\r\n          // entityFollows:\r\n          //   undefined = if we have nothing else to output, also ignore the just read space (buffer.sb)\r\n          //   1 = an entity follows, never omit the space if there was one just read before (can only apply to state 1)\r\n          //   2 = 1 + the entity can have an amount, so output a\\, instead of converting it to o (can only apply to states a|as)\r\n          /** @type {ParserOutput | ParserOutput[]} */\r\n          var ret;\r\n          if (!buffer.r) {\r\n            ret = [];\r\n            if (!buffer.a && !buffer.b && !buffer.p && !buffer.o && !buffer.q && !buffer.d && !entityFollows) {\r\n              //ret = [];\r\n            } else {\r\n              if (buffer.sb) {\r\n                ret.push({ type_: 'entitySkip' });\r\n              }\r\n              if (!buffer.o && !buffer.q && !buffer.d && !buffer.b && !buffer.p && entityFollows!==2) {\r\n                buffer.o = buffer.a;\r\n                buffer.a = undefined;\r\n              } else if (!buffer.o && !buffer.q && !buffer.d && (buffer.b || buffer.p)) {\r\n                buffer.o = buffer.a;\r\n                buffer.d = buffer.b;\r\n                buffer.q = buffer.p;\r\n                buffer.a = buffer.b = buffer.p = undefined;\r\n              } else {\r\n                if (buffer.o && buffer.dType==='kv' && mhchemParser.patterns.match_('d-oxidation$', buffer.d || \"\")) {\r\n                  buffer.dType = 'oxidation';\r\n                } else if (buffer.o && buffer.dType==='kv' && !buffer.q) {\r\n                  buffer.dType = undefined;\r\n                }\r\n              }\r\n              ret.push({\r\n                type_: 'chemfive',\r\n                a: mhchemParser.go(buffer.a, 'a'),\r\n                b: mhchemParser.go(buffer.b, 'bd'),\r\n                p: mhchemParser.go(buffer.p, 'pq'),\r\n                o: mhchemParser.go(buffer.o, 'o'),\r\n                q: mhchemParser.go(buffer.q, 'pq'),\r\n                d: mhchemParser.go(buffer.d, (buffer.dType === 'oxidation' ? 'oxidation' : 'bd')),\r\n                dType: buffer.dType\r\n              });\r\n            }\r\n          } else {  // r\r\n            /** @type {ParserOutput[]} */\r\n            var rd;\r\n            if (buffer.rdt === 'M') {\r\n              rd = mhchemParser.go(buffer.rd, 'tex-math');\r\n            } else if (buffer.rdt === 'T') {\r\n              rd = [ { type_: 'text', p1: buffer.rd || \"\" } ];\r\n            } else {\r\n              rd = mhchemParser.go(buffer.rd);\r\n            }\r\n            /** @type {ParserOutput[]} */\r\n            var rq;\r\n            if (buffer.rqt === 'M') {\r\n              rq = mhchemParser.go(buffer.rq, 'tex-math');\r\n            } else if (buffer.rqt === 'T') {\r\n              rq = [ { type_: 'text', p1: buffer.rq || \"\"} ];\r\n            } else {\r\n              rq = mhchemParser.go(buffer.rq);\r\n            }\r\n            ret = {\r\n              type_: 'arrow',\r\n              r: buffer.r,\r\n              rd: rd,\r\n              rq: rq\r\n            };\r\n          }\r\n          for (var p in buffer) {\r\n            if (p !== 'parenthesisLevel'  &&  p !== 'beginsWithBond') {\r\n              delete buffer[p];\r\n            }\r\n          }\r\n          return ret;\r\n        },\r\n        'oxidation-output': function (buffer, m) {\r\n          var ret = [ \"{\" ];\r\n          mhchemParser.concatArray(ret, mhchemParser.go(m, 'oxidation'));\r\n          ret.push(\"}\");\r\n          return ret;\r\n        },\r\n        'frac-output': function (buffer, m) {\r\n          return { type_: 'frac-ce', p1: mhchemParser.go(m[0]), p2: mhchemParser.go(m[1]) };\r\n        },\r\n        'overset-output': function (buffer, m) {\r\n          return { type_: 'overset', p1: mhchemParser.go(m[0]), p2: mhchemParser.go(m[1]) };\r\n        },\r\n        'underset-output': function (buffer, m) {\r\n          return { type_: 'underset', p1: mhchemParser.go(m[0]), p2: mhchemParser.go(m[1]) };\r\n        },\r\n        'underbrace-output': function (buffer, m) {\r\n          return { type_: 'underbrace', p1: mhchemParser.go(m[0]), p2: mhchemParser.go(m[1]) };\r\n        },\r\n        'color-output': function (buffer, m) {\r\n          return { type_: 'color', color1: m[0], color2: mhchemParser.go(m[1]) };\r\n        },\r\n        'r=': function (buffer, m) { buffer.r = m; },\r\n        'rdt=': function (buffer, m) { buffer.rdt = m; },\r\n        'rd=': function (buffer, m) { buffer.rd = m; },\r\n        'rqt=': function (buffer, m) { buffer.rqt = m; },\r\n        'rq=': function (buffer, m) { buffer.rq = m; },\r\n        'operator': function (buffer, m, p1) { return { type_: 'operator', kind_: (p1 || m) }; }\r\n      }\r\n    },\r\n    'a': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        '1/2$': {\r\n          '0': { action_: '1/2' } },\r\n        'else': {\r\n          '0': { nextState: '1', revisit: true } },\r\n        '$(...)$': {\r\n          '*': { action_: 'tex-math tight', nextState: '1' } },\r\n        ',': {\r\n          '*': { action_: { type_: 'insert', option: 'commaDecimal' } } },\r\n        'else2': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {}\r\n    },\r\n    'o': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        '1/2$': {\r\n          '0': { action_: '1/2' } },\r\n        'else': {\r\n          '0': { nextState: '1', revisit: true } },\r\n        'letters': {\r\n          '*': { action_: 'rm' } },\r\n        '\\\\ca': {\r\n          '*': { action_: { type_: 'insert', option: 'circa' } } },\r\n        '\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: 'copy' } },\r\n        '${(...)}$|$(...)$': {\r\n          '*': { action_: 'tex-math' } },\r\n        '{(...)}': {\r\n          '*': { action_: '{text}' } },\r\n        'else2': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {}\r\n    },\r\n    'text': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        '{...}': {\r\n          '*': { action_: 'text=' } },\r\n        '${(...)}$|$(...)$': {\r\n          '*': { action_: 'tex-math' } },\r\n        '\\\\greek': {\r\n          '*': { action_: [ 'output', 'rm' ] } },\r\n        '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: [ 'output', 'copy' ] } },\r\n        'else': {\r\n          '*': { action_: 'text=' } }\r\n      }),\r\n      actions: {\r\n        'output': function (buffer) {\r\n          if (buffer.text_) {\r\n            /** @type {ParserOutput} */\r\n            var ret = { type_: 'text', p1: buffer.text_ };\r\n            for (var p in buffer) { delete buffer[p]; }\r\n            return ret;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'pq': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        'state of aggregation $': {\r\n          '*': { action_: 'state of aggregation' } },\r\n        'i$': {\r\n          '0': { nextState: '!f', revisit: true } },\r\n        '(KV letters),': {\r\n          '0': { action_: 'rm', nextState: '0' } },\r\n        'formula$': {\r\n          '0': { nextState: 'f', revisit: true } },\r\n        '1/2$': {\r\n          '0': { action_: '1/2' } },\r\n        'else': {\r\n          '0': { nextState: '!f', revisit: true } },\r\n        '${(...)}$|$(...)$': {\r\n          '*': { action_: 'tex-math' } },\r\n        '{(...)}': {\r\n          '*': { action_: 'text' } },\r\n        'a-z': {\r\n          'f': { action_: 'tex-math' } },\r\n        'letters': {\r\n          '*': { action_: 'rm' } },\r\n        '-9.,9': {\r\n          '*': { action_: '9,9'  } },\r\n        ',': {\r\n          '*': { action_: { type_: 'insert+p1', option: 'comma enumeration S' } } },\r\n        '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n          '*': { action_: 'color-output' } },\r\n        '\\\\color{(...)}0': {\r\n          '*': { action_: 'color0-output' } },\r\n        '\\\\ce{(...)}': {\r\n          '*': { action_: 'ce' } },\r\n        '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: 'copy' } },\r\n        'else2': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {\r\n        'state of aggregation': function (buffer, m) {\r\n          return { type_: 'state of aggregation subscript', p1: mhchemParser.go(m, 'o') };\r\n        },\r\n        'color-output': function (buffer, m) {\r\n          return { type_: 'color', color1: m[0], color2: mhchemParser.go(m[1], 'pq') };\r\n        }\r\n      }\r\n    },\r\n    'bd': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        'x$': {\r\n          '0': { nextState: '!f', revisit: true } },\r\n        'formula$': {\r\n          '0': { nextState: 'f', revisit: true } },\r\n        'else': {\r\n          '0': { nextState: '!f', revisit: true } },\r\n        '-9.,9 no missing 0': {\r\n          '*': { action_: '9,9' } },\r\n        '.': {\r\n          '*': { action_: { type_: 'insert', option: 'electron dot' } } },\r\n        'a-z': {\r\n          'f': { action_: 'tex-math' } },\r\n        'x': {\r\n          '*': { action_: { type_: 'insert', option: 'KV x' } } },\r\n        'letters': {\r\n          '*': { action_: 'rm' } },\r\n        '\\'': {\r\n          '*': { action_: { type_: 'insert', option: 'prime' } } },\r\n        '${(...)}$|$(...)$': {\r\n          '*': { action_: 'tex-math' } },\r\n        '{(...)}': {\r\n          '*': { action_: 'text' } },\r\n        '\\\\color{(...)}{(...)}1|\\\\color(...){(...)}2': {\r\n          '*': { action_: 'color-output' } },\r\n        '\\\\color{(...)}0': {\r\n          '*': { action_: 'color0-output' } },\r\n        '\\\\ce{(...)}': {\r\n          '*': { action_: 'ce' } },\r\n        '\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: 'copy' } },\r\n        'else2': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {\r\n        'color-output': function (buffer, m) {\r\n          return { type_: 'color', color1: m[0], color2: mhchemParser.go(m[1], 'bd') };\r\n        }\r\n      }\r\n    },\r\n    'oxidation': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        'roman numeral': {\r\n          '*': { action_: 'roman-numeral' } },\r\n        '${(...)}$|$(...)$': {\r\n          '*': { action_: 'tex-math' } },\r\n        'else': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {\r\n        'roman-numeral': function (buffer, m) { return { type_: 'roman numeral', p1: m || \"\" }; }\r\n      }\r\n    },\r\n    'tex-math': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        '\\\\ce{(...)}': {\r\n          '*': { action_: [ 'output', 'ce' ] } },\r\n        '{...}|\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: 'o=' } },\r\n        'else': {\r\n          '*': { action_: 'o=' } }\r\n      }),\r\n      actions: {\r\n        'output': function (buffer) {\r\n          if (buffer.o) {\r\n            /** @type {ParserOutput} */\r\n            var ret = { type_: 'tex-math', p1: buffer.o };\r\n            for (var p in buffer) { delete buffer[p]; }\r\n            return ret;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'tex-math tight': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        '\\\\ce{(...)}': {\r\n          '*': { action_: [ 'output', 'ce' ] } },\r\n        '{...}|\\\\,|\\\\x{}{}|\\\\x{}|\\\\x': {\r\n          '*': { action_: 'o=' } },\r\n        '-|+': {\r\n          '*': { action_: 'tight operator' } },\r\n        'else': {\r\n          '*': { action_: 'o=' } }\r\n      }),\r\n      actions: {\r\n        'tight operator': function (buffer, m) { buffer.o = (buffer.o || \"\") + \"{\"+m+\"}\"; },\r\n        'output': function (buffer) {\r\n          if (buffer.o) {\r\n            /** @type {ParserOutput} */\r\n            var ret = { type_: 'tex-math', p1: buffer.o };\r\n            for (var p in buffer) { delete buffer[p]; }\r\n            return ret;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    '9,9': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': {} },\r\n        ',': {\r\n          '*': { action_: 'comma' } },\r\n        'else': {\r\n          '*': { action_: 'copy' } }\r\n      }),\r\n      actions: {\r\n        'comma': function () { return { type_: 'commaDecimal' }; }\r\n      }\r\n    },\r\n    //#endregion\r\n    //\r\n    // \\pu state machines\r\n    //\r\n    //#region pu\r\n    'pu': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        'space$': {\r\n          '*': { action_: [ 'output', 'space' ] } },\r\n        '{[(|)]}': {\r\n          '0|a': { action_: 'copy' } },\r\n        '(-)(9)^(-9)': {\r\n          '0': { action_: 'number^', nextState: 'a' } },\r\n        '(-)(9.,9)(e)(99)': {\r\n          '0': { action_: 'enumber', nextState: 'a' } },\r\n        'space': {\r\n          '0|a': {} },\r\n        'pm-operator': {\r\n          '0|a': { action_: { type_: 'operator', option: '\\\\pm' }, nextState: '0' } },\r\n        'operator': {\r\n          '0|a': { action_: 'copy', nextState: '0' } },\r\n        '//': {\r\n          'd': { action_: 'o=', nextState: '/' } },\r\n        '/': {\r\n          'd': { action_: 'o=', nextState: '/' } },\r\n        '{...}|else': {\r\n          '0|d': { action_: 'd=', nextState: 'd' },\r\n          'a': { action_: [ 'space', 'd=' ], nextState: 'd' },\r\n          '/|q': { action_: 'q=', nextState: 'q' } }\r\n      }),\r\n      actions: {\r\n        'enumber': function (buffer, m) {\r\n          /** @type {ParserOutput[]} */\r\n          var ret = [];\r\n          if (m[0] === \"+-\"  ||  m[0] === \"+/-\") {\r\n            ret.push(\"\\\\pm \");\r\n          } else if (m[0]) {\r\n            ret.push(m[0]);\r\n          }\r\n          if (m[1]) {\r\n            mhchemParser.concatArray(ret, mhchemParser.go(m[1], 'pu-9,9'));\r\n            if (m[2]) {\r\n              if (m[2].match(/[,.]/)) {\r\n                mhchemParser.concatArray(ret, mhchemParser.go(m[2], 'pu-9,9'));\r\n              } else {\r\n                ret.push(m[2]);\r\n              }\r\n            }\r\n            m[3] = m[4] || m[3];\r\n            if (m[3]) {\r\n              m[3] = m[3].trim();\r\n              if (m[3] === \"e\"  ||  m[3].substr(0, 1) === \"*\") {\r\n                ret.push({ type_: 'cdot' });\r\n              } else {\r\n                ret.push({ type_: 'times' });\r\n              }\r\n            }\r\n          }\r\n          if (m[3]) {\r\n            ret.push(\"10^{\"+m[5]+\"}\");\r\n          }\r\n          return ret;\r\n        },\r\n        'number^': function (buffer, m) {\r\n          /** @type {ParserOutput[]} */\r\n          var ret = [];\r\n          if (m[0] === \"+-\"  ||  m[0] === \"+/-\") {\r\n            ret.push(\"\\\\pm \");\r\n          } else if (m[0]) {\r\n            ret.push(m[0]);\r\n          }\r\n          mhchemParser.concatArray(ret, mhchemParser.go(m[1], 'pu-9,9'));\r\n          ret.push(\"^{\"+m[2]+\"}\");\r\n          return ret;\r\n        },\r\n        'operator': function (buffer, m, p1) { return { type_: 'operator', kind_: (p1 || m) }; },\r\n        'space': function () { return { type_: 'pu-space-1' }; },\r\n        'output': function (buffer) {\r\n          /** @type {ParserOutput | ParserOutput[]} */\r\n          var ret;\r\n          var md = mhchemParser.patterns.match_('{(...)}', buffer.d || \"\");\r\n          if (md  &&  md.remainder === '') { buffer.d = md.match_; }\r\n          var mq = mhchemParser.patterns.match_('{(...)}', buffer.q || \"\");\r\n          if (mq  &&  mq.remainder === '') { buffer.q = mq.match_; }\r\n          if (buffer.d) {\r\n            buffer.d = buffer.d.replace(/\\u00B0C|\\^oC|\\^{o}C/g, \"{}^{\\\\circ}C\");\r\n            buffer.d = buffer.d.replace(/\\u00B0F|\\^oF|\\^{o}F/g, \"{}^{\\\\circ}F\");\r\n          }\r\n          if (buffer.q) {  // fraction\r\n            buffer.q = buffer.q.replace(/\\u00B0C|\\^oC|\\^{o}C/g, \"{}^{\\\\circ}C\");\r\n            buffer.q = buffer.q.replace(/\\u00B0F|\\^oF|\\^{o}F/g, \"{}^{\\\\circ}F\");\r\n            var b5 = {\r\n              d: mhchemParser.go(buffer.d, 'pu'),\r\n              q: mhchemParser.go(buffer.q, 'pu')\r\n            };\r\n            if (buffer.o === '//') {\r\n              ret = { type_: 'pu-frac', p1: b5.d, p2: b5.q };\r\n            } else {\r\n              ret = b5.d;\r\n              if (b5.d.length > 1  ||  b5.q.length > 1) {\r\n                ret.push({ type_: ' / ' });\r\n              } else {\r\n                ret.push({ type_: '/' });\r\n              }\r\n              mhchemParser.concatArray(ret, b5.q);\r\n            }\r\n          } else {  // no fraction\r\n            ret = mhchemParser.go(buffer.d, 'pu-2');\r\n          }\r\n          for (var p in buffer) { delete buffer[p]; }\r\n          return ret;\r\n        }\r\n      }\r\n    },\r\n    'pu-2': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '*': { action_: 'output' } },\r\n        '*': {\r\n          '*': { action_: [ 'output', 'cdot' ], nextState: '0' } },\r\n        '\\\\x': {\r\n          '*': { action_: 'rm=' } },\r\n        'space': {\r\n          '*': { action_: [ 'output', 'space' ], nextState: '0' } },\r\n        '^{(...)}|^(-1)': {\r\n          '1': { action_: '^(-1)' } },\r\n        '-9.,9': {\r\n          '0': { action_: 'rm=', nextState: '0' },\r\n          '1': { action_: '^(-1)', nextState: '0' } },\r\n        '{...}|else': {\r\n          '*': { action_: 'rm=', nextState: '1' } }\r\n      }),\r\n      actions: {\r\n        'cdot': function () { return { type_: 'tight cdot' }; },\r\n        '^(-1)': function (buffer, m) { buffer.rm += \"^{\"+m+\"}\"; },\r\n        'space': function () { return { type_: 'pu-space-2' }; },\r\n        'output': function (buffer) {\r\n          /** @type {ParserOutput | ParserOutput[]} */\r\n          var ret = [];\r\n          if (buffer.rm) {\r\n            var mrm = mhchemParser.patterns.match_('{(...)}', buffer.rm || \"\");\r\n            if (mrm  &&  mrm.remainder === '') {\r\n              ret = mhchemParser.go(mrm.match_, 'pu');\r\n            } else {\r\n              ret = { type_: 'rm', p1: buffer.rm };\r\n            }\r\n          }\r\n          for (var p in buffer) { delete buffer[p]; }\r\n          return ret;\r\n        }\r\n      }\r\n    },\r\n    'pu-9,9': {\r\n      transitions: mhchemParser.createTransitions({\r\n        'empty': {\r\n          '0': { action_: 'output-0' },\r\n          'o': { action_: 'output-o' } },\r\n        ',': {\r\n          '0': { action_: [ 'output-0', 'comma' ], nextState: 'o' } },\r\n        '.': {\r\n          '0': { action_: [ 'output-0', 'copy' ], nextState: 'o' } },\r\n        'else': {\r\n          '*': { action_: 'text=' } }\r\n      }),\r\n      actions: {\r\n        'comma': function () { return { type_: 'commaDecimal' }; },\r\n        'output-0': function (buffer) {\r\n          /** @type {ParserOutput[]} */\r\n          var ret = [];\r\n          buffer.text_ = buffer.text_ || \"\";\r\n          if (buffer.text_.length > 4) {\r\n            var a = buffer.text_.length % 3;\r\n            if (a === 0) { a = 3; }\r\n            for (var i=buffer.text_.length-3; i>0; i-=3) {\r\n              ret.push(buffer.text_.substr(i, 3));\r\n              ret.push({ type_: '1000 separator' });\r\n            }\r\n            ret.push(buffer.text_.substr(0, a));\r\n            ret.reverse();\r\n          } else {\r\n            ret.push(buffer.text_);\r\n          }\r\n          for (var p in buffer) { delete buffer[p]; }\r\n          return ret;\r\n        },\r\n        'output-o': function (buffer) {\r\n          /** @type {ParserOutput[]} */\r\n          var ret = [];\r\n          buffer.text_ = buffer.text_ || \"\";\r\n          if (buffer.text_.length > 4) {\r\n            var a = buffer.text_.length - 3;\r\n            for (var i=0; i<a; i+=3) {\r\n              ret.push(buffer.text_.substr(i, 3));\r\n              ret.push({ type_: '1000 separator' });\r\n            }\r\n            ret.push(buffer.text_.substr(i));\r\n          } else {\r\n            ret.push(buffer.text_);\r\n          }\r\n          for (var p in buffer) { delete buffer[p]; }\r\n          return ret;\r\n        }\r\n      }\r\n    }\r\n    //#endregion\r\n  };\r\n\r\n  //\r\n  // texify: Take MhchemParser output and convert it to TeX\r\n  //\r\n  /** @type {Texify} */\r\n  var texify = {\r\n    go: function (input, isInner) {  // (recursive, max 4 levels)\r\n      if (!input) { return \"\"; }\r\n      var res = \"\";\r\n      var cee = false;\r\n      for (var i=0; i < input.length; i++) {\r\n        var inputi = input[i];\r\n        if (typeof inputi === \"string\") {\r\n          res += inputi;\r\n        } else {\r\n          res += texify._go2(inputi);\r\n          if (inputi.type_ === '1st-level escape') { cee = true; }\r\n        }\r\n      }\r\n      if (!isInner && !cee && res) {\r\n        res = \"{\" + res + \"}\";\r\n      }\r\n      return res;\r\n    },\r\n    _goInner: function (input) {\r\n      if (!input) { return input; }\r\n      return texify.go(input, true);\r\n    },\r\n    _go2: function (buf) {\r\n      /** @type {undefined | string} */\r\n      var res;\r\n      switch (buf.type_) {\r\n        case 'chemfive':\r\n          res = \"\";\r\n          var b5 = {\r\n            a: texify._goInner(buf.a),\r\n            b: texify._goInner(buf.b),\r\n            p: texify._goInner(buf.p),\r\n            o: texify._goInner(buf.o),\r\n            q: texify._goInner(buf.q),\r\n            d: texify._goInner(buf.d)\r\n          };\r\n          //\r\n          // a\r\n          //\r\n          if (b5.a) {\r\n            if (b5.a.match(/^[+\\-]/)) { b5.a = \"{\"+b5.a+\"}\"; }\r\n            res += b5.a + \"\\\\,\";\r\n          }\r\n          //\r\n          // b and p\r\n          //\r\n          if (b5.b || b5.p) {\r\n            res += \"{\\\\vphantom{X}}\";\r\n            res += \"^{\\\\hphantom{\"+(b5.b||\"\")+\"}}_{\\\\hphantom{\"+(b5.p||\"\")+\"}}\";\r\n            res += \"{\\\\vphantom{X}}\";\r\n            res += \"^{\\\\smash[t]{\\\\vphantom{2}}\\\\mathllap{\"+(b5.b||\"\")+\"}}\";\r\n            res += \"_{\\\\vphantom{2}\\\\mathllap{\\\\smash[t]{\"+(b5.p||\"\")+\"}}}\";\r\n          }\r\n          //\r\n          // o\r\n          //\r\n          if (b5.o) {\r\n            if (b5.o.match(/^[+\\-]/)) { b5.o = \"{\"+b5.o+\"}\"; }\r\n            res += b5.o;\r\n          }\r\n          //\r\n          // q and d\r\n          //\r\n          if (buf.dType === 'kv') {\r\n            if (b5.d || b5.q) {\r\n              res += \"{\\\\vphantom{X}}\";\r\n            }\r\n            if (b5.d) {\r\n              res += \"^{\"+b5.d+\"}\";\r\n            }\r\n            if (b5.q) {\r\n              res += \"_{\\\\smash[t]{\"+b5.q+\"}}\";\r\n            }\r\n          } else if (buf.dType === 'oxidation') {\r\n            if (b5.d) {\r\n              res += \"{\\\\vphantom{X}}\";\r\n              res += \"^{\"+b5.d+\"}\";\r\n            }\r\n            if (b5.q) {\r\n              res += \"{\\\\vphantom{X}}\";\r\n              res += \"_{\\\\smash[t]{\"+b5.q+\"}}\";\r\n            }\r\n          } else {\r\n            if (b5.q) {\r\n              res += \"{\\\\vphantom{X}}\";\r\n              res += \"_{\\\\smash[t]{\"+b5.q+\"}}\";\r\n            }\r\n            if (b5.d) {\r\n              res += \"{\\\\vphantom{X}}\";\r\n              res += \"^{\"+b5.d+\"}\";\r\n            }\r\n          }\r\n          break;\r\n        case 'rm':\r\n          res = \"\\\\mathrm{\"+buf.p1+\"}\";\r\n          break;\r\n        case 'text':\r\n          if (buf.p1.match(/[\\^_]/)) {\r\n            buf.p1 = buf.p1.replace(\" \", \"~\").replace(\"-\", \"\\\\text{-}\");\r\n            res = \"\\\\mathrm{\"+buf.p1+\"}\";\r\n          } else {\r\n            res = \"\\\\text{\"+buf.p1+\"}\";\r\n          }\r\n          break;\r\n        case 'roman numeral':\r\n          res = \"\\\\mathrm{\"+buf.p1+\"}\";\r\n          break;\r\n        case 'state of aggregation':\r\n          res = \"\\\\mskip2mu \"+texify._goInner(buf.p1);\r\n          break;\r\n        case 'state of aggregation subscript':\r\n          res = \"\\\\mskip1mu \"+texify._goInner(buf.p1);\r\n          break;\r\n        case 'bond':\r\n          res = texify._getBond(buf.kind_);\r\n          if (!res) {\r\n            throw [\"MhchemErrorBond\", \"mhchem Error. Unknown bond type (\" + buf.kind_ + \")\"];\r\n          }\r\n          break;\r\n        case 'frac':\r\n          var c = \"\\\\frac{\" + buf.p1 + \"}{\" + buf.p2 + \"}\";\r\n          res = \"\\\\mathchoice{\\\\textstyle\"+c+\"}{\"+c+\"}{\"+c+\"}{\"+c+\"}\";\r\n          break;\r\n        case 'pu-frac':\r\n          var d = \"\\\\frac{\" + texify._goInner(buf.p1) + \"}{\" + texify._goInner(buf.p2) + \"}\";\r\n          res = \"\\\\mathchoice{\\\\textstyle\"+d+\"}{\"+d+\"}{\"+d+\"}{\"+d+\"}\";\r\n          break;\r\n        case 'tex-math':\r\n          res = buf.p1 + \" \";\r\n          break;\r\n        case 'frac-ce':\r\n          res = \"\\\\frac{\" + texify._goInner(buf.p1) + \"}{\" + texify._goInner(buf.p2) + \"}\";\r\n          break;\r\n        case 'overset':\r\n          res = \"\\\\overset{\" + texify._goInner(buf.p1) + \"}{\" + texify._goInner(buf.p2) + \"}\";\r\n          break;\r\n        case 'underset':\r\n          res = \"\\\\underset{\" + texify._goInner(buf.p1) + \"}{\" + texify._goInner(buf.p2) + \"}\";\r\n          break;\r\n        case 'underbrace':\r\n          res =  \"\\\\underbrace{\" + texify._goInner(buf.p1) + \"}_{\" + texify._goInner(buf.p2) + \"}\";\r\n          break;\r\n        case 'color':\r\n          res = \"{\\\\color{\" + buf.color1 + \"}{\" + texify._goInner(buf.color2) + \"}}\";\r\n          break;\r\n        case 'color0':\r\n          res = \"\\\\color{\" + buf.color + \"}\";\r\n          break;\r\n        case 'arrow':\r\n          var b6 = {\r\n            rd: texify._goInner(buf.rd),\r\n            rq: texify._goInner(buf.rq)\r\n          };\r\n          var arrow = \"\\\\x\" + texify._getArrow(buf.r);\r\n          if (b6.rq) { arrow += \"[{\" + b6.rq + \"}]\"; }\r\n          if (b6.rd) {\r\n            arrow += \"{\" + b6.rd + \"}\";\r\n          } else {\r\n            arrow += \"{}\";\r\n          }\r\n          res = arrow;\r\n          break;\r\n        case 'operator':\r\n          res = texify._getOperator(buf.kind_);\r\n          break;\r\n        case '1st-level escape':\r\n          res = buf.p1+\" \";  // &, \\\\\\\\, \\\\hlin\r\n          break;\r\n        case 'space':\r\n          res = \" \";\r\n          break;\r\n        case 'entitySkip':\r\n          res = \"~\";\r\n          break;\r\n        case 'pu-space-1':\r\n          res = \"~\";\r\n          break;\r\n        case 'pu-space-2':\r\n          res = \"\\\\mkern3mu \";\r\n          break;\r\n        case '1000 separator':\r\n          res = \"\\\\mkern2mu \";\r\n          break;\r\n        case 'commaDecimal':\r\n          res = \"{,}\";\r\n          break;\r\n          case 'comma enumeration L':\r\n          res = \"{\"+buf.p1+\"}\\\\mkern6mu \";\r\n          break;\r\n        case 'comma enumeration M':\r\n          res = \"{\"+buf.p1+\"}\\\\mkern3mu \";\r\n          break;\r\n        case 'comma enumeration S':\r\n          res = \"{\"+buf.p1+\"}\\\\mkern1mu \";\r\n          break;\r\n        case 'hyphen':\r\n          res = \"\\\\text{-}\";\r\n          break;\r\n        case 'addition compound':\r\n          res = \"\\\\,{\\\\cdot}\\\\,\";\r\n          break;\r\n        case 'electron dot':\r\n          res = \"\\\\mkern1mu \\\\bullet\\\\mkern1mu \";\r\n          break;\r\n        case 'KV x':\r\n          res = \"{\\\\times}\";\r\n          break;\r\n        case 'prime':\r\n          res = \"\\\\prime \";\r\n          break;\r\n        case 'cdot':\r\n          res = \"\\\\cdot \";\r\n          break;\r\n        case 'tight cdot':\r\n          res = \"\\\\mkern1mu{\\\\cdot}\\\\mkern1mu \";\r\n          break;\r\n        case 'times':\r\n          res = \"\\\\times \";\r\n          break;\r\n        case 'circa':\r\n          res = \"{\\\\sim}\";\r\n          break;\r\n        case '^':\r\n          res = \"uparrow\";\r\n          break;\r\n        case 'v':\r\n          res = \"downarrow\";\r\n          break;\r\n        case 'ellipsis':\r\n          res = \"\\\\ldots \";\r\n          break;\r\n        case '/':\r\n          res = \"/\";\r\n          break;\r\n        case ' / ':\r\n          res = \"\\\\,/\\\\,\";\r\n          break;\r\n        default:\r\n          assertNever(buf);\r\n          throw [\"MhchemBugT\", \"mhchem bug T. Please report.\"];  // Missing texify rule or unknown MhchemParser output\r\n      }\r\n      assertString(res);\r\n      return res;\r\n    },\r\n    _getArrow: function (a) {\r\n      switch (a) {\r\n        case \"->\": return \"rightarrow\";\r\n        case \"\\u2192\": return \"rightarrow\";\r\n        case \"\\u27F6\": return \"rightarrow\";\r\n        case \"<-\": return \"leftarrow\";\r\n        case \"<->\": return \"leftrightarrow\";\r\n        case \"<--\x3e\": return \"rightleftarrows\";\r\n        case \"<=>\": return \"rightleftharpoons\";\r\n        case \"\\u21CC\": return \"rightleftharpoons\";\r\n        case \"<=>>\": return \"rightequilibrium\";\r\n        case \"<<=>\": return \"leftequilibrium\";\r\n        default:\r\n          assertNever(a);\r\n          throw [\"MhchemBugT\", \"mhchem bug T. Please report.\"];\r\n      }\r\n    },\r\n    _getBond: function (a) {\r\n      switch (a) {\r\n        case \"-\": return \"{-}\";\r\n        case \"1\": return \"{-}\";\r\n        case \"=\": return \"{=}\";\r\n        case \"2\": return \"{=}\";\r\n        case \"#\": return \"{\\\\equiv}\";\r\n        case \"3\": return \"{\\\\equiv}\";\r\n        case \"~\": return \"{\\\\tripledash}\";\r\n        case \"~-\": return \"{\\\\mathrlap{\\\\raisebox{-.1em}{$-$}}\\\\raisebox{.1em}{$\\\\tripledash$}}\";\r\n        case \"~=\": return \"{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$\\\\tripledash$}}-}\";\r\n        case \"~--\": return \"{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$\\\\tripledash$}}-}\";\r\n        case \"-~-\": return \"{\\\\mathrlap{\\\\raisebox{-.2em}{$-$}}\\\\mathrlap{\\\\raisebox{.2em}{$-$}}\\\\tripledash}\";\r\n        case \"...\": return \"{{\\\\cdot}{\\\\cdot}{\\\\cdot}}\";\r\n        case \"....\": return \"{{\\\\cdot}{\\\\cdot}{\\\\cdot}{\\\\cdot}}\";\r\n        case \"->\": return \"{\\\\rightarrow}\";\r\n        case \"<-\": return \"{\\\\leftarrow}\";\r\n        case \"<\": return \"{<}\";\r\n        case \">\": return \"{>}\";\r\n        default:\r\n          assertNever(a);\r\n          throw [\"MhchemBugT\", \"mhchem bug T. Please report.\"];\r\n      }\r\n    },\r\n    _getOperator: function (a) {\r\n      switch (a) {\r\n        case \"+\": return \" {}+{} \";\r\n        case \"-\": return \" {}-{} \";\r\n        case \"=\": return \" {}={} \";\r\n        case \"<\": return \" {}<{} \";\r\n        case \">\": return \" {}>{} \";\r\n        case \"<<\": return \" {}\\\\ll{} \";\r\n        case \">>\": return \" {}\\\\gg{} \";\r\n        case \"\\\\pm\": return \" {}\\\\pm{} \";\r\n        case \"\\\\approx\": return \" {}\\\\approx{} \";\r\n        case \"$\\\\approx$\": return \" {}\\\\approx{} \";\r\n        case \"v\": return \" \\\\downarrow{} \";\r\n        case \"(v)\": return \" \\\\downarrow{} \";\r\n        case \"^\": return \" \\\\uparrow{} \";\r\n        case \"(^)\": return \" \\\\uparrow{} \";\r\n        default:\r\n          assertNever(a);\r\n          throw [\"MhchemBugT\", \"mhchem bug T. Please report.\"];\r\n      }\r\n    }\r\n  };\r\n\r\n  //\r\n  // Helpers for code analysis\r\n  // Will show type error at calling position\r\n  //\r\n  /** @param {number} a */\r\n  function assertNever(a) {}\r\n  /** @param {string} a */\r\n  function assertString(a) {}\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/katex/mhchem.js?")},"./src/assets/js/keyboard/keyboard.css":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/keyboard/keyboard.css?")},"./src/assets/js/keyboard/keyboard.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VKI_init: () => (/* binding */ VKI_init)\n/* harmony export */ });\n/* harmony import */ var _keyboard_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./keyboard.css */ "./src/assets/js/keyboard/keyboard.css");\n\r\n\r\nvar VKI_console, debug = false;\r\nif (debug) {\r\n    if (window.console) {\r\n        VKI_console = window.console\r\n    } else {\r\n        VKI_console = {\r\n            log: function(a) {\r\n                alert(a)\r\n            },\r\n            error: function(a) {\r\n                alert(a)\r\n            }\r\n        }\r\n    }\r\n} else {\r\n    VKI_console = {\r\n        log: function(a) {},\r\n        error: function(a) {}\r\n    }\r\n}\r\n\r\nvar VKI_attach, VKI_close;\r\nvar VKI_version;\r\nvar VKI_show;\r\n\r\nfunction VKI_init() {\r\n    var self = this;\r\n\tglobalThis.document2 = $(document).get(0);\t\t\t\t\t// do we get a real document here ?\r\n    this.VKI_version = "1.49";\r\n    VKI_version = this.VKI_version;\r\n    this.VKI_showVersion = false;\r\n    this.VKI_target = false;\r\n    this.VKI_shift = this.VKI_shiftlock = false;\r\n    this.VKI_altgr = this.VKI_altgrlock = false;\r\n    this.VKI_dead = false;\r\n    this.VKI_deadBox = true;\r\n    this.VKI_deadkeysOn = false;\r\n    this.VKI_numberPad = true;\r\n    this.VKI_numberPadOn = true;\r\n    this.VKI_kts = this.VKI_kt = "US International";\r\n    this.VKI_langAdapt = true;\r\n    this.VKI_size = 3;\r\n    this.VKI_sizeAdj = true;\r\n    this.VKI_clearPasswords = false;\r\n    this.VKI_imageURI = "";\r\n    this.VKI_clickless = 0;\r\n    this.VKI_activeTab = 0;\r\n    this.VKI_enterSubmit = false;\r\n    this.VKI_keyCenter = 3;\r\n    this.VKI_isIE = false;;\r\n    this.VKI_isIE6 = false;;\r\n    this.VKI_isIElt8 = false;;\r\n    this.VKI_isWebKit = RegExp("KHTML").test(navigator.userAgent);\r\n    this.VKI_isOpera = RegExp("Opera").test(navigator.userAgent);\r\n    this.VKI_isMoz = (!this.VKI_isWebKit && navigator.product == "Gecko");\r\n    this.VKI_i18n = {\r\n        "00": globalThis.vme.getLocalText("VKI_00"),\r\n        "01": globalThis.vme.getLocalText("VKI_01"),\r\n        "02": globalThis.vme.getLocalText("VKI_02"),\r\n        "03": globalThis.vme.getLocalText("VKI_03"),\r\n        "04": globalThis.vme.getLocalText("VKI_04"),\r\n        "05": globalThis.vme.getLocalText("VKI_05"),\r\n        "06": globalThis.vme.getLocalText("VKI_06"),\r\n        "07": globalThis.vme.getLocalText("VKI_07"),\r\n        "08": globalThis.vme.getLocalText("VKI_08"),\r\n        "09": globalThis.vme.getLocalText("VKI_09"),\r\n        "10": globalThis.vme.getLocalText("VKI_10"),\r\n        "11": globalThis.vme.getLocalText("VKI_11")\r\n    };\r\n    this.VKI_layout = {};\r\n    this.VKI_layout["\\u0627\\u0644\\u0639\\u0631\\u0628\\u064a\\u0629"] = {\r\n        name: "Arabic",\r\n        keys: [\r\n            [\r\n                ["\\u0630", "\\u0651 "],\r\n                ["1", "!", "\\u00a1", "\\u00b9"],\r\n                ["2", "@", "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00a4", "\\u00a3"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "^", "\\u00bc"],\r\n                ["7", "&", "\\u00bd"],\r\n                ["8", "*", "\\u00be"],\r\n                ["9", "(", "\\u2018"],\r\n                ["0", ")", "\\u2019"],\r\n                ["-", "_", "\\u00a5"],\r\n                ["=", "+", "\\u00d7", "\\u00f7"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0636", "\\u064e"],\r\n                ["\\u0635", "\\u064b"],\r\n                ["\\u062b", "\\u064f"],\r\n                ["\\u0642", "\\u064c"],\r\n                ["\\u0641", "\\u0644"],\r\n                ["\\u063a", "\\u0625"],\r\n                ["\\u0639", "\\u2018"],\r\n                ["\\u0647", "\\u00f7"],\r\n                ["\\u062e", "\\u00d7"],\r\n                ["\\u062d", "\\u061b"],\r\n                ["\\u062c", "<"],\r\n                ["\\u062f", ">"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0634", "\\u0650"],\r\n                ["\\u0633", "\\u064d"],\r\n                ["\\u064a", "]"],\r\n                ["\\u0628", "["],\r\n                ["\\u0644", "\\u0644"],\r\n                ["\\u0627", "\\u0623"],\r\n                ["\\u062a", "\\u0640"],\r\n                ["\\u0646", "\\u060c"],\r\n                ["\\u0645", "/"],\r\n                ["\\u0643", ":"],\r\n                ["\\u0637", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0626", "~"],\r\n                ["\\u0621", "\\u0652"],\r\n                ["\\u0624", "}"],\r\n                ["\\u0631", "{"],\r\n                ["\\u0644", "\\u0644"],\r\n                ["\\u0649", "\\u0622"],\r\n                ["\\u0629", "\\u2019"],\r\n                ["\\u0648", ","],\r\n                ["\\u0632", "."],\r\n                ["\\u0638", "\\u061f"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["ar"]\r\n    };\r\n    this.VKI_layout["\\u0985\\u09b8\\u09ae\\u09c0\\u09df\\u09be"] = {\r\n        name: "Assamese",\r\n        keys: [\r\n            [\r\n                ["+", "?"],\r\n                ["\\u09E7", "{", "\\u09E7"],\r\n                ["\\u09E8", "}", "\\u09E8"],\r\n                ["\\u09E9", "\\u09CD\\u09F0", "\\u09E9"],\r\n                ["\\u09EA", "\\u09F0\\u09CD", "\\u09EA"],\r\n                ["\\u09EB", "\\u099C\\u09CD\\u09F0", "\\u09EB"],\r\n                ["\\u09EC", "\\u0995\\u09CD\\u09B7", "\\u09EC"],\r\n                ["\\u09ED", "\\u0995\\u09CD\\u09F0", "\\u09ED"],\r\n                ["\\u09EE", "\\u09B6\\u09CD\\u09F0", "\\u09EE"],\r\n                ["\\u09EF", "(", "\\u09EF"],\r\n                ["\\u09E6", ")", "\\u09E6"],\r\n                ["-", ""],\r\n                ["\\u09C3", "\\u098B", "\\u09E2", "\\u09E0"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u09CC", "\\u0994", "\\u09D7"],\r\n                ["\\u09C8", "\\u0990"],\r\n                ["\\u09BE", "\\u0986"],\r\n                ["\\u09C0", "\\u0988", "\\u09E3", "\\u09E1"],\r\n                ["\\u09C2", "\\u098A"],\r\n                ["\\u09F1", "\\u09AD"],\r\n                ["\\u09B9", "\\u0999"],\r\n                ["\\u0997", "\\u0998"],\r\n                ["\\u09A6", "\\u09A7"],\r\n                ["\\u099C", "\\u099D"],\r\n                ["\\u09A1", "\\u09A2", "\\u09DC", "\\u09DD"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u09CB", "\\u0993", "\\u09F4", "\\u09F5"],\r\n                ["\\u09C7", "\\u098F", "\\u09F6", "\\u09F7"],\r\n                ["\\u09CD", "\\u0985", "\\u09F8", "\\u09F9"],\r\n                ["\\u09BF", "\\u0987", "\\u09E2", "\\u098C"],\r\n                ["\\u09C1", "\\u0989"],\r\n                ["\\u09AA", "\\u09AB"],\r\n                ["\\u09F0", "", "\\u09F0", "\\u09F1"],\r\n                ["\\u0995", "\\u0996"],\r\n                ["\\u09A4", "\\u09A5"],\r\n                ["\\u099A", "\\u099B"],\r\n                ["\\u099F", "\\u09A0"],\r\n                ["\\u09BC", "\\u099E"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u09CE", "\\u0983"],\r\n                ["\\u0982", "\\u0981", "\\u09FA"],\r\n                ["\\u09AE", "\\u09A3"],\r\n                ["\\u09A8", "\\u09F7"],\r\n                ["\\u09AC", \'"\'],\r\n                ["\\u09B2", "\'"],\r\n                ["\\u09B8", "\\u09B6"],\r\n                [",", "\\u09B7"],\r\n                [".", ";"],\r\n                ["\\u09AF", "\\u09DF"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["as"]\r\n    };\r\n    this.VKI_layout["\\u0410\\u0437\\u04d9\\u0440\\u0431\\u0430\\u0458\\u04b9\\u0430\\u043d\\u04b9\\u0430"] = {\r\n        name: "Azerbaijani Cyrillic",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0458", "\\u0408"],\r\n                ["\\u04AF", "\\u04AE"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u04BB", "\\u04BA"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u04B9", "\\u04B8"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u049D", "\\u049C"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["\\u04D9", "\\u04D8"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u0493", "\\u0492"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u04E9", "\\u04E8"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["az-Cyrl"]\r\n    };\r\n    this.VKI_layout["Az\\u0259rbaycanca"] = {\r\n        name: "Azerbaijani Latin",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2166"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["\\u00FC", "\\u00DC"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "\\u0130"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00F6", "\\u00D6"],\r\n                ["\\u011F", "\\u011E"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u0131", "I"],\r\n                ["\\u0259", "\\u018F"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                ["\\u00E7", "\\u00C7"],\r\n                ["\\u015F", "\\u015E"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["az"]\r\n    };\r\n    this.VKI_layout["\\u0411\\u0435\\u043b\\u0430\\u0440\\u0443\\u0441\\u043a\\u0430\\u044f"] = {\r\n        name: "Belarusian",\r\n        keys: [\r\n            [\r\n                ["\\u0451", "\\u0401"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043a", "\\u041a"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043d", "\\u041d"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u045e", "\\u040e"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\'", "\'"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044b", "\\u042b"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043f", "\\u041f"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043e", "\\u041e"],\r\n                ["\\u043b", "\\u041b"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044d", "\\u042d"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["/", "|"],\r\n                ["\\u044f", "\\u042f"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043c", "\\u041c"],\r\n                ["\\u0456", "\\u0406"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044c", "\\u042c"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044e", "\\u042e"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["be"]\r\n    };\r\n    this.VKI_layout["Belgische / Belge"] = {\r\n        name: "Belgian",\r\n        keys: [\r\n            [\r\n                ["\\u00b2", "\\u00b3"],\r\n                ["&", "1", "|"],\r\n                ["\\u00e9", "2", "@"],\r\n                [\'"\', "3", "#"],\r\n                ["\'", "4"],\r\n                ["(", "5"],\r\n                ["\\u00a7", "6", "^"],\r\n                ["\\u00e8", "7"],\r\n                ["!", "8"],\r\n                ["\\u00e7", "9", "{"],\r\n                ["\\u00e0", "0", "}"],\r\n                [")", "\\u00b0"],\r\n                ["-", "_"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["a", "A"],\r\n                ["z", "Z"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["^", "\\u00a8", "["],\r\n                ["$", "*", "]"],\r\n                ["\\u03bc", "\\u00a3", "`"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["q", "Q"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["m", "M"],\r\n                ["\\u00f9", "%", "\\u00b4"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["w", "W"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                [",", "?"],\r\n                [";", "."],\r\n                [":", "/"],\r\n                ["=", "+", "~"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["nl-BE", "fr-BE"]\r\n    };\r\n    this.VKI_layout["\\u0411\\u044a\\u043b\\u0433\\u0430\\u0440\\u0441\\u043a\\u0438 \\u0424\\u043e\\u043d\\u0435\\u0442\\u0438\\u0447\\u0435\\u043d"] = {\r\n        name: "Bulgarian Phonetic",\r\n        keys: [\r\n            [\r\n                ["\\u0447", "\\u0427"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u044E", "\\u042E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u043B", "\\u041B"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u043C", "\\u041C"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["bg"]\r\n    };\r\n    this.VKI_layout["\\u0411\\u044a\\u043b\\u0433\\u0430\\u0440\\u0441\\u043a\\u0438"] = {\r\n        name: "Bulgarian BDS",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "?"],\r\n                ["3", "+"],\r\n                ["4", \'"\'],\r\n                ["5", "%"],\r\n                ["6", "="],\r\n                ["7", ":"],\r\n                ["8", "/"],\r\n                ["9", "_"],\r\n                ["0", "\\u2116"],\r\n                ["-", "\\u0406"],\r\n                ["=", "V"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                [",", "\\u044b"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u043a", "\\u041a"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0446", "\\u0426"],\r\n                [";", "\\u00a7"],\r\n                ["(", ")"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u044c", "\\u042c"],\r\n                ["\\u044f", "\\u042f"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043e", "\\u041e"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u043d", "\\u041d"],\r\n                ["\\u0412", "\\u0412"],\r\n                ["\\u043c", "\\u041c"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u042e", "\\u044e"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u044a", "\\u042a"],\r\n                ["\\u044d", "\\u042d"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u043f", "\\u041f"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043b", "\\u041b"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["\\u09ac\\u09be\\u0982\\u09b2\\u09be"] = {\r\n        name: "Bengali",\r\n        keys: [\r\n            [\r\n                [""],\r\n                ["1", "", "\\u09E7"],\r\n                ["2", "", "\\u09E8"],\r\n                ["3", "\\u09CD\\u09B0", "\\u09E9"],\r\n                ["4", "\\u09B0\\u09CD", "\\u09EA"],\r\n                ["5", "\\u099C\\u09CD\\u09B0", "\\u09EB"],\r\n                ["6", "\\u09A4\\u09CD\\u09B7", "\\u09EC"],\r\n                ["7", "\\u0995\\u09CD\\u09B0", "\\u09ED"],\r\n                ["8", "\\u09B6\\u09CD\\u09B0", "\\u09EE"],\r\n                ["9", "(", "\\u09EF"],\r\n                ["0", ")", "\\u09E6"],\r\n                ["-", "\\u0983"],\r\n                ["\\u09C3", "\\u098B", "\\u09E2", "\\u09E0"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u09CC", "\\u0994", "\\u09D7"],\r\n                ["\\u09C8", "\\u0990"],\r\n                ["\\u09BE", "\\u0986"],\r\n                ["\\u09C0", "\\u0988", "\\u09E3", "\\u09E1"],\r\n                ["\\u09C2", "\\u098A"],\r\n                ["\\u09AC", "\\u09AD"],\r\n                ["\\u09B9", "\\u0999"],\r\n                ["\\u0997", "\\u0998"],\r\n                ["\\u09A6", "\\u09A7"],\r\n                ["\\u099C", "\\u099D"],\r\n                ["\\u09A1", "\\u09A2", "\\u09DC", "\\u09DD"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u09CB", "\\u0993", "\\u09F4", "\\u09F5"],\r\n                ["\\u09C7", "\\u098F", "\\u09F6", "\\u09F7"],\r\n                ["\\u09CD", "\\u0985", "\\u09F8", "\\u09F9"],\r\n                ["\\u09BF", "\\u0987", "\\u09E2", "\\u098C"],\r\n                ["\\u09C1", "\\u0989"],\r\n                ["\\u09AA", "\\u09AB"],\r\n                ["\\u09B0", "", "\\u09F0", "\\u09F1"],\r\n                ["\\u0995", "\\u0996"],\r\n                ["\\u09A4", "\\u09A5"],\r\n                ["\\u099A", "\\u099B"],\r\n                ["\\u099F", "\\u09A0"],\r\n                ["\\u09BC", "\\u099E"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [""],\r\n                ["\\u0982", "\\u0981", "\\u09FA"],\r\n                ["\\u09AE", "\\u09A3"],\r\n                ["\\u09A8"],\r\n                ["\\u09AC"],\r\n                ["\\u09B2"],\r\n                ["\\u09B8", "\\u09B6"],\r\n                [",", "\\u09B7"],\r\n                [".", "{"],\r\n                ["\\u09AF", "\\u09DF"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["bn"]\r\n    };\r\n    this.VKI_layout.Bosanski = {\r\n        name: "Bosnian",\r\n        keys: [\r\n            [\r\n                ["\\u00B8", "\\u00A8"],\r\n                ["1", "!", "~"],\r\n                ["2", \'"\', "\\u02C7"],\r\n                ["3", "#", "^"],\r\n                ["4", "$", "\\u02D8"],\r\n                ["5", "%", "\\u00B0"],\r\n                ["6", "&", "\\u02DB"],\r\n                ["7", "/", "`"],\r\n                ["8", "(", "\\u02D9"],\r\n                ["9", ")", "\\u00B4"],\r\n                ["0", "=", "\\u02DD"],\r\n                ["\'", "?", "\\u00A8"],\r\n                ["+", "*", "\\u00B8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\\\"],\r\n                ["w", "W", "|"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u0161", "\\u0160", "\\u00F7"],\r\n                ["\\u0111", "\\u0110", "\\u00D7"],\r\n                ["\\u017E", "\\u017D", "\\u00A4"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F", "["],\r\n                ["g", "G", "]"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K", "\\u0142"],\r\n                ["l", "L", "\\u0141"],\r\n                ["\\u010D", "\\u010C"],\r\n                ["\\u0107", "\\u0106", "\\u00DF"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V", "@"],\r\n                ["b", "B", "{"],\r\n                ["n", "N", "}"],\r\n                ["m", "M", "\\u00A7"],\r\n                [",", ";", "<"],\r\n                [".", ":", ">"],\r\n                ["-", "_", "\\u00A9"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["bs"]\r\n    };\r\n    this.VKI_layout["Canadienne-fran\\u00e7aise"] = {\r\n        name: "Canadian French",\r\n        keys: [\r\n            [\r\n                ["#", "|", "\\\\"],\r\n                ["1", "!", "\\u00B1"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "/", "\\u00A3"],\r\n                ["4", "$", "\\u00A2"],\r\n                ["5", "%", "\\u00A4"],\r\n                ["6", "?", "\\u00AC"],\r\n                ["7", "&", "\\u00A6"],\r\n                ["8", "*", "\\u00B2"],\r\n                ["9", "(", "\\u00B3"],\r\n                ["0", ")", "\\u00BC"],\r\n                ["-", "_", "\\u00BD"],\r\n                ["=", "+", "\\u00BE"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O", "\\u00A7"],\r\n                ["p", "P", "\\u00B6"],\r\n                ["^", "^", "["],\r\n                ["\\u00B8", "\\u00A8", "]"],\r\n                ["<", ">", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":", "~"],\r\n                ["`", "`", "{"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u00AB", "\\u00BB", "\\u00B0"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u00B5"],\r\n                [",", "\'", "\\u00AF"],\r\n                [".", ".", "\\u00AD"],\r\n                ["\\u00E9", "\\u00C9", "\\u00B4"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fr-CA"]\r\n    };\r\n    this.VKI_layout["\\u010cesky"] = {\r\n        name: "Czech",\r\n        keys: [\r\n            [\r\n                [";", "\\u00b0", "`", "~"],\r\n                ["+", "1", "!"],\r\n                ["\\u011B", "2", "@"],\r\n                ["\\u0161", "3", "#"],\r\n                ["\\u010D", "4", "$"],\r\n                ["\\u0159", "5", "%"],\r\n                ["\\u017E", "6", "^"],\r\n                ["\\u00FD", "7", "&"],\r\n                ["\\u00E1", "8", "*"],\r\n                ["\\u00ED", "9", "("],\r\n                ["\\u00E9", "0", ")"],\r\n                ["=", "%", "-", "_"],\r\n                ["\\u00B4", "\\u02c7", "=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00FA", "/", "[", "{"],\r\n                [")", "(", "]", "}"],\r\n                ["\\u00A8", "\'", "\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u016F", \'"\', ";", ":"],\r\n                ["\\u00A7", "!", "\\u00a4", "^"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|", "", "\\u02dd"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "?", "<", "\\u00d7"],\r\n                [".", ":", ">", "\\u00f7"],\r\n                ["-", "_", "/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["cs"]\r\n    };\r\n    this.VKI_layout.Dansk = {\r\n        name: "Danish",\r\n        keys: [\r\n            [\r\n                ["\\u00bd", "\\u00a7"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00a3"],\r\n                ["4", "\\u00a4", "$"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["+", "?"],\r\n                ["\\u00b4", "`", "|"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00e5", "\\u00c5"],\r\n                ["\\u00a8", "^", "~"],\r\n                ["\'", "*"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00e6", "\\u00c6"],\r\n                ["\\u00f8", "\\u00d8"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u03bc", "\\u039c"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["da"]\r\n    };\r\n    this.VKI_layout.Deutsch = {\r\n        name: "German",\r\n        keys: [\r\n            [\r\n                ["^", "\\u00b0"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "\\u00b2"],\r\n                ["3", "\\u00a7", "\\u00b3"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["\\u00df", "?", "\\\\"],\r\n                ["\\u00b4", "`"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "@"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00fc", "\\u00dc"],\r\n                ["+", "*", "~"],\r\n                ["#", "\'"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00f6", "\\u00d6"],\r\n                ["\\u00e4", "\\u00c4"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\u00a6"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u00b5"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["de"]\r\n    };\r\n    this.VKI_layout.Dingbats = {\r\n        name: "Dingbats",\r\n        keys: [\r\n            [\r\n                ["\\u2764", "\\u2765", "\\u2766", "\\u2767"],\r\n                ["\\u278a", "\\u2780", "\\u2776", "\\u2768"],\r\n                ["\\u278b", "\\u2781", "\\u2777", "\\u2769"],\r\n                ["\\u278c", "\\u2782", "\\u2778", "\\u276a"],\r\n                ["\\u278d", "\\u2783", "\\u2779", "\\u276b"],\r\n                ["\\u278e", "\\u2784", "\\u277a", "\\u276c"],\r\n                ["\\u278f", "\\u2785", "\\u277b", "\\u276d"],\r\n                ["\\u2790", "\\u2786", "\\u277c", "\\u276e"],\r\n                ["\\u2791", "\\u2787", "\\u277d", "\\u276f"],\r\n                ["\\u2792", "\\u2788", "\\u277e", "\\u2770"],\r\n                ["\\u2793", "\\u2789", "\\u277f", "\\u2771"],\r\n                ["\\u2795", "\\u2796", "\\u274c", "\\u2797"],\r\n                ["\\u2702", "\\u2704", "\\u2701", "\\u2703"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u2714", "\\u2705", "\\u2713"],\r\n                ["\\u2718", "\\u2715", "\\u2717", "\\u2716"],\r\n                ["\\u271a", "\\u2719", "\\u271b", "\\u271c"],\r\n                ["\\u271d", "\\u271e", "\\u271f", "\\u2720"],\r\n                ["\\u2722", "\\u2723", "\\u2724", "\\u2725"],\r\n                ["\\u2726", "\\u2727", "\\u2728", "\\u2756"],\r\n                ["\\u2729", "\\u272a", "\\u272d", "\\u2730"],\r\n                ["\\u272c", "\\u272b", "\\u272e", "\\u272f"],\r\n                ["\\u2736", "\\u2731", "\\u2732", "\\u2749"],\r\n                ["\\u273b", "\\u273c", "\\u273d", "\\u273e"],\r\n                ["\\u2744", "\\u2745", "\\u2746", "\\u2743"],\r\n                ["\\u2733", "\\u2734", "\\u2735", "\\u2721"],\r\n                ["\\u2737", "\\u2738", "\\u2739", "\\u273a"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u2799", "\\u279a", "\\u2798", "\\u2758"],\r\n                ["\\u27b5", "\\u27b6", "\\u27b4", "\\u2759"],\r\n                ["\\u27b8", "\\u27b9", "\\u27b7", "\\u275a"],\r\n                ["\\u2794", "\\u279c", "\\u27ba", "\\u27bb"],\r\n                ["\\u279d", "\\u279e", "\\u27a1", "\\u2772"],\r\n                ["\\u27a9", "\\u27aa", "\\u27ab", "\\u27ac"],\r\n                ["\\u27a4", "\\u27a3", "\\u27a2", "\\u279b"],\r\n                ["\\u27b3", "\\u27bc", "\\u27bd", "\\u2773"],\r\n                ["\\u27ad", "\\u27ae", "\\u27af", "\\u27b1"],\r\n                ["\\u27a8", "\\u27a6", "\\u27a5", "\\u27a7"],\r\n                ["\\u279f", "\\u27a0", "\\u27be", "\\u27b2"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u270c", "\\u270b", "\\u270a", "\\u270d"],\r\n                ["\\u274f", "\\u2750", "\\u2751", "\\u2752"],\r\n                ["\\u273f", "\\u2740", "\\u2741", "\\u2742"],\r\n                ["\\u2747", "\\u2748", "\\u274a", "\\u274b"],\r\n                ["\\u2757", "\\u2755", "\\u2762", "\\u2763"],\r\n                ["\\u2753", "\\u2754", "\\u27b0", "\\u27bf"],\r\n                ["\\u270f", "\\u2710", "\\u270e", "\\u2774"],\r\n                ["\\u2712", "\\u2711", "\\u274d", "\\u274e"],\r\n                ["\\u2709", "\\u2706", "\\u2708", "\\u2707"],\r\n                ["\\u275b", "\\u275d", "\\u2761", "\\u2775"],\r\n                ["\\u275c", "\\u275e", "\\u275f", "\\u2760"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["AltLk", "AltLk"],\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["\\u078b\\u07a8\\u0788\\u07ac\\u0780\\u07a8\\u0784\\u07a6\\u0790\\u07b0"] = {\r\n        name: "Divehi",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", ")"],\r\n                ["0", "("],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u07ab", "\\u00d7"],\r\n                ["\\u07ae", "\\u2019"],\r\n                ["\\u07a7", "\\u201c"],\r\n                ["\\u07a9", "/"],\r\n                ["\\u07ad", ":"],\r\n                ["\\u078e", "\\u07a4"],\r\n                ["\\u0783", "\\u079c"],\r\n                ["\\u0789", "\\u07a3"],\r\n                ["\\u078c", "\\u07a0"],\r\n                ["\\u0780", "\\u0799"],\r\n                ["\\u078d", "\\u00f7"],\r\n                ["[", "{"],\r\n                ["]", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u07a8", "<"],\r\n                ["\\u07aa", ">"],\r\n                ["\\u07b0", ".", ",", ","],\r\n                ["\\u07a6", "\\u060c"],\r\n                ["\\u07ac", \'"\'],\r\n                ["\\u0788", "\\u07a5"],\r\n                ["\\u0787", "\\u07a2"],\r\n                ["\\u0782", "\\u0798"],\r\n                ["\\u0786", "\\u079a"],\r\n                ["\\u078a", "\\u07a1"],\r\n                ["\\ufdf2", "\\u061b", ";", ";"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["\\u0792", "\\u0796"],\r\n                ["\\u0791", "\\u0795"],\r\n                ["\\u0790", "\\u078f"],\r\n                ["\\u0794", "\\u0797", "\\u200D"],\r\n                ["\\u0785", "\\u079f", "\\u200C"],\r\n                ["\\u078b", "\\u079b", "\\u200E"],\r\n                ["\\u0784", "\\u079D", "\\u200F"],\r\n                ["\\u0781", "\\\\"],\r\n                ["\\u0793", "\\u079e"],\r\n                ["\\u07af", "\\u061f"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["dv"]\r\n    };\r\n    this.VKI_layout.Dvorak = {\r\n        name: "Dvorak",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\'", \'"\'],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["p", "P"],\r\n                ["y", "Y"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["c", "C"],\r\n                ["r", "R"],\r\n                ["l", "L"],\r\n                ["/", "?"],\r\n                ["=", "+"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["o", "O"],\r\n                ["e", "E"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["d", "D"],\r\n                ["h", "H"],\r\n                ["t", "T"],\r\n                ["n", "N"],\r\n                ["s", "S"],\r\n                ["-", "_"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [";", ":"],\r\n                ["q", "Q"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["x", "X"],\r\n                ["b", "B"],\r\n                ["m", "M"],\r\n                ["w", "W"],\r\n                ["v", "V"],\r\n                ["z", "Z"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["\\u0395\\u03bb\\u03bb\\u03b7\\u03bd\\u03b9\\u03ba\\u03ac"] = {\r\n        name: "Greek",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@", "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00a3"],\r\n                ["5", "%", "\\u00a7"],\r\n                ["6", "^", "\\u00b6"],\r\n                ["7", "&"],\r\n                ["8", "*", "\\u00a4"],\r\n                ["9", "(", "\\u00a6"],\r\n                ["0", ")", "\\u00ba"],\r\n                ["-", "_", "\\u00b1"],\r\n                ["=", "+", "\\u00bd"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                [";", ":"],\r\n                ["\\u03c2", "^"],\r\n                ["\\u03b5", "\\u0395"],\r\n                ["\\u03c1", "\\u03a1"],\r\n                ["\\u03c4", "\\u03a4"],\r\n                ["\\u03c5", "\\u03a5"],\r\n                ["\\u03b8", "\\u0398"],\r\n                ["\\u03b9", "\\u0399"],\r\n                ["\\u03bf", "\\u039f"],\r\n                ["\\u03c0", "\\u03a0"],\r\n                ["[", "{", "\\u201c"],\r\n                ["]", "}", "\\u201d"],\r\n                ["\\\\", "|", "\\u00ac"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u03b1", "\\u0391"],\r\n                ["\\u03c3", "\\u03a3"],\r\n                ["\\u03b4", "\\u0394"],\r\n                ["\\u03c6", "\\u03a6"],\r\n                ["\\u03b3", "\\u0393"],\r\n                ["\\u03b7", "\\u0397"],\r\n                ["\\u03be", "\\u039e"],\r\n                ["\\u03ba", "\\u039a"],\r\n                ["\\u03bb", "\\u039b"],\r\n                ["\\u0384", "\\u00a8", "\\u0385"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["\\u03b6", "\\u0396"],\r\n                ["\\u03c7", "\\u03a7"],\r\n                ["\\u03c8", "\\u03a8"],\r\n                ["\\u03c9", "\\u03a9"],\r\n                ["\\u03b2", "\\u0392"],\r\n                ["\\u03bd", "\\u039d"],\r\n                ["\\u03bc", "\\u039c"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["el"]\r\n    };\r\n    this.VKI_layout.Eesti = {\r\n        name: "Estonian",\r\n        keys: [\r\n            [\r\n                ["\\u02C7", "~"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@", "@"],\r\n                ["3", "#", "\\u00A3", "\\u00A3"],\r\n                ["4", "\\u00A4", "$", "$"],\r\n                ["5", "%", "\\u20AC"],\r\n                ["6", "&"],\r\n                ["7", "/", "{", "{"],\r\n                ["8", "(", "[", "["],\r\n                ["9", ")", "]", "]"],\r\n                ["0", "=", "}", "}"],\r\n                ["+", "?", "\\\\", "\\\\"],\r\n                ["\\u00B4", "`"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00FC", "\\u00DC"],\r\n                ["\\u00F5", "\\u00D5", "\\u00A7", "\\u00A7"],\r\n                ["\'", "*", "\\u00BD", "\\u00BD"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u0161", "\\u0160"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00F6", "\\u00D6"],\r\n                ["\\u00E4", "\\u00C4", "^", "^"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|", "|"],\r\n                ["z", "Z", "\\u017E", "\\u017D"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["et"]\r\n    };\r\n    this.VKI_layout["Espa\\u00f1ol"] = {\r\n        name: "Spanish",\r\n        keys: [\r\n            [\r\n                ["\\u00ba", "\\u00aa", "\\\\"],\r\n                ["1", "!", "|"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "\'", "#"],\r\n                ["4", "$", "~"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "&", "\\u00ac"],\r\n                ["7", "/"],\r\n                ["8", "("],\r\n                ["9", ")"],\r\n                ["0", "="],\r\n                ["\'", "?"],\r\n                ["\\u00a1", "\\u00bf"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["`", "^", "["],\r\n                ["+", "*", "]"],\r\n                ["\\u00e7", "\\u00c7", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00f1", "\\u00d1"],\r\n                ["\\u00b4", "\\u00a8", "{"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["es"]\r\n    };\r\n    this.VKI_layout["\\u062f\\u0631\\u06cc"] = {\r\n        name: "Dari",\r\n        keys: [\r\n            [\r\n                ["\\u200D", "\\u00F7", "~"],\r\n                ["\\u06F1", "!", "`"],\r\n                ["\\u06F2", "\\u066C", "@"],\r\n                ["\\u06F3", "\\u066B", "#"],\r\n                ["\\u06F4", "\\u060B", "$"],\r\n                ["\\u06F5", "\\u066A", "%"],\r\n                ["\\u06F6", "\\u00D7", "^"],\r\n                ["\\u06F7", "\\u060C", "&"],\r\n                ["\\u06F8", "*", "\\u2022"],\r\n                ["\\u06F9", ")", "\\u200E"],\r\n                ["\\u06F0", "(", "\\u200F"],\r\n                ["-", "\\u0640", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0636", "\\u0652", "\\u00B0"],\r\n                ["\\u0635", "\\u064C"],\r\n                ["\\u062B", "\\u064D", "\\u20AC"],\r\n                ["\\u0642", "\\u064B", "\\uFD3E"],\r\n                ["\\u0641", "\\u064F", "\\uFD3F"],\r\n                ["\\u063A", "\\u0650", "\\u0656"],\r\n                ["\\u0639", "\\u064E", "\\u0659"],\r\n                ["\\u0647", "\\u0651", "\\u0655"],\r\n                ["\\u062E", "]", "\'"],\r\n                ["\\u062D", "[", \'"\'],\r\n                ["\\u062C", "}", "\\u0681"],\r\n                ["\\u0686", "{", "\\u0685"],\r\n                ["\\\\", "|", "?"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0634", "\\u0624", "\\u069A"],\r\n                ["\\u0633", "\\u0626", "\\u06CD"],\r\n                ["\\u06CC", "\\u064A", "\\u0649"],\r\n                ["\\u0628", "\\u0625", "\\u06D0"],\r\n                ["\\u0644", "\\u0623", "\\u06B7"],\r\n                ["\\u0627", "\\u0622", "\\u0671"],\r\n                ["\\u062A", "\\u0629", "\\u067C"],\r\n                ["\\u0646", "\\u00BB", "\\u06BC"],\r\n                ["\\u0645", "\\u00AB", "\\u06BA"],\r\n                ["\\u06A9", ":", ";"],\r\n                ["\\u06AF", "\\u061B", "\\u06AB"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0638", "\\u0643", "\\u06D2"],\r\n                ["\\u0637", "\\u0653", "\\u0691"],\r\n                ["\\u0632", "\\u0698", "\\u0696"],\r\n                ["\\u0631", "\\u0670", "\\u0693"],\r\n                ["\\u0630", "\\u200C", "\\u0688"],\r\n                ["\\u062F", "\\u0654", "\\u0689"],\r\n                ["\\u067E", "\\u0621", "\\u0679"],\r\n                ["\\u0648", ">", ","],\r\n                [".", "<", "\\u06C7"],\r\n                ["/", "\\u061F", "\\u06C9"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fa-AF"]\r\n    };\r\n    this.VKI_layout["\\u0641\\u0627\\u0631\\u0633\\u06cc"] = {\r\n        name: "Farsi",\r\n        keys: [\r\n            [\r\n                ["\\u067e", "\\u0651 "],\r\n                ["1", "!", "\\u00a1", "\\u00b9"],\r\n                ["2", "@", "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00a4", "\\u00a3"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "^", "\\u00bc"],\r\n                ["7", "&", "\\u00bd"],\r\n                ["8", "*", "\\u00be"],\r\n                ["9", "(", "\\u2018"],\r\n                ["0", ")", "\\u2019"],\r\n                ["-", "_", "\\u00a5"],\r\n                ["=", "+", "\\u00d7", "\\u00f7"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0636", "\\u064e"],\r\n                ["\\u0635", "\\u064b"],\r\n                ["\\u062b", "\\u064f"],\r\n                ["\\u0642", "\\u064c"],\r\n                ["\\u0641", "\\u0644"],\r\n                ["\\u063a", "\\u0625"],\r\n                ["\\u0639", "\\u2018"],\r\n                ["\\u0647", "\\u00f7"],\r\n                ["\\u062e", "\\u00d7"],\r\n                ["\\u062d", "\\u061b"],\r\n                ["\\u062c", "<"],\r\n                ["\\u0686", ">"],\r\n                ["\\u0698", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0634", "\\u0650"],\r\n                ["\\u0633", "\\u064d"],\r\n                ["\\u064a", "]"],\r\n                ["\\u0628", "["],\r\n                ["\\u0644", "\\u0644"],\r\n                ["\\u0627", "\\u0623"],\r\n                ["\\u062a", "\\u0640"],\r\n                ["\\u0646", "\\u060c"],\r\n                ["\\u0645", "\\\\"],\r\n                ["\\u06af", ":"],\r\n                ["\\u0643", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0638", "~"],\r\n                ["\\u0637", "\\u0652"],\r\n                ["\\u0632", "}"],\r\n                ["\\u0631", "{"],\r\n                ["\\u0630", "\\u0644"],\r\n                ["\\u062f", "\\u0622"],\r\n                ["\\u0626", "\\u0621"],\r\n                ["\\u0648", ","],\r\n                [".", "."],\r\n                ["/", "\\u061f"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["fa"]\r\n    };\r\n    this.VKI_layout["F\\u00f8royskt"] = {\r\n        name: "Faeroese",\r\n        keys: [\r\n            [\r\n                ["\\u00BD", "\\u00A7"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00A3"],\r\n                ["4", "\\u00A4", "$"],\r\n                ["5", "%", "\\u20AC"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["+", "?"],\r\n                ["\\u00B4", "`", "|"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00E5", "\\u00C5", "\\u00A8"],\r\n                ["\\u00F0", "\\u00D0", "~"],\r\n                ["\'", "*"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00E6", "\\u00C6"],\r\n                ["\\u00F8", "\\u00D8", "^"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u00B5"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fo"]\r\n    };\r\n    this.VKI_layout["Fran\\u00e7ais"] = {\r\n        name: "French",\r\n        keys: [\r\n            [\r\n                ["\\u00b2", "\\u00b3"],\r\n                ["&", "1"],\r\n                ["\\u00e9", "2", "~"],\r\n                [\'"\', "3", "#"],\r\n                ["\'", "4", "{"],\r\n                ["(", "5", "["],\r\n                ["-", "6", "|"],\r\n                ["\\u00e8", "7", "`"],\r\n                ["_", "8", "\\\\"],\r\n                ["\\u00e7", "9", "^"],\r\n                ["\\u00e0", "0", "@"],\r\n                [")", "\\u00b0", "]"],\r\n                ["=", "+", "}"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["a", "A"],\r\n                ["z", "Z"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["^", "\\u00a8"],\r\n                ["$", "\\u00a3", "\\u00a4"],\r\n                ["*", "\\u03bc"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["q", "Q"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["m", "M"],\r\n                ["\\u00f9", "%"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["w", "W"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                [",", "?"],\r\n                [";", "."],\r\n                [":", "/"],\r\n                ["!", "\\u00a7"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fr"]\r\n    };\r\n    this.VKI_layout.Gaeilge = {\r\n        name: "Irish / Gaelic",\r\n        keys: [\r\n            [\r\n                ["`", "\\u00AC", "\\u00A6", "\\u00A6"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u00A3"],\r\n                ["4", "$", "\\u20AC"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u00E9", "\\u00C9"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y", "\\u00FD", "\\u00DD"],\r\n                ["u", "U", "\\u00FA", "\\u00DA"],\r\n                ["i", "I", "\\u00ED", "\\u00CD"],\r\n                ["o", "O", "\\u00F3", "\\u00D3"],\r\n                ["p", "P"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["#", "~"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00E1", "\\u00C1"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":"],\r\n                ["\'", "@", "\\u00B4", "`"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ga", "gd"]\r\n    };\r\n    this.VKI_layout["\\u0a97\\u0ac1\\u0a9c\\u0ab0\\u0abe\\u0aa4\\u0ac0"] = {\r\n        name: "Gujarati",\r\n        keys: [\r\n            [\r\n                [""],\r\n                ["1", "\\u0A8D", "\\u0AE7"],\r\n                ["2", "\\u0AC5", "\\u0AE8"],\r\n                ["3", "\\u0ACD\\u0AB0", "\\u0AE9"],\r\n                ["4", "\\u0AB0\\u0ACD", "\\u0AEA"],\r\n                ["5", "\\u0A9C\\u0ACD\\u0A9E", "\\u0AEB"],\r\n                ["6", "\\u0AA4\\u0ACD\\u0AB0", "\\u0AEC"],\r\n                ["7", "\\u0A95\\u0ACD\\u0AB7", "\\u0AED"],\r\n                ["8", "\\u0AB6\\u0ACD\\u0AB0", "\\u0AEE"],\r\n                ["9", "(", "\\u0AEF"],\r\n                ["0", ")", "\\u0AE6"],\r\n                ["-", "\\u0A83"],\r\n                ["\\u0AC3", "\\u0A8B", "\\u0AC4", "\\u0AE0"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0ACC", "\\u0A94"],\r\n                ["\\u0AC8", "\\u0A90"],\r\n                ["\\u0ABE", "\\u0A86"],\r\n                ["\\u0AC0", "\\u0A88"],\r\n                ["\\u0AC2", "\\u0A8A"],\r\n                ["\\u0AAC", "\\u0AAD"],\r\n                ["\\u0AB9", "\\u0A99"],\r\n                ["\\u0A97", "\\u0A98"],\r\n                ["\\u0AA6", "\\u0AA7"],\r\n                ["\\u0A9C", "\\u0A9D"],\r\n                ["\\u0AA1", "\\u0AA2"],\r\n                ["\\u0ABC", "\\u0A9E"],\r\n                ["\\u0AC9", "\\u0A91"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0ACB", "\\u0A93"],\r\n                ["\\u0AC7", "\\u0A8F"],\r\n                ["\\u0ACD", "\\u0A85"],\r\n                ["\\u0ABF", "\\u0A87"],\r\n                ["\\u0AC1", "\\u0A89"],\r\n                ["\\u0AAA", "\\u0AAB"],\r\n                ["\\u0AB0"],\r\n                ["\\u0A95", "\\u0A96"],\r\n                ["\\u0AA4", "\\u0AA5"],\r\n                ["\\u0A9A", "\\u0A9B"],\r\n                ["\\u0A9F", "\\u0AA0"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [""],\r\n                ["\\u0A82", "\\u0A81", "", "\\u0AD0"],\r\n                ["\\u0AAE", "\\u0AA3"],\r\n                ["\\u0AA8"],\r\n                ["\\u0AB5"],\r\n                ["\\u0AB2", "\\u0AB3"],\r\n                ["\\u0AB8", "\\u0AB6"],\r\n                [",", "\\u0AB7"],\r\n                [".", "\\u0964", "\\u0965", "\\u0ABD"],\r\n                ["\\u0AAF"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["gu"]\r\n    };\r\n    this.VKI_layout["\\u05e2\\u05d1\\u05e8\\u05d9\\u05ea"] = {\r\n        name: "Hebrew",\r\n        keys: [\r\n            [\r\n                ["~", "`"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$", "\\u20aa"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", ")"],\r\n                ["0", "("],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["/", "Q"],\r\n                ["\'", "W"],\r\n                ["\\u05e7", "E", "\\u20ac"],\r\n                ["\\u05e8", "R"],\r\n                ["\\u05d0", "T"],\r\n                ["\\u05d8", "Y"],\r\n                ["\\u05d5", "U", "\\u05f0"],\r\n                ["\\u05df", "I"],\r\n                ["\\u05dd", "O"],\r\n                ["\\u05e4", "P"],\r\n                ["\\\\", "|"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u05e9", "A"],\r\n                ["\\u05d3", "S"],\r\n                ["\\u05d2", "D"],\r\n                ["\\u05db", "F"],\r\n                ["\\u05e2", "G"],\r\n                ["\\u05d9", "H", "\\u05f2"],\r\n                ["\\u05d7", "J", "\\u05f1"],\r\n                ["\\u05dc", "K"],\r\n                ["\\u05da", "L"],\r\n                ["\\u05e3", ":"],\r\n                [",", \'"\'],\r\n                ["]", "}"],\r\n                ["[", "{"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u05d6", "Z"],\r\n                ["\\u05e1", "X"],\r\n                ["\\u05d1", "C"],\r\n                ["\\u05d4", "V"],\r\n                ["\\u05e0", "B"],\r\n                ["\\u05de", "N"],\r\n                ["\\u05e6", "M"],\r\n                ["\\u05ea", ">"],\r\n                ["\\u05e5", "<"],\r\n                [".", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["he"]\r\n    };\r\n    this.VKI_layout["\\u0926\\u0947\\u0935\\u0928\\u093e\\u0917\\u0930\\u0940"] = {\r\n        name: "Devanagari",\r\n        keys: [\r\n            [\r\n                ["\\u094A", "\\u0912"],\r\n                ["1", "\\u090D", "\\u0967"],\r\n                ["2", "\\u0945", "\\u0968"],\r\n                ["3", "\\u094D\\u0930", "\\u0969"],\r\n                ["4", "\\u0930\\u094D", "\\u096A"],\r\n                ["5", "\\u091C\\u094D\\u091E", "\\u096B"],\r\n                ["6", "\\u0924\\u094D\\u0930", "\\u096C"],\r\n                ["7", "\\u0915\\u094D\\u0937", "\\u096D"],\r\n                ["8", "\\u0936\\u094D\\u0930", "\\u096E"],\r\n                ["9", "(", "\\u096F"],\r\n                ["0", ")", "\\u0966"],\r\n                ["-", "\\u0903"],\r\n                ["\\u0943", "\\u090B", "\\u0944", "\\u0960"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u094C", "\\u0914"],\r\n                ["\\u0948", "\\u0910"],\r\n                ["\\u093E", "\\u0906"],\r\n                ["\\u0940", "\\u0908", "\\u0963", "\\u0961"],\r\n                ["\\u0942", "\\u090A"],\r\n                ["\\u092C", "\\u092D"],\r\n                ["\\u0939", "\\u0919"],\r\n                ["\\u0917", "\\u0918", "\\u095A"],\r\n                ["\\u0926", "\\u0927"],\r\n                ["\\u091C", "\\u091D", "\\u095B"],\r\n                ["\\u0921", "\\u0922", "\\u095C", "\\u095D"],\r\n                ["\\u093C", "\\u091E"],\r\n                ["\\u0949", "\\u0911"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u094B", "\\u0913"],\r\n                ["\\u0947", "\\u090F"],\r\n                ["\\u094D", "\\u0905"],\r\n                ["\\u093F", "\\u0907", "\\u0962", "\\u090C"],\r\n                ["\\u0941", "\\u0909"],\r\n                ["\\u092A", "\\u092B", "", "\\u095E"],\r\n                ["\\u0930", "\\u0931"],\r\n                ["\\u0915", "\\u0916", "\\u0958", "\\u0959"],\r\n                ["\\u0924", "\\u0925"],\r\n                ["\\u091A", "\\u091B", "\\u0952"],\r\n                ["\\u091F", "\\u0920", "", "\\u0951"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0946", "\\u090E", "\\u0953"],\r\n                ["\\u0902", "\\u0901", "", "\\u0950"],\r\n                ["\\u092E", "\\u0923", "\\u0954"],\r\n                ["\\u0928", "\\u0929"],\r\n                ["\\u0935", "\\u0934"],\r\n                ["\\u0932", "\\u0933"],\r\n                ["\\u0938", "\\u0936"],\r\n                [",", "\\u0937", "\\u0970"],\r\n                [".", "\\u0964", "\\u0965", "\\u093D"],\r\n                ["\\u092F", "\\u095F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["hi-Deva"]\r\n    };\r\n    this.VKI_layout["\\u0939\\u093f\\u0902\\u0926\\u0940"] = {\r\n        name: "Hindi",\r\n        keys: [\r\n            [\r\n                ["\\u200d", "\\u200c", "`", "~"],\r\n                ["1", "\\u090D", "\\u0967", "!"],\r\n                ["2", "\\u0945", "\\u0968", "@"],\r\n                ["3", "\\u094D\\u0930", "\\u0969", "#"],\r\n                ["4", "\\u0930\\u094D", "\\u096A", "$"],\r\n                ["5", "\\u091C\\u094D\\u091E", "\\u096B", "%"],\r\n                ["6", "\\u0924\\u094D\\u0930", "\\u096C", "^"],\r\n                ["7", "\\u0915\\u094D\\u0937", "\\u096D", "&"],\r\n                ["8", "\\u0936\\u094D\\u0930", "\\u096E", "*"],\r\n                ["9", "(", "\\u096F", "("],\r\n                ["0", ")", "\\u0966", ")"],\r\n                ["-", "\\u0903", "-", "_"],\r\n                ["\\u0943", "\\u090B", "=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u094C", "\\u0914"],\r\n                ["\\u0948", "\\u0910"],\r\n                ["\\u093E", "\\u0906"],\r\n                ["\\u0940", "\\u0908"],\r\n                ["\\u0942", "\\u090A"],\r\n                ["\\u092C", "\\u092D"],\r\n                ["\\u0939", "\\u0919"],\r\n                ["\\u0917", "\\u0918"],\r\n                ["\\u0926", "\\u0927"],\r\n                ["\\u091C", "\\u091D"],\r\n                ["\\u0921", "\\u0922", "[", "{"],\r\n                ["\\u093C", "\\u091E", "]", "}"],\r\n                ["\\u0949", "\\u0911", "\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u094B", "\\u0913"],\r\n                ["\\u0947", "\\u090F"],\r\n                ["\\u094D", "\\u0905"],\r\n                ["\\u093F", "\\u0907"],\r\n                ["\\u0941", "\\u0909"],\r\n                ["\\u092A", "\\u092B"],\r\n                ["\\u0930", "\\u0931"],\r\n                ["\\u0915", "\\u0916"],\r\n                ["\\u0924", "\\u0925"],\r\n                ["\\u091A", "\\u091B", ";", ":"],\r\n                ["\\u091F", "\\u0920", "\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [""],\r\n                ["\\u0902", "\\u0901", "", "\\u0950"],\r\n                ["\\u092E", "\\u0923"],\r\n                ["\\u0928"],\r\n                ["\\u0935"],\r\n                ["\\u0932", "\\u0933"],\r\n                ["\\u0938", "\\u0936"],\r\n                [",", "\\u0937", ",", "<"],\r\n                [".", "\\u0964", ".", ">"],\r\n                ["\\u092F", "\\u095F", "/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["hi"]\r\n    };\r\n    this.VKI_layout.Hrvatski = {\r\n        name: "Croatian",\r\n        keys: this.VKI_layout.Bosanski.keys.slice(0),\r\n        lang: ["hr"]\r\n    };\r\n    this.VKI_layout["\\u0540\\u0561\\u0575\\u0565\\u0580\\u0565\\u0576 \\u0561\\u0580\\u0565\\u0582\\u0574\\u0578\\u0582\\u057f\\u0584"] = {\r\n        name: "Western Armenian",\r\n        keys: [\r\n            [\r\n                ["\\u055D", "\\u055C"],\r\n                [":", "1"],\r\n                ["\\u0571", "\\u0541"],\r\n                ["\\u0575", "\\u0545"],\r\n                ["\\u055B", "3"],\r\n                [",", "4"],\r\n                ["-", "9"],\r\n                [".", "\\u0587"],\r\n                ["\\u00AB", "("],\r\n                ["\\u00BB", ")"],\r\n                ["\\u0585", "\\u0555"],\r\n                ["\\u057C", "\\u054C"],\r\n                ["\\u056A", "\\u053A"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u056D", "\\u053D"],\r\n                ["\\u057E", "\\u054E"],\r\n                ["\\u0567", "\\u0537"],\r\n                ["\\u0580", "\\u0550"],\r\n                ["\\u0564", "\\u0534"],\r\n                ["\\u0565", "\\u0535"],\r\n                ["\\u0568", "\\u0538"],\r\n                ["\\u056B", "\\u053B"],\r\n                ["\\u0578", "\\u0548"],\r\n                ["\\u0562", "\\u0532"],\r\n                ["\\u0579", "\\u0549"],\r\n                ["\\u057B", "\\u054B"],\r\n                ["\'", "\\u055E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0561", "\\u0531"],\r\n                ["\\u057D", "\\u054D"],\r\n                ["\\u057F", "\\u054F"],\r\n                ["\\u0586", "\\u0556"],\r\n                ["\\u056F", "\\u053F"],\r\n                ["\\u0570", "\\u0540"],\r\n                ["\\u0573", "\\u0543"],\r\n                ["\\u0584", "\\u0554"],\r\n                ["\\u056C", "\\u053C"],\r\n                ["\\u0569", "\\u0539"],\r\n                ["\\u0583", "\\u0553"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0566", "\\u0536"],\r\n                ["\\u0581", "\\u0551"],\r\n                ["\\u0563", "\\u0533"],\r\n                ["\\u0582", "\\u0552"],\r\n                ["\\u057A", "\\u054A"],\r\n                ["\\u0576", "\\u0546"],\r\n                ["\\u0574", "\\u0544"],\r\n                ["\\u0577", "\\u0547"],\r\n                ["\\u0572", "\\u0542"],\r\n                ["\\u056E", "\\u053E"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["hy-arevmda"]\r\n    };\r\n    this.VKI_layout["\\u0540\\u0561\\u0575\\u0565\\u0580\\u0565\\u0576 \\u0561\\u0580\\u0565\\u0582\\u0565\\u056c\\u0584"] = {\r\n        name: "Eastern Armenian",\r\n        keys: [\r\n            [\r\n                ["\\u055D", "\\u055C"],\r\n                [":", "1"],\r\n                ["\\u0571", "\\u0541"],\r\n                ["\\u0575", "\\u0545"],\r\n                ["\\u055B", "3"],\r\n                [",", "4"],\r\n                ["-", "9"],\r\n                [".", "\\u0587"],\r\n                ["\\u00AB", "("],\r\n                ["\\u00BB", ")"],\r\n                ["\\u0585", "\\u0555"],\r\n                ["\\u057C", "\\u054C"],\r\n                ["\\u056A", "\\u053A"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u056D", "\\u053D"],\r\n                ["\\u0582", "\\u0552"],\r\n                ["\\u0567", "\\u0537"],\r\n                ["\\u0580", "\\u0550"],\r\n                ["\\u057F", "\\u054F"],\r\n                ["\\u0565", "\\u0535"],\r\n                ["\\u0568", "\\u0538"],\r\n                ["\\u056B", "\\u053B"],\r\n                ["\\u0578", "\\u0548"],\r\n                ["\\u057A", "\\u054A"],\r\n                ["\\u0579", "\\u0549"],\r\n                ["\\u057B", "\\u054B"],\r\n                ["\'", "\\u055E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0561", "\\u0531"],\r\n                ["\\u057D", "\\u054D"],\r\n                ["\\u0564", "\\u0534"],\r\n                ["\\u0586", "\\u0556"],\r\n                ["\\u0584", "\\u0554"],\r\n                ["\\u0570", "\\u0540"],\r\n                ["\\u0573", "\\u0543"],\r\n                ["\\u056F", "\\u053F"],\r\n                ["\\u056C", "\\u053C"],\r\n                ["\\u0569", "\\u0539"],\r\n                ["\\u0583", "\\u0553"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0566", "\\u0536"],\r\n                ["\\u0581", "\\u0551"],\r\n                ["\\u0563", "\\u0533"],\r\n                ["\\u057E", "\\u054E"],\r\n                ["\\u0562", "\\u0532"],\r\n                ["\\u0576", "\\u0546"],\r\n                ["\\u0574", "\\u0544"],\r\n                ["\\u0577", "\\u0547"],\r\n                ["\\u0572", "\\u0542"],\r\n                ["\\u056E", "\\u053E"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["hy"]\r\n    };\r\n    this.VKI_layout["\\u00cdslenska"] = {\r\n        name: "Icelandic",\r\n        keys: [\r\n            [\r\n                ["\\u00B0", "\\u00A8", "\\u00B0"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%", "\\u20AC"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["\\u00F6", "\\u00D6", "\\\\"],\r\n                ["-", "_"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "@"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00F0", "\\u00D0"],\r\n                ["\'", "?", "~"],\r\n                ["+", "*", "`"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00E6", "\\u00C6"],\r\n                ["\\u00B4", "\'", "^"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u00B5"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["\\u00FE", "\\u00DE"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["is"]\r\n    };\r\n    this.VKI_layout.Italiano = {\r\n        name: "Italian",\r\n        keys: [\r\n            [\r\n                ["\\\\", "|"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u00a3"],\r\n                ["4", "$", "\\u20ac"],\r\n                ["5", "%"],\r\n                ["6", "&"],\r\n                ["7", "/"],\r\n                ["8", "("],\r\n                ["9", ")"],\r\n                ["0", "="],\r\n                ["\'", "?"],\r\n                ["\\u00ec", "^"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00e8", "\\u00e9", "[", "{"],\r\n                ["+", "*", "]", "}"],\r\n                ["\\u00f9", "\\u00a7"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00f2", "\\u00e7", "@"],\r\n                ["\\u00e0", "\\u00b0", "#"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["it"]\r\n    };\r\n    this.VKI_layout["\\u65e5\\u672c\\u8a9e"] = {\r\n        name: "Japanese Hiragana/Katakana",\r\n        keys: [\r\n            [\r\n                ["\\uff5e"],\r\n                ["\\u306c", "\\u30cc"],\r\n                ["\\u3075", "\\u30d5"],\r\n                ["\\u3042", "\\u30a2", "\\u3041", "\\u30a1"],\r\n                ["\\u3046", "\\u30a6", "\\u3045", "\\u30a5"],\r\n                ["\\u3048", "\\u30a8", "\\u3047", "\\u30a7"],\r\n                ["\\u304a", "\\u30aa", "\\u3049", "\\u30a9"],\r\n                ["\\u3084", "\\u30e4", "\\u3083", "\\u30e3"],\r\n                ["\\u3086", "\\u30e6", "\\u3085", "\\u30e5"],\r\n                ["\\u3088", "\\u30e8", "\\u3087", "\\u30e7"],\r\n                ["\\u308f", "\\u30ef", "\\u3092", "\\u30f2"],\r\n                ["\\u307b", "\\u30db", "\\u30fc", "\\uff1d"],\r\n                ["\\u3078", "\\u30d8", "\\uff3e", "\\uff5e"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u305f", "\\u30bf"],\r\n                ["\\u3066", "\\u30c6"],\r\n                ["\\u3044", "\\u30a4", "\\u3043", "\\u30a3"],\r\n                ["\\u3059", "\\u30b9"],\r\n                ["\\u304b", "\\u30ab"],\r\n                ["\\u3093", "\\u30f3"],\r\n                ["\\u306a", "\\u30ca"],\r\n                ["\\u306b", "\\u30cb"],\r\n                ["\\u3089", "\\u30e9"],\r\n                ["\\u305b", "\\u30bb"],\r\n                ["\\u3001", "\\u3001", "\\uff20", "\\u2018"],\r\n                ["\\u3002", "\\u3002", "\\u300c", "\\uff5b"],\r\n                ["\\uffe5", "", "", "\\uff0a"],\r\n                ["\\u309B", \'"\', "\\uffe5", "\\uff5c"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u3061", "\\u30c1"],\r\n                ["\\u3068", "\\u30c8"],\r\n                ["\\u3057", "\\u30b7"],\r\n                ["\\u306f", "\\u30cf"],\r\n                ["\\u304d", "\\u30ad"],\r\n                ["\\u304f", "\\u30af"],\r\n                ["\\u307e", "\\u30de"],\r\n                ["\\u306e", "\\u30ce"],\r\n                ["\\u308c", "\\u30ec", "\\uff1b", "\\uff0b"],\r\n                ["\\u3051", "\\u30b1", "\\uff1a", "\\u30f6"],\r\n                ["\\u3080", "\\u30e0", "\\u300d", "\\uff5d"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u3064", "\\u30c4"],\r\n                ["\\u3055", "\\u30b5"],\r\n                ["\\u305d", "\\u30bd"],\r\n                ["\\u3072", "\\u30d2"],\r\n                ["\\u3053", "\\u30b3"],\r\n                ["\\u307f", "\\u30df"],\r\n                ["\\u3082", "\\u30e2"],\r\n                ["\\u306d", "\\u30cd", "\\u3001", "\\uff1c"],\r\n                ["\\u308b", "\\u30eb", "\\u3002", "\\uff1e"],\r\n                ["\\u3081", "\\u30e1", "\\u30fb", "\\uff1f"],\r\n                ["\\u308d", "\\u30ed", "", "\\uff3f"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["AltLk", "AltLk"],\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["ja"]\r\n    };\r\n    this.VKI_layout["\\u10e5\\u10d0\\u10e0\\u10d7\\u10e3\\u10da\\u10d8"] = {\r\n        name: "Georgian",\r\n        keys: [\r\n            [\r\n                ["\\u201E", "\\u201C"],\r\n                ["!", "1"],\r\n                ["?", "2"],\r\n                ["\\u2116", "3"],\r\n                ["\\u00A7", "4"],\r\n                ["%", "5"],\r\n                [":", "6"],\r\n                [".", "7"],\r\n                [";", "8"],\r\n                [",", "9"],\r\n                ["/", "0"],\r\n                ["\\u2013", "-"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u10E6", "\\u10E6"],\r\n                ["\\u10EF", "\\u10EF"],\r\n                ["\\u10E3", "\\u10E3"],\r\n                ["\\u10D9", "\\u10D9"],\r\n                ["\\u10D4", "\\u10D4", "\\u10F1"],\r\n                ["\\u10DC", "\\u10DC"],\r\n                ["\\u10D2", "\\u10D2"],\r\n                ["\\u10E8", "\\u10E8"],\r\n                ["\\u10EC", "\\u10EC"],\r\n                ["\\u10D6", "\\u10D6"],\r\n                ["\\u10EE", "\\u10EE", "\\u10F4"],\r\n                ["\\u10EA", "\\u10EA"],\r\n                ["(", ")"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u10E4", "\\u10E4", "\\u10F6"],\r\n                ["\\u10EB", "\\u10EB"],\r\n                ["\\u10D5", "\\u10D5", "\\u10F3"],\r\n                ["\\u10D7", "\\u10D7"],\r\n                ["\\u10D0", "\\u10D0"],\r\n                ["\\u10DE", "\\u10DE"],\r\n                ["\\u10E0", "\\u10E0"],\r\n                ["\\u10DD", "\\u10DD"],\r\n                ["\\u10DA", "\\u10DA"],\r\n                ["\\u10D3", "\\u10D3"],\r\n                ["\\u10DF", "\\u10DF"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u10ED", "\\u10ED"],\r\n                ["\\u10E9", "\\u10E9"],\r\n                ["\\u10E7", "\\u10E7"],\r\n                ["\\u10E1", "\\u10E1"],\r\n                ["\\u10DB", "\\u10DB"],\r\n                ["\\u10D8", "\\u10D8", "\\u10F2"],\r\n                ["\\u10E2", "\\u10E2"],\r\n                ["\\u10E5", "\\u10E5"],\r\n                ["\\u10D1", "\\u10D1"],\r\n                ["\\u10F0", "\\u10F0", "\\u10F5"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ka"]\r\n    };\r\n    this.VKI_layout["\\u049a\\u0430\\u0437\\u0430\\u049b\\u0448\\u0430"] = {\r\n        name: "Kazakh",\r\n        keys: [\r\n            [\r\n                ["(", ")"],\r\n                [\'"\', "!"],\r\n                ["\\u04d9", "\\u04d8"],\r\n                ["\\u0456", "\\u0406"],\r\n                ["\\u04a3", "\\u04a2"],\r\n                ["\\u0493", "\\u0492"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["\\u04af", "\\u04ae"],\r\n                ["\\u04b1", "\\u04b0"],\r\n                ["\\u049b", "\\u049a"],\r\n                ["\\u04e9", "\\u04e8"],\r\n                ["\\u04bb", "\\u04ba"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044D", "\\u042D"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044E", "\\u042E"],\r\n                ["\\u2116", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["kk"]\r\n    };\r\n    this.VKI_layout["\\u1797\\u17b6\\u179f\\u17b6\\u1781\\u17d2\\u1798\\u17c2\\u179a"] = {\r\n        name: "Khmer",\r\n        keys: [\r\n            [\r\n                ["\\u00AB", "\\u00BB", "\\u200D"],\r\n                ["\\u17E1", "!", "\\u200C", "\\u17F1"],\r\n                ["\\u17E2", "\\u17D7", "@", "\\u17F2"],\r\n                ["\\u17E3", \'"\', "\\u17D1", "\\u17F3"],\r\n                ["\\u17E4", "\\u17DB", "$", "\\u17F4"],\r\n                ["\\u17E5", "%", "\\u20AC", "\\u17F5"],\r\n                ["\\u17E6", "\\u17CD", "\\u17D9", "\\u17F6"],\r\n                ["\\u17E7", "\\u17D0", "\\u17DA", "\\u17F7"],\r\n                ["\\u17E8", "\\u17CF", "*", "\\u17F8"],\r\n                ["\\u17E9", "(", "{", "\\u17F9"],\r\n                ["\\u17E0", ")", "}", "\\u17F0"],\r\n                ["\\u17A5", "\\u17CC", "x"],\r\n                ["\\u17B2", "=", "\\u17CE"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u1786", "\\u1788", "\\u17DC", "\\u19E0"],\r\n                ["\\u17B9", "\\u17BA", "\\u17DD", "\\u19E1"],\r\n                ["\\u17C1", "\\u17C2", "\\u17AF", "\\u19E2"],\r\n                ["\\u179A", "\\u17AC", "\\u17AB", "\\u19E3"],\r\n                ["\\u178F", "\\u1791", "\\u17A8", "\\u19E4"],\r\n                ["\\u1799", "\\u17BD", "\\u1799\\u17BE\\u1784", "\\u19E5"],\r\n                ["\\u17BB", "\\u17BC", "", "\\u19E6"],\r\n                ["\\u17B7", "\\u17B8", "\\u17A6", "\\u19E7"],\r\n                ["\\u17C4", "\\u17C5", "\\u17B1", "\\u19E8"],\r\n                ["\\u1795", "\\u1797", "\\u17B0", "\\u19E9"],\r\n                ["\\u17C0", "\\u17BF", "\\u17A9", "\\u19EA"],\r\n                ["\\u17AA", "\\u17A7", "\\u17B3", "\\u19EB"],\r\n                ["\\u17AE", "\\u17AD", "\\\\"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u17B6", "\\u17B6\\u17C6", "\\u17B5", "\\u19EC"],\r\n                ["\\u179F", "\\u17C3", "", "\\u19ED"],\r\n                ["\\u178A", "\\u178C", "\\u17D3", "\\u19EE"],\r\n                ["\\u1790", "\\u1792", "", "\\u19EF"],\r\n                ["\\u1784", "\\u17A2", "\\u17A4", "\\u19F0"],\r\n                ["\\u17A0", "\\u17C7", "\\u17A3", "\\u19F1"],\r\n                ["\\u17D2", "\\u1789", "\\u17B4", "\\u19F2"],\r\n                ["\\u1780", "\\u1782", "\\u179D", "\\u19F3"],\r\n                ["\\u179B", "\\u17A1", "\\u17D8", "\\u19F4"],\r\n                ["\\u17BE", "\\u17C4\\u17C7", "\\u17D6", "\\u19F5"],\r\n                ["\\u17CB", "\\u17C9", "\\u17C8", "\\u19F6"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u178B", "\\u178D", "|", "\\u19F7"],\r\n                ["\\u1781", "\\u1783", "\\u1781\\u17D2\\u1789\\u17BB\\u17C6", "\\u19F8"],\r\n                ["\\u1785", "\\u1787", "-", "\\u19F9"],\r\n                ["\\u179C", "\\u17C1\\u17C7", "+", "\\u19FA"],\r\n                ["\\u1794", "\\u1796", "\\u179E", "\\u19FB"],\r\n                ["\\u1793", "\\u178E", "[", "\\u19FC"],\r\n                ["\\u1798", "\\u17C6", "]", "\\u19FD"],\r\n                ["\\u17BB\\u17C6", "\\u17BB\\u17C7", ",", "\\u19FE"],\r\n                ["\\u17D4", "\\u17D5", ".", "\\u19FF"],\r\n                ["\\u17CA", "?", "/"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["\\u200B", " ", "\\u00A0", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["km"]\r\n    };\r\n    this.VKI_layout["\\u0c95\\u0ca8\\u0ccd\\u0ca8\\u0ca1"] = {\r\n        name: "Kannada",\r\n        keys: [\r\n            [\r\n                ["\\u0CCA", "\\u0C92"],\r\n                ["1", "", "\\u0CE7"],\r\n                ["2", "", "\\u0CE8"],\r\n                ["3", "\\u0CCD\\u0CB0", "\\u0CE9"],\r\n                ["4", "\\u0CB0\\u0CCD", "\\u0CEA"],\r\n                ["5", "\\u0C9C\\u0CCD\\u0C9E", "\\u0CEB"],\r\n                ["6", "\\u0CA4\\u0CCD\\u0CB0", "\\u0CEC"],\r\n                ["7", "\\u0C95\\u0CCD\\u0CB7", "\\u0CED"],\r\n                ["8", "\\u0CB6\\u0CCD\\u0CB0", "\\u0CEE"],\r\n                ["9", "(", "\\u0CEF"],\r\n                ["0", ")", "\\u0CE6"],\r\n                ["-", "\\u0C83"],\r\n                ["\\u0CC3", "\\u0C8B", "\\u0CC4", "\\u0CE0"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0CCC", "\\u0C94"],\r\n                ["\\u0CC8", "\\u0C90", "\\u0CD6"],\r\n                ["\\u0CBE", "\\u0C86"],\r\n                ["\\u0CC0", "\\u0C88", "", "\\u0CE1"],\r\n                ["\\u0CC2", "\\u0C8A"],\r\n                ["\\u0CAC", "\\u0CAD"],\r\n                ["\\u0CB9", "\\u0C99"],\r\n                ["\\u0C97", "\\u0C98"],\r\n                ["\\u0CA6", "\\u0CA7"],\r\n                ["\\u0C9C", "\\u0C9D"],\r\n                ["\\u0CA1", "\\u0CA2"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0CCB", "\\u0C93"],\r\n                ["\\u0CC7", "\\u0C8F", "\\u0CD5"],\r\n                ["\\u0CCD", "\\u0C85"],\r\n                ["\\u0CBF", "\\u0C87", "", "\\u0C8C"],\r\n                ["\\u0CC1", "\\u0C89"],\r\n                ["\\u0CAA", "\\u0CAB", "", "\\u0CDE"],\r\n                ["\\u0CB0", "\\u0CB1"],\r\n                ["\\u0C95", "\\u0C96"],\r\n                ["\\u0CA4", "\\u0CA5"],\r\n                ["\\u0C9A", "\\u0C9B"],\r\n                ["\\u0C9F", "\\u0CA0"],\r\n                ["", "\\u0C9E"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0CC6", "\\u0C8F"],\r\n                ["\\u0C82"],\r\n                ["\\u0CAE", "\\u0CA3"],\r\n                ["\\u0CA8"],\r\n                ["\\u0CB5"],\r\n                ["\\u0CB2", "\\u0CB3"],\r\n                ["\\u0CB8", "\\u0CB6"],\r\n                [",", "\\u0CB7"],\r\n                [".", "|"],\r\n                ["\\u0CAF"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["kn"]\r\n    };\r\n    this.VKI_layout["\\ud55c\\uad6d\\uc5b4"] = {\r\n        name: "Korean",\r\n        keys: [\r\n            [\r\n                ["`", "~", "`", "~"],\r\n                ["1", "!", "1", "!"],\r\n                ["2", "@", "2", "@"],\r\n                ["3", "#", "3", "#"],\r\n                ["4", "$", "4", "$"],\r\n                ["5", "%", "5", "%"],\r\n                ["6", "^", "6", "^"],\r\n                ["7", "&", "7", "&"],\r\n                ["8", "*", "8", "*"],\r\n                ["9", ")", "9", ")"],\r\n                ["0", "(", "0", "("],\r\n                ["-", "_", "-", "_"],\r\n                ["=", "+", "=", "+"],\r\n                ["\\u20A9", "|", "\\u20A9", "|"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u1107", "\\u1108", "q", "Q"],\r\n                ["\\u110C", "\\u110D", "w", "W"],\r\n                ["\\u1103", "\\u1104", "e", "E"],\r\n                ["\\u1100", "\\u1101", "r", "R"],\r\n                ["\\u1109", "\\u110A", "t", "T"],\r\n                ["\\u116D", "", "y", "Y"],\r\n                ["\\u1167", "", "u", "U"],\r\n                ["\\u1163", "", "i", "I"],\r\n                ["\\u1162", "\\u1164", "o", "O"],\r\n                ["\\u1166", "\\u1168", "p", "P"],\r\n                ["[", "{", "[", "{"],\r\n                ["]", "}", "]", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u1106", "", "a", "A"],\r\n                ["\\u1102", "", "s", "S"],\r\n                ["\\u110B", "", "d", "D"],\r\n                ["\\u1105", "", "f", "F"],\r\n                ["\\u1112", "", "g", "G"],\r\n                ["\\u1169", "", "h", "H"],\r\n                ["\\u1165", "", "j", "J"],\r\n                ["\\u1161", "", "k", "K"],\r\n                ["\\u1175", "", "l", "L"],\r\n                [";", ":", ";", ":"],\r\n                ["\'", \'"\', "\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u110F", "", "z", "Z"],\r\n                ["\\u1110", "", "x", "X"],\r\n                ["\\u110E", "", "c", "C"],\r\n                ["\\u1111", "", "v", "V"],\r\n                ["\\u1172", "", "b", "B"],\r\n                ["\\u116E", "", "n", "N"],\r\n                ["\\u1173", "", "m", "M"],\r\n                [",", "<", ",", "<"],\r\n                [".", ">", ".", ">"],\r\n                ["/", "?", "/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Kor", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["ko"]\r\n    };\r\n    this.VKI_layout["Kurd\\u00ee"] = {\r\n        name: "Kurdish",\r\n        keys: [\r\n            [\r\n                ["\\u20ac", "~"],\r\n                ["\\u0661", "!"],\r\n                ["\\u0662", "@"],\r\n                ["\\u0663", "#"],\r\n                ["\\u0664", "$"],\r\n                ["\\u0665", "%"],\r\n                ["\\u0666", "^"],\r\n                ["\\u0667", "&"],\r\n                ["\\u0668", "*"],\r\n                ["\\u0669", "("],\r\n                ["\\u0660", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0642", "`"],\r\n                ["\\u0648", "\\u0648\\u0648"],\r\n                ["\\u06d5", "\\u064a"],\r\n                ["\\u0631", "\\u0695"],\r\n                ["\\u062a", "\\u0637"],\r\n                ["\\u06cc", "\\u06ce"],\r\n                ["\\u0626", "\\u0621"],\r\n                ["\\u062d", "\\u0639"],\r\n                ["\\u06c6", "\\u0624"],\r\n                ["\\u067e", "\\u062b"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0627", "\\u0622"],\r\n                ["\\u0633", "\\u0634"],\r\n                ["\\u062f", "\\u0630"],\r\n                ["\\u0641", "\\u0625"],\r\n                ["\\u06af", "\\u063a"],\r\n                ["\\u0647", "\\u200c"],\r\n                ["\\u0698", "\\u0623"],\r\n                ["\\u06a9", "\\u0643"],\r\n                ["\\u0644", "\\u06b5"],\r\n                ["\\u061b", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0632", "\\u0636"],\r\n                ["\\u062e", "\\u0635"],\r\n                ["\\u062c", "\\u0686"],\r\n                ["\\u06a4", "\\u0638"],\r\n                ["\\u0628", "\\u0649"],\r\n                ["\\u0646", "\\u0629"],\r\n                ["\\u0645", "\\u0640"],\r\n                ["\\u060c", "<"],\r\n                [".", ">"],\r\n                ["/", "\\u061f"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["ku"]\r\n    };\r\n    this.VKI_layout["\\u041a\\u044b\\u0440\\u0433\\u044b\\u0437\\u0447\\u0430"] = {\r\n        name: "Kyrgyz",\r\n        keys: [\r\n            [\r\n                ["\\u0451", "\\u0401"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423", "\\u04AF", "\\u04AE"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D", "\\u04A3", "\\u04A2"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E", "\\u04E9", "\\u04E8"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044D", "\\u042D"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044E", "\\u042E"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ky"]\r\n    };\r\n    this.VKI_layout["Latvie\\u0161u"] = {\r\n        name: "Latvian",\r\n        keys: [\r\n            [\r\n                ["\\u00AD", "?"],\r\n                ["1", "!", "\\u00AB"],\r\n                ["2", "\\u00AB", "", "@"],\r\n                ["3", "\\u00BB", "", "#"],\r\n                ["4", "$", "\\u20AC", "$"],\r\n                ["5", "%", \'"\', "~"],\r\n                ["6", "/", "\\u2019", "^"],\r\n                ["7", "&", "", "\\u00B1"],\r\n                ["8", "\\u00D7", ":"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_", "\\u2013", "\\u2014"],\r\n                ["f", "F", "=", ";"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u016B", "\\u016A", "q", "Q"],\r\n                ["g", "G", "\\u0123", "\\u0122"],\r\n                ["j", "J"],\r\n                ["r", "R", "\\u0157", "\\u0156"],\r\n                ["m", "M", "w", "W"],\r\n                ["v", "V", "y", "Y"],\r\n                ["n", "N"],\r\n                ["z", "Z"],\r\n                ["\\u0113", "\\u0112"],\r\n                ["\\u010D", "\\u010C"],\r\n                ["\\u017E", "\\u017D", "[", "{"],\r\n                ["h", "H", "]", "}"],\r\n                ["\\u0137", "\\u0136"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0161", "\\u0160"],\r\n                ["u", "U"],\r\n                ["s", "S"],\r\n                ["i", "I"],\r\n                ["l", "L"],\r\n                ["d", "D"],\r\n                ["a", "A"],\r\n                ["t", "T"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["c", "C"],\r\n                ["\\u00B4", "\\u00B0", "\\u00B4", "\\u00A8"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0146", "\\u0145"],\r\n                ["b", "B", "x", "X"],\r\n                ["\\u012B", "\\u012A"],\r\n                ["k", "K", "\\u0137", "\\u0136"],\r\n                ["p", "P"],\r\n                ["o", "O", "\\u00F5", "\\u00D5"],\r\n                ["\\u0101", "\\u0100"],\r\n                [",", ";", "<"],\r\n                [".", ":", ">"],\r\n                ["\\u013C", "\\u013B"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["lv"]\r\n    };\r\n    this.VKI_layout["Lietuvi\\u0173"] = {\r\n        name: "Lithuanian",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["\\u0105", "\\u0104"],\r\n                ["\\u010D", "\\u010C"],\r\n                ["\\u0119", "\\u0118"],\r\n                ["\\u0117", "\\u0116"],\r\n                ["\\u012F", "\\u012E"],\r\n                ["\\u0161", "\\u0160"],\r\n                ["\\u0173", "\\u0172"],\r\n                ["\\u016B", "\\u016A"],\r\n                ["\\u201E", "("],\r\n                ["\\u201C", ")"],\r\n                ["-", "_"],\r\n                ["\\u017E", "\\u017D"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u2013", "\\u20AC"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["lt"]\r\n    };\r\n    this.VKI_layout.Magyar = {\r\n        name: "Hungarian",\r\n        keys: [\r\n            [\r\n                ["0", "\\u00a7"],\r\n                ["1", "\'", "~"],\r\n                ["2", \'"\', "\\u02c7"],\r\n                ["3", "+", "\\u02c6"],\r\n                ["4", "!", "\\u02d8"],\r\n                ["5", "%", "\\u00b0"],\r\n                ["6", "/", "\\u02db"],\r\n                ["7", "=", "`"],\r\n                ["8", "(", "\\u02d9"],\r\n                ["9", ")", "\\u00b4"],\r\n                ["\\u00f6", "\\u00d6", "\\u02dd"],\r\n                ["\\u00fc", "\\u00dc", "\\u00a8"],\r\n                ["\\u00f3", "\\u00d3", "\\u00b8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\\\"],\r\n                ["w", "W", "|"],\r\n                ["e", "E", "\\u00c4"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U", "\\u20ac"],\r\n                ["i", "I", "\\u00cd"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u0151", "\\u0150", "\\u00f7"],\r\n                ["\\u00fa", "\\u00da", "\\u00d7"],\r\n                ["\\u0171", "\\u0170", "\\u00a4"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00e4"],\r\n                ["s", "S", "\\u0111"],\r\n                ["d", "D", "\\u0110"],\r\n                ["f", "F", "["],\r\n                ["g", "G", "]"],\r\n                ["h", "H"],\r\n                ["j", "J", "\\u00ed"],\r\n                ["k", "K", "\\u0141"],\r\n                ["l", "L", "\\u0142"],\r\n                ["\\u00e9", "\\u00c9", "$"],\r\n                ["\\u00e1", "\\u00c1", "\\u00df"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u00ed", "\\u00cd", "<"],\r\n                ["y", "Y", ">"],\r\n                ["x", "X", "#"],\r\n                ["c", "C", "&"],\r\n                ["v", "V", "@"],\r\n                ["b", "B", "{"],\r\n                ["n", "N", "}"],\r\n                ["m", "M", "<"],\r\n                [",", "?", ";"],\r\n                [".", ":", ">"],\r\n                ["-", "_", "*"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["hu"]\r\n    };\r\n    this.VKI_layout.Malti = {\r\n        name: "Maltese 48",\r\n        keys: [\r\n            [\r\n                ["\\u010B", "\\u010A", "`"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u20ac", "\\u00A3"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u00E8", "\\u00C8"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U", "\\u00F9", "\\u00D9"],\r\n                ["i", "I", "\\u00EC", "\\u00cc"],\r\n                ["o", "O", "\\u00F2", "\\u00D2"],\r\n                ["p", "P"],\r\n                ["\\u0121", "\\u0120", "[", "{"],\r\n                ["\\u0127", "\\u0126", "]", "}"],\r\n                ["#", "\\u017e"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00E0", "\\u00C0"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":"],\r\n                ["\'", "@"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u017c", "\\u017b", "\\\\", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?", "", "`"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["mt"]\r\n    };\r\n    this.VKI_layout["\\u041c\\u0430\\u043a\\u0435\\u0434\\u043e\\u043d\\u0441\\u043a\\u0438"] = {\r\n        name: "Macedonian Cyrillic",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "\\u201E"],\r\n                ["3", "\\u201C"],\r\n                ["4", "\\u2019"],\r\n                ["5", "%"],\r\n                ["6", "\\u2018"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0459", "\\u0409"],\r\n                ["\\u045A", "\\u040A"],\r\n                ["\\u0435", "\\u0415", "\\u20AC"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u0455", "\\u0405"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0448", "\\u0428", "\\u0402"],\r\n                ["\\u0453", "\\u0403", "\\u0452"],\r\n                ["\\u0436", "\\u0416"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0444", "\\u0424", "["],\r\n                ["\\u0433", "\\u0413", "]"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u0458", "\\u0408"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0447", "\\u0427", "\\u040B"],\r\n                ["\\u045C", "\\u040C", "\\u045B"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0451", "\\u0401"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u045F", "\\u040F"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0432", "\\u0412", "@"],\r\n                ["\\u0431", "\\u0411", "{"],\r\n                ["\\u043D", "\\u041D", "}"],\r\n                ["\\u043C", "\\u041C", "\\u00A7"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["mk"]\r\n    };\r\n    this.VKI_layout["\\u0d2e\\u0d32\\u0d2f\\u0d3e\\u0d33\\u0d02"] = {\r\n        name: "Malayalam",\r\n        keys: [\r\n            [\r\n                ["\\u0D4A", "\\u0D12"],\r\n                ["1", "", "\\u0D67"],\r\n                ["2", "", "\\u0D68"],\r\n                ["3", "\\u0D4D\\u0D30", "\\u0D69"],\r\n                ["4", "", "\\u0D6A"],\r\n                ["5", "", "\\u0D6B"],\r\n                ["6", "", "\\u0D6C"],\r\n                ["7", "\\u0D15\\u0D4D\\u0D37", "\\u0D6D"],\r\n                ["8", "", "\\u0D6E"],\r\n                ["9", "(", "\\u0D6F"],\r\n                ["0", ")", "\\u0D66"],\r\n                ["-", "\\u0D03"],\r\n                ["\\u0D43", "\\u0D0B", "", "\\u0D60"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0D4C", "\\u0D14", "\\u0D57"],\r\n                ["\\u0D48", "\\u0D10"],\r\n                ["\\u0D3E", "\\u0D06"],\r\n                ["\\u0D40", "\\u0D08", "", "\\u0D61"],\r\n                ["\\u0D42", "\\u0D0A"],\r\n                ["\\u0D2C", "\\u0D2D"],\r\n                ["\\u0D39", "\\u0D19"],\r\n                ["\\u0D17", "\\u0D18"],\r\n                ["\\u0D26", "\\u0D27"],\r\n                ["\\u0D1C", "\\u0D1D"],\r\n                ["\\u0D21", "\\u0D22"],\r\n                ["", "\\u0D1E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0D4B", "\\u0D13"],\r\n                ["\\u0D47", "\\u0D0F"],\r\n                ["\\u0D4D", "\\u0D05", "", "\\u0D0C"],\r\n                ["\\u0D3F", "\\u0D07"],\r\n                ["\\u0D41", "\\u0D09"],\r\n                ["\\u0D2A", "\\u0D2B"],\r\n                ["\\u0D30", "\\u0D31"],\r\n                ["\\u0D15", "\\u0D16"],\r\n                ["\\u0D24", "\\u0D25"],\r\n                ["\\u0D1A", "\\u0D1B"],\r\n                ["\\u0D1F", "\\u0D20"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0D46", "\\u0D0F"],\r\n                ["\\u0D02"],\r\n                ["\\u0D2E", "\\u0D23"],\r\n                ["\\u0D28"],\r\n                ["\\u0D35", "\\u0D34"],\r\n                ["\\u0D32", "\\u0D33"],\r\n                ["\\u0D38", "\\u0D36"],\r\n                [",", "\\u0D37"],\r\n                ["."],\r\n                ["\\u0D2F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ml"]\r\n    };\r\n    this.VKI_layout["Misc. Symbols"] = {\r\n        name: "Misc. Symbols",\r\n        keys: [\r\n            [\r\n                ["\\u2605", "\\u2606", "\\u260e", "\\u260f"],\r\n                ["\\u2648", "\\u2673", "\\u2659", "\\u2630"],\r\n                ["\\u2649", "\\u2674", "\\u2658", "\\u2631"],\r\n                ["\\u264a", "\\u2675", "\\u2657", "\\u2632"],\r\n                ["\\u264b", "\\u2676", "\\u2656", "\\u2633"],\r\n                ["\\u264c", "\\u2677", "\\u2655", "\\u2634"],\r\n                ["\\u264d", "\\u2678", "\\u2654", "\\u2635"],\r\n                ["\\u264e", "\\u2679", "\\u265f", "\\u2636"],\r\n                ["\\u264f", "\\u267a", "\\u265e", "\\u2637"],\r\n                ["\\u2650", "\\u267b", "\\u265d", "\\u2686"],\r\n                ["\\u2651", "\\u267c", "\\u265c", "\\u2687"],\r\n                ["\\u2652", "\\u267d", "\\u265b", "\\u2688"],\r\n                ["\\u2653", "\\u2672", "\\u265a", "\\u2689"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["\\u263f", "\\u2680", "\\u268a", "\\u26a2"],\r\n                ["\\u2640", "\\u2681", "\\u268b", "\\u26a3"],\r\n                ["\\u2641", "\\u2682", "\\u268c", "\\u26a4"],\r\n                ["\\u2642", "\\u2683", "\\u268d", "\\u26a5"],\r\n                ["\\u2643", "\\u2684", "\\u268e", "\\u26a6"],\r\n                ["\\u2644", "\\u2685", "\\u268f", "\\u26a7"],\r\n                ["\\u2645", "\\u2620", "\\u26ff", "\\u26a8"],\r\n                ["\\u2646", "\\u2622", "\\u2692", "\\u26a9"],\r\n                ["\\u2647", "\\u2623", "\\u2693", "\\u26b2"],\r\n                ["\\u2669", "\\u266d", "\\u2694", "\\u26ac"],\r\n                ["\\u266a", "\\u266e", "\\u2695", "\\u26ad"],\r\n                ["\\u266b", "\\u266f", "\\u2696", "\\u26ae"],\r\n                ["\\u266c", "\\u2607", "\\u2697", "\\u26af"],\r\n                ["\\u26f9", "\\u2608", "\\u2698", "\\u26b0"],\r\n                ["\\u267f", "\\u262e", "\\u2638", "\\u2609"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u261e", "\\u261c", "\\u261d", "\\u261f"],\r\n                ["\\u261b", "\\u261a", "\\u2618", "\\u2619"],\r\n                ["\\u2602", "\\u2614", "\\u26f1", "\\u26d9"],\r\n                ["\\u2615", "\\u2668", "\\u26fe", "\\u26d8"],\r\n                ["\\u263a", "\\u2639", "\\u263b", "\\u26dc"],\r\n                ["\\u2617", "\\u2616", "\\u26ca", "\\u26c9"],\r\n                ["\\u2660", "\\u2663", "\\u2665", "\\u2666"],\r\n                ["\\u2664", "\\u2667", "\\u2661", "\\u2662"],\r\n                ["\\u26c2", "\\u26c0", "\\u26c3", "\\u26c1"],\r\n                ["\\u2624", "\\u2625", "\\u269a", "\\u26b1"],\r\n                ["\\u2610", "\\u2611", "\\u2612", "\\u2613"],\r\n                ["\\u2628", "\\u2626", "\\u2627", "\\u2629"],\r\n                ["\\u262a", "\\u262b", "\\u262c", "\\u262d"],\r\n                ["\\u26fa", "\\u26fb", "\\u26fc", "\\u26fd"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u262f", "\\u2670", "\\u2671", "\\u267e"],\r\n                ["\\u263c", "\\u2699", "\\u263d", "\\u263e"],\r\n                ["\\u26c4", "\\u2603", "\\u26c7", "\\u26c6"],\r\n                ["\\u26a0", "\\u26a1", "\\u2621", "\\u26d4"],\r\n                ["\\u26e4", "\\u26e5", "\\u26e6", "\\u26e7"],\r\n                ["\\u260a", "\\u260b", "\\u260c", "\\u260d"],\r\n                ["\\u269c", "\\u269b", "\\u269d", "\\u2604"],\r\n                ["\\u26b3", "\\u26b4", "\\u26b5", "\\u26b6"],\r\n                ["\\u26b7", "\\u26bf", "\\u26b8", "\\u26f8"],\r\n                ["\\u26b9", "\\u26ba", "\\u26bb", "\\u26bc"],\r\n                ["\\u26bd", "\\u26be", "\\u269f", "\\u269e"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u2600", "\\u2601", "\\u26c5", "\\u26c8"],\r\n                ["\\u2691", "\\u2690", "\\u26ab", "\\u26aa"],\r\n                ["\\u26cb", "\\u26cc", "\\u26cd", "\\u26ce"],\r\n                ["\\u26cf", "\\u26d0", "\\u26d1", "\\u26d2"],\r\n                ["\\u26d3", "\\u26d5", "\\u26d6", "\\u26d7"],\r\n                ["\\u26da", "\\u26db", "\\u26dd", "\\u26de"],\r\n                ["\\u26df", "\\u26e0", "\\u26e1", "\\u26e2"],\r\n                ["\\u26e3", "\\u26e8", "\\u26e9", "\\u26ea"],\r\n                ["\\u26eb", "\\u26ec", "\\u26ed", "\\u26ee"],\r\n                ["\\u26ef", "\\u26f0", "\\u26f2", "\\u26f3"],\r\n                ["\\u26f4", "\\u26f5", "\\u26f6", "\\u26f7"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["AltLk", "AltLk"],\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["\\u041c\\u043e\\u043d\\u0433\\u043e\\u043b"] = {\r\n        name: "Mongolian Cyrillic",\r\n        keys: [\r\n            [\r\n                ["=", "+"],\r\n                ["\\u2116", "1"],\r\n                ["-", "2"],\r\n                [\'"\', "3"],\r\n                ["\\u20AE", "4"],\r\n                [":", "5"],\r\n                [".", "6"],\r\n                ["_", "7"],\r\n                [",", "8"],\r\n                ["%", "9"],\r\n                ["?", "0"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044d", "\\u042d"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u04af", "\\u04AE"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u043A", "\\u041a"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u04e9", "\\u04e8"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043e", "\\u041e"],\r\n                ["\\u043B", "\\u041b"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u043f", "\\u041f"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0451", "\\u0401"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043c", "\\u041c"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044c", "\\u042c"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u044e", "\\u042e"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["mn"]\r\n    };\r\n    this.VKI_layout["\\u092e\\u0930\\u093e\\u0920\\u0940"] = {\r\n        name: "Marathi",\r\n        keys: [\r\n            [\r\n                ["", "", "`", "~"],\r\n                ["\\u0967", "\\u090D", "1", "!"],\r\n                ["\\u0968", "\\u0945", "2", "@"],\r\n                ["\\u0969", "\\u094D\\u0930", "3", "#"],\r\n                ["\\u096A", "\\u0930\\u094D", "4", "$"],\r\n                ["\\u096B", "\\u091C\\u094D\\u091E", "5", "%"],\r\n                ["\\u096C", "\\u0924\\u094D\\u0930", "6", "^"],\r\n                ["\\u096D", "\\u0915\\u094D\\u0937", "7", "&"],\r\n                ["\\u096E", "\\u0936\\u094D\\u0930", "8", "*"],\r\n                ["\\u096F", "(", "9", "("],\r\n                ["\\u0966", ")", "0", ")"],\r\n                ["-", "\\u0903", "-", "_"],\r\n                ["\\u0943", "\\u090B", "=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u094C", "\\u0914"],\r\n                ["\\u0948", "\\u0910"],\r\n                ["\\u093E", "\\u0906"],\r\n                ["\\u0940", "\\u0908"],\r\n                ["\\u0942", "\\u090A"],\r\n                ["\\u092C", "\\u092D"],\r\n                ["\\u0939", "\\u0919"],\r\n                ["\\u0917", "\\u0918"],\r\n                ["\\u0926", "\\u0927"],\r\n                ["\\u091C", "\\u091D"],\r\n                ["\\u0921", "\\u0922", "[", "{"],\r\n                ["\\u093C", "\\u091E", "]", "}"],\r\n                ["\\u0949", "\\u0911", "\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u094B", "\\u0913"],\r\n                ["\\u0947", "\\u090F"],\r\n                ["\\u094D", "\\u0905"],\r\n                ["\\u093F", "\\u0907"],\r\n                ["\\u0941", "\\u0909"],\r\n                ["\\u092A", "\\u092B"],\r\n                ["\\u0930", "\\u0931"],\r\n                ["\\u0915", "\\u0916"],\r\n                ["\\u0924", "\\u0925"],\r\n                ["\\u091A", "\\u091B", ";", ":"],\r\n                ["\\u091F", "\\u0920", "\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [""],\r\n                ["\\u0902", "\\u0901", "", "\\u0950"],\r\n                ["\\u092E", "\\u0923"],\r\n                ["\\u0928"],\r\n                ["\\u0935"],\r\n                ["\\u0932", "\\u0933"],\r\n                ["\\u0938", "\\u0936"],\r\n                [",", "\\u0937", ",", "<"],\r\n                [".", "\\u0964", ".", ">"],\r\n                ["\\u092F", "\\u095F", "/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["mr"]\r\n    };\r\n    this.VKI_layout["\\u1019\\u103c\\u1014\\u103a\\u1019\\u102c\\u1018\\u102c\\u101e\\u102c"] = {\r\n        name: "Burmese",\r\n        keys: [\r\n            [\r\n                ["\\u1039`", "~"],\r\n                ["\\u1041", "\\u100D"],\r\n                ["\\u1042", "\\u100E"],\r\n                ["\\u1043", "\\u100B"],\r\n                ["\\u1044", "\\u1000\\u103B\\u1015\\u103A"],\r\n                ["\\u1045", "%"],\r\n                ["\\u1046", "/"],\r\n                ["\\u1047", "\\u101B"],\r\n                ["\\u1048", "\\u1002"],\r\n                ["\\u1049", "("],\r\n                ["\\u1040", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u1006", "\\u1029"],\r\n                ["\\u1010", "\\u1040"],\r\n                ["\\u1014", "\\u103F"],\r\n                ["\\u1019", "\\u1023"],\r\n                ["\\u1021", "\\u1024"],\r\n                ["\\u1015", "\\u104C"],\r\n                ["\\u1000", "\\u1009"],\r\n                ["\\u1004", "\\u104D"],\r\n                ["\\u101E", "\\u1025"],\r\n                ["\\u1005", "\\u100F"],\r\n                ["\\u101F", "\\u1027"],\r\n                ["\\u2018", "\\u2019"],\r\n                ["\\u104F", "\\u100B\\u1039\\u100C"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u200B\\u1031", "\\u1017"],\r\n                ["\\u200B\\u103B", "\\u200B\\u103E"],\r\n                ["\\u200B\\u102D", "\\u200B\\u102E"],\r\n                ["\\u200B\\u103A", "\\u1004\\u103A\\u1039\\u200B"],\r\n                ["\\u200B\\u102B", "\\u200B\\u103D"],\r\n                ["\\u200B\\u1037", "\\u200B\\u1036"],\r\n                ["\\u200B\\u103C", "\\u200B\\u1032"],\r\n                ["\\u200B\\u102F", "\\u200B\\u102F"],\r\n                ["\\u200B\\u1030", "\\u200B\\u1030"],\r\n                ["\\u200B\\u1038", "\\u200B\\u102B\\u103A"],\r\n                ["\\u1012", "\\u1013"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u1016", "\\u1007"],\r\n                ["\\u1011", "\\u100C"],\r\n                ["\\u1001", "\\u1003"],\r\n                ["\\u101C", "\\u1020"],\r\n                ["\\u1018", "\\u1026"],\r\n                ["\\u100A", "\\u1008"],\r\n                ["\\u200B\\u102C", "\\u102A"],\r\n                ["\\u101A", "\\u101B"],\r\n                [".", "\\u101B"],\r\n                ["\\u104B", "\\u104A"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["my"]\r\n    };\r\n    this.VKI_layout.Nederlands = {\r\n        name: "Dutch",\r\n        keys: [\r\n            [\r\n                ["@", "\\u00a7", "\\u00ac"],\r\n                ["1", "!", "\\u00b9"],\r\n                ["2", \'"\', "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00bc"],\r\n                ["5", "%", "\\u00bd"],\r\n                ["6", "&", "\\u00be"],\r\n                ["7", "_", "\\u00a3"],\r\n                ["8", "(", "{"],\r\n                ["9", ")", "}"],\r\n                ["0", "\'"],\r\n                ["/", "?", "\\\\"],\r\n                ["\\u00b0", "~", "\\u00b8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R", "\\u00b6"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00a8", "^"],\r\n                ["*", "|"],\r\n                ["<", ">"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u00df"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["+", "\\u00b1"],\r\n                ["\\u00b4", "`"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["]", "[", "\\u00a6"],\r\n                ["z", "Z", "\\u00ab"],\r\n                ["x", "X", "\\u00bb"],\r\n                ["c", "C", "\\u00a2"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u00b5"],\r\n                [",", ";"],\r\n                [".", ":", "\\u00b7"],\r\n                ["-", "="],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["nl"]\r\n    };\r\n    this.VKI_layout.Norsk = {\r\n        name: "Norwegian",\r\n        keys: [\r\n            [\r\n                ["|", "\\u00a7"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00a3"],\r\n                ["4", "\\u00a4", "$"],\r\n                ["5", "%"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["+", "?"],\r\n                ["\\\\", "`", "\\u00b4"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00e5", "\\u00c5"],\r\n                ["\\u00a8", "^", "~"],\r\n                ["\'", "*"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00f8", "\\u00d8"],\r\n                ["\\u00e6", "\\u00c6"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u03bc", "\\u039c"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["no", "nb", "nn"]\r\n    };\r\n    this.VKI_layout["\\u067e\\u069a\\u062a\\u0648"] = {\r\n        name: "Pashto",\r\n        keys: [\r\n            [\r\n                ["\\u200d", "\\u00f7", "`"],\r\n                ["\\u06f1", "!", "`"],\r\n                ["\\u06f2", "\\u066c", "@"],\r\n                ["\\u06f3", "\\u066b", "\\u066b"],\r\n                ["\\u06f4", "\\u00a4", "\\u00a3"],\r\n                ["\\u06f5", "\\u066a", "%"],\r\n                ["\\u06f6", "\\u00d7", "^"],\r\n                ["\\u06f7", "\\u00ab", "&"],\r\n                ["\\u06f8", "\\u00bb", "*"],\r\n                ["\\u06f9", "(", "\\ufdf2"],\r\n                ["\\u06f0", ")", "\\ufefb"],\r\n                ["-", "\\u0640", "_"],\r\n                ["=", "+", "\\ufe87", "\\u00f7"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0636", "\\u0652", "\\u06d5"],\r\n                ["\\u0635", "\\u064c", "\\u0653"],\r\n                ["\\u062b", "\\u064d", "\\u20ac"],\r\n                ["\\u0642", "\\u064b", "\\ufef7"],\r\n                ["\\u0641", "\\u064f", "\\ufef5"],\r\n                ["\\u063a", "\\u0650", "\'"],\r\n                ["\\u0639", "\\u064e", "\\ufe84"],\r\n                ["\\u0647", "\\u0651", "\\u0670"],\r\n                ["\\u062e", "\\u0681", "\'"],\r\n                ["\\u062d", "\\u0685", \'"\'],\r\n                ["\\u062c", "]", "}"],\r\n                ["\\u0686", "[", "{"],\r\n                ["\\\\", "\\u066d", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0634", "\\u069a", "\\ufbb0"],\r\n                ["\\u0633", "\\u06cd", "\\u06d2"],\r\n                ["\\u06cc", "\\u064a", "\\u06d2"],\r\n                ["\\u0628", "\\u067e", "\\u06ba"],\r\n                ["\\u0644", "\\u0623", "\\u06b7"],\r\n                ["\\u0627", "\\u0622", "\\u0671"],\r\n                ["\\u062a", "\\u067c", "\\u0679"],\r\n                ["\\u0646", "\\u06bc", "<"],\r\n                ["\\u0645", "\\u0629", ">"],\r\n                ["\\u06a9", ":", "\\u0643"],\r\n                ["\\u06af", "\\u061b", "\\u06ab"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0638", "\\u0626", "?"],\r\n                ["\\u0637", "\\u06d0", ";"],\r\n                ["\\u0632", "\\u0698", "\\u0655"],\r\n                ["\\u0631", "\\u0621", "\\u0654"],\r\n                ["\\u0630", "\\u200c", "\\u0625"],\r\n                ["\\u062f", "\\u0689", "\\u0688"],\r\n                ["\\u0693", "\\u0624", "\\u0691"],\r\n                ["\\u0648", "\\u060c", ","],\r\n                ["\\u0696", ".", "\\u06c7"],\r\n                ["/", "\\u061f", "\\u06c9"],\r\n                ["Shift", "Shift", "\\u064d"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["ps"]\r\n    };\r\n    this.VKI_layout["\\u0a2a\\u0a70\\u0a1c\\u0a3e\\u0a2c\\u0a40"] = {\r\n        name: "Punjabi (Gurmukhi)",\r\n        keys: [\r\n            [\r\n                [""],\r\n                ["1", "\\u0A4D\\u0A35", "\\u0A67", "\\u0A67"],\r\n                ["2", "\\u0A4D\\u0A2F", "\\u0A68", "\\u0A68"],\r\n                ["3", "\\u0A4D\\u0A30", "\\u0A69", "\\u0A69"],\r\n                ["4", "\\u0A71", "\\u0A6A", "\\u0A6A"],\r\n                ["5", "", "\\u0A6B", "\\u0A6B"],\r\n                ["6", "", "\\u0A6C", "\\u0A6C"],\r\n                ["7", "", "\\u0A6D", "\\u0A6D"],\r\n                ["8", "", "\\u0A6E", "\\u0A6E"],\r\n                ["9", "(", "\\u0A6F", "\\u0A6F"],\r\n                ["0", ")", "\\u0A66", "\\u0A66"],\r\n                ["-"],\r\n                [""],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0A4C", "\\u0A14"],\r\n                ["\\u0A48", "\\u0A10"],\r\n                ["\\u0A3E", "\\u0A06"],\r\n                ["\\u0A40", "\\u0A08"],\r\n                ["\\u0A42", "\\u0A0A"],\r\n                ["\\u0A2C", "\\u0A2D"],\r\n                ["\\u0A39", "\\u0A19"],\r\n                ["\\u0A17", "\\u0A18", "\\u0A5A", "\\u0A5A"],\r\n                ["\\u0A26", "\\u0A27"],\r\n                ["\\u0A1C", "\\u0A1D", "\\u0A5B", "\\u0A5B"],\r\n                ["\\u0A21", "\\u0A22", "\\u0A5C", "\\u0A5C"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0A4B", "\\u0A13"],\r\n                ["\\u0A47", "\\u0A0F"],\r\n                ["\\u0A4D", "\\u0A05"],\r\n                ["\\u0A3F", "\\u0A07"],\r\n                ["\\u0A41", "\\u0A09"],\r\n                ["\\u0A2A", "\\u0A2B", "\\u0A5E", "\\u0A5E"],\r\n                ["\\u0A30"],\r\n                ["\\u0A15", "\\u0A16", "\\u0A59", "\\u0A59"],\r\n                ["\\u0A24", "\\u0A25"],\r\n                ["\\u0A1A", "\\u0A1B"],\r\n                ["\\u0A1F", "\\u0A20"],\r\n                ["\\u0A3C", "\\u0A1E"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                [""],\r\n                ["\\u0A02", "\\u0A02"],\r\n                ["\\u0A2E", "\\u0A23"],\r\n                ["\\u0A28"],\r\n                ["\\u0A35", "\\u0A72", "\\u0A73", "\\u0A73"],\r\n                ["\\u0A32", "\\u0A33"],\r\n                ["\\u0A38", "\\u0A36"],\r\n                [","],\r\n                [".", "|", "\\u0965", "\\u0965"],\r\n                ["\\u0A2F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["pa"]\r\n    };\r\n    this.VKI_layout["\\u62fc\\u97f3 (Pinyin)"] = {\r\n        name: "Pinyin",\r\n        keys: [\r\n            [\r\n                ["`", "~", "\\u4e93", "\\u301C"],\r\n                ["1", "!", "\\uFF62"],\r\n                ["2", "@", "\\uFF63"],\r\n                ["3", "#", "\\u301D"],\r\n                ["4", "$", "\\u301E"],\r\n                ["5", "%", "\\u301F"],\r\n                ["6", "^", "\\u3008"],\r\n                ["7", "&", "\\u3009"],\r\n                ["8", "*", "\\u302F"],\r\n                ["9", "(", "\\u300A"],\r\n                ["0", ")", "\\u300B"],\r\n                ["-", "_", "\\u300E"],\r\n                ["=", "+", "\\u300F"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\u0101", "\\u0100"],\r\n                ["w", "W", "\\u00E1", "\\u00C1"],\r\n                ["e", "E", "\\u01CE", "\\u01CD"],\r\n                ["r", "R", "\\u00E0", "\\u00C0"],\r\n                ["t", "T", "\\u0113", "\\u0112"],\r\n                ["y", "Y", "\\u00E9", "\\u00C9"],\r\n                ["u", "U", "\\u011B", "\\u011A"],\r\n                ["i", "I", "\\u00E8", "\\u00C8"],\r\n                ["o", "O", "\\u012B", "\\u012A"],\r\n                ["p", "P", "\\u00ED", "\\u00CD"],\r\n                ["[", "{", "\\u01D0", "\\u01CF"],\r\n                ["]", "}", "\\u00EC", "\\u00CC"],\r\n                ["\\\\", "|", "\\u3020"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u014D", "\\u014C"],\r\n                ["s", "S", "\\u00F3", "\\u00D3"],\r\n                ["d", "D", "\\u01D2", "\\u01D1"],\r\n                ["f", "F", "\\u00F2", "\\u00D2"],\r\n                ["g", "G", "\\u00fc", "\\u00dc"],\r\n                ["h", "H", "\\u016B", "\\u016A"],\r\n                ["j", "J", "\\u00FA", "\\u00DA"],\r\n                ["k", "K", "\\u01D4", "\\u01D3"],\r\n                ["l", "L", "\\u00F9", "\\u00D9"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z", "\\u01D6", "\\u01D5"],\r\n                ["x", "X", "\\u01D8", "\\u01D7"],\r\n                ["c", "C", "\\u01DA", "\\u01D9"],\r\n                ["v", "V", "\\u01DC", "\\u01DB"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<", "\\u3001"],\r\n                [".", ">", "\\u3002"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["AltLk", "AltLk"],\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["zh-Latn"]\r\n    };\r\n    this.VKI_layout.Polski = {\r\n        name: "Polish (214)",\r\n        keys: [\r\n            [\r\n                ["\\u02DB", "\\u00B7"],\r\n                ["1", "!", "~"],\r\n                ["2", \'"\', "\\u02C7"],\r\n                ["3", "#", "^"],\r\n                ["4", "\\u00A4", "\\u02D8"],\r\n                ["5", "%", "\\u00B0"],\r\n                ["6", "&", "\\u02DB"],\r\n                ["7", "/", "`"],\r\n                ["8", "(", "\\u00B7"],\r\n                ["9", ")", "\\u00B4"],\r\n                ["0", "=", "\\u02DD"],\r\n                ["+", "?", "\\u00A8"],\r\n                ["\'", "*", "\\u00B8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\\\"],\r\n                ["w", "W", "\\u00A6"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U", "\\u20AC"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u017C", "\\u0144", "\\u00F7"],\r\n                ["\\u015B", "\\u0107", "\\u00D7"],\r\n                ["\\u00F3", "\\u017A"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u0111"],\r\n                ["d", "D", "\\u0110"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u0142", "\\u0141", "$"],\r\n                ["\\u0105", "\\u0119", "\\u00DF"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V", "@"],\r\n                ["b", "B", "{"],\r\n                ["n", "N", "}"],\r\n                ["m", "M", "\\u00A7"],\r\n                [",", ";", "<"],\r\n                [".", ":", ">"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["Polski Programisty"] = {\r\n        name: "Polish Programmers",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u0119", "\\u0118"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O", "\\u00f3", "\\u00d3"],\r\n                ["p", "P"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u0105", "\\u0104"],\r\n                ["s", "S", "\\u015b", "\\u015a"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L", "\\u0142", "\\u0141"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z", "\\u017c", "\\u017b"],\r\n                ["x", "X", "\\u017a", "\\u0179"],\r\n                ["c", "C", "\\u0107", "\\u0106"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N", "\\u0144", "\\u0143"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["pl"]\r\n    };\r\n    this.VKI_layout["Portugu\\u00eas Brasileiro"] = {\r\n        name: "Portuguese (Brazil)",\r\n        keys: [\r\n            [\r\n                ["\'", \'"\'],\r\n                ["1", "!", "\\u00b9"],\r\n                ["2", "@", "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00a3"],\r\n                ["5", "%", "\\u00a2"],\r\n                ["6", "\\u00a8", "\\u00ac"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+", "\\u00a7"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "/"],\r\n                ["w", "W", "?"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00b4", "`"],\r\n                ["[", "{", "\\u00aa"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00e7", "\\u00c7"],\r\n                ["~", "^"],\r\n                ["]", "}", "\\u00ba"],\r\n                ["/", "?"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C", "\\u20a2"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                [":", ":"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["pt-BR"]\r\n    };\r\n    this.VKI_layout["Portugu\\u00eas"] = {\r\n        name: "Portuguese",\r\n        keys: [\r\n            [\r\n                ["\\\\", "|"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00a3"],\r\n                ["4", "$", "\\u00a7"],\r\n                ["5", "%"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["\'", "?"],\r\n                ["\\u00ab", "\\u00bb"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["+", "*", "\\u00a8"],\r\n                ["\\u00b4", "`"],\r\n                ["~", "^"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00e7", "\\u00c7"],\r\n                ["\\u00ba", "\\u00aa"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["pt"]\r\n    };\r\n    this.VKI_layout["Rom\\u00e2n\\u0103"] = {\r\n        name: "Romanian",\r\n        keys: [\r\n            [\r\n                ["\\u201E", "\\u201D", "`", "~"],\r\n                ["1", "!", "~"],\r\n                ["2", "@", "\\u02C7"],\r\n                ["3", "#", "^"],\r\n                ["4", "$", "\\u02D8"],\r\n                ["5", "%", "\\u00B0"],\r\n                ["6", "^", "\\u02DB"],\r\n                ["7", "&", "`"],\r\n                ["8", "*", "\\u02D9"],\r\n                ["9", "(", "\\u00B4"],\r\n                ["0", ")", "\\u02DD"],\r\n                ["-", "_", "\\u00A8"],\r\n                ["=", "+", "\\u00B8", "\\u00B1"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P", "\\u00A7"],\r\n                ["\\u0103", "\\u0102", "[", "{"],\r\n                ["\\u00EE", "\\u00CE", "]", "}"],\r\n                ["\\u00E2", "\\u00C2", "\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u00df"],\r\n                ["d", "D", "\\u00f0", "\\u00D0"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L", "\\u0142", "\\u0141"],\r\n                [(this.VKI_isIElt8) ? "\\u015F" : "\\u0219", (this.VKI_isIElt8) ? "\\u015E" : "\\u0218", ";", ":"],\r\n                [(this.VKI_isIElt8) ? "\\u0163" : "\\u021B", (this.VKI_isIElt8) ? "\\u0162" : "\\u021A", "\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C", "\\u00A9"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";", "<", "\\u00AB"],\r\n                [".", ":", ">", "\\u00BB"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ro"]\r\n    };\r\n    this.VKI_layout["\\u0420\\u0443\\u0441\\u0441\\u043a\\u0438\\u0439"] = {\r\n        name: "Russian",\r\n        keys: [\r\n            [\r\n                ["\\u0451", "\\u0401"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044D", "\\u042D"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["/", "|"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044E", "\\u042E"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["ru"]\r\n    };\r\n    this.VKI_layout.Schweizerdeutsch = {\r\n        name: "Swiss German",\r\n        keys: [\r\n            [\r\n                ["\\u00A7", "\\u00B0"],\r\n                ["1", "+", "\\u00A6"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "*", "#"],\r\n                ["4", "\\u00E7", "\\u00B0"],\r\n                ["5", "%", "\\u00A7"],\r\n                ["6", "&", "\\u00AC"],\r\n                ["7", "/", "|"],\r\n                ["8", "(", "\\u00A2"],\r\n                ["9", ")"],\r\n                ["0", "="],\r\n                ["\'", "?", "\\u00B4"],\r\n                ["^", "`", "~"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00FC", "\\u00E8", "["],\r\n                ["\\u00A8", "!", "]"],\r\n                ["$", "\\u00A3", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00F6", "\\u00E9"],\r\n                ["\\u00E4", "\\u00E0", "{"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["de-CH"]\r\n    };\r\n    this.VKI_layout.Shqip = {\r\n        name: "Albanian",\r\n        keys: [\r\n            [\r\n                ["\\\\", "|"],\r\n                ["1", "!", "~"],\r\n                ["2", \'"\', "\\u02C7"],\r\n                ["3", "#", "^"],\r\n                ["4", "$", "\\u02D8"],\r\n                ["5", "%", "\\u00B0"],\r\n                ["6", "^", "\\u02DB"],\r\n                ["7", "&", "`"],\r\n                ["8", "*", "\\u02D9"],\r\n                ["9", "(", "\\u00B4"],\r\n                ["0", ")", "\\u02DD"],\r\n                ["-", "_", "\\u00A8"],\r\n                ["=", "+", "\\u00B8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\\\"],\r\n                ["w", "W", "|"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00E7", "\\u00C7", "\\u00F7"],\r\n                ["[", "{", "\\u00DF"],\r\n                ["]", "}", "\\u00A4"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u0111"],\r\n                ["d", "D", "\\u0110"],\r\n                ["f", "F", "["],\r\n                ["g", "G", "]"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K", "\\u0142"],\r\n                ["l", "L", "\\u0141"],\r\n                ["\\u00EB", "\\u00CB", "$"],\r\n                ["@", "\'", "\\u00D7"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V", "@"],\r\n                ["b", "B", "{"],\r\n                ["n", "N", "}"],\r\n                ["m", "M", "\\u00A7"],\r\n                [",", ";", "<"],\r\n                [".", ":", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["sq"]\r\n    };\r\n    this.VKI_layout["Sloven\\u010dina"] = {\r\n        name: "Slovak",\r\n        keys: [\r\n            [\r\n                [";", "\\u00b0"],\r\n                ["+", "1", "~"],\r\n                ["\\u013E", "2", "\\u02C7"],\r\n                ["\\u0161", "3", "^"],\r\n                ["\\u010D", "4", "\\u02D8"],\r\n                ["\\u0165", "5", "\\u00B0"],\r\n                ["\\u017E", "6", "\\u02DB"],\r\n                ["\\u00FD", "7", "`"],\r\n                ["\\u00E1", "8", "\\u02D9"],\r\n                ["\\u00ED", "9", "\\u00B4"],\r\n                ["\\u00E9", "0", "\\u02DD"],\r\n                ["=", "%", "\\u00A8"],\r\n                ["\\u00B4", "\\u02c7", "\\u00B8"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\\\"],\r\n                ["w", "W", "|"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P", "\'"],\r\n                ["\\u00FA", "/", "\\u00F7"],\r\n                ["\\u00E4", "(", "\\u00D7"],\r\n                ["\\u0148", ")", "\\u00A4"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S", "\\u0111"],\r\n                ["d", "D", "\\u0110"],\r\n                ["f", "F", "["],\r\n                ["g", "G", "]"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K", "\\u0142"],\r\n                ["l", "L", "\\u0141"],\r\n                ["\\u00F4", \'"\', "$"],\r\n                ["\\u00A7", "!", "\\u00DF"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["&", "*", "<"],\r\n                ["y", "Y", ">"],\r\n                ["x", "X", "#"],\r\n                ["c", "C", "&"],\r\n                ["v", "V", "@"],\r\n                ["b", "B", "{"],\r\n                ["n", "N", "}"],\r\n                ["m", "M"],\r\n                [",", "?", "<"],\r\n                [".", ":", ">"],\r\n                ["-", "_", "*"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["sk"]\r\n    };\r\n    this.VKI_layout["Sloven\\u0161\\u010dina"] = {\r\n        name: "Slovenian",\r\n        keys: this.VKI_layout.Bosanski.keys.slice(0),\r\n        lang: ["sl"]\r\n    };\r\n    this.VKI_layout["\\u0441\\u0440\\u043f\\u0441\\u043a\\u0438"] = {\r\n        name: "Serbian Cyrillic",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "&"],\r\n                ["7", "/"],\r\n                ["8", "("],\r\n                ["9", ")"],\r\n                ["0", "="],\r\n                ["\'", "?"],\r\n                ["+", "*"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0459", "\\u0409"],\r\n                ["\\u045a", "\\u040a"],\r\n                ["\\u0435", "\\u0415", "\\u20ac"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u043e", "\\u041e"],\r\n                ["\\u043f", "\\u041f"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0452", "\\u0402"],\r\n                ["\\u0436", "\\u0416"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u0458", "\\u0408"],\r\n                ["\\u043a", "\\u041a"],\r\n                ["\\u043b", "\\u041b"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u045b", "\\u040b"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">"],\r\n                ["\\u0455", "\\u0405"],\r\n                ["\\u045f", "\\u040f"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u043d", "\\u041d"],\r\n                ["\\u043c", "\\u041c"],\r\n                [",", ";", "<"],\r\n                [".", ":", ">"],\r\n                ["-", "_", "\\u00a9"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["sr-Cyrl"]\r\n    };\r\n    this.VKI_layout.Srpski = {\r\n        name: "Serbian Latin",\r\n        keys: this.VKI_layout.Bosanski.keys.slice(0),\r\n        lang: ["sr"]\r\n    };\r\n    this.VKI_layout.Suomi = {\r\n        name: "Finnish",\r\n        keys: [\r\n            [\r\n                ["\\u00a7", "\\u00BD"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00A3"],\r\n                ["4", "\\u00A4", "$"],\r\n                ["5", "%", "\\u20AC"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["+", "?", "\\\\"],\r\n                ["\\u00B4", "`"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\u00E2", "\\u00C2"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T", "\\u0167", "\\u0166"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I", "\\u00ef", "\\u00CF"],\r\n                ["o", "O", "\\u00f5", "\\u00D5"],\r\n                ["p", "P"],\r\n                ["\\u00E5", "\\u00C5"],\r\n                ["\\u00A8", "^", "~"],\r\n                ["\'", "*"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00E1", "\\u00C1"],\r\n                ["s", "S", "\\u0161", "\\u0160"],\r\n                ["d", "D", "\\u0111", "\\u0110"],\r\n                ["f", "F", "\\u01e5", "\\u01E4"],\r\n                ["g", "G", "\\u01E7", "\\u01E6"],\r\n                ["h", "H", "\\u021F", "\\u021e"],\r\n                ["j", "J"],\r\n                ["k", "K", "\\u01e9", "\\u01E8"],\r\n                ["l", "L"],\r\n                ["\\u00F6", "\\u00D6", "\\u00F8", "\\u00D8"],\r\n                ["\\u00E4", "\\u00C4", "\\u00E6", "\\u00C6"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|"],\r\n                ["z", "Z", "\\u017E", "\\u017D"],\r\n                ["x", "X"],\r\n                ["c", "C", "\\u010d", "\\u010C"],\r\n                ["v", "V", "\\u01EF", "\\u01EE"],\r\n                ["b", "B", "\\u0292", "\\u01B7"],\r\n                ["n", "N", "\\u014B", "\\u014A"],\r\n                ["m", "M", "\\u00B5"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                ["Alt", "Alt"],\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fi"]\r\n    };\r\n    this.VKI_layout.Svenska = {\r\n        name: "Swedish",\r\n        keys: [\r\n            [\r\n                ["\\u00a7", "\\u00bd"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "#", "\\u00a3"],\r\n                ["4", "\\u00a4", "$"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["+", "?", "\\\\"],\r\n                ["\\u00b4", "`"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00e5", "\\u00c5"],\r\n                ["\\u00a8", "^", "~"],\r\n                ["\'", "*"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00f6", "\\u00d6"],\r\n                ["\\u00e4", "\\u00c4"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M", "\\u03bc", "\\u039c"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["sv"]\r\n    };\r\n    this.VKI_layout["Swiss Fran\\u00e7ais"] = {\r\n        name: "Swiss French",\r\n        keys: [\r\n            [\r\n                ["\\u00A7", "\\u00B0"],\r\n                ["1", "+", "\\u00A6"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "*", "#"],\r\n                ["4", "\\u00E7", "\\u00B0"],\r\n                ["5", "%", "\\u00A7"],\r\n                ["6", "&", "\\u00AC"],\r\n                ["7", "/", "|"],\r\n                ["8", "(", "\\u00A2"],\r\n                ["9", ")"],\r\n                ["0", "="],\r\n                ["\'", "?", "\\u00B4"],\r\n                ["^", "`", "~"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20AC"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["z", "Z"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u00E8", "\\u00FC", "["],\r\n                ["\\u00A8", "!", "]"],\r\n                ["$", "\\u00A3", "}"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u00E9", "\\u00F6"],\r\n                ["\\u00E0", "\\u00E4", "{"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "\\\\"],\r\n                ["y", "Y"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", ";"],\r\n                [".", ":"],\r\n                ["-", "_"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["fr-CH"]\r\n    };\r\n    this.VKI_layout["\\u0723\\u0718\\u072a\\u071d\\u071d\\u0710"] = {\r\n        name: "Syriac",\r\n        keys: [\r\n            [\r\n                ["\\u070f", "\\u032e", "\\u0651", "\\u0651"],\r\n                ["1", "!", "\\u0701", "\\u0701"],\r\n                ["2", "\\u030a", "\\u0702", "\\u0702"],\r\n                ["3", "\\u0325", "\\u0703", "\\u0703"],\r\n                ["4", "\\u0749", "\\u0704", "\\u0704"],\r\n                ["5", "\\u2670", "\\u0705", "\\u0705"],\r\n                ["6", "\\u2671", "\\u0708", "\\u0708"],\r\n                ["7", "\\u070a", "\\u0709", "\\u0709"],\r\n                ["8", "\\u00bb", "\\u070B", "\\u070B"],\r\n                ["9", ")", "\\u070C", "\\u070C"],\r\n                ["0", "(", "\\u070D", "\\u070D"],\r\n                ["-", "\\u00ab", "\\u250C", "\\u250C"],\r\n                ["=", "+", "\\u2510", "\\u2510"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0714", "\\u0730", "\\u064E", "\\u064E"],\r\n                ["\\u0728", "\\u0733", "\\u064B", "\\u064B"],\r\n                ["\\u0716", "\\u0736", "\\u064F", "\\u064F"],\r\n                ["\\u0729", "\\u073A", "\\u064C", "\\u064C"],\r\n                ["\\u0726", "\\u073D", "\\u0653", "\\u0653"],\r\n                ["\\u071c", "\\u0740", "\\u0654", "\\u0654"],\r\n                ["\\u0725", "\\u0741", "\\u0747", "\\u0747"],\r\n                ["\\u0717", "\\u0308", "\\u0743", "\\u0743"],\r\n                ["\\u071e", "\\u0304", "\\u0745", "\\u0745"],\r\n                ["\\u071a", "\\u0307", "\\u032D", "\\u032D"],\r\n                ["\\u0713", "\\u0303"],\r\n                ["\\u0715", "\\u074A"],\r\n                ["\\u0706", ":"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u072b", "\\u0731", "\\u0650", "\\u0650"],\r\n                ["\\u0723", "\\u0734", "\\u064d", "\\u064d"],\r\n                ["\\u071d", "\\u0737"],\r\n                ["\\u0712", "\\u073b", "\\u0621", "\\u0621"],\r\n                ["\\u0720", "\\u073e", "\\u0655", "\\u0655"],\r\n                ["\\u0710", "\\u0711", "\\u0670", "\\u0670"],\r\n                ["\\u072c", "\\u0640", "\\u0748", "\\u0748"],\r\n                ["\\u0722", "\\u0324", "\\u0744", "\\u0744"],\r\n                ["\\u0721", "\\u0331", "\\u0746", "\\u0746"],\r\n                ["\\u071f", "\\u0323"],\r\n                ["\\u071b", "\\u0330"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["]", "\\u0732"],\r\n                ["[", "\\u0735", "\\u0652", "\\u0652"],\r\n                ["\\u0724", "\\u0738"],\r\n                ["\\u072a", "\\u073c", "\\u200D"],\r\n                ["\\u0727", "\\u073f", "\\u200C"],\r\n                ["\\u0700", "\\u0739", "\\u200E"],\r\n                [".", "\\u0742", "\\u200F"],\r\n                ["\\u0718", "\\u060c"],\r\n                ["\\u0719", "\\u061b"],\r\n                ["\\u0707", "\\u061F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["syc"]\r\n    };\r\n    this.VKI_layout["\\u0ba4\\u0bae\\u0bbf\\u0bb4\\u0bcd"] = {\r\n        name: "Tamil",\r\n        keys: [\r\n            [\r\n                ["\\u0BCA", "\\u0B92"],\r\n                ["1", "", "\\u0BE7"],\r\n                ["2", "", "\\u0BE8"],\r\n                ["3", "", "\\u0BE9"],\r\n                ["4", "", "\\u0BEA"],\r\n                ["5", "", "\\u0BEB"],\r\n                ["6", "\\u0BA4\\u0BCD\\u0BB0", "\\u0BEC"],\r\n                ["7", "\\u0B95\\u0BCD\\u0BB7", "\\u0BED"],\r\n                ["8", "\\u0BB7\\u0BCD\\u0BB0", "\\u0BEE"],\r\n                ["9", "", "\\u0BEF"],\r\n                ["0", "", "\\u0BF0"],\r\n                ["-", "\\u0B83", "\\u0BF1"],\r\n                ["", "", "\\u0BF2"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0BCC", "\\u0B94"],\r\n                ["\\u0BC8", "\\u0B90"],\r\n                ["\\u0BBE", "\\u0B86"],\r\n                ["\\u0BC0", "\\u0B88"],\r\n                ["\\u0BC2", "\\u0B8A"],\r\n                ["\\u0BAA", "\\u0BAA"],\r\n                ["\\u0BB9", "\\u0B99"],\r\n                ["\\u0B95", "\\u0B95"],\r\n                ["\\u0BA4", "\\u0BA4"],\r\n                ["\\u0B9C", "\\u0B9A"],\r\n                ["\\u0B9F", "\\u0B9F"],\r\n                ["\\u0B9E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0BCB", "\\u0B93"],\r\n                ["\\u0BC7", "\\u0B8F"],\r\n                ["\\u0BCD", "\\u0B85"],\r\n                ["\\u0BBF", "\\u0B87"],\r\n                ["\\u0BC1", "\\u0B89"],\r\n                ["\\u0BAA", "\\u0BAA"],\r\n                ["\\u0BB0", "\\u0BB1"],\r\n                ["\\u0B95", "\\u0B95"],\r\n                ["\\u0BA4", "\\u0BA4"],\r\n                ["\\u0B9A", "\\u0B9A"],\r\n                ["\\u0B9F", "\\u0B9F"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0BC6", "\\u0B8E"],\r\n                [""],\r\n                ["\\u0BAE", "\\u0BA3"],\r\n                ["\\u0BA8", "\\u0BA9"],\r\n                ["\\u0BB5", "\\u0BB4"],\r\n                ["\\u0BB2", "\\u0BB3"],\r\n                ["\\u0BB8", "\\u0BB7"],\r\n                [",", "\\u0BB7"],\r\n                [".", "\\u0BB8\\u0BCD\\u0BB0\\u0BC0"],\r\n                ["\\u0BAF", "\\u0BAF"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["ta"]\r\n    };\r\n    this.VKI_layout["\\u0c24\\u0c46\\u0c32\\u0c41\\u0c17\\u0c41"] = {\r\n        name: "Telugu",\r\n        keys: [\r\n            [\r\n                ["\\u0C4A", "\\u0C12"],\r\n                ["1", "", "\\u0C67"],\r\n                ["2", "", "\\u0C68"],\r\n                ["3", "\\u0C4D\\u0C30", "\\u0C69"],\r\n                ["4", "", "\\u0C6A"],\r\n                ["5", "\\u0C1C\\u0C4D\\u0C1E", "\\u0C6B"],\r\n                ["6", "\\u0C24\\u0C4D\\u0C30", "\\u0C6C"],\r\n                ["7", "\\u0C15\\u0C4D\\u0C37", "\\u0C6D"],\r\n                ["8", "\\u0C36\\u0C4D\\u0C30", "\\u0C6E"],\r\n                ["9", "(", "\\u0C6F"],\r\n                ["0", ")", "\\u0C66"],\r\n                ["-", "\\u0C03"],\r\n                ["\\u0C43", "\\u0C0B", "\\u0C44"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0C4C", "\\u0C14"],\r\n                ["\\u0C48", "\\u0C10", "\\u0C56"],\r\n                ["\\u0C3E", "\\u0C06"],\r\n                ["\\u0C40", "\\u0C08", "", "\\u0C61"],\r\n                ["\\u0C42", "\\u0C0A"],\r\n                ["\\u0C2C"],\r\n                ["\\u0C39", "\\u0C19"],\r\n                ["\\u0C17", "\\u0C18"],\r\n                ["\\u0C26", "\\u0C27"],\r\n                ["\\u0C1C", "\\u0C1D"],\r\n                ["\\u0C21", "\\u0C22"],\r\n                ["", "\\u0C1E"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0C4B", "\\u0C13"],\r\n                ["\\u0C47", "\\u0C0F", "\\u0C55"],\r\n                ["\\u0C4D", "\\u0C05"],\r\n                ["\\u0C3F", "\\u0C07", "", "\\u0C0C"],\r\n                ["\\u0C41", "\\u0C09"],\r\n                ["\\u0C2A", "\\u0C2B"],\r\n                ["\\u0C30", "\\u0C31"],\r\n                ["\\u0C15", "\\u0C16"],\r\n                ["\\u0C24", "\\u0C25"],\r\n                ["\\u0C1A", "\\u0C1B"],\r\n                ["\\u0C1F", "\\u0C25"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0C46", "\\u0C0E"],\r\n                ["\\u0C02", "\\u0C01"],\r\n                ["\\u0C2E", "\\u0C23"],\r\n                ["\\u0C28", "\\u0C28"],\r\n                ["\\u0C35"],\r\n                ["\\u0C32", "\\u0C33"],\r\n                ["\\u0C38", "\\u0C36"],\r\n                [",", "\\u0C37"],\r\n                ["."],\r\n                ["\\u0C2F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["te"]\r\n    };\r\n    this.VKI_layout["Ti\\u1ebfng Vi\\u1ec7t"] = {\r\n        name: "Vietnamese",\r\n        keys: [\r\n            [\r\n                ["`", "~", "`", "~"],\r\n                ["\\u0103", "\\u0102", "1", "!"],\r\n                ["\\u00E2", "\\u00C2", "2", "@"],\r\n                ["\\u00EA", "\\u00CA", "3", "#"],\r\n                ["\\u00F4", "\\u00D4", "4", "$"],\r\n                ["\\u0300", "\\u0300", "5", "%"],\r\n                ["\\u0309", "\\u0309", "6", "^"],\r\n                ["\\u0303", "\\u0303", "7", "&"],\r\n                ["\\u0301", "\\u0301", "8", "*"],\r\n                ["\\u0323", "\\u0323", "9", "("],\r\n                ["\\u0111", "\\u0110", "0", ")"],\r\n                ["-", "_", "-", "_"],\r\n                ["\\u20AB", "+", "=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "q", "Q"],\r\n                ["w", "W", "w", "W"],\r\n                ["e", "E", "e", "E"],\r\n                ["r", "R", "r", "R"],\r\n                ["t", "T", "t", "T"],\r\n                ["y", "Y", "y", "Y"],\r\n                ["u", "U", "u", "U"],\r\n                ["i", "I", "i", "I"],\r\n                ["o", "O", "o", "O"],\r\n                ["p", "P", "p", "P"],\r\n                ["\\u01B0", "\\u01AF", "[", "{"],\r\n                ["\\u01A1", "\\u01A0", "]", "}"],\r\n                ["\\\\", "|", "\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "a", "A"],\r\n                ["s", "S", "s", "S"],\r\n                ["d", "D", "d", "D"],\r\n                ["f", "F", "f", "F"],\r\n                ["g", "G", "g", "G"],\r\n                ["h", "H", "h", "H"],\r\n                ["j", "J", "j", "J"],\r\n                ["k", "K", "k", "K"],\r\n                ["l", "L", "l", "L"],\r\n                [";", ":", ";", ":"],\r\n                ["\'", \'"\', "\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z", "z", "Z"],\r\n                ["x", "X", "x", "X"],\r\n                ["c", "C", "c", "C"],\r\n                ["v", "V", "v", "V"],\r\n                ["b", "B", "b", "B"],\r\n                ["n", "N", "n", "N"],\r\n                ["m", "M", "m", "M"],\r\n                [",", "<", ",", "<"],\r\n                [".", ">", ".", ">"],\r\n                ["/", "?", "/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["vi"]\r\n    };\r\n    this.VKI_layout["\\u0e44\\u0e17\\u0e22 Kedmanee"] = {\r\n        name: "Thai Kedmanee",\r\n        keys: [\r\n            [\r\n                ["_", "%"],\r\n                ["\\u0E45", "+"],\r\n                ["/", "\\u0E51"],\r\n                ["-", "\\u0E52"],\r\n                ["\\u0E20", "\\u0E53"],\r\n                ["\\u0E16", "\\u0E54"],\r\n                ["\\u0E38", "\\u0E39"],\r\n                ["\\u0E36", "\\u0E3F"],\r\n                ["\\u0E04", "\\u0E55"],\r\n                ["\\u0E15", "\\u0E56"],\r\n                ["\\u0E08", "\\u0E57"],\r\n                ["\\u0E02", "\\u0E58"],\r\n                ["\\u0E0A", "\\u0E59"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0E46", "\\u0E50"],\r\n                ["\\u0E44", \'"\'],\r\n                ["\\u0E33", "\\u0E0E"],\r\n                ["\\u0E1E", "\\u0E11"],\r\n                ["\\u0E30", "\\u0E18"],\r\n                ["\\u0E31", "\\u0E4D"],\r\n                ["\\u0E35", "\\u0E4A"],\r\n                ["\\u0E23", "\\u0E13"],\r\n                ["\\u0E19", "\\u0E2F"],\r\n                ["\\u0E22", "\\u0E0D"],\r\n                ["\\u0E1A", "\\u0E10"],\r\n                ["\\u0E25", ","],\r\n                ["\\u0E03", "\\u0E05"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0E1F", "\\u0E24"],\r\n                ["\\u0E2B", "\\u0E06"],\r\n                ["\\u0E01", "\\u0E0F"],\r\n                ["\\u0E14", "\\u0E42"],\r\n                ["\\u0E40", "\\u0E0C"],\r\n                ["\\u0E49", "\\u0E47"],\r\n                ["\\u0E48", "\\u0E4B"],\r\n                ["\\u0E32", "\\u0E29"],\r\n                ["\\u0E2A", "\\u0E28"],\r\n                ["\\u0E27", "\\u0E0B"],\r\n                ["\\u0E07", "."],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0E1C", "("],\r\n                ["\\u0E1B", ")"],\r\n                ["\\u0E41", "\\u0E09"],\r\n                ["\\u0E2D", "\\u0E2E"],\r\n                ["\\u0E34", "\\u0E3A"],\r\n                ["\\u0E37", "\\u0E4C"],\r\n                ["\\u0E17", "?"],\r\n                ["\\u0E21", "\\u0E12"],\r\n                ["\\u0E43", "\\u0E2C"],\r\n                ["\\u0E1D", "\\u0E26"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["th"]\r\n    };\r\n    this.VKI_layout["\\u0e44\\u0e17\\u0e22 Pattachote"] = {\r\n        name: "Thai Pattachote",\r\n        keys: [\r\n            [\r\n                ["_", "\\u0E3F"],\r\n                ["=", "+"],\r\n                ["\\u0E52", \'"\'],\r\n                ["\\u0E53", "/"],\r\n                ["\\u0E54", ","],\r\n                ["\\u0E55", "?"],\r\n                ["\\u0E39", "\\u0E38"],\r\n                ["\\u0E57", "_"],\r\n                ["\\u0E58", "."],\r\n                ["\\u0E59", "("],\r\n                ["\\u0E50", ")"],\r\n                ["\\u0E51", "-"],\r\n                ["\\u0E56", "%"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0E47", "\\u0E4A"],\r\n                ["\\u0E15", "\\u0E24"],\r\n                ["\\u0E22", "\\u0E46"],\r\n                ["\\u0E2D", "\\u0E0D"],\r\n                ["\\u0E23", "\\u0E29"],\r\n                ["\\u0E48", "\\u0E36"],\r\n                ["\\u0E14", "\\u0E1D"],\r\n                ["\\u0E21", "\\u0E0B"],\r\n                ["\\u0E27", "\\u0E16"],\r\n                ["\\u0E41", "\\u0E12"],\r\n                ["\\u0E43", "\\u0E2F"],\r\n                ["\\u0E0C", "\\u0E26"],\r\n                ["\\uF8C7", "\\u0E4D"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0E49", "\\u0E4B"],\r\n                ["\\u0E17", "\\u0E18"],\r\n                ["\\u0E07", "\\u0E33"],\r\n                ["\\u0E01", "\\u0E13"],\r\n                ["\\u0E31", "\\u0E4C"],\r\n                ["\\u0E35", "\\u0E37"],\r\n                ["\\u0E32", "\\u0E1C"],\r\n                ["\\u0E19", "\\u0E0A"],\r\n                ["\\u0E40", "\\u0E42"],\r\n                ["\\u0E44", "\\u0E06"],\r\n                ["\\u0E02", "\\u0E11"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0E1A", "\\u0E0E"],\r\n                ["\\u0E1B", "\\u0E0F"],\r\n                ["\\u0E25", "\\u0E10"],\r\n                ["\\u0E2B", "\\u0E20"],\r\n                ["\\u0E34", "\\u0E31"],\r\n                ["\\u0E04", "\\u0E28"],\r\n                ["\\u0E2A", "\\u0E2E"],\r\n                ["\\u0E30", "\\u0E1F"],\r\n                ["\\u0E08", "\\u0E09"],\r\n                ["\\u0E1E", "\\u0E2C"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["\\u0422\\u0430\\u0442\\u0430\\u0440\\u0447\\u0430"] = {\r\n        name: "Tatar",\r\n        keys: [\r\n            [\r\n                ["\\u04BB", "\\u04BA", "\\u0451", "\\u0401"],\r\n                ["1", "!"],\r\n                ["2", \'"\', "@"],\r\n                ["3", "\\u2116", "#"],\r\n                ["4", ";", "$"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?", "["],\r\n                ["8", "*", "]"],\r\n                ["9", "(", "{"],\r\n                ["0", ")", "}"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u04E9", "\\u04E8", "\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u04D9", "\\u04D8", "\\u0449", "\\u0429"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u04AF", "\\u04AE", "\\u044A", "\\u042A"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u044B", "\\u042B"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u04A3", "\\u04A2", "\\u0436", "\\u0416"],\r\n                ["\\u044D", "\\u042D", "\'"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0491", "\\u0490"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u0497", "\\u0496", "\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411", "<"],\r\n                ["\\u044E", "\\u042E", ">"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["tt"]\r\n    };\r\n    this.VKI_layout["T\\u00fcrk\\u00e7e F"] = {\r\n        name: "Turkish F",\r\n        keys: [\r\n            [\r\n                ["+", "*", "\\u00ac"],\r\n                ["1", "!", "\\u00b9", "\\u00a1"],\r\n                ["2", \'"\', "\\u00b2"],\r\n                ["3", "^", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00bc", "\\u00a4"],\r\n                ["5", "%", "\\u00bd"],\r\n                ["6", "&", "\\u00be"],\r\n                ["7", "\'", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["/", "?", "\\\\", "\\u00bf"],\r\n                ["-", "_", "|"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["f", "F", "@"],\r\n                ["g", "G"],\r\n                ["\\u011f", "\\u011e"],\r\n                ["\\u0131", "I", "\\u00b6", "\\u00ae"],\r\n                ["o", "O"],\r\n                ["d", "D", "\\u00a5"],\r\n                ["r", "R"],\r\n                ["n", "N"],\r\n                ["h", "H", "\\u00f8", "\\u00d8"],\r\n                ["p", "P", "\\u00a3"],\r\n                ["q", "Q", "\\u00a8"],\r\n                ["w", "W", "~"],\r\n                ["x", "X", "`"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["u", "U", "\\u00e6", "\\u00c6"],\r\n                ["i", "\\u0130", "\\u00df", "\\u00a7"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["a", "A", " ", "\\u00aa"],\r\n                ["\\u00fc", "\\u00dc"],\r\n                ["t", "T"],\r\n                ["k", "K"],\r\n                ["m", "M"],\r\n                ["l", "L"],\r\n                ["y", "Y", "\\u00b4"],\r\n                ["\\u015f", "\\u015e"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|", "\\u00a6"],\r\n                ["j", "J", "\\u00ab", "<"],\r\n                ["\\u00f6", "\\u00d6", "\\u00bb", ">"],\r\n                ["v", "V", "\\u00a2", "\\u00a9"],\r\n                ["c", "C"],\r\n                ["\\u00e7", "\\u00c7"],\r\n                ["z", "Z"],\r\n                ["s", "S", "\\u00b5", "\\u00ba"],\r\n                ["b", "B", "\\u00d7"],\r\n                [".", ":", "\\u00f7"],\r\n                [",", ";", "-"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["T\\u00fcrk\\u00e7e Q"] = {\r\n        name: "Turkish Q",\r\n        keys: [\r\n            [\r\n                [\'"\', "\\u00e9", "<"],\r\n                ["1", "!", ">"],\r\n                ["2", "\'", "\\u00a3"],\r\n                ["3", "^", "#"],\r\n                ["4", "+", "$"],\r\n                ["5", "%", "\\u00bd"],\r\n                ["6", "&"],\r\n                ["7", "/", "{"],\r\n                ["8", "(", "["],\r\n                ["9", ")", "]"],\r\n                ["0", "=", "}"],\r\n                ["*", "?", "\\\\"],\r\n                ["-", "_", "|"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "@"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u20ac"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["\\u0131", "I", "i", "\\u0130"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["\\u011f", "\\u011e", "\\u00a8"],\r\n                ["\\u00fc", "\\u00dc", "~"],\r\n                [",", ";", "`"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00e6", "\\u00c6"],\r\n                ["s", "S", "\\u00df"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                ["\\u015f", "\\u015e", "\\u00b4"],\r\n                ["i", "\\u0130"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["<", ">", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                ["\\u00f6", "\\u00d6"],\r\n                ["\\u00e7", "\\u00c7"],\r\n                [".", ":"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["tr"]\r\n    };\r\n    this.VKI_layout["\\u0423\\u043a\\u0440\\u0430\\u0457\\u043d\\u0441\\u044c\\u043a\\u0430"] = {\r\n        name: "Ukrainian",\r\n        keys: [\r\n            [\r\n                ["\\u00b4", "~"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u0449", "\\u0429"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u0457", "\\u0407"],\r\n                ["\\u0491", "\\u0490"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u0456", "\\u0406"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u0454", "\\u0404"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044E", "\\u042E"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["uk"]\r\n    };\r\n    this.VKI_layout["United Kingdom"] = {\r\n        name: "United Kingdom",\r\n        keys: [\r\n            [\r\n                ["`", "\\u00ac", "\\u00a6"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u00a3"],\r\n                ["4", "$", "\\u20ac"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E", "\\u00e9", "\\u00c9"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U", "\\u00fa", "\\u00da"],\r\n                ["i", "I", "\\u00ed", "\\u00cd"],\r\n                ["o", "O", "\\u00f3", "\\u00d3"],\r\n                ["p", "P"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["#", "~"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00e1", "\\u00c1"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":"],\r\n                ["\'", "@"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\\\", "|"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["AltGr", "AltGr"]\r\n            ]\r\n        ],\r\n        lang: ["en-gb"]\r\n    };\r\n    this.VKI_layout["\\u0627\\u0631\\u062f\\u0648"] = {\r\n        name: "Urdu",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "\\u066A"],\r\n                ["6", "^"],\r\n                ["7", "\\u06D6"],\r\n                ["8", "\\u066D"],\r\n                ["9", ")"],\r\n                ["0", "("],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0637", "\\u0638"],\r\n                ["\\u0635", "\\u0636"],\r\n                ["\\u06be", "\\u0630"],\r\n                ["\\u062f", "\\u0688"],\r\n                ["\\u0679", "\\u062B"],\r\n                ["\\u067e", "\\u0651"],\r\n                ["\\u062a", "\\u06C3"],\r\n                ["\\u0628", "\\u0640"],\r\n                ["\\u062c", "\\u0686"],\r\n                ["\\u062d", "\\u062E"],\r\n                ["]", "}"],\r\n                ["[", "{"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0645", "\\u0698"],\r\n                ["\\u0648", "\\u0632"],\r\n                ["\\u0631", "\\u0691"],\r\n                ["\\u0646", "\\u06BA"],\r\n                ["\\u0644", "\\u06C2"],\r\n                ["\\u06c1", "\\u0621"],\r\n                ["\\u0627", "\\u0622"],\r\n                ["\\u06A9", "\\u06AF"],\r\n                ["\\u06CC", "\\u064A"],\r\n                ["\\u061b", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0642", "\\u200D"],\r\n                ["\\u0641", "\\u200C"],\r\n                ["\\u06D2", "\\u06D3"],\r\n                ["\\u0633", "\\u200E"],\r\n                ["\\u0634", "\\u0624"],\r\n                ["\\u063a", "\\u0626"],\r\n                ["\\u0639", "\\u200F"],\r\n                ["\\u060C", ">"],\r\n                ["\\u06D4", "<"],\r\n                ["/", "\\u061F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["ur"]\r\n    };\r\n    this.VKI_layout["\\u0627\\u0631\\u062f\\u0648 Phonetic"] = {\r\n        name: "Urdu Phonetic",\r\n        keys: [\r\n            [\r\n                ["\\u064D", "\\u064B", "~"],\r\n                ["\\u06F1", "1", "!"],\r\n                ["\\u06F2", "2", "@"],\r\n                ["\\u06F3", "3", "#"],\r\n                ["\\u06F4", "4", "$"],\r\n                ["\\u06F5", "5", "\\u066A"],\r\n                ["\\u06F6", "6", "^"],\r\n                ["\\u06F7", "7", "&"],\r\n                ["\\u06F8", "8", "*"],\r\n                ["\\u06F9", "9", "("],\r\n                ["\\u06F0", "0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0642", "\\u0652"],\r\n                ["\\u0648", "\\u0651", "\\u0602"],\r\n                ["\\u0639", "\\u0670", "\\u0656"],\r\n                ["\\u0631", "\\u0691", "\\u0613"],\r\n                ["\\u062A", "\\u0679", "\\u0614"],\r\n                ["\\u06D2", "\\u064E", "\\u0601"],\r\n                ["\\u0621", "\\u0626", "\\u0654"],\r\n                ["\\u06CC", "\\u0650", "\\u0611"],\r\n                ["\\u06C1", "\\u06C3"],\r\n                ["\\u067E", "\\u064F", "\\u0657"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0627", "\\u0622", "\\uFDF2"],\r\n                ["\\u0633", "\\u0635", "\\u0610"],\r\n                ["\\u062F", "\\u0688", "\\uFDFA"],\r\n                ["\\u0641"],\r\n                ["\\u06AF", "\\u063A"],\r\n                ["\\u062D", "\\u06BE", "\\u0612"],\r\n                ["\\u062C", "\\u0636", "\\uFDFB"],\r\n                ["\\u06A9", "\\u062E"],\r\n                ["\\u0644"],\r\n                ["\\u061B", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u0632", "\\u0630", "\\u060F"],\r\n                ["\\u0634", "\\u0698", "\\u060E"],\r\n                ["\\u0686", "\\u062B", "\\u0603"],\r\n                ["\\u0637", "\\u0638"],\r\n                ["\\u0628", "", "\\uFDFD"],\r\n                ["\\u0646", "\\u06BA", "\\u0600"],\r\n                ["\\u0645", "\\u0658"],\r\n                ["\\u060C", "", "<"],\r\n                ["\\u06D4", "\\u066B", ">"],\r\n                ["/", "\\u061F"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ]\r\n    };\r\n    this.VKI_layout["US Standard"] = {\r\n        name: "US Standard",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q"],\r\n                ["w", "W"],\r\n                ["e", "E"],\r\n                ["r", "R"],\r\n                ["t", "T"],\r\n                ["y", "Y"],\r\n                ["u", "U"],\r\n                ["i", "I"],\r\n                ["o", "O"],\r\n                ["p", "P"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A"],\r\n                ["s", "S"],\r\n                ["d", "D"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z"],\r\n                ["x", "X"],\r\n                ["c", "C"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N"],\r\n                ["m", "M"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["en-us"]\r\n    };\r\n    this.VKI_layout["US International"] = {\r\n        name: "US International",\r\n        keys: [\r\n            [\r\n                ["`", "~"],\r\n                ["1", "!", "\\u00a1", "\\u00b9"],\r\n                ["2", "@", "\\u00b2"],\r\n                ["3", "#", "\\u00b3"],\r\n                ["4", "$", "\\u00a4", "\\u00a3"],\r\n                ["5", "%", "\\u20ac"],\r\n                ["6", "^", "\\u00bc"],\r\n                ["7", "&", "\\u00bd"],\r\n                ["8", "*", "\\u00be"],\r\n                ["9", "(", "\\u2018"],\r\n                ["0", ")", "\\u2019"],\r\n                ["-", "_", "\\u00a5"],\r\n                ["=", "+", "\\u00d7", "\\u00f7"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["q", "Q", "\\u00e4", "\\u00c4"],\r\n                ["w", "W", "\\u00e5", "\\u00c5"],\r\n                ["e", "E", "\\u00e9", "\\u00c9"],\r\n                ["r", "R", "\\u00ae"],\r\n                ["t", "T", "\\u00fe", "\\u00de"],\r\n                ["y", "Y", "\\u00fc", "\\u00dc"],\r\n                ["u", "U", "\\u00fa", "\\u00da"],\r\n                ["i", "I", "\\u00ed", "\\u00cd"],\r\n                ["o", "O", "\\u00f3", "\\u00d3"],\r\n                ["p", "P", "\\u00f6", "\\u00d6"],\r\n                ["[", "{", "\\u00ab"],\r\n                ["]", "}", "\\u00bb"],\r\n                ["\\\\", "|", "\\u00ac", "\\u00a6"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["a", "A", "\\u00e1", "\\u00c1"],\r\n                ["s", "S", "\\u00df", "\\u00a7"],\r\n                ["d", "D", "\\u00f0", "\\u00d0"],\r\n                ["f", "F"],\r\n                ["g", "G"],\r\n                ["h", "H"],\r\n                ["j", "J"],\r\n                ["k", "K"],\r\n                ["l", "L", "\\u00f8", "\\u00d8"],\r\n                [";", ":", "\\u00b6", "\\u00b0"],\r\n                ["\'", \'"\', "\\u00b4", "\\u00a8"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["z", "Z", "\\u00e6", "\\u00c6"],\r\n                ["x", "X"],\r\n                ["c", "C", "\\u00a9", "\\u00a2"],\r\n                ["v", "V"],\r\n                ["b", "B"],\r\n                ["n", "N", "\\u00f1", "\\u00d1"],\r\n                ["m", "M", "\\u00b5"],\r\n                [",", "<", "\\u00e7", "\\u00c7"],\r\n                [".", ">"],\r\n                ["/", "?", "\\u00bf"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["en"]\r\n    };\r\n    this.VKI_layout["\\u040e\\u0437\\u0431\\u0435\\u043a\\u0447\\u0430"] = {\r\n        name: "Uzbek Cyrillic",\r\n        keys: [\r\n            [\r\n                ["\\u0451", "\\u0401"],\r\n                ["1", "!"],\r\n                ["2", \'"\'],\r\n                ["3", "\\u2116"],\r\n                ["4", ";"],\r\n                ["5", "%"],\r\n                ["6", ":"],\r\n                ["7", "?"],\r\n                ["8", "*"],\r\n                ["9", "("],\r\n                ["0", ")"],\r\n                ["\\u0493", "\\u0492"],\r\n                ["\\u04B3", "\\u04B2"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u0439", "\\u0419"],\r\n                ["\\u0446", "\\u0426"],\r\n                ["\\u0443", "\\u0423"],\r\n                ["\\u043A", "\\u041A"],\r\n                ["\\u0435", "\\u0415"],\r\n                ["\\u043D", "\\u041D"],\r\n                ["\\u0433", "\\u0413"],\r\n                ["\\u0448", "\\u0428"],\r\n                ["\\u045E", "\\u040E"],\r\n                ["\\u0437", "\\u0417"],\r\n                ["\\u0445", "\\u0425"],\r\n                ["\\u044A", "\\u042A"],\r\n                ["\\\\", "/"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u0444", "\\u0424"],\r\n                ["\\u049B", "\\u049A"],\r\n                ["\\u0432", "\\u0412"],\r\n                ["\\u0430", "\\u0410"],\r\n                ["\\u043F", "\\u041F"],\r\n                ["\\u0440", "\\u0420"],\r\n                ["\\u043E", "\\u041E"],\r\n                ["\\u043B", "\\u041B"],\r\n                ["\\u0434", "\\u0414"],\r\n                ["\\u0436", "\\u0416"],\r\n                ["\\u044D", "\\u042D"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u044F", "\\u042F"],\r\n                ["\\u0447", "\\u0427"],\r\n                ["\\u0441", "\\u0421"],\r\n                ["\\u043C", "\\u041C"],\r\n                ["\\u0438", "\\u0418"],\r\n                ["\\u0442", "\\u0422"],\r\n                ["\\u044C", "\\u042C"],\r\n                ["\\u0431", "\\u0411"],\r\n                ["\\u044E", "\\u042E"],\r\n                [".", ","],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["uz"]\r\n    };\r\n    this.VKI_layout["\\u05d9\\u05d9\\u05b4\\u05d3\\u05d9\\u05e9"] = {\r\n        name: "Yiddish",\r\n        keys: [\r\n            [\r\n                [";", "~", "\\u05B0"],\r\n                ["1", "!", "\\u05B1"],\r\n                ["2", "@", "\\u05B2"],\r\n                ["3", "#", "\\u05B3"],\r\n                ["4", "$", "\\u05B4"],\r\n                ["5", "%", "\\u05B5"],\r\n                ["6", "^", "\\u05B6"],\r\n                ["7", "*", "\\u05B7"],\r\n                ["8", "&", "\\u05B8"],\r\n                ["9", "(", "\\u05C2"],\r\n                ["0", ")", "\\u05C1"],\r\n                ["-", "_", "\\u05B9"],\r\n                ["=", "+", "\\u05BC"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["/", "\\u201F", "\\u201F"],\r\n                ["\'", "\\u201E", "\\u201E"],\r\n                ["\\u05E7", "`", "`"],\r\n                ["\\u05E8", "\\uFB2F", "\\uFB2F"],\r\n                ["\\u05D0", "\\uFB2E", "\\uFB2E"],\r\n                ["\\u05D8", "\\u05F0", "\\u05F0"],\r\n                ["\\u05D5", "\\uFB35", "\\uFB35"],\r\n                ["\\u05DF", "\\uFB4B", "\\uFB4B"],\r\n                ["\\u05DD", "\\uFB4E", "\\uFB4E"],\r\n                ["\\u05E4", "\\uFB44", "\\uFB44"],\r\n                ["[", "{", "\\u05BD"],\r\n                ["]", "}", "\\u05BF"],\r\n                ["\\\\", "|", "\\u05BB"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u05E9", "\\uFB2A", "\\uFB2A"],\r\n                ["\\u05D3", "\\uFB2B", "\\uFB2B"],\r\n                ["\\u05D2"],\r\n                ["\\u05DB", "\\uFB3B", "\\uFB3B"],\r\n                ["\\u05E2", "\\u05F1", "\\u05F1"],\r\n                ["\\u05D9", "\\uFB1D", "\\uFB1D"],\r\n                ["\\u05D7", "\\uFF1F", "\\uFF1F"],\r\n                ["\\u05DC", "\\u05F2", "\\u05F2"],\r\n                ["\\u05DA"],\r\n                ["\\u05E3", ":", "\\u05C3"],\r\n                [",", \'"\', "\\u05C0"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u05D6", "\\u2260", "\\u2260"],\r\n                ["\\u05E1", "\\uFB4C", "\\uFB4C"],\r\n                ["\\u05D1", "\\uFB31", "\\uFB31"],\r\n                ["\\u05D4", "\\u05BE", "\\u05BE"],\r\n                ["\\u05E0", "\\u2013", "\\u2013"],\r\n                ["\\u05DE", "\\u2014", "\\u2014"],\r\n                ["\\u05E6", "\\uFB4A", "\\uFB4A"],\r\n                ["\\u05EA", "<", "\\u05F3"],\r\n                ["\\u05E5", ">", "\\u05F4"],\r\n                [".", "?", "\\u20AA"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["yi"]\r\n    };\r\n    this.VKI_layout["\\u05d9\\u05d9\\u05b4\\u05d3\\u05d9\\u05e9 \\u05dc\\u05e2\\u05d1\\u05d8"] = {\r\n        name: "Yiddish (Yidish Lebt)",\r\n        keys: [\r\n            [\r\n                [";", "~"],\r\n                ["1", "!", "\\u05B2", "\\u05B2"],\r\n                ["2", "@", "\\u05B3", "\\u05B3"],\r\n                ["3", "#", "\\u05B1", "\\u05B1"],\r\n                ["4", "$", "\\u05B4", "\\u05B4"],\r\n                ["5", "%", "\\u05B5", "\\u05B5"],\r\n                ["6", "^", "\\u05B7", "\\u05B7"],\r\n                ["7", "&", "\\u05B8", "\\u05B8"],\r\n                ["8", "*", "\\u05BB", "\\u05BB"],\r\n                ["9", ")", "\\u05B6", "\\u05B6"],\r\n                ["0", "(", "\\u05B0", "\\u05B0"],\r\n                ["-", "_", "\\u05BF", "\\u05BF"],\r\n                ["=", "+", "\\u05B9", "\\u05B9"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["/", "", "\\u05F4", "\\u05F4"],\r\n                ["\'", "", "\\u05F3", "\\u05F3"],\r\n                ["\\u05E7", "", "\\u20AC"],\r\n                ["\\u05E8"],\r\n                ["\\u05D0", "", "\\u05D0\\u05B7", "\\uFB2E"],\r\n                ["\\u05D8", "", "\\u05D0\\u05B8", "\\uFB2F"],\r\n                ["\\u05D5", "\\u05D5\\u05B9", "\\u05D5\\u05BC", "\\uFB35"],\r\n                ["\\u05DF", "", "\\u05D5\\u05D5", "\\u05F0"],\r\n                ["\\u05DD", "", "\\u05BC"],\r\n                ["\\u05E4", "", "\\u05E4\\u05BC", "\\uFB44"],\r\n                ["]", "}", "\\u201E", "\\u201D"],\r\n                ["[", "{", "\\u201A", "\\u2019"],\r\n                ["\\\\", "|", "\\u05BE", "\\u05BE"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u05E9", "\\u05E9\\u05C1", "\\u05E9\\u05C2", "\\uFB2B"],\r\n                ["\\u05D3", "", "\\u20AA"],\r\n                ["\\u05D2", "\\u201E"],\r\n                ["\\u05DB", "", "\\u05DB\\u05BC", "\\uFB3B"],\r\n                ["\\u05E2", "", "", "\\uFB20"],\r\n                ["\\u05D9", "", "\\u05D9\\u05B4", "\\uFB1D"],\r\n                ["\\u05D7", "", "\\u05F2\\u05B7", "\\uFB1F"],\r\n                ["\\u05DC", "\\u05DC\\u05B9", "\\u05D5\\u05D9", "\\u05F1"],\r\n                ["\\u05DA", "", "", "\\u05F2"],\r\n                ["\\u05E3", ":", "\\u05E4\\u05BF", "\\uFB4E"],\r\n                [",", \'"\', ";", "\\u05B2"],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u05D6", "", "\\u2013", "\\u2013"],\r\n                ["\\u05E1", "", "\\u2014", "\\u2014"],\r\n                ["\\u05D1", "\\u05DC\\u05B9", "\\u05D1\\u05BF", "\\uFB4C"],\r\n                ["\\u05D4", "", "\\u201D", "\\u201C"],\r\n                ["\\u05E0", "", "\\u059C", "\\u059E"],\r\n                ["\\u05DE", "", "\\u2019", "\\u2018"],\r\n                ["\\u05E6", "", "\\u05E9\\u05C1", "\\uFB2A"],\r\n                ["\\u05EA", ">", "\\u05EA\\u05BC", "\\uFB4A"],\r\n                ["\\u05E5", "<"],\r\n                [".", "?", "\\u2026"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " ", " ", " "],\r\n                ["Alt", "Alt"]\r\n            ]\r\n        ],\r\n        lang: ["yi"]\r\n    };\r\n    this.VKI_layout["\\u4e2d\\u6587\\u6ce8\\u97f3\\u7b26\\u53f7"] = {\r\n        name: "Chinese Bopomofo IME",\r\n        keys: [\r\n            [\r\n                ["\\u20AC", "~"],\r\n                ["\\u3105", "!"],\r\n                ["\\u3109", "@"],\r\n                ["\\u02C7", "#"],\r\n                ["\\u02CB", "$"],\r\n                ["\\u3113", "%"],\r\n                ["\\u02CA", "^"],\r\n                ["\\u02D9", "&"],\r\n                ["\\u311A", "*"],\r\n                ["\\u311E", ")"],\r\n                ["\\u3122", "("],\r\n                ["\\u3126", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u3106", "q"],\r\n                ["\\u310A", "w"],\r\n                ["\\u310D", "e"],\r\n                ["\\u3110", "r"],\r\n                ["\\u3114", "t"],\r\n                ["\\u3117", "y"],\r\n                ["\\u3127", "u"],\r\n                ["\\u311B", "i"],\r\n                ["\\u311F", "o"],\r\n                ["\\u3123", "p"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u3107", "a"],\r\n                ["\\u310B", "s"],\r\n                ["\\u310E", "d"],\r\n                ["\\u3111", "f"],\r\n                ["\\u3115", "g"],\r\n                ["\\u3118", "h"],\r\n                ["\\u3128", "j"],\r\n                ["\\u311C", "k"],\r\n                ["\\u3120", "l"],\r\n                ["\\u3124", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\u3108", "z"],\r\n                ["\\u310C", "x"],\r\n                ["\\u310F", "c"],\r\n                ["\\u3112", "v"],\r\n                ["\\u3116", "b"],\r\n                ["\\u3119", "n"],\r\n                ["\\u3129", "m"],\r\n                ["\\u311D", "<"],\r\n                ["\\u3121", ">"],\r\n                ["\\u3125", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["zh-Bopo"]\r\n    };\r\n    this.VKI_layout["\\u4e2d\\u6587\\u4ed3\\u9889\\u8f93\\u5165\\u6cd5"] = {\r\n        name: "Chinese Cangjie IME",\r\n        keys: [\r\n            [\r\n                ["\\u20AC", "~"],\r\n                ["1", "!"],\r\n                ["2", "@"],\r\n                ["3", "#"],\r\n                ["4", "$"],\r\n                ["5", "%"],\r\n                ["6", "^"],\r\n                ["7", "&"],\r\n                ["8", "*"],\r\n                ["9", ")"],\r\n                ["0", "("],\r\n                ["-", "_"],\r\n                ["=", "+"],\r\n                ["Bksp", "Bksp"]\r\n            ],\r\n            [\r\n                ["Tab", "Tab"],\r\n                ["\\u624B", "q"],\r\n                ["\\u7530", "w"],\r\n                ["\\u6C34", "e"],\r\n                ["\\u53E3", "r"],\r\n                ["\\u5EFF", "t"],\r\n                ["\\u535C", "y"],\r\n                ["\\u5C71", "u"],\r\n                ["\\u6208", "i"],\r\n                ["\\u4EBA", "o"],\r\n                ["\\u5FC3", "p"],\r\n                ["[", "{"],\r\n                ["]", "}"],\r\n                ["\\\\", "|"]\r\n            ],\r\n            [\r\n                ["Caps", "Caps"],\r\n                ["\\u65E5", "a"],\r\n                ["\\u5C38", "s"],\r\n                ["\\u6728", "d"],\r\n                ["\\u706B", "f"],\r\n                ["\\u571F", "g"],\r\n                ["\\u7AF9", "h"],\r\n                ["\\u5341", "j"],\r\n                ["\\u5927", "k"],\r\n                ["\\u4E2D", "l"],\r\n                [";", ":"],\r\n                ["\'", \'"\'],\r\n                ["Enter", "Enter"]\r\n            ],\r\n            [\r\n                ["Shift", "Shift"],\r\n                ["\\uFF3A", "z"],\r\n                ["\\u96E3", "x"],\r\n                ["\\u91D1", "c"],\r\n                ["\\u5973", "v"],\r\n                ["\\u6708", "b"],\r\n                ["\\u5F13", "n"],\r\n                ["\\u4E00", "m"],\r\n                [",", "<"],\r\n                [".", ">"],\r\n                ["/", "?"],\r\n                ["Shift", "Shift"]\r\n            ],\r\n            [\r\n                [" ", " "]\r\n            ]\r\n        ],\r\n        lang: ["zh"]\r\n    };\r\n    this.VKI_deadkey = {};\r\n    this.VKI_deadkey[\'"\'] = this.VKI_deadkey["\\u00a8"] = this.VKI_deadkey["\\u309B"] = {\r\n        a: "\\u00e4",\r\n        e: "\\u00eb",\r\n        i: "\\u00ef",\r\n        o: "\\u00f6",\r\n        u: "\\u00fc",\r\n        y: "\\u00ff",\r\n        "\\u03b9": "\\u03ca",\r\n        "\\u03c5": "\\u03cb",\r\n        "\\u016B": "\\u01D6",\r\n        "\\u00FA": "\\u01D8",\r\n        "\\u01D4": "\\u01DA",\r\n        "\\u00F9": "\\u01DC",\r\n        A: "\\u00c4",\r\n        E: "\\u00cb",\r\n        I: "\\u00cf",\r\n        O: "\\u00d6",\r\n        U: "\\u00dc",\r\n        Y: "\\u0178",\r\n        "\\u0399": "\\u03aa",\r\n        "\\u03a5": "\\u03ab",\r\n        "\\u016A": "\\u01D5",\r\n        "\\u00DA": "\\u01D7",\r\n        "\\u01D3": "\\u01D9",\r\n        "\\u00D9": "\\u01DB",\r\n        "\\u304b": "\\u304c",\r\n        "\\u304d": "\\u304e",\r\n        "\\u304f": "\\u3050",\r\n        "\\u3051": "\\u3052",\r\n        "\\u3053": "\\u3054",\r\n        "\\u305f": "\\u3060",\r\n        "\\u3061": "\\u3062",\r\n        "\\u3064": "\\u3065",\r\n        "\\u3066": "\\u3067",\r\n        "\\u3068": "\\u3069",\r\n        "\\u3055": "\\u3056",\r\n        "\\u3057": "\\u3058",\r\n        "\\u3059": "\\u305a",\r\n        "\\u305b": "\\u305c",\r\n        "\\u305d": "\\u305e",\r\n        "\\u306f": "\\u3070",\r\n        "\\u3072": "\\u3073",\r\n        "\\u3075": "\\u3076",\r\n        "\\u3078": "\\u3079",\r\n        "\\u307b": "\\u307c",\r\n        "\\u30ab": "\\u30ac",\r\n        "\\u30ad": "\\u30ae",\r\n        "\\u30af": "\\u30b0",\r\n        "\\u30b1": "\\u30b2",\r\n        "\\u30b3": "\\u30b4",\r\n        "\\u30bf": "\\u30c0",\r\n        "\\u30c1": "\\u30c2",\r\n        "\\u30c4": "\\u30c5",\r\n        "\\u30c6": "\\u30c7",\r\n        "\\u30c8": "\\u30c9",\r\n        "\\u30b5": "\\u30b6",\r\n        "\\u30b7": "\\u30b8",\r\n        "\\u30b9": "\\u30ba",\r\n        "\\u30bb": "\\u30bc",\r\n        "\\u30bd": "\\u30be",\r\n        "\\u30cf": "\\u30d0",\r\n        "\\u30d2": "\\u30d3",\r\n        "\\u30d5": "\\u30d6",\r\n        "\\u30d8": "\\u30d9",\r\n        "\\u30db": "\\u30dc"\r\n    };\r\n    this.VKI_deadkey["~"] = {\r\n        a: "\\u00e3",\r\n        l: "\\u0142",\r\n        n: "\\u00f1",\r\n        o: "\\u00f5",\r\n        A: "\\u00c3",\r\n        L: "\\u0141",\r\n        N: "\\u00d1",\r\n        O: "\\u00d5"\r\n    };\r\n    this.VKI_deadkey["^"] = {\r\n        a: "\\u00e2",\r\n        e: "\\u00ea",\r\n        i: "\\u00ee",\r\n        o: "\\u00f4",\r\n        u: "\\u00fb",\r\n        w: "\\u0175",\r\n        y: "\\u0177",\r\n        A: "\\u00c2",\r\n        E: "\\u00ca",\r\n        I: "\\u00ce",\r\n        O: "\\u00d4",\r\n        U: "\\u00db",\r\n        W: "\\u0174",\r\n        Y: "\\u0176"\r\n    };\r\n    this.VKI_deadkey["\\u02c7"] = {\r\n        c: "\\u010D",\r\n        d: "\\u010f",\r\n        e: "\\u011b",\r\n        s: "\\u0161",\r\n        l: "\\u013e",\r\n        n: "\\u0148",\r\n        r: "\\u0159",\r\n        t: "\\u0165",\r\n        u: "\\u01d4",\r\n        z: "\\u017E",\r\n        "\\u00fc": "\\u01da",\r\n        C: "\\u010C",\r\n        D: "\\u010e",\r\n        E: "\\u011a",\r\n        S: "\\u0160",\r\n        L: "\\u013d",\r\n        N: "\\u0147",\r\n        R: "\\u0158",\r\n        T: "\\u0164",\r\n        U: "\\u01d3",\r\n        Z: "\\u017D",\r\n        "\\u00dc": "\\u01d9"\r\n    };\r\n    this.VKI_deadkey["\\u02d8"] = {\r\n        a: "\\u0103",\r\n        g: "\\u011f",\r\n        A: "\\u0102",\r\n        G: "\\u011e"\r\n    };\r\n    this.VKI_deadkey["-"] = this.VKI_deadkey["\\u00af"] = {\r\n        a: "\\u0101",\r\n        e: "\\u0113",\r\n        i: "\\u012b",\r\n        o: "\\u014d",\r\n        u: "\\u016B",\r\n        y: "\\u0233",\r\n        "\\u00fc": "\\u01d6",\r\n        A: "\\u0100",\r\n        E: "\\u0112",\r\n        I: "\\u012a",\r\n        O: "\\u014c",\r\n        U: "\\u016A",\r\n        Y: "\\u0232",\r\n        "\\u00dc": "\\u01d5"\r\n    };\r\n    this.VKI_deadkey["`"] = {\r\n        a: "\\u00e0",\r\n        e: "\\u00e8",\r\n        i: "\\u00ec",\r\n        o: "\\u00f2",\r\n        u: "\\u00f9",\r\n        "\\u00fc": "\\u01dc",\r\n        A: "\\u00c0",\r\n        E: "\\u00c8",\r\n        I: "\\u00cc",\r\n        O: "\\u00d2",\r\n        U: "\\u00d9",\r\n        "\\u00dc": "\\u01db"\r\n    };\r\n    this.VKI_deadkey["\'"] = this.VKI_deadkey["\\u00b4"] = this.VKI_deadkey["\\u0384"] = {\r\n        a: "\\u00e1",\r\n        e: "\\u00e9",\r\n        i: "\\u00ed",\r\n        o: "\\u00f3",\r\n        u: "\\u00fa",\r\n        y: "\\u00fd",\r\n        "\\u03b1": "\\u03ac",\r\n        "\\u03b5": "\\u03ad",\r\n        "\\u03b7": "\\u03ae",\r\n        "\\u03b9": "\\u03af",\r\n        "\\u03bf": "\\u03cc",\r\n        "\\u03c5": "\\u03cd",\r\n        "\\u03c9": "\\u03ce",\r\n        "\\u00fc": "\\u01d8",\r\n        A: "\\u00c1",\r\n        E: "\\u00c9",\r\n        I: "\\u00cd",\r\n        O: "\\u00d3",\r\n        U: "\\u00da",\r\n        Y: "\\u00dd",\r\n        "\\u0391": "\\u0386",\r\n        "\\u0395": "\\u0388",\r\n        "\\u0397": "\\u0389",\r\n        "\\u0399": "\\u038a",\r\n        "\\u039f": "\\u038c",\r\n        "\\u03a5": "\\u038e",\r\n        "\\u03a9": "\\u038f",\r\n        "\\u00dc": "\\u01d7"\r\n    };\r\n    this.VKI_deadkey["\\u02dd"] = {\r\n        o: "\\u0151",\r\n        u: "\\u0171",\r\n        O: "\\u0150",\r\n        U: "\\u0170"\r\n    };\r\n    this.VKI_deadkey["\\u0385"] = {\r\n        "\\u03b9": "\\u0390",\r\n        "\\u03c5": "\\u03b0"\r\n    };\r\n    this.VKI_deadkey["\\u00b0"] = this.VKI_deadkey["\\u00ba"] = {\r\n        a: "\\u00e5",\r\n        u: "\\u016f",\r\n        A: "\\u00c5",\r\n        U: "\\u016e"\r\n    };\r\n    this.VKI_deadkey["\\u02DB"] = {\r\n        a: "\\u0106",\r\n        e: "\\u0119",\r\n        i: "\\u012f",\r\n        o: "\\u01eb",\r\n        u: "\\u0173",\r\n        y: "\\u0177",\r\n        A: "\\u0105",\r\n        E: "\\u0118",\r\n        I: "\\u012e",\r\n        O: "\\u01ea",\r\n        U: "\\u0172",\r\n        Y: "\\u0176"\r\n    };\r\n    this.VKI_deadkey["\\u02D9"] = {\r\n        c: "\\u010B",\r\n        e: "\\u0117",\r\n        g: "\\u0121",\r\n        z: "\\u017C",\r\n        C: "\\u010A",\r\n        E: "\\u0116",\r\n        G: "\\u0120",\r\n        Z: "\\u017B"\r\n    };\r\n    this.VKI_deadkey["\\u00B8"] = this.VKI_deadkey["\\u201a"] = {\r\n        c: "\\u00e7",\r\n        s: "\\u015F",\r\n        C: "\\u00c7",\r\n        S: "\\u015E"\r\n    };\r\n    this.VKI_deadkey[","] = {\r\n        s: (this.VKI_isIElt8) ? "\\u015F" : "\\u0219",\r\n        t: (this.VKI_isIElt8) ? "\\u0163" : "\\u021B",\r\n        S: (this.VKI_isIElt8) ? "\\u015E" : "\\u0218",\r\n        T: (this.VKI_isIElt8) ? "\\u0162" : "\\u021A"\r\n    };\r\n    this.VKI_deadkey["\\u3002"] = {\r\n        "\\u306f": "\\u3071",\r\n        "\\u3072": "\\u3074",\r\n        "\\u3075": "\\u3077",\r\n        "\\u3078": "\\u307a",\r\n        "\\u307b": "\\u307d",\r\n        "\\u30cf": "\\u30d1",\r\n        "\\u30d2": "\\u30d4",\r\n        "\\u30d5": "\\u30d7",\r\n        "\\u30d8": "\\u30da",\r\n        "\\u30db": "\\u30dd"\r\n    };\r\n    this.VKI_symbol = {\r\n        "\\u00a0": "NB\\nSP",\r\n        "\\u200b": "ZW\\nSP",\r\n        "\\u200c": "ZW\\nNJ",\r\n        "\\u200d": "ZW\\nJ"\r\n    };\r\n    this.VKI_numpad = [\r\n        [\r\n            ["$"],\r\n            ["\\u00a3"],\r\n            ["\\u20ac"],\r\n            ["\\u00a5"]\r\n        ],\r\n        [\r\n            ["7"],\r\n            ["8"],\r\n            ["9"],\r\n            ["/"]\r\n        ],\r\n        [\r\n            ["4"],\r\n            ["5"],\r\n            ["6"],\r\n            ["*"]\r\n        ],\r\n        [\r\n            ["1"],\r\n            ["2"],\r\n            ["3"],\r\n            ["-"]\r\n        ],\r\n        [\r\n            ["0"],\r\n            ["."],\r\n            ["="],\r\n            ["+"]\r\n        ]\r\n    ];\r\n    globalThis.VKI_attach = function(elem) {\r\n        if (elem.getAttribute("VKI_attached")) {\r\n            return false\r\n        }\r\n        if (self.VKI_imageURI) {\r\n            var keybut = document2.createElement("img");\r\n            keybut.src = self.VKI_imageURI;\r\n            keybut.alt = self.VKI_i18n["01"];\r\n            keybut.className = "keyboardInputInitiator";\r\n            keybut.title = self.VKI_i18n["01"];\r\n            keybut.elem = elem;\r\n            keybut.onclick = function(e) {\r\n                e = e || event;\r\n                if (e.stopPropagation) {\r\n                    e.stopPropagation()\r\n                } else {\r\n                    e.cancelBubble = true\r\n                }\r\n                self.VKI_show(this.elem)\r\n            };\r\n            elem.parentNode.insertBefore(keybut, (elem.dir == "rtl") ? elem : elem.nextSibling)\r\n        } else {\r\n            elem.onfocus = function() {\r\n                if (self.VKI_target != this) {\r\n                    if (self.VKI_target) {\r\n                        VKI_console.log("VKI_close from elem.onfocus");\r\n                        self.VKI_close()\r\n                    }\r\n                    self.VKI_show(this)\r\n                }\r\n            };\r\n            elem.onclick = function() {\r\n                if (!self.VKI_target) {\r\n                    self.VKI_show(this)\r\n                }\r\n            }\r\n        }\r\n        elem.setAttribute("VKI_attached", "true");\r\n        if (self.VKI_isIE) {\r\n            elem.onclick = elem.onselect = elem.onkeyup = function(e) {\r\n                if ((e || event).type != "keyup" || !this.readOnly) {\r\n                    this.range = document2.selection.createRange()\r\n                }\r\n            }\r\n        }\r\n        VKI_addListener(elem, "click", function(e) {\r\n            if (self.VKI_target == this) {\r\n                e = e || event;\r\n                if (e.stopPropagation) {\r\n                    e.stopPropagation()\r\n                } else {\r\n                    e.cancelBubble = true\r\n                }\r\n            }\r\n            return false\r\n        }, false);\r\n        if (self.VKI_isMoz) {\r\n            elem.addEventListener("blur", function() {\r\n                this.setAttribute("_scrollTop", this.scrollTop)\r\n            }, false)\r\n        }\r\n    };\r\n\r\n    function VKI_buildKeyboardInputs() {\r\n        var inputElems = [document2.getElementsByTagName("input"), document2.getElementsByTagName("textarea")];\r\n        for (var x = 0, elem; elem = inputElems[x++];) {\r\n            for (var y = 0, ex; ex = elem[y++];) {\r\n                if (ex.nodeName == "TEXTAREA" || ex.type == "text" || ex.type == "password") {\r\n                    if (ex.className.indexOf("keyboardInput") > -1) {\r\n                        VKI_attach(ex)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function VKI_mouseEvents(elem) {\r\n        if (elem.nodeName == "TD") {\r\n            if (!elem.click) {\r\n                elem.click = function() {\r\n                    var evt = this.ownerdocument2.createEvent("MouseEvents");\r\n                    evt.initMouseEvent("click", true, true, this.ownerdocument2.defaultView, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n                    this.dispatchEvent(evt)\r\n                }\r\n            }\r\n            elem.VKI_clickless = 0;\r\n            VKI_addListener(elem, "dblclick", function() {\r\n                return false\r\n            }, false)\r\n        }\r\n        VKI_addListener(elem, "mouseover", function() {\r\n            if (this.nodeName == "TD" && self.VKI_clickless) {\r\n                var _self = this;\r\n                clearTimeout(this.VKI_clickless);\r\n                this.VKI_clickless = setTimeout(function() {\r\n                    _self.click()\r\n                }, self.VKI_clickless)\r\n            }\r\n            if (self.VKI_isIE) {\r\n                this.className += " hover"\r\n            }\r\n        }, false);\r\n        VKI_addListener(elem, "mouseout", function() {\r\n            if (this.nodeName == "TD") {\r\n                clearTimeout(this.VKI_clickless)\r\n            }\r\n            if (self.VKI_isIE) {\r\n                this.className = this.className.replace(/ ?(hover|pressed) ?/g, "")\r\n            }\r\n        }, false);\r\n        VKI_addListener(elem, "mousedown", function() {\r\n            if (this.nodeName == "TD") {\r\n                clearTimeout(this.VKI_clickless)\r\n            }\r\n            if (self.VKI_isIE) {\r\n                this.className += " pressed"\r\n            }\r\n        }, false);\r\n        VKI_addListener(elem, "mouseup", function() {\r\n            if (this.nodeName == "TD") {\r\n                clearTimeout(this.VKI_clickless)\r\n            }\r\n            if (self.VKI_isIE) {\r\n                this.className = this.className.replace(/ ?pressed ?/g, "")\r\n            }\r\n        }, false)\r\n    }\r\n    this.VKI_keyboard = document2.createElement("table");\r\n    this.VKI_keyboard.id = "keyboardInputMaster";\r\n    this.VKI_keyboard.dir = "ltr";\r\n    this.VKI_keyboard.cellSpacing = "0";\r\n    this.VKI_keyboard.reflow = function() {\r\n        this.style.width = "50px";\r\n        var foo = this.offsetWidth;\r\n        this.style.width = ""\r\n    };\r\n    VKI_addListener(this.VKI_keyboard, "click", function(e) {\r\n        e = e || event;\r\n        if (e.stopPropagation) {\r\n            e.stopPropagation()\r\n        } else {\r\n            e.cancelBubble = true\r\n        }\r\n        return false\r\n    }, false);\r\n    if (!this.VKI_layout[this.VKI_kt]) {\r\n        return alert(\'No keyboard named "\' + this.VKI_kt + \'"\')\r\n    }\r\n    this.VKI_langCode = {};\r\n    var thead = document2.createElement("thead");\r\n    var tr = document2.createElement("tr");\r\n    var th = document2.createElement("th");\r\n    th.colSpan = "2";\r\n    th.id = "keyboardTitle";\r\n    var kbSelect = document2.createElement("div");\r\n    kbSelect.title = this.VKI_i18n["02"];\r\n    VKI_addListener(kbSelect, "click", function() {\r\n        var ol = this.getElementsByTagName("ol")[0];\r\n        if (!ol.style.display) {\r\n            ol.style.display = "block";\r\n            var li = ol.getElementsByTagName("li");\r\n            for (var x = 0, scr = 0; x < li.length; x++) {\r\n                if (VKI_kt == li[x].firstChild.nodeValue) {\r\n                    li[x].className = "selected";\r\n                    scr = li[x].offsetTop - li[x].offsetHeight * 2\r\n                } else {\r\n                    li[x].className = ""\r\n                }\r\n            }\r\n            setTimeout(function() {\r\n                ol.scrollTop = scr\r\n            }, 0)\r\n        } else {\r\n            ol.style.display = ""\r\n        }\r\n    }, false);\r\n    kbSelect.appendChild(document2.createTextNode(this.VKI_kt));\r\n    kbSelect.appendChild(document2.createTextNode(this.VKI_isIElt8 ? " \\u2193" : " \\u25be"));\r\n    kbSelect.langCount = 0;\r\n    var ol = document2.createElement("ol");\r\n    for (ktype in this.VKI_layout) {\r\n        if (typeof this.VKI_layout[ktype] == "object") {\r\n            if (!this.VKI_layout[ktype].lang) {\r\n                this.VKI_layout[ktype].lang = []\r\n            }\r\n            for (var x = 0; x < this.VKI_layout[ktype].lang.length; x++) {\r\n                this.VKI_langCode[this.VKI_layout[ktype].lang[x].toLowerCase().replace(/-/g, "_")] = ktype\r\n            }\r\n            var li = document2.createElement("li");\r\n            li.title = this.VKI_layout[ktype].name;\r\n            VKI_addListener(li, "click", function(e) {\r\n                e = e || event;\r\n                if (e.stopPropagation) {\r\n                    e.stopPropagation()\r\n                } else {\r\n                    e.cancelBubble = true\r\n                }\r\n                this.parentNode.style.display = "";\r\n                self.VKI_kts = self.VKI_kt = kbSelect.firstChild.nodeValue = this.firstChild.nodeValue;\r\n                self.VKI_buildKeys();\r\n                self.VKI_position(true)\r\n            }, false);\r\n            VKI_mouseEvents(li);\r\n            li.appendChild(document2.createTextNode(ktype));\r\n            ol.appendChild(li);\r\n            kbSelect.langCount++\r\n        }\r\n    }\r\n    kbSelect.appendChild(ol);\r\n    if (kbSelect.langCount > 1) {\r\n        th.appendChild(kbSelect)\r\n    }\r\n    this.VKI_langCode.index = [];\r\n    for (prop in this.VKI_langCode) {\r\n        if (prop != "index" && typeof this.VKI_langCode[prop] == "string") {\r\n            this.VKI_langCode.index.push(prop)\r\n        }\r\n    }\r\n    this.VKI_langCode.index.sort();\r\n    this.VKI_langCode.index.reverse();\r\n    if (this.VKI_numberPad) {\r\n        var span = document2.createElement("span");\r\n        span.appendChild(document2.createTextNode("#"));\r\n        span.title = this.VKI_i18n["00"];\r\n        VKI_addListener(span, "click", function() {\r\n            kbNumpad.style.display = (!kbNumpad.style.display) ? "none" : "";\r\n            self.VKI_position(true)\r\n        }, false);\r\n        VKI_mouseEvents(span);\r\n        th.appendChild(span)\r\n    }\r\n    this.VKI_kbsize = function(e) {\r\n        self.VKI_size = Math.min(5, Math.max(1, self.VKI_size));\r\n        self.VKI_keyboard.className = self.VKI_keyboard.className.replace(/ ?keyboardInputSize\\d ?/, "");\r\n        if (self.VKI_size != 2) {\r\n            self.VKI_keyboard.className += " keyboardInputSize" + self.VKI_size\r\n        }\r\n        self.VKI_position(true);\r\n        if (self.VKI_isOpera) {\r\n            self.VKI_keyboard.reflow()\r\n        }\r\n    };\r\n    if (this.VKI_sizeAdj) {\r\n        var small = document2.createElement("small");\r\n        small.title = this.VKI_i18n["10"];\r\n        VKI_addListener(small, "click", function() {\r\n            --self.VKI_size;\r\n            self.VKI_kbsize()\r\n        }, false);\r\n        VKI_mouseEvents(small);\r\n        small.appendChild(document2.createTextNode(this.VKI_isIElt8 ? "\\u2193" : "\\u21d3"));\r\n        th.appendChild(small);\r\n        var big = document2.createElement("big");\r\n        big.title = this.VKI_i18n["11"];\r\n        VKI_addListener(big, "click", function() {\r\n            ++self.VKI_size;\r\n            self.VKI_kbsize()\r\n        }, false);\r\n        VKI_mouseEvents(big);\r\n        big.appendChild(document2.createTextNode(this.VKI_isIElt8 ? "\\u2191" : "\\u21d1"));\r\n        th.appendChild(big)\r\n    }\r\n    var span = document2.createElement("span");\r\n    span.appendChild(document2.createTextNode(this.VKI_i18n["07"]));\r\n    span.title = this.VKI_i18n["08"];\r\n    VKI_addListener(span, "click", function() {\r\n        self.VKI_target.value = "";\r\n        self.VKI_target.focus();\r\n        return false\r\n    }, false);\r\n    VKI_mouseEvents(span);\r\n    var strong = document2.createElement("strong");\r\n    strong.appendChild(document2.createTextNode("X"));\r\n    strong.title = this.VKI_i18n["06"];\r\n    VKI_addListener(strong, "click", function() {\r\n        VKI_console.log("VKI_close from X.click");\r\n        self.VKI_close()\r\n    }, false);\r\n    VKI_mouseEvents(strong);\r\n    th.appendChild(strong);\r\n    tr.appendChild(th);\r\n    thead.appendChild(tr);\r\n    this.VKI_keyboard.appendChild(thead);\r\n    var tbody = document2.createElement("tbody");\r\n    var tr = document2.createElement("tr");\r\n    var td = document2.createElement("td");\r\n    var div = document2.createElement("div");\r\n    if (this.VKI_deadBox) {\r\n        var label = document2.createElement("label");\r\n        var checkbox = document2.createElement("input");\r\n        checkbox.type = "checkbox";\r\n        checkbox.title = this.VKI_i18n["03"] + ": " + ((this.VKI_deadkeysOn) ? this.VKI_i18n["04"] : this.VKI_i18n["05"]);\r\n        checkbox.defaultChecked = this.VKI_deadkeysOn;\r\n        VKI_addListener(checkbox, "click", function() {\r\n            this.title = self.VKI_i18n["03"] + ": " + ((this.checked) ? self.VKI_i18n["04"] : self.VKI_i18n["05"]);\r\n            self.VKI_modify("");\r\n            return true\r\n        }, false);\r\n        label.appendChild(checkbox);\r\n        checkbox.checked = this.VKI_deadkeysOn;\r\n        div.appendChild(label);\r\n        this.VKI_deadkeysOn = checkbox\r\n    } else {\r\n        this.VKI_deadkeysOn.checked = this.VKI_deadkeysOn\r\n    }\r\n    if (this.VKI_showVersion) {\r\n        var vr = document2.createElement("var");\r\n        vr.title = this.VKI_i18n["09"] + " " + this.VKI_version;\r\n        vr.appendChild(document2.createTextNode("v" + this.VKI_version));\r\n        div.appendChild(vr)\r\n    }\r\n    td.appendChild(div);\r\n    tr.appendChild(td);\r\n    var kbNumpad = document2.createElement("td");\r\n    kbNumpad.id = "keyboardInputNumpad";\r\n    if (!this.VKI_numberPadOn) {\r\n        kbNumpad.style.display = "none"\r\n    }\r\n    var ntable = document2.createElement("table");\r\n    ntable.cellSpacing = "0";\r\n    var ntbody = document2.createElement("tbody");\r\n    for (var x = 0; x < this.VKI_numpad.length; x++) {\r\n        var ntr = document2.createElement("tr");\r\n        for (var y = 0; y < this.VKI_numpad[x].length; y++) {\r\n            var ntd = document2.createElement("td");\r\n            VKI_addListener(ntd, "click", VKI_keyClick, false);\r\n            VKI_mouseEvents(ntd);\r\n            ntd.appendChild(document2.createTextNode(this.VKI_numpad[x][y]));\r\n            ntr.appendChild(ntd)\r\n        }\r\n        ntbody.appendChild(ntr)\r\n    }\r\n    ntable.appendChild(ntbody);\r\n    kbNumpad.appendChild(ntable);\r\n    tr.appendChild(kbNumpad);\r\n    tbody.appendChild(tr);\r\n    this.VKI_keyboard.appendChild(tbody);\r\n    if (this.VKI_isIE6) {\r\n        this.VKI_iframe = document2.createElement("iframe");\r\n        this.VKI_iframe.style.position = "absolute";\r\n        this.VKI_iframe.style.border = "0px none";\r\n        this.VKI_iframe.style.filter = "mask()";\r\n        this.VKI_iframe.style.zIndex = "999999";\r\n        this.VKI_iframe.src = this.VKI_imageURI\r\n    }\r\n\r\n    function VKI_keyClick() {\r\n        var done = false,\r\n            character = "\\xa0";\r\n        if (this.firstChild.nodeName.toLowerCase() != "small") {\r\n            if ((character = this.firstChild.nodeValue) == "\\xa0") {\r\n                return false\r\n            }\r\n        } else {\r\n            character = this.firstChild.getAttribute("char")\r\n        }\r\n        if (self.VKI_deadkeysOn.checked && self.VKI_dead) {\r\n            if (self.VKI_dead != character) {\r\n                if (character != " ") {\r\n                    if (self.VKI_deadkey[self.VKI_dead][character]) {\r\n                        self.VKI_insert(self.VKI_deadkey[self.VKI_dead][character]);\r\n                        done = true\r\n                    }\r\n                } else {\r\n                    self.VKI_insert(self.VKI_dead);\r\n                    done = true\r\n                }\r\n            } else {\r\n                done = true\r\n            }\r\n        }\r\n        self.VKI_dead = false;\r\n        if (!done) {\r\n            if (self.VKI_deadkeysOn.checked && self.VKI_deadkey[character]) {\r\n                self.VKI_dead = character;\r\n                this.className += " dead";\r\n                if (self.VKI_shift) {\r\n                    self.VKI_modify("Shift")\r\n                }\r\n                if (self.VKI_altgr) {\r\n                    self.VKI_modify("AltGr")\r\n                }\r\n            } else {\r\n                self.VKI_insert(character)\r\n            }\r\n        }\r\n        self.VKI_modify("");\r\n        return false\r\n    }\r\n    this.VKI_buildKeys = function() {\r\n        this.VKI_shift = this.VKI_shiftlock = this.VKI_altgr = this.VKI_altgrlock = this.VKI_dead = false;\r\n        var container = this.VKI_keyboard.tBodies[0].getElementsByTagName("div")[0];\r\n        var tables = container.getElementsByTagName("table");\r\n        for (var x = tables.length - 1; x >= 0; x--) {\r\n            container.removeChild(tables[x])\r\n        }\r\n        for (var x = 0, hasDeadKey = false, lyt; lyt = this.VKI_layout[this.VKI_kt].keys[x++];) {\r\n            var table = document2.createElement("table");\r\n            table.cellSpacing = "0";\r\n            if (lyt.length <= this.VKI_keyCenter) {\r\n                table.className = "keyboardInputCenter"\r\n            }\r\n            var tbody = document2.createElement("tbody");\r\n            var tr = document2.createElement("tr");\r\n            for (var y = 0, lkey; lkey = lyt[y++];) {\r\n                var td = document2.createElement("td");\r\n                if (this.VKI_symbol[lkey[0]]) {\r\n                    var text = this.VKI_symbol[lkey[0]].split("\\n");\r\n                    var small = document2.createElement("small");\r\n                    small.setAttribute("char", lkey[0]);\r\n                    for (var z = 0; z < text.length; z++) {\r\n                        if (z) {\r\n                            small.appendChild(document2.createElement("br"))\r\n                        }\r\n                        small.appendChild(document2.createTextNode(text[z]))\r\n                    }\r\n                    td.appendChild(small)\r\n                } else {\r\n                    td.appendChild(document2.createTextNode(lkey[0] || "\\xa0"))\r\n                }\r\n                var className = [];\r\n                if (this.VKI_deadkeysOn.checked) {\r\n                    for (key in this.VKI_deadkey) {\r\n                        if (key === lkey[0]) {\r\n                            className.push("deadkey");\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n                if (lyt.length > this.VKI_keyCenter && y == lyt.length) {\r\n                    className.push("last")\r\n                }\r\n                if (lkey[0] == " " || lkey[1] == " ") {\r\n                    className.push("space")\r\n                }\r\n                td.className = className.join(" ");\r\n                switch (lkey[1]) {\r\n                    case "Caps":\r\n                    case "Shift":\r\n                    case "Alt":\r\n                    case "AltGr":\r\n                    case "AltLk":\r\n                        VKI_addListener(td, "click", (function(type) {\r\n                            return function() {\r\n                                self.VKI_modify(type);\r\n                                return false\r\n                            }\r\n                        })(lkey[1]), false);\r\n                        break;\r\n                    case "Tab":\r\n                        VKI_addListener(td, "click", function() {\r\n                            if (self.VKI_activeTab) {\r\n                                if (self.VKI_target.form) {\r\n                                    var target = self.VKI_target,\r\n                                        elems = target.form.elements;\r\n                                    VKI_console.log("VKI_close from Tab.click");\r\n                                    self.VKI_close();\r\n                                    for (var z = 0, me = false, j = -1; z < elems.length; z++) {\r\n                                        if (j == -1 && elems[z].getAttribute("VKI_attached")) {\r\n                                            j = z\r\n                                        }\r\n                                        if (me) {\r\n                                            if (self.VKI_activeTab == 1 && elems[z]) {\r\n                                                break\r\n                                            }\r\n                                            if (elems[z].getAttribute("VKI_attached")) {\r\n                                                break\r\n                                            }\r\n                                        } else {\r\n                                            if (elems[z] == target) {\r\n                                                me = true\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    if (z == elems.length) {\r\n                                        z = Math.max(j, 0)\r\n                                    }\r\n                                    if (elems[z].getAttribute("VKI_attached")) {\r\n                                        self.VKI_show(elems[z])\r\n                                    } else {\r\n                                        elems[z].focus()\r\n                                    }\r\n                                } else {\r\n                                    self.VKI_target.focus()\r\n                                }\r\n                            } else {\r\n                                self.VKI_insert("\\t")\r\n                            }\r\n                            return false\r\n                        }, false);\r\n                        break;\r\n                    case "Bksp":\r\n                        VKI_addListener(td, "click", function() {\r\n                            self.VKI_target.focus();\r\n                            if (self.VKI_target.setSelectionRange && !self.VKI_target.readOnly) {\r\n                                var rng = [self.VKI_target.selectionStart, self.VKI_target.selectionEnd];\r\n                                if (rng[0] < rng[1]) {\r\n                                    rng[0]++\r\n                                }\r\n                                self.VKI_target.value = self.VKI_target.value.substr(0, rng[0] - 1) + self.VKI_target.value.substr(rng[1]);\r\n                                self.VKI_target.setSelectionRange(rng[0] - 1, rng[0] - 1)\r\n                            } else {\r\n                                if (self.VKI_target.createTextRange && !self.VKI_target.readOnly) {\r\n                                    try {\r\n                                        self.VKI_target.range.select()\r\n                                    } catch (e) {\r\n                                        self.VKI_target.range = document2.selection.createRange()\r\n                                    }\r\n                                    if (!self.VKI_target.range.text.length) {\r\n                                        self.VKI_target.range.moveStart("character", -1)\r\n                                    }\r\n                                    self.VKI_target.range.text = ""\r\n                                } else {\r\n                                    self.VKI_target.value = self.VKI_target.value.substr(0, self.VKI_target.value.length - 1)\r\n                                }\r\n                            }\r\n                            if (self.VKI_shift) {\r\n                                self.VKI_modify("Shift")\r\n                            }\r\n                            if (self.VKI_altgr) {\r\n                                self.VKI_modify("AltGr")\r\n                            }\r\n                            self.VKI_target.focus();\r\n                            return true\r\n                        }, false);\r\n                        break;\r\n                    case "Enter":\r\n                        VKI_addListener(td, "click", function() {\r\n                            if (self.VKI_target.nodeName != "TEXTAREA") {\r\n                                if (self.VKI_enterSubmit && self.VKI_target.form) {\r\n                                    for (var z = 0, subm = false; z < self.VKI_target.form.elements.length; z++) {\r\n                                        if (self.VKI_target.form.elements[z].type == "submit") {\r\n                                            subm = true\r\n                                        }\r\n                                    }\r\n                                    if (!subm) {\r\n                                        self.VKI_target.form.submit()\r\n                                    }\r\n                                }\r\n                                VKI_console.log("VKI_close from Enter.click");\r\n                                self.VKI_close()\r\n                            } else {\r\n                                self.VKI_insert("\\n")\r\n                            }\r\n                            return true\r\n                        }, false);\r\n                        break;\r\n                    default:\r\n                        VKI_addListener(td, "click", VKI_keyClick, false)\r\n                }\r\n                VKI_mouseEvents(td);\r\n                tr.appendChild(td);\r\n                for (var z = 0; z < 4; z++) {\r\n                    if (this.VKI_deadkey[lkey[z] = lkey[z] || ""]) {\r\n                        hasDeadKey = true\r\n                    }\r\n                }\r\n            }\r\n            tbody.appendChild(tr);\r\n            table.appendChild(tbody);\r\n            container.appendChild(table)\r\n        }\r\n        if (this.VKI_deadBox) {\r\n            this.VKI_deadkeysOn.style.display = (hasDeadKey) ? "inline" : "none"\r\n        }\r\n        if (this.VKI_isIE6) {\r\n            this.VKI_iframe.style.width = this.VKI_keyboard.offsetWidth + "px";\r\n            this.VKI_iframe.style.height = this.VKI_keyboard.offsetHeight + "px"\r\n        }\r\n    };\r\n    this.VKI_buildKeys();\r\n    VKI_addListener(this.VKI_keyboard, "selectstart", function() {\r\n        return false\r\n    }, false);\r\n    this.VKI_keyboard.unselectable = "on";\r\n    if (this.VKI_isOpera) {\r\n        VKI_addListener(this.VKI_keyboard, "mousedown", function() {\r\n            return false\r\n        }, false)\r\n    }\r\n    this.VKI_modify = function(type) {\r\n        switch (type) {\r\n            case "Alt":\r\n            case "AltGr":\r\n                this.VKI_altgr = !this.VKI_altgr;\r\n                break;\r\n            case "AltLk":\r\n                this.VKI_altgr = 0;\r\n                this.VKI_altgrlock = !this.VKI_altgrlock;\r\n                break;\r\n            case "Caps":\r\n                this.VKI_shift = 0;\r\n                this.VKI_shiftlock = !this.VKI_shiftlock;\r\n                break;\r\n            case "Shift":\r\n                this.VKI_shift = !this.VKI_shift;\r\n                break\r\n        }\r\n        var vchar = 0;\r\n        if (!this.VKI_shift != !this.VKI_shiftlock) {\r\n            vchar += 1\r\n        }\r\n        if (!this.VKI_altgr != !this.VKI_altgrlock) {\r\n            vchar += 2\r\n        }\r\n        var tables = this.VKI_keyboard.tBodies[0].getElementsByTagName("div")[0].getElementsByTagName("table");\r\n        for (var x = 0; x < tables.length; x++) {\r\n            var tds = tables[x].getElementsByTagName("td");\r\n            for (var y = 0; y < tds.length; y++) {\r\n                var className = [],\r\n                    lkey = this.VKI_layout[this.VKI_kt].keys[x][y];\r\n                switch (lkey[1]) {\r\n                    case "Alt":\r\n                    case "AltGr":\r\n                        if (this.VKI_altgr) {\r\n                            className.push("pressed")\r\n                        }\r\n                        break;\r\n                    case "AltLk":\r\n                        if (this.VKI_altgrlock) {\r\n                            className.push("pressed")\r\n                        }\r\n                        break;\r\n                    case "Shift":\r\n                        if (this.VKI_shift) {\r\n                            className.push("pressed")\r\n                        }\r\n                        break;\r\n                    case "Caps":\r\n                        if (this.VKI_shiftlock) {\r\n                            className.push("pressed")\r\n                        }\r\n                        break;\r\n                    case "Tab":\r\n                    case "Enter":\r\n                    case "Bksp":\r\n                        break;\r\n                    default:\r\n                        if (type) {\r\n                            tds[y].removeChild(tds[y].firstChild);\r\n                            if (this.VKI_symbol[lkey[vchar]]) {\r\n                                var text = this.VKI_symbol[lkey[vchar]].split("\\n");\r\n                                var small = document2.createElement("small");\r\n                                small.setAttribute("char", lkey[vchar]);\r\n                                for (var z = 0; z < text.length; z++) {\r\n                                    if (z) {\r\n                                        small.appendChild(document2.createElement("br"))\r\n                                    }\r\n                                    small.appendChild(document2.createTextNode(text[z]))\r\n                                }\r\n                                tds[y].appendChild(small)\r\n                            } else {\r\n                                tds[y].appendChild(document2.createTextNode(lkey[vchar] || "\\xa0"))\r\n                            }\r\n                        }\r\n                        if (this.VKI_deadkeysOn.checked) {\r\n                            var character = tds[y].firstChild.nodeValue || tds[y].firstChild.className;\r\n                            if (this.VKI_dead) {\r\n                                if (character == this.VKI_dead) {\r\n                                    className.push("pressed")\r\n                                }\r\n                                if (this.VKI_deadkey[this.VKI_dead][character]) {\r\n                                    className.push("target")\r\n                                }\r\n                            }\r\n                            if (this.VKI_deadkey[character]) {\r\n                                className.push("deadkey")\r\n                            }\r\n                        }\r\n                }\r\n                if (y == tds.length - 1 && tds.length > this.VKI_keyCenter) {\r\n                    className.push("last")\r\n                }\r\n                if (lkey[0] == " " || lkey[1] == " ") {\r\n                    className.push("space")\r\n                }\r\n                tds[y].className = className.join(" ")\r\n            }\r\n        }\r\n    };\r\n    this.VKI_insert = function(text) {\r\n        globalThis.vme.insert(text);\r\n        this.VKI_target.focus();\r\n        if (this.VKI_target.maxLength) {\r\n            this.VKI_target.maxlength = this.VKI_target.maxLength\r\n        }\r\n        if (typeof this.VKI_target.maxlength == "undefined" || this.VKI_target.maxlength < 0 || this.VKI_target.value.length < this.VKI_target.maxlength) {\r\n            if (this.VKI_target.setSelectionRange && !this.VKI_target.readOnly && !this.VKI_isIE) {\r\n                var rng = [this.VKI_target.selectionStart, this.VKI_target.selectionEnd];\r\n                this.VKI_target.value = this.VKI_target.value.substr(0, rng[0]) + text + this.VKI_target.value.substr(rng[1]);\r\n                if (text == "\\n" && this.VKI_isOpera) {\r\n                    rng[0]++\r\n                }\r\n                this.VKI_target.setSelectionRange(rng[0] + text.length, rng[0] + text.length)\r\n            } else {\r\n                if (this.VKI_target.createTextRange && !this.VKI_target.readOnly) {\r\n                    try {\r\n                        this.VKI_target.range.select()\r\n                    } catch (e) {\r\n                        this.VKI_target.range = document2.selection.createRange()\r\n                    }\r\n                    this.VKI_target.range.text = text;\r\n                    this.VKI_target.range.collapse(true);\r\n                    this.VKI_target.range.select()\r\n                } else {\r\n                    this.VKI_target.value += text\r\n                }\r\n            }\r\n            if (this.VKI_shift) {\r\n                this.VKI_modify("Shift")\r\n            }\r\n            if (this.VKI_altgr) {\r\n                this.VKI_modify("AltGr")\r\n            }\r\n            this.VKI_target.focus()\r\n        } else {\r\n            if (this.VKI_target.createTextRange && this.VKI_target.range) {\r\n                this.VKI_target.range.select()\r\n            }\r\n        }\r\n    };\r\n    this.VKI_show = function(elem) {\r\n        VKI_console.log("VKI_show");\r\n        if (!this.VKI_target) {\r\n            VKI_console.log("!this.VKI_target");\r\n            this.VKI_target = elem;\r\n            if (this.VKI_langAdapt && this.VKI_target.lang) {\r\n                var chg = false,\r\n                    sub = [],\r\n                    lang = this.VKI_target.lang.toLowerCase().replace(/-/g, "_");\r\n                for (var x = 0, chg = false; !chg && x < this.VKI_langCode.index.length; x++) {\r\n                    if (lang.indexOf(this.VKI_langCode.index[x]) == 0) {\r\n                        chg = kbSelect.firstChild.nodeValue = this.VKI_kt = this.VKI_langCode[this.VKI_langCode.index[x]]\r\n                    }\r\n                }\r\n                if (chg) {\r\n                    this.VKI_buildKeys()\r\n                }\r\n            }\r\n            if (this.VKI_isIE) {\r\n                if (!this.VKI_target.range) {\r\n                    this.VKI_target.range = this.VKI_target.createTextRange();\r\n                    this.VKI_target.range.moveStart("character", this.VKI_target.value.length)\r\n                }\r\n                this.VKI_target.range.select()\r\n            }\r\n            try {\r\n                this.VKI_keyboard.parentNode.removeChild(this.VKI_keyboard)\r\n            } catch (e) {}\r\n            if (this.VKI_clearPasswords && this.VKI_target.type == "password") {\r\n                this.VKI_target.value = ""\r\n            }\r\n            var elem = this.VKI_target;\r\n            this.VKI_target.keyboardPosition = "relative";\r\n            do {\r\n                if (VKI_getStyle(elem, "position") == "fixed") {\r\n                    this.VKI_target.keyboardPosition = "fixed";\r\n                    break\r\n                }\r\n            } while (elem = elem.offsetParent);\r\n            if (this.VKI_isIE6) {\r\n                document2.body.appendChild(this.VKI_iframe)\r\n            }\r\n            document2.body.appendChild(this.VKI_keyboard);\r\n            this.VKI_keyboard.style.position = this.VKI_target.keyboardPosition;\r\n            if (this.VKI_isOpera) {\r\n                this.VKI_keyboard.reflow()\r\n            }\r\n            this.VKI_position(true);\r\n            if (self.VKI_isMoz || self.VKI_isWebKit) {\r\n                this.VKI_position(true)\r\n            }\r\n            this.VKI_target.blur();\r\n            this.VKI_target.focus()\r\n        } else {\r\n            VKI_console.log("VKI_close from VKI_show");\r\n            this.VKI_close()\r\n        }\r\n    };\r\n    VKI_show = this.VKI_show;\r\n    this.VKI_position = function(force) {\r\n        if (self.VKI_target) {\r\n            var kPos = VKI_findPos(self.VKI_keyboard),\r\n                wDim = VKI_innerDimensions(),\r\n                sDis = VKI_scrollDist();\r\n            var place = false,\r\n                fudge = self.VKI_target.offsetHeight + 3;\r\n            if (force !== true) {\r\n                if (kPos[1] + self.VKI_keyboard.offsetHeight - sDis[1] - wDim[1] > 0) {\r\n                    place = true;\r\n                    fudge = -self.VKI_keyboard.offsetHeight - 3\r\n                } else {\r\n                    if (kPos[1] - sDis[1] < 0) {\r\n                        place = true\r\n                    }\r\n                }\r\n            }\r\n            if (place || force === true) {\r\n                var iPos = VKI_findPos(self.VKI_target),\r\n                    scr = self.VKI_target;\r\n                while (scr = scr.parentNode) {\r\n                    if (scr == document2.body) {\r\n                        break\r\n                    }\r\n                    if (scr.scrollHeight > scr.offsetHeight || scr.scrollWidth > scr.offsetWidth) {\r\n                        if (!scr.getAttribute("VKI_scrollListener")) {\r\n                            scr.setAttribute("VKI_scrollListener", true);\r\n                            VKI_addListener(scr, "scroll", function() {\r\n                                self.VKI_position(true)\r\n                            }, false)\r\n                        }\r\n                        var pPos = VKI_findPos(scr),\r\n                            oTop = iPos[1] - pPos[1],\r\n                            oLeft = iPos[0] - pPos[0];\r\n                        var top = oTop + self.VKI_target.offsetHeight;\r\n                        var left = oLeft + self.VKI_target.offsetWidth;\r\n                        var bottom = scr.offsetHeight - oTop - self.VKI_target.offsetHeight;\r\n                        var right = scr.offsetWidth - oLeft - self.VKI_target.offsetWidth;\r\n                        self.VKI_keyboard.style.display = (top < 0 || left < 0 || bottom < 0 || right < 0) ? "none" : "";\r\n                        if (self.VKI_isIE6) {\r\n                            self.VKI_iframe.style.display = (top < 0 || left < 0 || bottom < 0 || right < 0) ? "none" : ""\r\n                        }\r\n                    }\r\n                }\r\n                self.VKI_keyboard.style.top = iPos[1] - ((self.VKI_target.keyboardPosition == "fixed" && !self.VKI_isIE && !self.VKI_isMoz) ? sDis[1] : 0) + fudge + "px";\r\n                self.VKI_keyboard.style.left = Math.max(10, Math.min(wDim[0] - self.VKI_keyboard.offsetWidth - 25, iPos[0])) + "px";\r\n                if (self.VKI_isIE6) {\r\n                    self.VKI_iframe.style.width = self.VKI_keyboard.offsetWidth + "px";\r\n                    self.VKI_iframe.style.height = self.VKI_keyboard.offsetHeight + "px";\r\n                    self.VKI_iframe.style.top = self.VKI_keyboard.style.top;\r\n                    self.VKI_iframe.style.left = self.VKI_keyboard.style.left\r\n                }\r\n            }\r\n            if (force === true) {\r\n                self.VKI_position()\r\n            }\r\n        }\r\n    };\r\n    this.VKI_close = VKI_close = function() {\r\n        VKI_console.log("VKI_close");\r\n        if (this.VKI_target) {\r\n            try {\r\n                this.VKI_keyboard.parentNode.removeChild(this.VKI_keyboard);\r\n                if (this.VKI_isIE6) {\r\n                    this.VKI_iframe.parentNode.removeChild(this.VKI_iframe)\r\n                }\r\n            } catch (e) {}\r\n            if (this.VKI_kt != this.VKI_kts) {\r\n                kbSelect.firstChild.nodeValue = this.VKI_kt = this.VKI_kts;\r\n                this.VKI_buildKeys()\r\n            }\r\n            kbSelect.getElementsByTagName("ol")[0].style.display = "";\r\n            this.VKI_target.focus();\r\n            if (this.VKI_isIE) {\r\n                setTimeout(function() {\r\n                    self.VKI_target = false\r\n                }, 0)\r\n            } else {\r\n                this.VKI_target = false\r\n            }\r\n        }\r\n    };\r\n\r\n    function VKI_addListener(elem, type, func, cap) {\r\n        if (elem.addEventListener) {\r\n            elem.addEventListener(type, function(e) {\r\n                func.call(elem, e)\r\n            }, cap)\r\n        } else {\r\n            if (elem.attachEvent) {\r\n                elem.attachEvent("on" + type, function() {\r\n                    func.call(elem)\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    function VKI_findPos(obj) {\r\n        var curleft = curtop = 0,\r\n            scr = obj;\r\n        while ((scr = scr.parentNode) && scr != document2.body) {\r\n            curleft -= scr.scrollLeft || 0;\r\n            curtop -= scr.scrollTop || 0\r\n        }\r\n        do {\r\n            curleft += obj.offsetLeft;\r\n            curtop += obj.offsetTop\r\n        } while (obj = obj.offsetParent);\r\n        return [curleft, curtop]\r\n    }\r\n\r\n    function VKI_innerDimensions() {\r\n        if (self.innerHeight) {\r\n            return [self.innerWidth, self.innerHeight]\r\n        } else {\r\n            if (document2.documentElement && document2.documentElement.clientHeight) {\r\n                return [document2.documentElement.clientWidth, document2.documentElement.clientHeight]\r\n            } else {\r\n                if (document2.body) {\r\n                    return [document2.body.clientWidth, document2.body.clientHeight]\r\n                }\r\n            }\r\n        }\r\n        return [0, 0]\r\n    }\r\n\r\n    function VKI_scrollDist() {\r\n        var html = document2.getElementsByTagName("html")[0];\r\n        if (html.scrollTop && document2.documentElement.scrollTop) {\r\n            return [html.scrollLeft, html.scrollTop]\r\n        } else {\r\n            if (html.scrollTop || document2.documentElement.scrollTop) {\r\n                return [html.scrollLeft + document2.documentElement.scrollLeft, html.scrollTop + document2.documentElement.scrollTop]\r\n            } else {\r\n                if (document2.body.scrollTop) {\r\n                    return [document2.body.scrollLeft, document2.body.scrollTop]\r\n                }\r\n            }\r\n        }\r\n        return [0, 0]\r\n    }\r\n\r\n    function VKI_getStyle(obj, styleProp) {\r\n        if (obj.currentStyle) {\r\n            var y = obj.currentStyle[styleProp]\r\n        } else {\r\n            if (window.getComputedStyle) {\r\n                var y = window.getComputedStyle(obj, null)[styleProp]\r\n            }\r\n        }\r\n        return y\r\n    }\r\n    VKI_addListener(window, "resize", this.VKI_position, false);\r\n    VKI_addListener(window, "scroll", this.VKI_position, false);\r\n    this.VKI_kbsize();\r\n    VKI_addListener(window, "load", VKI_buildKeyboardInputs, false)\r\n};\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/keyboard/keyboard.js?')},"./src/assets/js/localization lazy recursive ^\\.\\/.*\\/lang\\.json$ include: \\.json$":(module,__unused_webpack_exports,__webpack_require__)=>{eval('var map = {\n\t"./ar/lang.json": [\n\t\t"./src/assets/js/localization/ar/lang.json",\n\t\t"src_assets_js_localization_ar_lang_json"\n\t],\n\t"./de_DE/lang.json": [\n\t\t"./src/assets/js/localization/de_DE/lang.json",\n\t\t"src_assets_js_localization_de_DE_lang_json"\n\t],\n\t"./en_US/lang.json": [\n\t\t"./src/assets/js/localization/en_US/lang.json",\n\t\t"src_assets_js_localization_en_US_lang_json"\n\t],\n\t"./es_ES/lang.json": [\n\t\t"./src/assets/js/localization/es_ES/lang.json",\n\t\t"src_assets_js_localization_es_ES_lang_json"\n\t],\n\t"./fr_FR/lang.json": [\n\t\t"./src/assets/js/localization/fr_FR/lang.json",\n\t\t"src_assets_js_localization_fr_FR_lang_json"\n\t],\n\t"./ru/lang.json": [\n\t\t"./src/assets/js/localization/ru/lang.json",\n\t\t"src_assets_js_localization_ru_lang_json"\n\t],\n\t"./vi_VN/lang.json": [\n\t\t"./src/assets/js/localization/vi_VN/lang.json",\n\t\t"src_assets_js_localization_vi_VN_lang_json"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\t\te.code = \'MODULE_NOT_FOUND\';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 3 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = "./src/assets/js/localization lazy recursive ^\\\\.\\\\/.*\\\\/lang\\\\.json$ include: \\\\.json$";\nmodule.exports = webpackAsyncContext;\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/localization/_lazy_^\\.\\/.*\\/lang\\.json$_include:_\\.json$_namespace_object?')},"./src/assets/js/localization.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Localizer: () => (/* binding */ Localizer)\n/* harmony export */ });\n/* harmony import */ var _patterns_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./patterns/observable */ \"./src/assets/js/patterns/observable.js\");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n/**\r\n * @abstract Supports the localization of this application.\r\n * \r\n * This is an Observable as it recognizes the change of Language and notifies its observers.\r\n */\r\nclass Localizer {\r\n\t\r\n\tcurrent = null;\r\n\tfallback = null;\r\n\tlocales = ['ar', 'de_DE', 'en_US', 'es_ES', 'fr_FR', 'ru', 'vi_VN'];\r\n\tcurrentLocale = 'en_US';\r\n\tobservable = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor. The script location is queried as needed to locate the language files.\r\n\t */\r\n\tconstructor(observableCls = _patterns_observable__WEBPACK_IMPORTED_MODULE_0__.Observable) {\r\n\t\tthis.observable = new observableCls();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Override of the Observable.\r\n\t */\r\n\tsubscribe(func, ...args) {\r\n\t\tthis.observable.subscribe(func, ...args);\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract The basic load method. Reads a language file given by its language code.\r\n\t */\r\n\tasync basicLoad(langCode) {\r\n\t\ttry {\r\n\t\t\tvar json = await __webpack_require__(\"./src/assets/js/localization lazy recursive ^\\\\.\\\\/.*\\\\/lang\\\\.json$ include: \\\\.json$\")(`./${langCode}/lang.json`);\r\n\t\t\t\r\n\t\t\treturn json;\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Could not load language file - ${e}`);\r\n\t\t\treturn { };\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The main load method.\r\n\t * \r\n\t * Loads the fallback variant for en_US and the given languages language files and stores\r\n\t * them in this instance. Notifies observers about this event.\r\n\t */\r\n\tasync load(langCode) {\r\n\t\tvar inst = this;\r\n\t\t\r\n\t\tif (inst.fallback == null) {\r\n\t\t\tinst.fallback = await inst.basicLoad('en_US');\r\n\t\t}\r\n\t\t\r\n\t\tinst.current = await inst.basicLoad(langCode);\r\n\t\tinst.currentLocale = langCode;\r\n\t\t\r\n\t\t// ATTENTION! NOT EVERY LOCALE has a corresponding EASYUI LOCALE\r\n\t\ttry {\r\n\t\t\tvar shortCode = inst.current._i18n_HTML_Lang;\r\n\t\t\tawait __webpack_require__(\"./src/assets/js/jquery-easyui/locale lazy recursive ^\\\\.\\\\/easyui\\\\-lang\\\\-.*\\\\.js$\")(`./easyui-lang-${shortCode}.js`);\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`${shortCode} : no corresponding easyui locale`);\r\n\t\t}\r\n\t\t\r\n\t\tawait inst.observable.notifyAsync(inst);\r\n\t\tconsole.info(`Read language file for ${langCode}`);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Queries the languages version of some text given by its key(code).\r\n\t */\r\n\tgetLocalText(code) {\r\n\t\tif (this.current != null) {\r\n\t\t\tvar text = this.current[code];\r\n\t\t\tif (text != undefined && text != '') return text;\r\n\t\t}\r\n\t\tif (this.fallback != null) {\r\n\t\t\tvar text = this.fallback[code];\r\n\t\t\tif (text != undefined && text != '') return text;\r\n\t\t}\r\n\t\t\r\n\t\treturn code;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialises the **Language Choice** dialog.\r\n\t * \r\n\t * This is a one time initialisation task\r\n\t * \r\n\t * @param localType - the language code as de_DE or en_US\r\n\t */\r\n\tasync initialiseLanguageChoice(localType) {\r\n\t\tvar inst = this;\r\n\t\tvar html = await this.buildLocalTypes();\r\n\t\t$(\"#formLANGUAGE_CHOISE\").html(html);\r\n\t\t$(\"[name='localType']\").filter(`[value=${localType}]`).attr(\"checked\", \"checked\"); \r\n\t\t\r\n\t\t$(\"input[name='localType']\").change(async function() { \r\n\t\t\tvar localType = $(\"input[name='localType']:checked\").val(); \r\n\t\t\tawait inst.load(localType); \r\n\t\t}); \r\n\r\n\t\tawait this.load(localType);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Assembles the content of the Language selection dialog using the existing language \r\n\t * \t\t\t files.\r\n\t */\r\n\tasync buildLocalTypes() {\r\n\t\tvar html = \"<fieldset dir='ltr'>\"; \r\n\t\tvar inst = this;\r\n\t\t\r\n\t\tfor (var lang of inst.locales) {\r\n\t\t\tvar json = await inst.basicLoad(lang);\t\t\t\r\n\t\t\tvar langage = json[\"_i18n_Langage\"]; \r\n\t\t\tvar langCode = json[\"_i18n_HTML_Lang\"]; \r\n\t\t\tvar langDir = json[\"_i18n_HTML_Dir\"]; \r\n\t\t\tvar langAuthor = json[\"_i18n_Author\"]; \r\n\t\t\tvar flag = langCode;\r\n\t\t\tif (langCode == 'en') { flag = 'us'; }\r\n\t\t\t\r\n\t\t\tvar ico = await __webpack_require__(\"./src/assets/js/i18n/icons lazy recursive ^\\\\.\\\\/.*\\\\.png$\")(`./${flag}.png`);\r\n\t\t\t\r\n\t\t\thtml += \r\n\t\t\t\t`\\n\\t` + \r\n\t\t\t\t`<input type='radio' name='localType' id='${lang}_localType' value='${lang}' />` + \r\n\t\t\t\t`<img src='./icons/${flag}.png' width='16' height='11' alt='${langCode}' /> &nbsp; ` + \r\n\t\t\t\t`<label for='${lang}_localType' dir='${langDir}'>${langage}</label> - ${langAuthor} <br />`;\r\n\t\t}\r\n\t\thtml += \"\\n</fieldset>\";\r\n\t\treturn html; \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Assembles the content of the Language Resources dialog.\r\n\t */\r\n\tasync buildLocalResources() {\r\n\t\tvar inst = this;\r\n\r\n\t\tfor (var lang of inst.locales) {\r\n\t\t\tvar json = await inst.basicLoad(lang);\r\n\t\t\tvar title = lang; \r\n\t\t\tvar langage = json[\"_i18n_Langage\"]; \r\n\t\t\tif (!$('#tLANGUAGE_LIST').tabs('exists', title)) {\r\n\t\t\t\tvar list = \"<table border='1' cellspacing='0' style='border-spacing:0px;border-collapse:collapse;margin:20px;width:580px'>\"; \r\n\t\t\t\tvar dir = json[\"_i18n_HTML_Dir\"]; \r\n\t\t\t\tfor (var ressource in json) { \r\n\t\t\t\t\tlist += (\r\n\t\t\t\t\t\t\"<tr><td valign='top'><b>\" + ressource + \"</b> : </td>\" + \r\n\t\t\t\t\t\t\"<td valign='top' class='rtl-align-right'\" + ((dir == \"rtl\") ? \"style='text-align:right;'\" : \"\") + \" dir='\" + dir + \"'>\" + json[ressource].replace(/</gi, \"&lt;\") + \"</td></tr>\\n\"); \r\n\t\t\t\t}\r\n\t\t\t\tlist += \"</table>\"; \r\n\t\t\t\t$('#tLANGUAGE_LIST').tabs('add', { title: title, content: list, closable: false });\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\t$('#tLANGUAGE_LIST').tabs('select', inst.currentLocale);\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { Localizer };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/localization.js?")},"./src/assets/js/math.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MathFormulae: () => (/* binding */ MathFormulae)\n/* harmony export */ });\n/* harmony import */ var _katex_katex_min__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./katex/katex.min */ \"./src/assets/js/katex/katex.min.js\");\n/* harmony import */ var _katex_katex_min__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_katex_katex_min__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./helpers */ \"./src/assets/js/helpers.js\");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n\r\n\r\n/**\r\n * Class responsible for Math Formula handling.\r\n * The framework supported here is Katex.\r\n * CodeMirror is the only supported Editor case.\r\n */\r\nclass MathFormulae {\r\n\t\r\n\tmathVisualOutput = null;\r\n\tmathTextInput = null;\r\n\trunNotKatex = false;\r\n\tencloseAllFormula = false; \r\n\tmenuupdateType = true;\r\n\tlocalizer = null;\r\n\tcodeMirror = null;\r\n\tparameters = null;\r\n\tparser = null;\r\n\tdynamicPanels = [];\r\n\tmessager = null;\r\n\t\r\n\t/**\r\n\t * Constructor.\r\n\t */\r\n\tconstructor(runNotKatex, localizer, codeMirror, parameters, parser) {\r\n\t\tthis.mathTextInput = document.getElementById('mathTextInput'); \r\n\t\tthis.mathVisualOutput = document.getElementById('mathVisualOutput');\r\n\t\tthis.codeMirror = codeMirror;\r\n\t\tthis.runNotKatex = runNotKatex;\r\n\t\tthis.localizer = localizer;\r\n\t\tthis.parameters = parameters;\r\n\t\tthis.parser = parser;\r\n\t\tthis.messager = new _helpers__WEBPACK_IMPORTED_MODULE_1__.Messager(localizer);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets the Code Mirror Editor instance (method injection)\r\n\t */\r\n\tsetEditorInstance(codeMirror) {\r\n\t\tthis.codeMirror = codeMirror;\r\n\t}\r\n\t\r\n\t/**\r\n\t * The most basic insertion method. Inserts Math into given element.\r\n\t * \r\n\t * @param text - text bo be translated into math\r\n\t * @param element - html element to be used for insertion\r\n\t * @param multiple - if true inserts multiple math elements, separated by horizontal space\r\n\t * @param displayMode - in display mode can handle expressions differently (for instance environments) \r\n\t */\r\n\tinsertMath(text, element = null, multiple = false, displayMode = false) {\r\n\t\tif (text == '') {\r\n\t\t\tconsole.warn(`Katex: no text`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tvar target = element;\r\n\t\t\tif (target == null) {\r\n\t\t\t\tconsole.debug(`Attention : writing to output area : ${displayMode}`);\r\n\t\t\t\tconsole.trace(`Trace : `);\r\n\t\t\t\ttarget = this.mathVisualOutput;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!this.runNotKatex) {\r\n\t\t\t\tif (text.startsWith('$')) {\r\n\t\t\t\t\ttext = text.replace(/&lt;/g, '<');\t\t\t\t\t\t\t// TODO: check!\r\n\t\t\t\t\ttext = text.replace(/&amp;/g, '&');\r\n\t\t\t\t\tif (! multiple) {\r\n\t\t\t\t\t\ttext = text.substring(1, text.length - 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttext = text.replace(/&nbsp;&nbsp;/g, '\\\\quad');\r\n\t\t\t\t\t\ttext = text.replace(/\\$/g, '');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t_katex_katex_min__WEBPACK_IMPORTED_MODULE_0___default().render(text, target, { thrownOnError: false, strict: false, displayMode: displayMode, macros: { '\\\\box': '□' } });\r\n\t\t\t} else {\r\n\t\t\t\ttarget.innerTEXT = text;\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`Katex: insertMath : ${e}`);\r\n\t\t\tthis.messager.show('KATEX', 'KATEX_NOT_RENDERED', e)\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Updates Tables in Panels or Dialogs by translating contained Math. Although this is a Math\r\n\t * method, it also updates some image references. TODO: implement SRP (single responsibility \r\n\t * principle)\r\n\t */\r\n\tasync updateTables() {\r\n\t\ttry {\r\n\t\t\tvar inst = this;\r\n\t\t\tvar selector = '.panel-body table tbody tr td a.easyui-tooltip, .easyui-dialog div a.s';\r\n\t\t\tvar entries = $(selector);\r\n\t\t\tconsole.debug(`Katex: ${entries.length} td or div items`);\r\n\t\t\tvar im1 = 0;\r\n\t\t\tentries.each(function(idx, a) {\r\n\t\t\t\t\r\n\t\t\t\tif (a && $(this).find('.katex').length == 0) {\t\t\t\t\t\t\t\t// check : no katex embedded\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tvar html = a.innerHTML;\r\n\t\t\t\t\t\tvar count = html.split('$').length - 1;\r\n\t\t\t\t\t\tvar text = a.innerText;\r\n\t\t\t\t\t\tvar dm = (text.startsWith('$$') || text.includes('{equation}'));\t// $$ triggers display mode\r\n\t\t\t\t\t\tif (count == 2 || text == '$\\\\$$' || text.includes('\\\\ce')) {\t\t// normal case: math\r\n\t\t\t\t\t\t\ttext = text.replace(/□/g, '\\\\square');\r\n\t\t\t\t\t\t\tinst.insertMath(text, a);\r\n\t\t\t\t\t\t} else if (count > 2 && !dm) {\t\t\t\t\t\t\t\t\t\t// image with surrounding characters\r\n\t\t\t\t\t\t\tvar text1 = a.firstChild.textContent;\r\n\t\t\t\t\t\t\ttext1 = text1.substring(1, text1.length - 1);\r\n\t\r\n\t\t\t\t\t\t\tvar text2 = a.lastChild.textContent;\r\n\t\t\t\t\t\t\ttext2 = text2.substring(1, text2.length - 1);\r\n\t\r\n\t\t\t\t\t\t\tvar img = a.children[0];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tinst.insertMath(text2, a);\r\n\t\t\t\t\t\t\tvar ch = a.children[0];\r\n\t\t\t\t\t\t\tinst.insertMath(text1, a);\r\n\t\t\t\t\t\t\ta.appendChild(img);\r\n\t\t\t\t\t\t\ta.appendChild(ch);\r\n\t\t\t\t\t\t} else if (dm) {\r\n\t\t\t\t\t\t\tinst.updateAnchor(a);\r\n\t\t\t\t\t\t} else {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// direct image case\r\n\t\t\t\t\t\t\tvar img = a.firstChild;\r\n\t\t\t\t\t\t\tif (img && img.nodeType != Node.TEXT_NODE && img.hasAttribute('src')) {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\tconsole.warn(`Katex: updateTables : ${a.innerText} : ${e}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (im1 > 0) {\r\n\t\t\t\tconsole.debug(`Images detected: ${im1}`)\r\n\t\t\t}\t\t\t\t\r\n\r\n\t\t\t// TODO: TEST: changes must be updated so that easyui knows them\r\n\t\t\tawait this.parser.parseAsync(selector);\r\n\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Katex: updateTables : ${e}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Updates the headers of some Panels by translating contained Math.\r\n\t * \r\n\t * If a selector is given, it is assumed that it is a single panel from an accordion.\r\n\t */\r\n\tupdateHeaders(selector = \"\") {\r\n\t\ttry {\r\n\t\t\tvar inst = this;\r\n\t\t\tvar entries = $(`.panel-title span`);\r\n\t\t\tif (selector != '') {\r\n\t\t\t\tvar options = $(selector).panel('options');\r\n\t\t\t\tvar title = options.title;\r\n\t\t\t\tvar info = $(title).attr('information');\r\n\t\t\t\tconsole.debug(`Katex: opening ${info} panel`);\r\n\t\t\t\tentries = $(`.panel-title span[information=${info}]`);\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconsole.debug(`Katex: ${entries.length} header items`);\r\n\t\t\tentries.each((idx, a) => {\r\n\t\t\t\tif (a) {\r\n\t\t\t\t\tvar text = a.innerText;\r\n\t\t\t\t\tif (text.startsWith('$')) {\r\n\t\t\t\t\t\tinst.insertMath(text, a, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Katex: updateHeaders : ${e}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * The Latex menu command gets the true Latex symbol.\r\n\t * \r\n\t * No longer working. Use workaround.\r\n\t */\r\n\tupdateLatexMenu() {\r\n\t\tvar html = _katex_katex_min__WEBPACK_IMPORTED_MODULE_0___default().renderToString('\\\\LaTeX', { thrownOnError: false });\r\n\t\tconsole.debug(`LaTeX symbol : ${html}`);\r\n\t\t$('#mLaTeX_TEXT span').text('LaTeX');\r\n\t\t// this.inplaceUpdate('#mLaTeX_TEXT span', false);\r\n\t}\r\n\t\r\n\t/**\r\n\t * For some dialogs, which are initialized lazily, updates the Math.\r\n\t */\r\n\tinplaceUpdate(selector, javascript = true) {\r\n\t\ttry {\r\n\t\t\tvar inst = this;\r\n\t\t\tvar entries = $(selector);\r\n\t\t\tconsole.debug(`Katex: ${entries.length} in-place items for selector ${selector}`);\r\n\t\t\tentries.each(function(idx, a) {\r\n\t\t\t\tif (a && !inst.runNotKatex) {\r\n\t\t\t\t\tinst.updateAnchor(a);\r\n\t\t\t\t\tif (typeof selector !== 'string' || !selector.startsWith('#mLaTeX_TEXT')) {\r\n\t\t\t\t\t\tinst.equipWithInteractivity($(this), javascript);\t\t\t\t\t// the latex menu command will not get tooltip...\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Katex: inplaceUpdate : ${e}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Equips some anchors with interactivity which they do not already have.\r\n\t * \r\n\t * \"Equips\" means *tooltip* and *click* and *mouseover*.\r\n\t * If the anchor does not have a latex attribute, it will not be equipped\r\n\t * \r\n\t * @param a - the anchor to be equipped\r\n\t */\r\n\tequipWithInteractivity(a, javascript = true) {\r\n\t\tvar vme = this;\r\n\t\tfunction getSymbol(obj) { \r\n\t\t\tif (typeof ($(obj).attr(\"latex\")) != \"undefined\") { \r\n\t\t\t\treturn $(obj).attr(\"latex\"); \r\n\t\t\t} else { \r\n\t\t\t\treturn vme.localizer.getLocalText(\"NO_LATEX\"); \r\n\t\t\t} \r\n\t\t};\r\n\r\n\t\tif (typeof ($(a).attr(\"latex\")) == \"undefined\") {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconsole.debug(`equipWithInteractivity ${a.attr('latex')}`);\r\n\t\tvar text = getSymbol(a);\r\n\t\tthis.equipWithTooltip(a, text, javascript);\r\n\t\t\r\n\t\ta.click(function(event) { \r\n\t\t\tevent.preventDefault(); \r\n\t\t\tvar latex = a.attr(\"latex\");\r\n\t\t\tconsole.debug(`Click on equation: ${latex}`);\r\n\t\t\tif (latex != undefined) { \r\n\t\t\t\tvme.insert(latex); \r\n\t\t\t} else { \r\n\t\t\t\t$.messager.show({ \r\n\t\t\t\t\ttitle: \"<span class='rtl-title-withicon'>\" + vme.localizer.getLocalText(\"INFORMATION\") + \"</span>\", \r\n\t\t\t\t\tmsg: vme.localizer.getLocalText(\"NO_LATEX\") \r\n\t\t\t\t}); \r\n\t\t\t} \r\n\t\t}); \r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Equips a selector (preferibly an anchor) with a tooltip.\r\n\t * \r\n\t * Additionally prepares the same info for the status line.\r\n\t * This is the central place for doing that.\r\n\t * \r\n\t * @param selector {*} - ui item to be equipped\r\n\t * @param {string} text - the tooltip text \r\n\t * @param {boolean} javascript \r\n\t */\r\n\tequipWithTooltip(selector, text, javascript) {\r\n\r\n\t\tselector.addClass(\"easyui-tooltip s\");\r\n\r\n\t\tvar encoded = text.replace(/</g, '&lt;');\t\t\t\t\t\t\t\t\t// GUI does not like text looking like tag begin -> encode\r\n\t\tif (javascript) {\r\n\t\t\tselector.attr(\"href\", \"javascript:void(0)\");\r\n\t\t\tselector.tooltip({ \r\n\t\t\t\tcontent: encoded,\r\n\t\t\t\tshow: function() {\r\n\t\t\t\t\t$(this).tooltip('tip').css({ maxWidth: 500 });\r\n\t\t\t\t} \r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tselector.attr(\"href\", \"#\")\r\n\t\t\t.attr(\"title\", function(index, attr) { return encoded; });\r\n\t\t}\t\t\r\n\r\n\t\tselector.on('mouseover', function(event) { $(\"#divInformation\").html(encoded); });\r\n\t\tselector.mouseout(function(event) { $(\"#divInformation\").html(\"&nbsp;\"); });\r\n\t\t\r\n\t\treturn selector;\r\n\t}\r\n\r\n\t/**\r\n\t * Updates an anchor (or other tag) with a formula. Takes the text from original anchor content.\r\n\t */\t\r\n\tupdateAnchor(a) {\r\n\t\tvar text = a.innerText;\r\n\t\tif (text.includes('Rightarrow')) {\r\n\t\t\tconsole.debug(`Found-arrow-text: ${text}`);\r\n\t\t}\r\n\t\tvar mathText = text.includes('$');\r\n\t\tvar dm = (text.includes('$$') || text.includes('{equation}'));\r\n\t\ttext = text.replace(/^\\s{0,5}\\\"?\\${1,2}(.*?)\\${1,2}\\\"?\\s{0,5}$/s, '$1');\r\n\t\tconsole.debug(`Processed text: ${text.substring(0, 20)}`);\r\n\t\tif (mathText) this.insertMath(text, a, false, dm);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Inserts given text into Code Mirror Editor and updates the formula in the output.\r\n\t */\r\n\tinsert(b) {\r\n\t\tthis.codeMirror.replaceSelection(b);\r\n\t\tthis.updateOutput();\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the formula in the output field. Also writes the formula back to the parameters\r\n\t * so to be returned by the dialog to its caller.\r\n\t */\t\r\n\tupdateOutput() {\r\n\t\tvar vme = this; \r\n\t\tvar encloseChar = \"$\"; \r\n\t\tvar content = \"\"; \r\n\t\tcontent = this.codeMirror.getValue(); \r\n\t\tvar dm = content.includes('\\\\begin{CD}');\r\n\t\tif (content == \"\") content = \" \"; \r\n\t\tif (!vme.encloseAllFormula) { \r\n\t\t\tcontent = content.replace(/</gi, \"&lt;\"); \r\n\t\t\tcontent = encloseChar + content + encloseChar; \r\n\t\t} else { \r\n\t\t}\r\n\r\n\t\tdm = dm || vme.parameters.displayMode;\t\t\t\t\t\t// displayMode from invocation context enforces dm\r\n\t\tvme.insertMath(content, null, false, dm); \r\n\t\tvme.setFocus();\r\n\t\tthis.parameters.equation = this.codeMirror.getValue();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets the Focus to the Code Mirror Editor.\r\n\t */\r\n\tsetFocus() { \r\n\t\tthis.codeMirror.focus(); \r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { MathFormulae };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/math.js?")},"./src/assets/js/panels.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DynamicPanel: () => (/* binding */ DynamicPanel),\n/* harmony export */   KIHMoreDialog: () => (/* binding */ KIHMoreDialog),\n/* harmony export */   KIHPanel: () => (/* binding */ KIHPanel),\n/* harmony export */   KIHPanels: () => (/* binding */ KIHPanels),\n/* harmony export */   KIHWindow: () => (/* binding */ KIHWindow)\n/* harmony export */ });\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./helpers */ \"./src/assets/js/helpers.js\");\n/* harmony import */ var _categoriesTree__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./categoriesTree */ \"./src/assets/js/categoriesTree.js\");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n\r\n/**\r\n * @abstract The base class of all Panels, Dialogs, Windows.\r\n */\r\nclass KIHPanel {\r\n\tid = \"\";\r\n\tparent = null;\r\n\tinitialised = false;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor\r\n\t */\r\n\tconstructor(id, parent) {\r\n\t\tthis.id = id;\r\n\t\tthis.parent = parent;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The handler of move events, invoked when the panel is moved.\r\n\t * \r\n\t * This delegates to the *Parameters* instance.\r\n\t */\r\n\tonMove(left, top) { \r\n\t\tconsole.info(`Panel with id ${this.id} moved : ${left}, ${top}`);\r\n\t\tthis.parent.parameters.onPanelMove(this.id, left, top);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The handler of resize events, invoked when the panel is resized.\r\n\t * \r\n\t * This delegates to the *Parameters* instance.\r\n\t */\r\n\tonResize(width, height) {\r\n\t\tconsole.info(`Panel with id ${this.id} resized : ${width}, ${height}`);\r\n\t\tthis.parent.parameters.onPanelResize(this.id, width, height);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Builds an object from the events to be provided when the panel is created.\r\n\t */\r\n\tget handlers() {\r\n\t\treturn {\r\n\t\t\tonMove: this.onMove.bind(this),\r\n\t\t\tonResize: this.onResize.bind(this)\r\n\t\t};\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialise method, creates the *Panel* with the handlers provided.\r\n\t */\r\n\tasync initialise() {\r\n\t\t$(`#${this.id}`).dialog(this.handlers)\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Shows the *Panel* and resizes (Position, Size) it to stored values.\r\n\t */\r\n\tasync show() {\r\n\t\tthis.resize();\r\n\t\tthis.open();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Resizes this panel with the values in parameters.\r\n\t */\r\n\tresize() {\r\n\t\tif (this.id in this.parent.parameters) {\r\n\t\t\t$(`#${this.id}`).panel('resize', this.parent.parameters[this.id]);\r\n\t\t} else {\r\n\t\t\tconsole.warn(`Missing id in parameters : ${this.id}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Opens (shows) the Panel.\r\n\t */\r\n\topen() {\r\n\t\t$(`#${this.id}`).dialog('open');\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Used to localize an option.\r\n\t * \r\n\t * Place this service into this base class to get access everywhere.\r\n\t */\t\r\n\tlocalizeOption(option, id = null, func = $.fn.panel) {\r\n\t\tid = id ? id : this.id;\r\n\t\tvar text = func.bind($(`#${id}`))('options')[option];\t\t\t\t\t\t\t// do something to preserve the TITLE: this is an option\r\n\t\tvar html = $.parseHTML(text);\t\t\t\t\t\t\t\t\t\t\t\t\t// parse it into html object\r\n\t\tvar key = $(html).attr('locate');\t\t\t\t\t\t\t\t\t\t\t\t// extract the locate attribute\r\n\t\tvar located = this.parent.localizer.getLocalText(key);\t\t\t\t\t\t\t// use it to get localized text\r\n\t\thtml = $(html).html(located)[0].outerHTML;\t\t\t\t\t\t\t\t\t\t// insert it into orginal html\r\n\t\treturn html;\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract The More Dialog class.\r\n * \r\n * This represents dialogs with Math content which is loaded on demand when the dialog is opened.\r\n * This content is in Katex format and will be translated to Math.\r\n * \r\n * @extends KIHPanel\r\n */\r\nclass KIHMoreDialog extends KIHPanel {\r\n\t\r\n\t/**\r\n\t * @abstract Constructor\r\n\t */\r\n\tconstructor(id, parent) {\r\n\t\tsuper(id, parent);\r\n\t\t\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Initialises (creates) the dialog.\r\n\t * \r\n\t * This additionally to the *super* class method provides a translation method and a title for\r\n\t * Katex to Math in-place translation.\r\n\t * \r\n\t * @param initialiseSymbolContent - method of the client to be invoked during loading\r\n\t */\r\n\tasync initialise(initialiseSymbolContent) {\r\n\t\t// id is the MORE id as in dialog.html file with 'w' and '_MORE'\r\n\t\tvar vme = this;\r\n\t\tvar fPanelMoreID = this.id;\r\n\t\tvar fPanelMore = $('#' + fPanelMoreID);\r\n\t\tvar htmlFile = fPanelMoreID.substring(1); \r\n\t\t\r\n\t\t$(fPanelMore).dialog({ \r\n\t\t\tonLoad: async function() { await initialiseSymbolContent(fPanelMoreID); }, \r\n\t\t\ttitle: $(`#${fPanelMoreID}_TITLE`).html() \r\n\t\t}); \r\n\t\tawait super.initialise(fPanelMoreID);\r\n\t\t$(fPanelMore).dialog('open'); \r\n\t\t$(fPanelMore).dialog('refresh', `formulas/${htmlFile}.html`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract The KIHWindow class.\r\n * \r\n * This represents windows like the Configuration Parameters window, the Language Configuration\r\n * window or the Theme (Style) selection window.\r\n */\r\nclass KIHWindow extends KIHPanel {\r\n\r\n\t/**\r\n\t * @abstract Constructor\r\n\t */\r\n\tconstructor(id, parent) {\r\n\t\tsuper(id, parent);\r\n\t\t\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialises (creates) a window.\r\n\t * \r\n\t * This is an adaptation of the KIHPanel version. It is able to provide a localized title\r\n\t * that would otherwise disappear.\r\n\t * \r\n\t * TODO: harmonize with More Dialog class.\r\n\t */\r\n\tasync initialise() {\r\n\t\tvar handlers = this.handlers;\r\n\t\thandlers.title = this.localizeOption('title');\r\n\t\t$(`#${this.id}`).window(handlers)\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Shows the *Window* and resizes (Position, Size) it to stored values.\r\n\t * \r\n\t * This is an adaptation of the KIHPanel version for KIHWindow.\r\n\t */\r\n\tasync show() {\r\n\t\tthis.resize();\r\n\t\tthis.open();\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Opens (shows) this window.\r\n\t */\r\n\topen() {\r\n\t\t$(`#${this.id}`).window('open');\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @abstract This class is solely responsible for the Dynamic Panel for Custom Equations.\r\n */\r\nclass DynamicPanel extends KIHPanel {\r\n\tparent = null;\r\n\tmessager = null;\r\n\tutilities = null;\r\n\tpanelId = \"\";\r\n\tgridSelector = \"\";\r\n\tgridSelectorOfCopy = \"\";\r\n\ttreeSelector = \"\";\r\n\tinitialised = false;\r\n\trenderComplete = false;\r\n\tsortOrderAsc = 'desc';\r\n\tcategoriesTree = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor(parent) {\r\n\t\tvar panelId = 'wf_CUSTOM_EQUATIONS_MORE';\r\n\t\tsuper(panelId, parent);\r\n\t\tthis.panelId = panelId;\r\n\t\tthis.parent = parent;\r\n\t\tthis.messager = new _helpers__WEBPACK_IMPORTED_MODULE_0__.Messager(this.parent.localizer);\r\n\t\tthis.utilities = new _helpers__WEBPACK_IMPORTED_MODULE_0__.Utilities(this.parent.localizer);\r\n\t\tthis.categoriesTree = new _categoriesTree__WEBPACK_IMPORTED_MODULE_1__.CategoriesTree();\r\n\t\tthis.gridSelector = `#${panelId} .easyui-datagrid`;\r\n\t\tthis.gridSelectorOfCopy = `#${panelId} table:not(.easyui-datagrid)`;\r\n\t\tthis.treeSelector = `#categories`;\r\n\t\t\r\n\t\tthis.parent.localizer.subscribe(this.onLocaleChanged.bind(this));\r\n\t\tthis.categoriesTree.nodeSelected.subscribe(this.onNodeSelected.bind(this));\r\n\t\tthis.categoriesTree.treeChanged.subscribe(this.onTreeChanged.bind(this));\r\n\t\tthis.categoriesTree.equationMoved.subscribe(this.onEquationMoved.bind(this));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract An Observer for the Locale Changed notifications.\r\n\t * \r\n\t * This changes all localized text in the dialog.\r\n\t */\r\n\tasync onLocaleChanged(localizer) {\r\n\t\tvar inst = this;\r\n\t\tconsole.debug(`DynamicPanel.onLocaleChanged : ${localizer.currentLocale} `);\r\n\r\n\t\t$('span[locate].custom-equations')\t\t\t\t\t\t\t\t\t\t\t// span elements in html\r\n\t\t.each(function() { \r\n\t\t\tif (typeof ($(this).attr(\"locate\")) != \"undefined\") { \r\n\t\t\t\tvar localText = localizer.getLocalText($(this).attr(\"locate\")); \r\n\t\t\t\tif (typeof (localText) != \"undefined\") $(this).html(localText); \r\n\t\t\t} \r\n\t\t});\r\n\t\t\r\n\t\t$('.custom-equations:not(span)')\t\t\t\t\t\t\t\t\t\t\t// the spans are embedded in titles (tooltips)\r\n\t\t.each(function() {\r\n\t\t\tif ($(this).hasClass('easyui-tooltip')) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvar id = $(this).attr('id');\r\n\t\t\t\t\tvar title = inst.localizeOption('content', id, $.fn.tooltip);\r\n\t\t\t\t\t$(this).tooltip({\r\n\t\t\t\t\t\tcontent: title,\r\n\t\t\t\t\t\tonShow: function() {\r\n\t\t\t\t\t\t\tconsole.debug(`Tooltip %o`, $(this).tooltip('tip'));\r\n\t\t\t\t\t\t\t$(this).tooltip('tip').css({ \r\n\t\t\t\t\t\t\t\t'z-index': 500000, \t\t\t\t\t\t\t\t\t// always above all ui elements!\r\n\t\t\t\t\t\t\t\tmaxWidth: 300 \r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\tconsole.warn(`easyui-tooltip warning : ${e}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\t\r\n\r\n\t/**\r\n\t * @abstract It is intended to create this Panel dynamically taking the content from the Settings.\r\n\t */\r\n\tasync initialise() {\r\n\t\tvar inst = this;\r\n\t\t\r\n\t\tawait super.initialise();\r\n\t\tawait inst.initialiseDatagrid(`${inst.gridSelector}`);\r\n\t\tawait inst.customEquationsFromParameters();\r\n\r\n\t\t// TODO: pagination bar adaptation\t\t\r\n\t\t// Building the dialog more than once was not the intention, but this comes at a low\r\n\t\t// price and enables language update of the pagination bar over invocations.\r\n\r\n\t\t$('#btCUSTOM_EQUATIONS_ADD')\r\n\t\t.click(async function(event) { \r\n\t\t\tevent.preventDefault();\r\n\t\t\t\r\n\t\t\tvar selectedText = inst.parent.codeMirror.getSelection();\r\n\t\t\tif (selectedText != \"\") {\r\n\t\t\t\tinst.addEquation('Placeholder', selectedText);\r\n\t\t\t\tinst.onAfterRender();\r\n\t\t\t\tinst.editCell();\t\t\t\t\t\t\t\t\t\t\t\t\t\t// TODO: attention! order reversed\r\n\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\tinst.messager.show('FORMULA_EDITOR', 'NO_SELECTION_TEXT');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t$('#btCUSTOM_EQUATIONS_REMOVE')\r\n\t\t.click(async function(event) { \r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar checkedEquations = inst.categoriesTree.getCheckedEquations();\t\t\t// indices of checked equations\r\n\t\t\tvar from = inst.categoriesTree.currentLeaf;\t\t\t\t\t\t\t\t\t// the currrent set\r\n\t\t\tif (from !== null && checkedEquations.length > 0) {\t\t\t\t\t\t\t// remove configured?\r\n\t\t\t\tinst.categoriesTree.deleteEquations(from.attributes, checkedEquations); // -> then delete the checked equations\r\n\t\t\t\tinst.clearCheckedAndUpdate();\r\n\t\t\t} else {\r\n\t\t\t\tinst.messager.show('FORMULA_EDITOR', 'NO_SELECTION_CELL');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t$('#btCUSTOM_EQUATIONS_SAVE')\r\n\t\t.click(async function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconsole.info('Click on btCUSTOM_EQUATIONS_SAVE');\r\n\t\t\tinst.categoriesTree.currentEquations = inst.toJson();\r\n\t\t\tvar data = JSON.stringify(inst.categoriesTree.customEquationsProxy);\t\t\t// must be a JSON string\r\n\t\t\tvar type = 'application/json';\r\n\t\t\t\r\n\t\t\tvar fileHandler = new FileHandler();\r\n\t\t\tfileHandler.saveFile(data, type, \"fSAVE_CUSTOM_EQUATIONS\");\r\n\t\t});\r\n\t\r\n\t\t$('#btCUSTOM_EQUATIONS_LOAD')\r\n\t\t.click(async function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar fileHandler = new FileHandler();\r\n\t\t\tvar json = await fileHandler.loadFile(\"fOPEN_CUSTOM_EQUATIONS\");\r\n\t\t\tawait inst.categoriesTree.setCustomEquations(JSON.parse(json));\r\n\t\t\tinst.fromJson(inst.categoriesTree.currentEquations);\r\n\t\t\tinst.onAfterRender();\r\n\t\t});\r\n\t\t\r\n\t\t$('#CUSTOM_EQUATIONS_LAYOUT').layout({fit: true});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Show override of the base class for localization.\r\n\t */\r\n\tasync show() {\r\n\t\t// TODO: order changed to initialize span[locate]? -> changes nothing in appearance\r\n\t\tawait super.show();\r\n\t\tawait this.onLocaleChanged(this.parent.localizer);\t\t\t// TODO: does not help for pagination\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Observer of *Category Tree* observable.\r\n\t */\r\n\tonTreeChanged(node) {\r\n\t\tthis.customEquationsToParameters();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Observer of *Category Tree* observable.\r\n\t */\r\n\tonEquationMoved() {\r\n\t\tthis.clearCheckedAndUpdate();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Observer of *Category Tree* observable.\r\n\t */\r\n\tonNodeSelected(equations) {\r\n\t\ttry {\r\n\t\t\tthis.fromJson(equations);\r\n\t\t\t$(this.gridSelector).datagrid('doFilter');\r\n\t\t} catch(e) {\r\n\t\t\t\r\n\t\t}\r\n\t\tthis.customEquationsToParameters();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Clears the checked checkboxes in datagrid and updates the latter.\r\n\t */\r\n\tclearCheckedAndUpdate() {\r\n\t\ttry {\r\n\t\t\t$(this.gridSelector).datagrid('clearChecked');\t\t\t// does this clear all checks (not the rows itselfs)?\r\n\t\t\tthis.fromJson(this.categoriesTree.currentEquations);\r\n\t\t\t$(this.gridSelector).datagrid('doFilter');\r\n\t\t} catch(e) {\r\n\t\t\t\r\n\t\t}\r\n\t\tthis.customEquationsToParameters();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Reads the Custom Equations from the parameters.\r\n\t */\r\n\tasync customEquationsFromParameters() {\r\n\t\ttry {\r\n\t\t\tawait this.categoriesTree.setCustomEquations(this.parent.parameters.equationCollection);\r\n\t\t\tthis.fromJson(this.categoriesTree.currentEquations);\r\n\t\t\t$(this.gridSelector).datagrid('doFilter');\r\n\t\t} catch(e) {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Called after each change of the content writes the Custom Equations back to the parameters.\r\n\t */\t\r\n\tcustomEquationsToParameters() {\r\n\t\tthis.categoriesTree.currentEquations = this.toJson();\r\n\t\tthis.parent.parameters.equationCollection = this.categoriesTree.customEquationsProxy;\t\t\r\n\t\t// Writing to parameters DOES initiate writeParameters !!\r\n\t\t// this.parent.parameters.writeParameters();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Uses the given JSON compatible data to fill the data grid.\r\n\t * \r\n\t * @param json - a json object used to fill the data grid\r\n\t */\r\n\tfromJson(json) {\r\n\t\t$(this.gridSelector)\r\n\t\t.datagrid('loadData', []);\r\n\t\tvar id = 0;\r\n\t\t\r\n\t\ttry {\r\n\t\t\tvar equations = json; // JSON.parse(json);\r\n\t\t\tfor (const equation of equations) {\r\n\t\t\t\tif (typeof(equation[1]) == \"string\" && equation[1] != \"[object Object]\") {\r\n\t\t\t\t\tthis.addEquation(equation[0], equation[1], ++id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\tthis.messager.error('LOAD_ERROR', e);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Reads the Equations from data grid and returns them.\r\n\t * \r\n\t * These are all equations now but filtered, if a filter is active.\r\n\t * \r\n\t * @returns An array of the equations, JSON compatible\r\n\t */\r\n\ttoJson() {\r\n\t\tvar data = $(this.gridSelector)\r\n\t\t.datagrid('doFilter')\r\n\t\t.datagrid('getData');\r\n\t\t\r\n\t\tvar customEquations = data.filterRows.map(function(row) {\r\n\t\t\tvar title = row.title;\r\n\t\t\tvar fragment = $.parseHTML(row.formula)[0];\r\n\t\t\tvar formula = fragment.attributes['latex'].value;\r\n\t\t\treturn [ title, formula ];\r\n\t\t});\r\n\t\t\r\n\t\treturn customEquations;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract A test to get all data rows.\r\n\t * \r\n\t * No longer needed, only for illustration purposes.\r\n\t */\r\n\ttest() {\r\n\t\t\r\n\t\tvar pager = $(this.gridSelector).datagrid('getPager');\r\n\t\tvar options = pager.pagination('options');\r\n\t\tvar total = options.total;\r\n\t\tvar pageSize = options.pageSize;\r\n\t\t\r\n\t\tvar rows = [];\r\n\t\tfor (var page = 1, remaining = total; remaining > 0; page++, remaining -= pageSize) {\r\n\t\t\t$(this.gridSelector).datagrid('gotoPage', page);\r\n\t\t\tpager.pagination('refresh');\r\n\t\t\tvar pageRows = $(this.gridSelector).datagrid('getData').rows;\r\n\t\t\trows = rows.concat(pageRows);\r\n\t\t}\r\n\t\t\r\n\t\tconsole.debug(`test-read : read ${rows.length} of ${options.total} `);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Checks if a filter is active in the datagrid.\r\n\t * \r\n\t * @returns true, if so\r\n\t */\r\n\tfilterActive() {\r\n\t\tvar pager = $(this.gridSelector).datagrid('getPager');\r\n\t\tvar options = pager.pagination('options');\r\n\t\tvar total = options.total;\r\n\t\tvar rows = $(this.gridSelector).datagrid('getData').filterRows;\r\n\t\t\r\n\t\treturn rows.length < total;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Determines the first free id for the id field making it unique.\r\n\t */\r\n\tfreeId() {\r\n\t\tvar data = $(this.gridSelector)\r\n\t\t.datagrid('getData');\r\n\r\n\t\tvar ids = data.filterRows.map(row => row.id);\r\n\t\treturn Math.max(ids) + 1;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Adds an Equation to the grid.\r\n\t * \r\n\t * @param title - the title of the equation\r\n\t * @param formula - the formula itself in katex format\r\n\t */\r\n\taddEquation(title, formula, id = -1) {\r\n\t\t$(this.gridSelector)\r\n\t\t.datagrid(\r\n\t\t\t'appendRow', {\r\n\t\t\tid: id == -1 ? this.freeId() : id,\r\n\t\t\ttitle: title,\r\n\t\t\tformula: this.buildAnchor(formula)\t \r\n\t\t})\r\n\t\t.datagrid('acceptChanges', {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Equips the datagrid (after render update).\r\n\t * \r\n\t * - inplace update of the content\r\n\t * - row height fixing\r\n\t * - saving of equations\r\n\t */\r\n\tonAfterRender(withParametersUpdate = true) {\r\n\t\tvar anchor = $(`${this.gridSelectorOfCopy} a`);\r\n\t\tthis.parent.inplaceUpdate(anchor, true);\r\n\t\t$(this.gridSelector).datagrid('fixRowHeight');\r\n\t\tif (withParametersUpdate) this.customEquationsToParameters();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initiates cell editing.\r\n\t */\r\n\teditCell(index = -1) {\r\n\t\tif (index == -1) {\r\n\t\t\tindex = $(this.gridSelector).datagrid('getRows').length - 1;\r\n\t\t}\r\n\t\t\r\n\t\tvar input = $(this.gridSelector)\r\n\t\t.datagrid('editCell', {\r\n\t\t\tindex: index,\r\n\t\t\tfield: 'title'\r\n\t\t})\r\n\t\t.datagrid('input', {\r\n\t\t\tindex: index,\r\n\t\t\tfield: 'title'\r\n\t\t});\r\n\t\tif (input) {\r\n\t\t\tinput.select();\r\n\t\t}\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Builds a single Anchor from formula.\r\n\t * \r\n\t * @param formula - the formula is capable of providing an interactive anchor\r\n\t * @returns the calculated anchor\r\n\t */\r\n\tbuildAnchor(formula) {\r\n\t\tvar title = `<span style='background:yellow; color: brown;'>${formula}</span>`;\r\n\t\treturn `<a style=\"text-align:left;\" href=\"#\" class=\"s easyui-tooltip\" title=\"${title}\" latex=\"${formula}\">$${formula}$</a>`;\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Compares 2 items of the datagrid for sorting.\r\n\t * \r\n\t * WORKS. Must observe the contract with the sorting API.\r\n\t * \r\n\t * @param a - item 1\r\n\t * @param b - item 2\r\n\t * @returns -1 for a < b and +1 for a >= b;\r\n\t */\r\n\talphaSorter(a, b) {\r\n\t\tconsole.debug(`SORT comparing ${a} < ${b}, order: ${this.sortOrderAsc}`);\r\n\t\treturn a < b ? -1 : +1;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initialises a Data Grid given by the selector\r\n\t */\r\n\tasync initialiseDatagrid(selector) {\r\n\t\tvar inst = this;\r\n\t\tvar filterPrompt = inst.parent.localizer.getLocalText('FILTER_PROMPT');\r\n\t\t$(selector)\r\n\t\t.datagrid({\r\n\t\t\t//singleSelect: true,\r\n\t\t\tselectOnCheck: true,\r\n\t\t\tremoteSort: false,\r\n\t\t\tremoteFilter: false,\r\n\t\t\tpagination: true,\r\n\t\t\tpageSize: 20,\r\n\t\t\trownumbers: true,\r\n\t\t\tfit: true,\r\n\t\t\tnoheader: false,\r\n\t\t\tonAfterEdit: async function(idx, row, changes) {\r\n\t\t\t\tconsole.debug(`onAfterEdit for ${selector}`);\r\n\t\t\t\tinst.onAfterRender();\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tonCancelEdit: async function(idx, row) {\r\n\t\t\t\tconsole.debug(`onCancelEdit for ${selector}`);\r\n\t\t\t\tinst.onAfterRender();\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tclickToEdit: false,\r\n\t\t\tdblclickToEdit: true,\r\n\t\t\tcolumns: [[\r\n\t\t\t\t{ field: 'id', title: 'Id', hidden: true },\r\n\t\t\t\t{ field: 'check', checkbox: true },\r\n\t\t\t\t{ field: 'title', title: '<span class=\"custom-equations\" locate=\"TITLE\">Title</span>', width: '35%', editor: 'text', sortable: true, sorter: inst.alphaSorter.bind(inst) },\r\n\t\t\t\t{ field:'formula', title: '<span class=\"custom-equations\" locate=\"FORMULA\">Formula</span>', width:'60%' }\r\n\t\t\t]],\r\n\t\t\tidField: 'id',\r\n\t\t\tonBeforeSortColumn: function(sort, order) {\r\n\t\t\t\tconsole.debug(`Sort order is: ${order}`);\r\n\t\t\t\tinst.sortOrderAsc = order;\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tonLoadSuccess: function() {\r\n\t\t\t\t$(this).datagrid('enableDnd');\r\n\t\t\t\tvar opts = $(this).datagrid('options');\r\n\t\t\t\tvar trs = opts.finder.getTr(this, 0, 'allbody');\r\n\t\t\t\ttrs.draggable({\r\n\t\t\t\t\trevert: true,\r\n\t\t\t\t\tdeltaX: 70,\r\n\t\t\t\t\tdeltaY: 70,\r\n\t\t\t\t\tproxy: function(source) {\r\n\t\t\t\t\t\tconsole.dir(source);\r\n\t\t\t\t\t\tvar p = $('<div class=\"datagrid-div tree-node-proxy droppable\" style=\"border: 2px solid red; z-index: 100;\"></div>').appendTo(`#${inst.panelId}`);\r\n\t\t\t\t\t\tvar row = $('<div style=\"width: 400px; display: flex; flex-direction: row; justify-content: center;\"></div>');\r\n\t\t\t\t\t\t$(source).find('td')\r\n\t\t\t\t\t\t.first()\r\n\t\t\t\t\t\t.each(function() {\r\n\t\t\t\t\t\t\tvar td = $('<div style=\"margin: auto; width: 80px;\"></div>');\r\n\t\t\t\t\t\t\t$(td).html($(this).html());\r\n\t\t\t\t\t\t\t$(td).appendTo($(row));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar withIcon = $(row).prepend('<div class=\"tree-dnd-icon tree-dnd-no\" style=\"width: 20px;\">&nbsp;</div');\r\n\t\t\t\t\t\tp.append($(withIcon));\r\n\t\t\t\t\t\t// THIS TRIAL TO MIMICK THE TREE NODE DOES NOT WORK\r\n\t\t\t\t\t\t// p.append('<span class=\"tree-indent\"></span><span class=\"tree-file\" style=\"width: 20px;\">&nbsp;</span><span class=\"title\">TEXT SAMPLE</span>');\r\n\t\t\t\t\t\tvar proxy = p[0];\r\n\t\t\t\t\t\tconsole.dir(proxy);\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonDragOver: function(target, source) {\r\n\t\t\t\tconsole.dir(source);\r\n\t\t\t}\r\n\t\t});\r\n\t\tinst.equipDatagridWithInteractivity();\t\t\t\t\t\t\t\t// TODO: is this a better place?\r\n\t\t$(selector)\r\n\t\t.datagrid('enableCellEditing')\r\n\t\t.datagrid('gotoCell', {\r\n            index: 0,\r\n            field: 'title'\r\n    \t})\r\n    \t.datagrid(await inst.viewRender())\t\t\t\t\t\t\t\t\t// adds onAfterRender to view\r\n\t\t.datagrid('enableFilter', [\r\n\t\t\t{\r\n\t\t\t\tfield: 'title',\r\n\t\t\t\ttype: 'textbox',\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tprompt: filterPrompt\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t])\r\n\t\t.datagrid('addFilterRule', {\r\n\t\t\tfield: 'title',\r\n\t\t\top: 'contains',\r\n\t\t\tvalue: ''\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns an object with view property, assigning overrides for render methods.\r\n\t */\r\n\tasync viewRender() {\r\n\t\tvar inst = this;\r\n\t\treturn {\r\n\t\t\tview: $.extend(true, {}, $.fn.datagrid.defaults.view, {\r\n\t\t\t\trender: async function(target, container, frozen){\r\n\t\t\t\t\t$.fn.datagrid.defaults.view.render.call(this, target, container, frozen);\r\n\t\t\t\t\t//console.log('Render');\r\n\t\t\t\t},\r\n\t\t\t\tonBeforeRender: async function(target){\r\n\t\t\t\t\t$.fn.datagrid.defaults.view.onBeforeRender.call(this, target);\r\n\t\t\t\t\t//console.log('Before render');\r\n\t\t\t\t},\r\n\t\t\t\tonAfterRender: function(target){\r\n\t\t\t\t\t$.fn.datagrid.defaults.view.onAfterRender.call(this, target);\r\n\t\t\t\t\tinst.onAfterRender(false);\r\n\t\t\t\t\t//console.log('After render');\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Equips the data grid anchors with interactivity. \r\n\t * \r\n\t * This is necessary because original event handlers\r\n\t * do not stay active after changes.\r\n\t */\r\n\tequipDatagridWithInteractivity() {\r\n\t\tvar inst = this;\r\n\t\tfunction getSymbol(obj) { \r\n\t\t\tif ($(obj).attr(\"latex\") != undefined) { \r\n\t\t\t\treturn $(obj).attr(\"latex\"); \r\n\t\t\t} else { \r\n\t\t\t\treturn undefined; \r\n\t\t\t} \r\n\t\t}; \r\n\t\tvar selector = `${this.gridSelectorOfCopy}`;\r\n\t\t\r\n\t\ttry {\r\n\t\t\tvar grid = $(selector);\r\n\t\t\tgrid\r\n\t\t\t.on('mouseover', 'a', function(event) { \r\n\t\t\t\tvar latex = getSymbol(event.target);\r\n\t\t\t\tif (latex) $(\"#divInformation\").html(latex); \r\n\t\t\t})\r\n\t\t\t.on('mouseout', 'a', function(event) { $(\"#divInformation\").html(\"&nbsp;\"); })\r\n\t\t\t.on('click', 'a', function(event) {\r\n\t\t\t\tevent.preventDefault(); \r\n\t\t\t\tvar a = $(event.target);\r\n\t\t\t\tvar latex = a.attr(\"latex\");\r\n\t\t\t\tif (latex != undefined) { \r\n\t\t\t\t\tinst.parent.insert(latex); \r\n\t\t\t\t} else { \r\n\t\t\t\t\t$.messager.show({ \r\n\t\t\t\t\t\ttitle: \"<span class='rtl-title-withicon'>\" + inst.parent.localizer.getLocalText(\"INFORMATION\") + \"</span>\", \r\n\t\t\t\t\t\tmsg: inst.parent.localizer.getLocalText(\"NO_LATEX\") \r\n\t\t\t\t\t}); \r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Katex: equipDatagridWithInteractivity : ${e}`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract The KIHPanels container for all Panels.\r\n * \r\n * This hosts all Panel derived instances and is able to *show* them with a specialized method.\r\n * This method performs an initialisation lazily and one time and can show the Panel repeatedly.\r\n * Client is the central *Katex Input Helper* instance.\r\n */\r\nclass KIHPanels {\r\n\tparameters = null;\r\n\tlocalizer = null;\r\n\tparser = null;\r\n\tmessager = null;\r\n\tpanels = { };\r\n\t\r\n\t/**\r\n\t * @abstract Constructor\r\n\t */\r\n\tconstructor(parameters, localizer, parser) {\r\n\t\tthis.parameters = parameters;\r\n\t\tthis.localizer = localizer;\r\n\t\tthis.parser = parser;\r\n\t\tthis.messager = new _helpers__WEBPACK_IMPORTED_MODULE_0__.Messager(localizer);\r\n\t}\r\n\t\r\n\tasync showPanel(id) {\r\n\t\tif (!(id in this.panels)) {\r\n\t\t\tthis.panels[id] = new KIHPanel(id, this);\r\n\t\t\tawait this.initialise(id);\r\n\t\t}\r\n\t\tawait this.show(id);\r\n\t}\r\n\r\n\tasync showMoreDialog(id, initialiseSymbolContent) {\r\n\t\tif (!(id in this.panels)) {\r\n\t\t\tthis.panels[id] = new KIHMoreDialog(id, this);\r\n\t\t\tawait this.initialise(id, initialiseSymbolContent);\r\n\t\t}\r\n\t\tawait this.show(id);\r\n\t}\r\n\t\r\n\tasync showWindow(id) {\r\n\t\tif (!(id in this.panels)) {\r\n\t\t\tthis.panels[id] = new KIHWindow(id, this);\r\n\t\t\tawait this.initialise(id);\r\n\t\t}\r\n\t\tawait this.show(id);\r\n\t}\r\n\t\r\n\tasync showDynamicPanel(math) {\r\n\t\tvar id = 'wf_CUSTOM_EQUATIONS_MORE';\r\n\t\tif (!(id in this.panels)) {\r\n\t\t\tthis.panels[id] = new DynamicPanel(math);\r\n\t\t\tawait this.initialise(id);\r\n\t\t}\r\n\t\tawait this.show(id);\r\n\t}\r\n\t\r\n\tasync initialise(id, initialiseSymbolContent = null) {\r\n\t\tawait this.panels[id].initialise(initialiseSymbolContent);\r\n\t}\r\n\t\r\n\tasync show(id) {\r\n\t\tawait this.panels[id].show();\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { \r\n\t\tDynamicPanel, KIHMoreDialog, KIHPanel, KIHPanels, KIHWindow\r\n\t};\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/panels.js?")},"./src/assets/js/parameters.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KIHParameters: () => (/* binding */ KIHParameters),\n/* harmony export */   ParametersProxy: () => (/* binding */ ParametersProxy)\n/* harmony export */ });\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n/**\r\n * @abstract Factory method generating a Proxy for KIHParameters.\r\n */\r\nfunction ParametersProxy() {\r\n\tvar parameters = new KIHParameters();\r\n\treturn new Proxy(\r\n\t\tparameters,\r\n\t\t{\r\n\t\t\tset(target, prop, value, receiver) {\r\n\t\t\t\tvar changed = target[prop] != value;\r\n\t\t\t\tif (changed) {\r\n\t\t\t\t\ttarget[prop] = value;\r\n\t\t\t\t\tif (!target.transaction.isOngoingTransaction) {\r\n\t\t\t\t\t\t// console.debug(`property set: ${prop} = ${value}, set : ${target[prop]}`);\r\n\t\t\t\t\t\ttarget.transaction.complete();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n}\r\n\r\n/**\r\n * @abstract Manages control parameters, especially those which can be stored over sessions.\r\n * \r\n * It is based on the communication of messages to gain the settings of the plugin.\r\n */\r\nclass KIHParameters {\r\n\t\r\n\tid = 'Katex Input Helper';\r\n\tstyle = \"aguas\";\r\n\tlocalType = \"en_US\";\r\n\tencloseAllFormula = false; \r\n\tautoUpdateTime = 500; \r\n\tmenuupdateType = true; \r\n\tautoupdateType = true; \r\n\r\n\tequation = \"\";\r\n\tequationCollection = [ ];\r\n\tdialogSettingsPrefix = \"KIH_Location_\";\r\n\tpersistEquations = true;\r\n\tpersistWindowPositions = true;\r\n\tblockWrite = false;\r\n\t\r\n\ttransaction = null;\r\n\tmouseState = null;\r\n\tdisplayMode = true;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor() {\r\n\t\tthis.transaction = new Transaction();\r\n\t\tthis.transaction.configure(this.writeParameters.bind(this));\r\n\t\tthis.mouseState = new MouseState(this.transaction);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Queries the parameters from the Plugin.\r\n\t */\r\n\tasync queryParameters() {\r\n\t\t\r\n\t\tvar api = window.webviewApi; \r\n\t\tif (!api) {\r\n\t\t\tapi = { postMessage: async ( o ) => { } }; \r\n\t\t}\r\n\t\tvar inst = this;\r\n\t\tvar response = await api.postMessage({\r\n\t\t\tid: this.id,\r\n\t\t\tcmd: 'getparams'\r\n\t\t});\r\n\t\tif (response) {\r\n\t\t\tinst.transaction.begin();\r\n\t\t\tfor (const [key, val] of Object.entries(response)) {\r\n\t\t\t\tif (key == 'displayMode') {\r\n\t\t\t\t\tconsole.debug(`Parameters : queryParameters : displayMode ${val} `);\r\n\t\t\t\t}\r\n\t\t\t\tinst[key] = val;\r\n\t\t\t\tif (key.startsWith('w')) {\r\n\t\t\t\t\tinst.resizePanel(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tinst.transaction.end();\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * Is there a way to use messages to return data to the caller?\r\n\t\t\t * Experience says NO!\r\n\t\t\t * \r\n\t\t\t * TODO: CHECK! IS THERE A DANGER ON THIS?\r\n\t\t\t * \r\n\t\t\t$(window).bind('unload', async function() {\r\n\t\t\t\tvar response = await webviewApi.postMessage({\r\n\t\t\t\t\tid: this.id,\r\n\t\t\t\t\tcmd: 'sendparams',\r\n\t\t\t\t\tcheck: true\r\n\t\t\t\t});\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\t*/\r\n\t\t} else {\r\n\t\t\tconsole.warn(`The \"Katex Input Helper\" plugin did not return a response to get parameters `);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Resets all window positions. Defaults will be activated.\r\n\t * \r\n\t * The defaults are taken from css file *dialog.css* (application css file).\r\n\t */\t\r\n\tresetWindowPositions() {\r\n\t\tthis.transaction.begin();\r\n\t\tvar css = new Css();\r\n\r\n\t\tfor (const [key, val] of Object.entries(this)) {\r\n\t\t\tif (key.startsWith('w')) {\r\n\t\t\t\tvar o = css.dimensionsOf(key);\r\n\t\t\t\tthis[key] = o;\r\n\t\t\t\t$(`#${key}`).panel('resize', o);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.transaction.end();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the window ids as array.\r\n\t */\r\n\tget windowIds() {\r\n\t\treturn Object.keys(this).filter(key => key.startsWith('w'));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the windows selectors as one string.\r\n\t */\r\n\tget windowSelectors() {\r\n\t\treturn this.windowIds.map(key => `#${key}`).join(',');\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Writes parameters to the HIDDEN field as required to return some values back\r\n\t * \t\t\t to the caller.\r\n\t */\r\n\twriteParameters(equation = \"\") {\r\n\t\tvar parameters = JSON.stringify(this.filteredParameters);\r\n\t\t$('#hidden').attr('value', parameters);\r\n\t\tthis.debugPrint();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Filters some parameters out from the attributes of this instance.\r\n\t * \r\n\t * Those are not needed as settings nor are they JSON stringifyable.\r\n\t * \r\n\t * @returns the filtered settings keys\r\n\t */\r\n\tget filteredParameters() {\r\n\t\tvar o = { };\r\n\t\tvar doNotUse = [ \"transaction\", \"displayMode\", \"mouseState\" ];\r\n\t\tfor (const [key, val] of Object.entries(this)) {\r\n\t\t\tif (!doNotUse.includes[key]) {\r\n\t\t\t\to[key] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn o;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract onPanelMove handler for some dialogs and windows.\r\n\t */\r\n\tonPanelMove(id, left, top) {\r\n\t\tif (id in this && (this[id].left != left || this[id].top != top)) {\r\n\t\t\tthis[id].left = left;\r\n\t\t\tthis[id].top = top;\r\n\t\t\tthis.mouseState.increment();\r\n\t\t\t// TODO: check\r\n\t\t\t//var dimensions = this.getPanelDimensions(id);\r\n\t\t\t//this[id].width = dimensions.width;\r\n\t\t\t//this[id].height = dimensions.height;\r\n\t\t\t\r\n\t\t\tthis.transaction.complete();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract onPanelResize handler for some dialogs and windows.\r\n\t * \r\n\t * A Resize can also change *left* and *top* values. That's why we must include \r\n\t * those into consideration and add them to the object.\r\n\t * TODO: this only works, if left / top are updated during resize!!\r\n\t * EXPERIENCE: resize with left change persisted although onPanelMove not detected\r\n\t * \r\n\t * @param id - id of the panel\r\n\t * @param width - the width established by the user\r\n\t * @param height - the height established by the user\r\n\t */\r\n\tonPanelResize(id, width, height) {\r\n\t\tif (id in this && (this[id].width != width || this[id].height != height)) {\r\n\t\t\tthis[id].width = width;\r\n\t\t\tthis[id].height = height;\r\n\t\t\tthis.mouseState.increment();\t\t\t\t\t\t\t\t// counts the number of resize / move events\r\n\t\t\t\r\n\t\t\tvar dimensions = this.getPanelDimensions(id);\r\n\t\t\tthis.check(this[id], dimensions);\t\t\t\t\t\t\t// checks for discrepancy\r\n\t\t\tthis[id].left = dimensions.left;\r\n\t\t\tthis[id].top = dimensions.top;\r\n\t\t\t\r\n\t\t\tthis.transaction.complete();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Checks for discrepancy between handler and options dimensions.\r\n\t */\r\n\tcheck(windowState, dimensions) {\r\n\t\tif (Math.abs(windowState.width - dimensions.width) > 5 \t||\r\n\t\t\tMath.abs(windowState.height - dimensions.height) > 5) {\r\n\t\t\tconsole.warn('KIHParameters : discrepancy deteced during window resize');\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Resizes a given panel by using the 'configured' settings.\r\n\t * \r\n\t * @param id - the panel id as in HTML\r\n\t */\r\n\tresizePanel(id) {\r\n\t\tif (id in this && this[id] != undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tvar o = this[id];\r\n\t\t\t\t$(`#${id}`).panel('resize', this[id]);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tconsole.error(`Exception resizing panel ${id} : ${e}`);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the complete panel dimensions as from options.\r\n\t * \r\n\t * TODO: Seems to be not correct!\r\n\t */\r\n\tgetPanelDimensions(id) {\r\n\t\tvar options = $(`#${id}`).panel('options');\r\n\t\tvar dimensions = { \r\n\t\t\tleft: options.left, \r\n\t\t\ttop: options.top, \r\n\t\t\twidth: options.width, \r\n\t\t\theight: options.height \r\n\t\t};\r\n\t\treturn dimensions;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Selected console output of the attributes.\r\n\t */\r\n\tdebugPrint() {\r\n\t\tthis.printEquation();\r\n\t\tthis.printEquationCollection();\r\n\t\tthis.printSettingsConfiguration();\r\n\t\tthis.printWindowConfiguration();\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Console output of the equation.\r\n\t */\r\n\tprintEquation() {\r\n\t\tconsole.debug(`Return-Parameter : ${JSON.stringify(this.equation)} `);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Console output of the Custom Equations.\r\n\t */\r\n\tprintEquationCollection() {\r\n\t\tconsole.debug(`Equations-Parameter : ${JSON.stringify(this.equationCollection)} `);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Console output of the settings.\r\n\t */\r\n\tprintSettingsConfiguration() {\r\n\t\tfor (const key of this.configurationKeys) {\r\n\t\t\tconsole.debug(`Settings-Parameters : ${key} : ${this[key]} `);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Console output of the Window Size and Position.\r\n\t */\r\n\tprintWindowConfiguration() {\r\n\t\tfor (const key of this.windowKeys) {\r\n\t\t\tconsole.debug(`Window-Parameters : ${key} : ${JSON.stringify(this[key])} `);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the settings configuration keys.\r\n\t */\r\n\tget configurationKeys() {\r\n\t\treturn [\r\n\t\t\t\"id\",\r\n\t\t\t\"style\",\r\n\t\t\t\"localType\",\r\n\t\t\t\"encloseAllFormula\", \r\n\t\t\t\"autoUpdateTime\", \r\n\t\t\t\"menuupdateType\", \r\n\t\t\t\"autoupdateType\", \r\n\t\t\t\"persistEquations\",\r\n\t\t\t\"persistWindowPositions\"\t\t\t\r\n\t\t];\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Returns the window configuration keys.\r\n\t */\r\n\tget windowKeys() {\r\n\t\treturn Object.keys(this).filter(s => s.startsWith('w'));\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract Supports transactions.\r\n * \r\n * - normal mode: each desired action of the client initiates execution of a completion routine.\r\n * - transaction mode: after a series of desired actions the execution of a completion \r\n *   routine is initiated.\r\n */\r\nclass Transaction {\r\n\t\r\n\tonComplete = null;\r\n\tonEnd = null;\r\n\tonCompleteBackup = null;\r\n\tonEmpty = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor\r\n\t */\r\n\tconstructor() {\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Configures the instance by providing *Completion* and *End* routines.\r\n\t */\r\n\tconfigure(onComplete, onEnd = onComplete) {\r\n\t\tthis.onComplete = onComplete;\r\n\t\tthis.onCompleteBackup = onComplete;\r\n\t\tthis.onEnd = onEnd;\r\n\t\tthis.onEmpty = (...args) => { };\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Completes a single *Action* but not during a *Transaction*.\r\n\t * \r\n\t * Executes the Completion routine, but not during a Transaction.\r\n\t */\r\n\tcomplete(...args) {\r\n\t\tthis.onComplete(...args);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Begins a *Transaction*. The completion routine is deactivated.\r\n\t */\r\n\tbegin() {\r\n\t\tthis.onComplete = this.onEmpty;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Ends a *Transaction*.\r\n\t * \r\n\t * The *End* routine is executed, then the Completion routine is re-activated.\r\n\t */\r\n\tend(...args) {\r\n\t\tthis.onEnd(...args);\r\n\t\tthis.onComplete = this.onCompleteBackup;\r\n\t}\r\n\t\r\n\tcancel() {\r\n\t\tthis.onComplete = this.onCompleteBackup;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Checks and returns, if there is an ongoing Transaction.\r\n\t */\r\n\tget isOngoingTransaction() {\r\n\t\treturn this.onComplete === this.onEmpty;\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract This class supports retrieval of css info from the *dialog.css* CSS file.\r\n * \r\n * This is used to reset the dimensions of the dialogs.\r\n */\r\nclass Css {\r\n\tsheet = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor() {\r\n\t\tthis.findSheet();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Finds the style sheet.\r\n\t */\r\n\tfindSheet() {\r\n\t\tfor (const sheet of document.styleSheets) {\r\n\t\t\tif (sheet.href && sheet.href.endsWith('dialog.css')) {\r\n\t\t\t\tthis.sheet = sheet;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Searches for and retrieves the width and height given the window id.\r\n\t * \r\n\t * @param id - the id of the window (id attribute)\r\n\t * @returns object with width and height entries, returns *auto* if not found\r\n\t */\r\n\tdimensionsOf(id) {\r\n\t\tfor (const rule of this.sheet.cssRules) {\r\n\t\t\tif (rule.type == rule.STYLE_RULE && rule.selectorText === ('#' + id)) {\r\n\t\t\t\tconst width = rule.styleMap.get('width');\r\n\t\t\t\tconst height = rule.styleMap.get('height');\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: width.value + width.unit,\r\n\t\t\t\t\theight: height.value + height.unit\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { width: 'auto', height: 'auto'};\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract Used to reduce write back to the hidden field based on the use of\r\n * \t\t\t Transactions and observation of the mouse state.\r\n * \r\n * The hopes has not fulfilled as there is already a reduction of mouse events during\r\n * a size or position change.\r\n */\r\nclass MouseState {\r\n\r\n\ttransaction = null;\r\n\twindowEvents = 0;\r\n\tmouseUp = true;\r\n\tactive = false;\t\t\t\t\t\t\t\t\t\t// currently deactivated\r\n\r\n\tconstructor(transaction) {\r\n\t\tthis.transaction = transaction;\r\n\t\tvar inst = this;\r\n\r\n\t\tif (this.active) {\r\n\t\t\t$('body').on('mousedown', function (event) {\r\n\t\t\t\tinst.mouseUp = false;\r\n\t\t\t\tinst.reset();\r\n\t\t\t\tinst.transaction.begin();\r\n\t\t\t});\r\n\t\t\t$('body').on('mouseup', function (event) {\r\n\t\t\t\tinst.mouseUp = true;\r\n\t\t\t\tif (inst.isWindowChanged) {\r\n\t\t\t\t\tinst.transaction.end();\r\n\t\t\t\t\tconsole.debug(`MouseState : ${inst.windowEvents} window events during transaction`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tinst.transaction.cancel();\r\n\t\t\t\t\tconsole.debug(`MouseState : no window events during transaction`);\r\n\t\t\t\t} \r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\treset() {\r\n\t\tthis.windowEvents = 0;\r\n\t}\r\n\t\r\n\tincrement() {\r\n\t\tthis.windowEvents ++;\r\n\t\tconsole.debug(`MouseState : incremented to : ${this.windowEvents} `);\r\n\t}\r\n\t\r\n\tget isWindowChanged() {\r\n\t\treturn this.windowEvents > 0;\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { Css, KIHParameters, ParametersProxy, Transaction };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/parameters.js?")},"./src/assets/js/parserExtension.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ParserExtension: () => (/* binding */ ParserExtension)\n/* harmony export */ });\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n/**\r\n * @abstract A the jquery parser using parser wrapper.\r\n * \r\n * To be preferred : the asynchronous version with xxxAsync.\r\n */\r\nclass ParserExtension {\r\n\tqueue = [];\r\n\titem = null;\r\n\tasync = false;\r\n\tcompleteCount = 0;\r\n\tfatalError = null;\r\n\t\r\n\t/**\r\n\t * @abstract Constructor\r\n\t * \r\n\t * @param async - to be true if async mode is used (preferred)\r\n\t */\r\n\tconstructor(async = false) {\r\n\t\tthis.async = async;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract The inititialization method\r\n\t */\r\n\tinitialise() {\r\n\t\tvar inst = this;\r\n\t\ttry {\r\n\t\t\tif (!inst.async) {\r\n\t\t\t\t$.parser.onComplete = function(ctx) {\r\n\t\t\t\t\tinst.onComplete(ctx);\r\n\t\t\t\t\tinst.next(ctx);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$.parser.onComplete = function(ctx) {\r\n\t\t\t\t\tinst.onCompleteAsync(ctx);\r\n\t\t\t\t\tinst.nextAsync(ctx);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\tconsole.error(`Fatal Error: jquery not loaded ${e}`);\r\n\t\t\tthis.fatalError = e;\r\n\t\t\tthrow(e);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Parses object(s) for given selector.\r\n\t * \r\n\t * This method returns a Promise, e.g. is able to wait for the result of the call to become\r\n\t * ready.\r\n\t * \r\n\t * @param selector - the selector\r\n\t * @param ctx - a context parameter\r\n\t * @param delay - an optional delay (to be applied after the parser becomes ready)\r\n\t * @returns the Promise\r\n\t */\r\n\tasync parseAsync(selector, ctx, delay = 0) {\r\n\t\ttry {\r\n\t\t\tvar item = {\r\n\t\t\t\tctx: ctx,\r\n\t\t\t\tdelay: delay,\r\n\t\t\t\tselector: selector,\r\n\t\t\t\tpromise: null,\r\n\t\t\t\tonComplete: null\r\n\t\t\t};\r\n\t\t\tthis.queue.push(item);\r\n\t\t\tthis.nextAsync(ctx);\r\n\t\t\titem.promise = this.promisify(this, this.startParseAsync);\r\n\t\t\t\r\n\t\t\treturn item.promise;\r\n\t\t} catch(err) {\r\n\t\t\tPromise.reject(err);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Retrieves the next selector in the queue.\r\n\t */\r\n\tnextAsync(ctx) {\r\n\t\ttry {\r\n\t\t\tvar item = this.queue.shift();\r\n\t\t\tthis.item = item;\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`nextAsync without queued item for ${ctx} : ${this}`);\r\n\t\t\tthis.item = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Executes the prepared selector.\r\n\t */\r\n\tstartParseAsync(cb) {\r\n\t\tthis.item.onComplete = cb;\r\n\t\t$.parser.parse(this.item.selector);\t\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract The central completion routine.\r\n\t */\r\n\tonCompleteAsync(ctx) {\r\n\t\tthis.completeCount ++;\r\n\t\tif (typeof ctx != \"string\") {\r\n\t\t\tconsole.warn(`onCompleteAsync for external source - not handled.`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar item = this.item;\r\n\t\tif (item != null) {\r\n\t\t\tconsole.info(`onCompleteAsync for ${ctx}: ${this}`);\r\n\t\t\tthis.item = null;\r\n\t\t\tif (item.delay > 0) {\r\n\t\t\t\tvar timer = setInterval(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\titem.onComplete(null, item.ctx);\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t},\r\n\t\t\t\t\titem.delay);\r\n\t\t\t} else {\r\n\t\t\t\titem.onComplete(null, item.ctx);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(`onCompleteAsync for ${ctx} without active item: ${this}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\tparse(selector, ctx, onComplete, delay = 0) {\r\n\t\tthis.queue.push({\r\n\t\t\tselector: selector,\r\n\t\t\tonComplete: onComplete,\r\n\t\t\tctx: ctx,\r\n\t\t\tdelay: delay\r\n\t\t});\r\n\t\tconsole.info(`Parse after pushing: ${this}`);\r\n\t\tthis.next(ctx);\r\n\t}\r\n\t\r\n\tnext(ctx) {\r\n\t\ttry {\r\n\t\t\tvar item = this.queue.shift();\r\n\t\t\tthis.item = item;\r\n\t\t\t$.parser.parse(item.selector);\t\t\t\r\n\t\t} catch(e) {\r\n\t\t\tconsole.warn(`next without queued item: ${this}`);\r\n\t\t\tthis.item = null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tonComplete(ctx) {\r\n\t\tvar item = this.item;\r\n\t\tif (item != null) {\r\n\t\t\tconsole.info(`onComplete: ${this}`);\r\n\t\t\tthis.item = null;\r\n\t\t\tif (item.delay > 0) {\r\n\t\t\t\tvar timer = setInterval(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\titem.onComplete(item.selector, item.ctx);\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t},\r\n\t\t\t\t\titem.delay);\r\n\t\t\t} else {\r\n\t\t\t\titem.onComplete(item.selector, item.ctx);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(`onComplete without active item: ${this}`);\r\n\t\t}\r\n\t}\r\n\t\r\n\ttoString() {\r\n\t\treturn `Diagnostic info: number: ${this.completeCount}, active item: ${JSON.stringify(this.item)}, queue: ${JSON.stringify(this.queue)}`;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Converts a method with given signature and callback to a Promise returning method\r\n\t * \r\n\t */\r\n\tasync promisify(ob, fnc, ...args)\r\n\t{\r\n\t\treturn new Promise((resolve, reject) =>\r\n\t\t{\t\t\t\r\n\t\t\tfnc.bind(ob)(...args, (err, result) => {\r\n\t\t\t\t\r\n\t\t\tif (err)\r\n\t\t\t{\r\n\t\t\t\tconsole.error('Error occurred: ' + err)\t\t\r\n\t\t\t\treject(err);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tresolve(result);\r\n\t\t\t}});\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\t\r\n/**\r\n * @abstract Converts a method with given signature and callback to a Promise returning method\r\n * \r\n * @param ob - an object to be bound to the function parameter\r\n * @param fnc - a function object to be invoked\r\n * @param args - args of the function. The function has one additional callback parameter\r\n * @returns the Promise, will be fulfilled if the callback is invoked\r\n */\r\nasync function promisify(ob, fnc, ...args)\r\n{\r\n\treturn new Promise((resolve, reject) =>\r\n\t{\t\t\t\r\n\t\tfnc.bind(ob)(...args, (err, result) => {\r\n\t\t\t\r\n\t\tif (err)\r\n\t\t{\r\n\t\t\tconsole.error('Error occurred: ' + err)\t\t\r\n\t\t\treject(err);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tresolve(result);\r\n\t\t}});\r\n\t});\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { ParserExtension, promisify };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/parserExtension.js?")},"./src/assets/js/patterns/observable.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Observable: () => (/* binding */ Observable)\n/* harmony export */ });\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n/**\r\n * @abstract A simple implementation of the observable pattern.\r\n */\r\nclass Observable {\r\n\tobservers = null;\r\n  \r\n  /**\r\n   * @abstract Initialises the instance\r\n   */\r\n  constructor() {\r\n    this.observers = [];\r\n  }\r\n\r\n  /**\r\n   * @abstract Subscribes a function as an Observer.\r\n   * \r\n   * Supports also first time notification by providing additional arguments. This must be done\r\n   * by overriding this function in the Observable and providing the relevant argument(s).\r\n   */\r\n  subscribe(func, ...args) {\r\n    this.observers.push(func);\r\n    if (arguments.length > 1) {\t\t\t\t\t\t\t// indication that we want a first time notification\r\n\t\tfunc(...args);\r\n\t}\r\n  }\r\n\r\n  /**\r\n   * @abstract Unsubscribes a function from the Observers list.\r\n   */\r\n  unsubscribe(func) {\r\n    this.observers = this.observers.filter((observer) => observer !== func);\r\n  }\r\n\r\n  /**\r\n   * @abstract Notifies the Observers about an event of the Observable.\r\n   * \r\n   * The sent data is part of the contract between the Observable and its Observers\r\n   */\r\n  notify(...args) {\r\n    this.observers.forEach(function(observer) {\r\n\t\tvar potentialPromise = observer(...args);\r\n    \tif (potentialPromise instanceof Promise) {\r\n\t\t\tpotentialPromise.then(\r\n\t\t\t\t(value) => {}\r\n\t\t\t)\r\n\t\t}\r\n\t});\r\n  }\r\n\r\n  /**\r\n   * @abstract Notifies the Observers about an event of the Observable.\r\n   *\r\n   * This is the asynchronous variant of notify as asynchronous observers can be called\r\n   * The sent data is part of the contract between the Observable and its Observers\r\n   */\r\n  async notifyAsync(...args) {\r\n    this.observers.forEach(async function(observer) { \r\n\t\tvar potentialPromise = observer(...args);\r\n    \tif (potentialPromise instanceof Promise) {\r\n\t\t\tawait potentialPromise;\r\n\t\t}\r\n    });\r\n  }\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { Observable };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/patterns/observable.js?")},"./src/assets/js/themes.js":(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Themes: () => (/* binding */ Themes)\n/* harmony export */ });\n/* harmony import */ var _patterns_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./patterns/observable */ \"./src/assets/js/patterns/observable.js\");\n/* module decorator */ module = __webpack_require__.hmd(module);\n\r\n\r\n/**\r\n * @abstract Themes or Styles support. This is an Observable.\r\n * \r\n * @extends Observable\r\n */\r\nclass Themes extends _patterns_observable__WEBPACK_IMPORTED_MODULE_0__.Observable {\r\n\tdir = \"\";\r\n\tcssActive = false;\r\n\tactiveTheme = \"\";\r\n\t\r\n\t/**\r\n\t * @abstract Constructor.\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Appends attributes of one or more elements to another. \r\n\t */\r\n\tuniversalLoad(where, what) {\r\n\t\tfor (var entry of what) {\r\n\t\t\t$(where)\r\n\t\t\t.append(\r\n\t\t\t\t$(entry.element)\r\n\t\t\t\t.attr(entry.attributes)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Initializes the theme choice.\r\n\t * \r\n\t * This method must be invoked during initialization time.\r\n\t * \r\n\t * @param activeTheme - the theme as it comes from the stored parameters\r\n\t * @param dir - the language direction parameter (comes from the selected language)\r\n\t */\r\n\tasync initialiseThemeChoice(activeTheme, dir = 'ltr') {\r\n\t\tvar inst = this;\r\n\t\tawait this.appendCss(activeTheme, dir);\t\t\t\t\t\t\t\t\t\t\t\t// initialisation -> 'load' css files\r\n\t\t$(\"[name='style']\").filter(`[value=${activeTheme}]`).attr(\"checked\", \"checked\"); \t// select Radio button\r\n\r\n\t\t$(\"input[name='style']\").change(function() { \t\t\t\t\t\t\t\t\t\t// change handler of style changes\r\n\t\t\tvar activeTheme = $(\"input[name='style']:checked\").val(); \r\n\t\t\tinst.activateStyle(activeTheme).then(() => { });\r\n\t\t}); \r\n\t\t\r\n\t\tawait this.activateStyle(activeTheme);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Activate the style setting.\r\n\t * \r\n\t * This activates one and disables the others of several styles. On ready this method notifies\r\n\t * possible Observers registered on this Observable.\r\n\t * \r\n\t * @param activeTheme - the theme / style to be activated.\r\n\t */\r\n\tasync activateStyle(activeTheme) {\r\n\t\tif (activeTheme == this.activeTheme) {\t\t\t\t\t\t\t\t\t\t\t\t// no change\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis.activeTheme = activeTheme;\r\n\t\tvar colorType = '';\r\n\t\tvar opts = { with: { type: 'css' } };\r\n\t\tthis.disableThemeLinks();\r\n\r\n\t\t// TRYING alternative way\r\n\t\t// WORKS and loads all present themes!!\r\n\t\tvar mainTheme = activeTheme;\r\n\t\tif (activeTheme == 'aguas') { mainTheme = 'default'; }\r\n\t\tif (activeTheme == 'black') { colorType = 'black'; }\r\n\t\tawait __webpack_require__(\"./src/assets/js/jquery-easyui/themes lazy recursive ^\\\\.\\\\/.*\\\\/easyui\\\\.css$\")(`./${mainTheme}/easyui.css`);\r\n\t\tawait __webpack_require__(\"./src/assets/js/jquery-easyui-MathEditorExtend/themes lazy recursive ^\\\\.\\\\/.*\\\\/easyui\\\\.css$\")(`./${activeTheme}/easyui.css`);\r\n\t\t\r\n\t\tthis.enableThemeLinks(activeTheme);\r\n\t\tthis.notify(activeTheme, this.dir, colorType);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Disables link tags to the theme resources.\r\n\t * \r\n\t * The hope was this could enforce a new load of themes every time one selects any.\r\n\t * Yes, but it must be combined with *enableThemeLinks*.\r\n\t */\r\n\tdisableThemeLinks() {\r\n\t\t$('link[href$=\"easyui_css.styles.css\"]').attr('disabled', true);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Enables css link tags again after disabling them.\r\n\t */\r\n\tenableThemeLinks(theme) {\r\n\t\t$(`link[href$=\"${theme}_easyui_css.styles.css\"]`).removeAttr('disabled');\r\n\t\tif (theme == 'aguas') {\r\n\t\t\t$(`link[href$=\"default_easyui_css.styles.css\"]`).removeAttr('disabled'); \t// ?\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @abstract Appends a series of required CSS files to head of html.\r\n\t * \r\n\t * The HTML itself cannot do this, because the active theme dynamically changes. This is an\r\n\t * initialisation time task.\r\n\t * \r\n\t * @param activeTheme - the active theme\r\n\t * @param dir - direction of the active language (ltr or rtl)\r\n\t */\r\n\tasync appendCss(activeTheme, dir = 'ltr') {\r\n\t\tconsole.info(`Active theme is ${activeTheme}`);\r\n\t\t\r\n\t\tvar opts = { with: { \r\n\t\t\ttype: 'css',\r\n\t\t} };\r\n\t\tawait __webpack_require__.e(/*! import() */ \"src_assets_js_jquery-easyui-MathEditorExtend_themes_rtl_css\").then(__webpack_require__.bind(__webpack_require__, /*! ./jquery-easyui-MathEditorExtend/themes/rtl.css */ \"./src/assets/js/jquery-easyui-MathEditorExtend/themes/rtl.css\"));\r\n\t\t$('link').last()\r\n\t\t.attr('id', 'RTLstyle')\r\n\t\t.attr('disabled', true);\r\n\t\t\r\n\t\tthis.setRTLstyle(dir);\r\n\t\tthis.cssActive = true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @abstract Sets the RTL style.\r\n\t * \r\n\t * This enables / disables the RTL style file.\r\n\t * \r\n\t * @param dir - the direction ('ltr' or 'rtl')\r\n\t */\r\n\tsetRTLstyle(dir = 'ltr') {\r\n\t\tif (dir == this.dir) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.dir = dir;\r\n\t\tif (this.cssActive) {\r\n\t\t\tconsole.info(`Html Dir is: ${dir}`);\r\n\t\t\tvar disabled = document.getElementById(\"RTLstyle\").disabled;\r\n\t\t\tvar newDisabled = dir !== 'rtl';\t\t\t\t\t\t\t\t\t\t// suppress unnecessary changes => measure did not help\r\n\t\t\tif (newDisabled != disabled) {\r\n\t\t\t\tdocument.getElementById(\"RTLstyle\").disabled = newDisabled;\r\n\t\t\t\tconsole.info(`RTL style set to: ${newDisabled}`);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// This helps to import symbols in test suite\r\ntry {\r\n\tmodule.exports = { Themes };\r\n} catch(e) { }\r\n\n\n//# sourceURL=webpack://joplin-plugin-katex-input-helper/./src/assets/js/themes.js?")}},__webpack_module_cache__={},leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(t){var n=__webpack_module_cache__[t];if(void 0!==n)return n.exports;var e=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(e.exports,e,e.exports,__webpack_require__),e.loaded=!0,e.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},__webpack_require__.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(n,{a:n}),n},getProto=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,__webpack_require__.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var e=Object.create(null);__webpack_require__.r(e);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&n&&t;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((n=>r[n]=()=>t[n]));return r.default=()=>t,__webpack_require__.d(e,r),e},__webpack_require__.d=(t,n)=>{for(var e in n)__webpack_require__.o(n,e)&&!__webpack_require__.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((n,e)=>(__webpack_require__.f[e](t,n),n)),[])),__webpack_require__.u=t=>{if({src_assets_js_localization_ar_lang_json:1,src_assets_js_localization_de_DE_lang_json:1,src_assets_js_localization_en_US_lang_json:1,src_assets_js_localization_es_ES_lang_json:1,src_assets_js_localization_fr_FR_lang_json:1,src_assets_js_localization_ru_lang_json:1,src_assets_js_localization_vi_VN_lang_json:1,"src_assets_js_jquery-easyui_locale_easyui-lang-af_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-am_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-ar_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-bg_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-ca_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-cs_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-cz_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-da_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-de_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-el_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-en_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-es_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-fa_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-fr_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-it_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-jp_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-ko_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-nl_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-pl_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-pt_BR_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-ru_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-sv_SE_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-tr_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-ua_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-zh_CN_js":1,"src_assets_js_jquery-easyui_locale_easyui-lang-zh_TW_js":1,src_assets_js_i18n_icons_ar_png:1,src_assets_js_i18n_icons_de_png:1,src_assets_js_i18n_icons_es_png:1,src_assets_js_i18n_icons_fr_png:1,src_assets_js_i18n_icons_ru_png:1,src_assets_js_i18n_icons_us_png:1,src_assets_js_i18n_icons_vi_png:1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_rtl_css":1,"src_assets_js_jquery-easyui_themes_aguas_easyui_css":1,"src_assets_js_jquery-easyui_themes_black_easyui_css":1,"src_assets_js_jquery-easyui_themes_bootstrap_easyui_css":1,"src_assets_js_jquery-easyui_themes_default_easyui_css":1,"src_assets_js_jquery-easyui_themes_gray_easyui_css":1,"src_assets_js_jquery-easyui_themes_material-blue_easyui_css":1,"src_assets_js_jquery-easyui_themes_material-teal_easyui_css":1,"src_assets_js_jquery-easyui_themes_material_easyui_css":1,"src_assets_js_jquery-easyui_themes_metro_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_aguas_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_black_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_bootstrap_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_gray_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_metro_easyui_css":1}[t])return"js/"+t+".js"},__webpack_require__.miniCssF=t=>"css/"+t+".styles.css",__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),inProgress={},dataWebpackPrefix="joplin-plugin-katex-input-helper:",__webpack_require__.l=(t,n,e,r)=>{if(inProgress[t])inProgress[t].push(n);else{var a,i;if(void 0!==e)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var l=o[s];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==dataWebpackPrefix+e){a=l;break}}a||(i=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+e),a.src=t),inProgress[t]=[n];var d=(n,e)=>{a.onerror=a.onload=null,clearTimeout(c);var r=inProgress[t];if(delete inProgress[t],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(e))),n)return n(e)},c=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),i&&document.head.appendChild(a)}},__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.p="/Katex-Input-Helper/",(()=>{if("undefined"!=typeof document){var t=t=>new Promise(((n,e)=>{var r=__webpack_require__.miniCssF(t),a=__webpack_require__.p+r;if(((t,n)=>{for(var e=document.getElementsByTagName("link"),r=0;r<e.length;r++){var a=(o=e[r]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===t||a===n))return o}var i=document.getElementsByTagName("style");for(r=0;r<i.length;r++){var o;if((a=(o=i[r]).getAttribute("data-href"))===t||a===n)return o}})(r,a))return n();((t,n,e,r,a)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",__webpack_require__.nc&&(i.nonce=__webpack_require__.nc),i.onerror=i.onload=e=>{if(i.onerror=i.onload=null,"load"===e.type)r();else{var o=e&&e.type,s=e&&e.target&&e.target.href||n,l=new Error("Loading CSS chunk "+t+" failed.\n("+o+": "+s+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=s,i.parentNode&&i.parentNode.removeChild(i),a(l)}},i.href=n,e?e.parentNode.insertBefore(i,e.nextSibling):document.head.appendChild(i)})(t,a,null,n,e)})),n={main:0};__webpack_require__.f.miniCss=(e,r)=>{n[e]?r.push(n[e]):0!==n[e]&&{"src_assets_js_jquery-easyui-MathEditorExtend_themes_rtl_css":1,"src_assets_js_jquery-easyui_themes_aguas_easyui_css":1,"src_assets_js_jquery-easyui_themes_black_easyui_css":1,"src_assets_js_jquery-easyui_themes_bootstrap_easyui_css":1,"src_assets_js_jquery-easyui_themes_gray_easyui_css":1,"src_assets_js_jquery-easyui_themes_material-blue_easyui_css":1,"src_assets_js_jquery-easyui_themes_material-teal_easyui_css":1,"src_assets_js_jquery-easyui_themes_material_easyui_css":1,"src_assets_js_jquery-easyui_themes_metro_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_black_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_bootstrap_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_gray_easyui_css":1,"src_assets_js_jquery-easyui-MathEditorExtend_themes_metro_easyui_css":1}[e]&&r.push(n[e]=t(e).then((()=>{n[e]=0}),(t=>{throw delete n[e],t})))}}})(),(()=>{var t={main:0};__webpack_require__.f.j=(n,e)=>{var r=__webpack_require__.o(t,n)?t[n]:void 0;if(0!==r)if(r)e.push(r[2]);else{var a=new Promise(((e,a)=>r=t[n]=[e,a]));e.push(r[2]=a);var i=__webpack_require__.p+__webpack_require__.u(n),o=new Error;__webpack_require__.l(i,(e=>{if(__webpack_require__.o(t,n)&&(0!==(r=t[n])&&(t[n]=void 0),r)){var a=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;o.message="Loading chunk "+n+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,r[1](o)}}),"chunk-"+n,n)}};var n=(n,e)=>{var r,a,[i,o,s]=e,l=0;if(i.some((n=>0!==t[n]))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(s)s(__webpack_require__)}for(n&&n(e);l<i.length;l++)a=i[l],__webpack_require__.o(t,a)&&t[a]&&t[a][0](),t[a]=0},e=self.webpackChunkjoplin_plugin_katex_input_helper=self.webpackChunkjoplin_plugin_katex_input_helper||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))})();var __webpack_exports__=__webpack_require__("./src/assets/js/bootLoader.js")})();